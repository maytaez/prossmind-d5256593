var Ek=Object.defineProperty;var Zg=t=>{throw TypeError(t)};var Sk=(t,e,n)=>e in t?Ek(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var uo=(t,e,n)=>Sk(t,typeof e!="symbol"?e+"":e,n),th=(t,e,n)=>e.has(t)||Zg("Cannot "+n);var z=(t,e,n)=>(th(t,e,"read from private field"),n?n.call(t):e.get(t)),nt=(t,e,n)=>e.has(t)?Zg("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),De=(t,e,n,r)=>(th(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Jt=(t,e,n)=>(th(t,e,"access private method"),n);var sl=(t,e,n,r)=>({set _(i){De(t,e,i,n)},get _(){return z(t,e,r)}});import{j as o,A as nw,m as he,u as rw,a as Do,b as jk}from"./framer-motion-Bp83z11m.js";import{a as yd,r as y,R as W,v as Nk,u as af,d as kk,c as Un,L as pn,e as Ps,B as Ck,f as Pk,h as Ir,i as Tk}from"./react-vendor-B6gVOSLb.js";import{P as Pe,c as of,a as Vn,u as gt,B as Rk,b as dr,d as Oi,e as Tn,f as Ee,R as Ak,g as iw,h as jn,i as Ik,j as xd,A as sw,D as aw,C as ow,k as cw,l as lw,S as dw,O as uc,m as hc,n as bd,T as pc,o as fc,p as cf,q as lf,r as uw,s as hw,t as pw,v as Mk,w as fw,I as mw,x as gw,y as vw,z as yw,L as xw,E as bw,F as Dk,G as Ok,H as La,J as mc,K as $k,M as ww,W as Lk,N as wd,Q as _w,U as Ew,V as Bk,X as Fk,Y as zk,Z as Uk,_ as Hk,$ as Vk,a0 as Gk,a1 as Sw,a2 as Wk,a3 as qk}from"./ui-vendor-DjdtDkvh.js";import{l as Kk}from"./lottie-0gGhPYUH.js";import{B as df,e as fe,I as Yk,i as Ue,a as je,b as Hn,c as L,d as Dt,f as gc,t as Es,g as Ss,h as Zk,V as vc,j as I,s as Kr,k as Ve,l as uf,m as Ht,n as mn,q as Ct,o as Wo,p as ar,r as _d,u as lt,v as hf,O as jw,w as Pn,x as Nw,y as ya,z as Xr,C as Z,A as Ed,D as mt,E as Yt,F as $i,G as ye,H as we,J as Sd,K as Me,L as Vt,M as ce,N as _,P as pf,Q as jd,R as Nd,S as Vr,T as gn,U as ff,W as jr,X as We,Y as nh,Z as kw,_ as Nr,$ as Cw,a0 as Xk,a1 as ie,a2 as dt,a3 as ae,a4 as Y,a5 as Vh,a6 as Ur,a7 as an,a8 as Jk,a9 as on,aa as mf,ab as Xg,ac as Qk,ad as Pw,ae as Gh,af as Yr,ag as kd,ah as Wh,ai as eC,aj as Tw,ak as sa,al as Cd,am as gf,an as cn,ao as Ot,ap as At,aq as at,ar as ze,as as Pd,at as qo,au as xa,av as js,aw as Rn,ax as Ze,ay as yc,az as Ko,aA as Rw,aB as xc,aC as ea,aD as Al,aE as is,aF as Jg,aG as tC,aH as nC,aI as rC,aJ as iC,aK as sC,aL as Aw,aM as Pi,aN as qh,aO as Iw,aP as aC,aQ as vf,aR as oC,aS as yf,aT as cC,aU as lC,aV as dC,aW as uC,aX as Kh,aY as Mw,aZ as hC,a_ as pC,a$ as Qg,b0 as Dw,b1 as fC,b2 as xf,b3 as mC,b4 as Ow,b5 as $w,b6 as gC,b7 as vC,b8 as yC}from"./bpmn-vendor-Ci46SDFT.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Lw,ev=yd;Lw=ev.createRoot,ev.hydrateRoot;const xC=1,bC=1e6;let rh=0;function wC(){return rh=(rh+1)%Number.MAX_SAFE_INTEGER,rh.toString()}const ih=new Map,tv=t=>{if(ih.has(t))return;const e=setTimeout(()=>{ih.delete(t),Oo({type:"REMOVE_TOAST",toastId:t})},bC);ih.set(t,e)},_C=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,xC)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?tv(n):t.toasts.forEach(r=>{tv(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},Il=[];let Ml={toasts:[]};function Oo(t){Ml=_C(Ml,t),Il.forEach(e=>{e(Ml)})}function EC({...t}){const e=wC(),n=i=>Oo({type:"UPDATE_TOAST",toast:{...i,id:e}}),r=()=>Oo({type:"DISMISS_TOAST",toastId:e});return Oo({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:i=>{i||r()}}}),{id:e,dismiss:r,update:n}}function bf(){const[t,e]=y.useState(Ml);return y.useEffect(()=>(Il.push(e),()=>{const n=Il.indexOf(e);n>-1&&Il.splice(n,1)}),[t]),{...t,toast:EC,dismiss:n=>Oo({type:"DISMISS_TOAST",toastId:n})}}var Bw=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),SC="VisuallyHidden",Td=y.forwardRef((t,e)=>o.jsx(Pe.span,{...t,ref:e,style:{...Bw,...t.style}}));Td.displayName=SC;var jC=Td,wf="ToastProvider",[_f,NC,kC]=of("Toast"),[Fw,QF]=Vn("Toast",[kC]),[CC,Rd]=Fw(wf),zw=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:i="right",swipeThreshold:s=50,children:a}=t,[c,l]=y.useState(null),[d,u]=y.useState(0),h=y.useRef(!1),p=y.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${wf}\`. Expected non-empty \`string\`.`),o.jsx(_f.Provider,{scope:e,children:o.jsx(CC,{scope:e,label:n,duration:r,swipeDirection:i,swipeThreshold:s,toastCount:d,viewport:c,onViewportChange:l,onToastAdd:y.useCallback(()=>u(f=>f+1),[]),onToastRemove:y.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:p,children:a})})};zw.displayName=wf;var Uw="ToastViewport",PC=["F8"],Yh="toast.viewportPause",Zh="toast.viewportResume",Hw=y.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=PC,label:i="Notifications ({hotkey})",...s}=t,a=Rd(Uw,n),c=NC(n),l=y.useRef(null),d=y.useRef(null),u=y.useRef(null),h=y.useRef(null),p=gt(e,h,a.onViewportChange),f=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),m=a.toastCount>0;y.useEffect(()=>{const g=w=>{var x;r.length!==0&&r.every(E=>w[E]||w.code===E)&&((x=h.current)==null||x.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[r]),y.useEffect(()=>{const g=l.current,w=h.current;if(m&&g&&w){const b=()=>{if(!a.isClosePausedRef.current){const j=new CustomEvent(Yh);w.dispatchEvent(j),a.isClosePausedRef.current=!0}},x=()=>{if(a.isClosePausedRef.current){const j=new CustomEvent(Zh);w.dispatchEvent(j),a.isClosePausedRef.current=!1}},E=j=>{!g.contains(j.relatedTarget)&&x()},N=()=>{g.contains(document.activeElement)||x()};return g.addEventListener("focusin",b),g.addEventListener("focusout",E),g.addEventListener("pointermove",b),g.addEventListener("pointerleave",N),window.addEventListener("blur",b),window.addEventListener("focus",x),()=>{g.removeEventListener("focusin",b),g.removeEventListener("focusout",E),g.removeEventListener("pointermove",b),g.removeEventListener("pointerleave",N),window.removeEventListener("blur",b),window.removeEventListener("focus",x)}}},[m,a.isClosePausedRef]);const v=y.useCallback(({tabbingDirection:g})=>{const b=c().map(x=>{const E=x.ref.current,N=[E,...UC(E)];return g==="forwards"?N:N.reverse()});return(g==="forwards"?b.reverse():b).flat()},[c]);return y.useEffect(()=>{const g=h.current;if(g){const w=b=>{var N,j,C;const x=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!x){const R=document.activeElement,T=b.shiftKey;if(b.target===g&&T){(N=d.current)==null||N.focus();return}const D=v({tabbingDirection:T?"backwards":"forwards"}),q=D.findIndex(F=>F===R);sh(D.slice(q+1))?b.preventDefault():T?(j=d.current)==null||j.focus():(C=u.current)==null||C.focus()}};return g.addEventListener("keydown",w),()=>g.removeEventListener("keydown",w)}},[c,v]),o.jsxs(Rk,{ref:l,role:"region","aria-label":i.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:m?void 0:"none"},children:[m&&o.jsx(Xh,{ref:d,onFocusFromOutsideViewport:()=>{const g=v({tabbingDirection:"forwards"});sh(g)}}),o.jsx(_f.Slot,{scope:n,children:o.jsx(Pe.ol,{tabIndex:-1,...s,ref:p})}),m&&o.jsx(Xh,{ref:u,onFocusFromOutsideViewport:()=>{const g=v({tabbingDirection:"backwards"});sh(g)}})]})});Hw.displayName=Uw;var Vw="ToastFocusProxy",Xh=y.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...i}=t,s=Rd(Vw,n);return o.jsx(Td,{"aria-hidden":!0,tabIndex:0,...i,ref:e,style:{position:"fixed"},onFocus:a=>{var d;const c=a.relatedTarget;!((d=s.viewport)!=null&&d.contains(c))&&r()}})});Xh.displayName=Vw;var bc="Toast",TC="toast.swipeStart",RC="toast.swipeMove",AC="toast.swipeCancel",IC="toast.swipeEnd",Gw=y.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:i,onOpenChange:s,...a}=t,[c,l]=dr({prop:r,defaultProp:i??!0,onChange:s,caller:bc});return o.jsx(Oi,{present:n||c,children:o.jsx(OC,{open:c,...a,ref:e,onClose:()=>l(!1),onPause:Tn(t.onPause),onResume:Tn(t.onResume),onSwipeStart:Ee(t.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Ee(t.onSwipeMove,d=>{const{x:u,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:Ee(t.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Ee(t.onSwipeEnd,d=>{const{x:u,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),l(!1)})})})});Gw.displayName=bc;var[MC,DC]=Fw(bc,{onClose(){}}),OC=y.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:i,open:s,onClose:a,onEscapeKeyDown:c,onPause:l,onResume:d,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:p,onSwipeEnd:f,...m}=t,v=Rd(bc,n),[g,w]=y.useState(null),b=gt(e,F=>w(F)),x=y.useRef(null),E=y.useRef(null),N=i||v.duration,j=y.useRef(0),C=y.useRef(N),R=y.useRef(0),{onToastAdd:T,onToastRemove:$}=v,B=Tn(()=>{var xe;(g==null?void 0:g.contains(document.activeElement))&&((xe=v.viewport)==null||xe.focus()),a()}),D=y.useCallback(F=>{!F||F===1/0||(window.clearTimeout(R.current),j.current=new Date().getTime(),R.current=window.setTimeout(B,F))},[B]);y.useEffect(()=>{const F=v.viewport;if(F){const xe=()=>{D(C.current),d==null||d()},de=()=>{const Be=new Date().getTime()-j.current;C.current=C.current-Be,window.clearTimeout(R.current),l==null||l()};return F.addEventListener(Yh,de),F.addEventListener(Zh,xe),()=>{F.removeEventListener(Yh,de),F.removeEventListener(Zh,xe)}}},[v.viewport,N,l,d,D]),y.useEffect(()=>{s&&!v.isClosePausedRef.current&&D(N)},[s,N,v.isClosePausedRef,D]),y.useEffect(()=>(T(),()=>$()),[T,$]);const q=y.useMemo(()=>g?Jw(g):null,[g]);return v.viewport?o.jsxs(o.Fragment,{children:[q&&o.jsx($C,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:q}),o.jsx(MC,{scope:n,onClose:B,children:yd.createPortal(o.jsx(_f.ItemSlot,{scope:n,children:o.jsx(Ak,{asChild:!0,onEscapeKeyDown:Ee(c,()=>{v.isFocusedToastEscapeKeyDownRef.current||B(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:o.jsx(Pe.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":v.swipeDirection,...m,ref:b,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Ee(t.onKeyDown,F=>{F.key==="Escape"&&(c==null||c(F.nativeEvent),F.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,B()))}),onPointerDown:Ee(t.onPointerDown,F=>{F.button===0&&(x.current={x:F.clientX,y:F.clientY})}),onPointerMove:Ee(t.onPointerMove,F=>{if(!x.current)return;const xe=F.clientX-x.current.x,de=F.clientY-x.current.y,Be=!!E.current,$e=["left","right"].includes(v.swipeDirection),pe=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,Ke=$e?pe(0,xe):0,Ye=$e?0:pe(0,de),Te=F.pointerType==="touch"?10:2,Se={x:Ke,y:Ye},_e={originalEvent:F,delta:Se};Be?(E.current=Se,al(RC,h,_e,{discrete:!1})):nv(Se,v.swipeDirection,Te)?(E.current=Se,al(TC,u,_e,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs(xe)>Te||Math.abs(de)>Te)&&(x.current=null)}),onPointerUp:Ee(t.onPointerUp,F=>{const xe=E.current,de=F.target;if(de.hasPointerCapture(F.pointerId)&&de.releasePointerCapture(F.pointerId),E.current=null,x.current=null,xe){const Be=F.currentTarget,$e={originalEvent:F,delta:xe};nv(xe,v.swipeDirection,v.swipeThreshold)?al(IC,f,$e,{discrete:!0}):al(AC,p,$e,{discrete:!0}),Be.addEventListener("click",pe=>pe.preventDefault(),{once:!0})}})})})}),v.viewport)})]}):null}),$C=t=>{const{__scopeToast:e,children:n,...r}=t,i=Rd(bc,e),[s,a]=y.useState(!1),[c,l]=y.useState(!1);return FC(()=>a(!0)),y.useEffect(()=>{const d=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(d)},[]),c?null:o.jsx(iw,{asChild:!0,children:o.jsx(Td,{...r,children:s&&o.jsxs(o.Fragment,{children:[i.label," ",n]})})})},LC="ToastTitle",Ww=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return o.jsx(Pe.div,{...r,ref:e})});Ww.displayName=LC;var BC="ToastDescription",qw=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return o.jsx(Pe.div,{...r,ref:e})});qw.displayName=BC;var Kw="ToastAction",Yw=y.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?o.jsx(Xw,{altText:n,asChild:!0,children:o.jsx(Ef,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${Kw}\`. Expected non-empty \`string\`.`),null)});Yw.displayName=Kw;var Zw="ToastClose",Ef=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,i=DC(Zw,n);return o.jsx(Xw,{asChild:!0,children:o.jsx(Pe.button,{type:"button",...r,ref:e,onClick:Ee(t.onClick,i.onClose)})})});Ef.displayName=Zw;var Xw=y.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...i}=t;return o.jsx(Pe.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...i,ref:e})});function Jw(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),zC(r)){const i=r.ariaHidden||r.hidden||r.style.display==="none",s=r.dataset.radixToastAnnounceExclude==="";if(!i)if(s){const a=r.dataset.radixToastAnnounceAlt;a&&e.push(a)}else e.push(...Jw(r))}}),e}function al(t,e,n,{discrete:r}){const i=n.originalEvent.currentTarget,s=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?Ik(i,s):i.dispatchEvent(s)}var nv=(t,e,n=0)=>{const r=Math.abs(t.x),i=Math.abs(t.y),s=r>i;return e==="left"||e==="right"?s&&r>n:!s&&i>n};function FC(t=()=>{}){const e=Tn(t);jn(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function zC(t){return t.nodeType===t.ELEMENT_NODE}function UC(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function sh(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var HC=zw,Qw=Hw,e0=Gw,t0=Ww,n0=qw,r0=Yw,i0=Ef;function s0(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=s0(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function ba(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=s0(t))&&(r&&(r+=" "),r+=e);return r}const rv=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,iv=ba,Ba=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return iv(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:s}=e,a=Object.keys(i).map(d=>{const u=n==null?void 0:n[d],h=s==null?void 0:s[d];if(u===null)return null;const p=rv(u)||rv(h);return i[d][p]}),c=n&&Object.entries(n).reduce((d,u)=>{let[h,p]=u;return p===void 0||(d[h]=p),d},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((d,u)=>{let{class:h,className:p,...f}=u;return Object.entries(f).every(m=>{let[v,g]=m;return Array.isArray(g)?g.includes({...s,...c}[v]):{...s,...c}[v]===g})?[...d,h,p]:d},[]);return iv(t,a,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VC=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a0=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var GC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=y.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...c},l)=>y.createElement("svg",{ref:l,...GC,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:a0("lucide",i),...c},[...a.map(([d,u])=>y.createElement(d,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=(t,e)=>{const n=y.forwardRef(({className:r,...i},s)=>y.createElement(WC,{ref:s,iconNode:e,className:a0(`lucide-${VC(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sv=se("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const av=se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=se("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=se("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KC=se("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=se("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=se("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ov=se("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=se("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=se("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=se("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=se("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cv=se("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=se("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=se("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e2=se("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lv=se("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t2=se("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=se("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jh=se("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n2=se("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=se("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r2=se("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i2=se("Hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ah=se("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=se("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qh=se("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dv=se("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=se("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uv=se("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s2=se("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a2=se("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oh=se("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o2=se("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c2=se("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l2=se("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=se("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=se("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=se("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=se("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=se("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=se("MousePointerClick",[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p2=se("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=se("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=se("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=se("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hv=se("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pv=se("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=se("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=se("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=se("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=se("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=se("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fv=se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=se("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=se("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=se("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mv=se("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gv=se("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vv=se("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ch=se("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=se("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yv=se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xv=se("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nf=se("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=se("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=se("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lh=se("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bv=se("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),kf="-",j2=t=>{const e=k2(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const c=a.split(kf);return c[0]===""&&c.length!==1&&c.shift(),u0(c,e)||N2(a)},getConflictingClassGroupIds:(a,c)=>{const l=n[a]||[];return c&&r[a]?[...l,...r[a]]:l}}},u0=(t,e)=>{var a;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),i=r?u0(t.slice(1),r):void 0;if(i)return i;if(e.validators.length===0)return;const s=t.join(kf);return(a=e.validators.find(({validator:c})=>c(s)))==null?void 0:a.classGroupId},wv=/^\[(.+)\]$/,N2=t=>{if(wv.test(t)){const e=wv.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},k2=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return P2(Object.entries(t.classGroups),n).forEach(([s,a])=>{tp(a,r,s,e)}),r},tp=(t,e,n,r)=>{t.forEach(i=>{if(typeof i=="string"){const s=i===""?e:_v(e,i);s.classGroupId=n;return}if(typeof i=="function"){if(C2(i)){tp(i(r),e,n,r);return}e.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([s,a])=>{tp(a,_v(e,s),n,r)})})},_v=(t,e)=>{let n=t;return e.split(kf).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},C2=t=>t.isThemeGetter,P2=(t,e)=>e?t.map(([n,r])=>{const i=r.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([a,c])=>[e+a,c])):s);return[n,i]}):t,T2=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const i=(s,a)=>{n.set(s,a),e++,e>t&&(e=0,r=n,n=new Map)};return{get(s){let a=n.get(s);if(a!==void 0)return a;if((a=r.get(s))!==void 0)return i(s,a),a},set(s,a){n.has(s)?n.set(s,a):i(s,a)}}},h0="!",R2=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,i=e[0],s=e.length,a=c=>{const l=[];let d=0,u=0,h;for(let g=0;g<c.length;g++){let w=c[g];if(d===0){if(w===i&&(r||c.slice(g,g+s)===e)){l.push(c.slice(u,g)),u=g+s;continue}if(w==="/"){h=g;continue}}w==="["?d++:w==="]"&&d--}const p=l.length===0?c:c.substring(u),f=p.startsWith(h0),m=f?p.substring(1):p,v=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:f,baseClassName:m,maybePostfixModifierPosition:v}};return n?c=>n({className:c,parseClassName:a}):a},A2=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},I2=t=>({cache:T2(t.cacheSize),parseClassName:R2(t),...j2(t)}),M2=/\s+/,D2=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i}=e,s=[],a=t.trim().split(M2);let c="";for(let l=a.length-1;l>=0;l-=1){const d=a[l],{modifiers:u,hasImportantModifier:h,baseClassName:p,maybePostfixModifierPosition:f}=n(d);let m=!!f,v=r(m?p.substring(0,f):p);if(!v){if(!m){c=d+(c.length>0?" "+c:c);continue}if(v=r(p),!v){c=d+(c.length>0?" "+c:c);continue}m=!1}const g=A2(u).join(":"),w=h?g+h0:g,b=w+v;if(s.includes(b))continue;s.push(b);const x=i(v,m);for(let E=0;E<x.length;++E){const N=x[E];s.push(w+N)}c=d+(c.length>0?" "+c:c)}return c};function O2(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=p0(e))&&(r&&(r+=" "),r+=n);return r}const p0=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=p0(t[r]))&&(n&&(n+=" "),n+=e);return n};function $2(t,...e){let n,r,i,s=a;function a(l){const d=e.reduce((u,h)=>h(u),t());return n=I2(d),r=n.cache.get,i=n.cache.set,s=c,c(l)}function c(l){const d=r(l);if(d)return d;const u=D2(l,n);return i(l,u),u}return function(){return s(O2.apply(null,arguments))}}const yt=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},f0=/^\[(?:([a-z-]+):)?(.+)\]$/i,L2=/^\d+\/\d+$/,B2=new Set(["px","full","screen"]),F2=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,z2=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,U2=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,H2=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,V2=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Mr=t=>oa(t)||B2.has(t)||L2.test(t),ui=t=>Fa(t,"length",J2),oa=t=>!!t&&!Number.isNaN(Number(t)),dh=t=>Fa(t,"number",oa),ho=t=>!!t&&Number.isInteger(Number(t)),G2=t=>t.endsWith("%")&&oa(t.slice(0,-1)),Le=t=>f0.test(t),hi=t=>F2.test(t),W2=new Set(["length","size","percentage"]),q2=t=>Fa(t,W2,m0),K2=t=>Fa(t,"position",m0),Y2=new Set(["image","url"]),Z2=t=>Fa(t,Y2,eP),X2=t=>Fa(t,"",Q2),po=()=>!0,Fa=(t,e,n)=>{const r=f0.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},J2=t=>z2.test(t)&&!U2.test(t),m0=()=>!1,Q2=t=>H2.test(t),eP=t=>V2.test(t),tP=()=>{const t=yt("colors"),e=yt("spacing"),n=yt("blur"),r=yt("brightness"),i=yt("borderColor"),s=yt("borderRadius"),a=yt("borderSpacing"),c=yt("borderWidth"),l=yt("contrast"),d=yt("grayscale"),u=yt("hueRotate"),h=yt("invert"),p=yt("gap"),f=yt("gradientColorStops"),m=yt("gradientColorStopPositions"),v=yt("inset"),g=yt("margin"),w=yt("opacity"),b=yt("padding"),x=yt("saturate"),E=yt("scale"),N=yt("sepia"),j=yt("skew"),C=yt("space"),R=yt("translate"),T=()=>["auto","contain","none"],$=()=>["auto","hidden","clip","visible","scroll"],B=()=>["auto",Le,e],D=()=>[Le,e],q=()=>["",Mr,ui],F=()=>["auto",oa,Le],xe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],de=()=>["solid","dashed","dotted","double","none"],Be=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],$e=()=>["start","end","center","between","around","evenly","stretch"],pe=()=>["","0",Le],Ke=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Ye=()=>[oa,Le];return{cacheSize:500,separator:":",theme:{colors:[po],spacing:[Mr,ui],blur:["none","",hi,Le],brightness:Ye(),borderColor:[t],borderRadius:["none","","full",hi,Le],borderSpacing:D(),borderWidth:q(),contrast:Ye(),grayscale:pe(),hueRotate:Ye(),invert:pe(),gap:D(),gradientColorStops:[t],gradientColorStopPositions:[G2,ui],inset:B(),margin:B(),opacity:Ye(),padding:D(),saturate:Ye(),scale:Ye(),sepia:pe(),skew:Ye(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",Le]}],container:["container"],columns:[{columns:[hi]}],"break-after":[{"break-after":Ke()}],"break-before":[{"break-before":Ke()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...xe(),Le]}],overflow:[{overflow:$()}],"overflow-x":[{"overflow-x":$()}],"overflow-y":[{"overflow-y":$()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ho,Le]}],basis:[{basis:B()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Le]}],grow:[{grow:pe()}],shrink:[{shrink:pe()}],order:[{order:["first","last","none",ho,Le]}],"grid-cols":[{"grid-cols":[po]}],"col-start-end":[{col:["auto",{span:["full",ho,Le]},Le]}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":[po]}],"row-start-end":[{row:["auto",{span:[ho,Le]},Le]}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Le]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Le]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...$e()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...$e(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...$e(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Le,e]}],"min-w":[{"min-w":[Le,e,"min","max","fit"]}],"max-w":[{"max-w":[Le,e,"none","full","min","max","fit","prose",{screen:[hi]},hi]}],h:[{h:[Le,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Le,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Le,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Le,e,"auto","min","max","fit"]}],"font-size":[{text:["base",hi,ui]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",dh]}],"font-family":[{font:[po]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Le]}],"line-clamp":[{"line-clamp":["none",oa,dh]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Mr,Le]}],"list-image":[{"list-image":["none",Le]}],"list-style-type":[{list:["none","disc","decimal",Le]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Mr,ui]}],"underline-offset":[{"underline-offset":["auto",Mr,Le]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Le]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Le]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...xe(),K2]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",q2]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Z2]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...de(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:de()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...de()]}],"outline-offset":[{"outline-offset":[Mr,Le]}],"outline-w":[{outline:[Mr,ui]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[Mr,ui]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",hi,X2]}],"shadow-color":[{shadow:[po]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...Be(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Be()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",hi,Le]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[x]}],sepia:[{sepia:[N]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[N]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Le]}],duration:[{duration:Ye()}],ease:[{ease:["linear","in","out","in-out",Le]}],delay:[{delay:Ye()}],animate:[{animate:["none","spin","ping","pulse","bounce",Le]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[E]}],"scale-x":[{"scale-x":[E]}],"scale-y":[{"scale-y":[E]}],rotate:[{rotate:[ho,Le]}],"translate-x":[{"translate-x":[R]}],"translate-y":[{"translate-y":[R]}],"skew-x":[{"skew-x":[j]}],"skew-y":[{"skew-y":[j]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Le]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Le]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Le]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Mr,ui,dh]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},nP=$2(tP);function J(...t){return nP(ba(t))}const rP=HC,g0=y.forwardRef(({className:t,...e},n)=>o.jsx(Qw,{ref:n,className:J("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));g0.displayName=Qw.displayName;const iP=Ba("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),v0=y.forwardRef(({className:t,variant:e,...n},r)=>o.jsx(e0,{ref:r,className:J(iP({variant:e}),t),...n}));v0.displayName=e0.displayName;const sP=y.forwardRef(({className:t,...e},n)=>o.jsx(r0,{ref:n,className:J("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...e}));sP.displayName=r0.displayName;const y0=y.forwardRef(({className:t,...e},n)=>o.jsx(i0,{ref:n,className:J("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:o.jsx(wr,{className:"h-4 w-4"})}));y0.displayName=i0.displayName;const x0=y.forwardRef(({className:t,...e},n)=>o.jsx(t0,{ref:n,className:J("text-sm font-semibold",t),...e}));x0.displayName=t0.displayName;const b0=y.forwardRef(({className:t,...e},n)=>o.jsx(n0,{ref:n,className:J("text-sm opacity-90",t),...e}));b0.displayName=n0.displayName;function aP(){const{toasts:t}=bf();return o.jsxs(rP,{children:[t.map(function({id:e,title:n,description:r,action:i,...s}){return o.jsxs(v0,{...s,children:[o.jsxs("div",{className:"grid gap-1",children:[n&&o.jsx(x0,{children:n}),r&&o.jsx(b0,{children:r})]}),i,o.jsx(y0,{})]},e)}),o.jsx(g0,{})]})}var Ev=["light","dark"],oP="(prefers-color-scheme: dark)",cP=y.createContext(void 0),lP={setTheme:t=>{},themes:[]},dP=()=>{var t;return(t=y.useContext(cP))!=null?t:lP};y.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:r,enableColorScheme:i,defaultTheme:s,value:a,attrs:c,nonce:l})=>{let d=s==="system",u=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${c.map(m=>`'${m}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,h=i?Ev.includes(s)&&s?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${s}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",p=(m,v=!1,g=!0)=>{let w=a?a[m]:m,b=v?m+"|| ''":`'${w}'`,x="";return i&&g&&!v&&Ev.includes(m)&&(x+=`d.style.colorScheme = '${m}';`),n==="class"?v||w?x+=`c.add(${b})`:x+="null":w&&(x+=`d[s](n,${b})`),x},f=t?`!function(){${u}${p(t)}}()`:r?`!function(){try{${u}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${d})){var t='${oP}',m=window.matchMedia(t);if(m.media!==t||m.matches){${p("dark")}}else{${p("light")}}}else if(e){${a?`var x=${JSON.stringify(a)};`:""}${p(a?"x[e]":"e",!0)}}${d?"":"else{"+p(s,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${e}');if(e){${a?`var x=${JSON.stringify(a)};`:""}${p(a?"x[e]":"e",!0)}}else{${p(s,!1,!1)};}${h}}catch(t){}}();`;return y.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:f}})});var uP=t=>{switch(t){case"success":return fP;case"info":return gP;case"warning":return mP;case"error":return vP;default:return null}},hP=Array(12).fill(0),pP=({visible:t,className:e})=>W.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},W.createElement("div",{className:"sonner-spinner"},hP.map((n,r)=>W.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),fP=W.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},W.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),mP=W.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},W.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),gP=W.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},W.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),vP=W.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},W.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),yP=W.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},W.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),W.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),xP=()=>{let[t,e]=W.useState(document.hidden);return W.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},np=1,bP=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:n,...r}=t,i=typeof(t==null?void 0:t.id)=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:np++,s=this.toasts.find(c=>c.id===i),a=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),s?this.toasts=this.toasts.map(c=>c.id===i?(this.publish({...c,...t,id:i,title:n}),{...c,...t,id:i,dismissible:a,title:n}):c):this.addToast({title:n,...r,dismissible:a,id:i}),i},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(e=>{this.subscribers.forEach(n=>n({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let n;e.loading!==void 0&&(n=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let r=t instanceof Promise?t:t(),i=n!==void 0,s,a=r.then(async l=>{if(s=["resolve",l],W.isValidElement(l))i=!1,this.create({id:n,type:"default",message:l});else if(_P(l)&&!l.ok){i=!1;let d=typeof e.error=="function"?await e.error(`HTTP error! status: ${l.status}`):e.error,u=typeof e.description=="function"?await e.description(`HTTP error! status: ${l.status}`):e.description;this.create({id:n,type:"error",message:d,description:u})}else if(e.success!==void 0){i=!1;let d=typeof e.success=="function"?await e.success(l):e.success,u=typeof e.description=="function"?await e.description(l):e.description;this.create({id:n,type:"success",message:d,description:u})}}).catch(async l=>{if(s=["reject",l],e.error!==void 0){i=!1;let d=typeof e.error=="function"?await e.error(l):e.error,u=typeof e.description=="function"?await e.description(l):e.description;this.create({id:n,type:"error",message:d,description:u})}}).finally(()=>{var l;i&&(this.dismiss(n),n=void 0),(l=e.finally)==null||l.call(e)}),c=()=>new Promise((l,d)=>a.then(()=>s[0]==="reject"?d(s[1]):l(s[1])).catch(d));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(t,e)=>{let n=(e==null?void 0:e.id)||np++;return this.create({jsx:t(n),id:n,...e}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},En=new bP,wP=(t,e)=>{let n=(e==null?void 0:e.id)||np++;return En.addToast({title:t,...e,id:n}),n},_P=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",EP=wP,SP=()=>En.toasts,jP=()=>En.getActiveToasts(),k=Object.assign(EP,{success:En.success,info:En.info,warning:En.warning,error:En.error,custom:En.custom,message:En.message,promise:En.promise,dismiss:En.dismiss,loading:En.loading},{getHistory:SP,getToasts:jP});function NP(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}NP(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function ol(t){return t.label!==void 0}var kP=3,CP="32px",PP="16px",Sv=4e3,TP=356,RP=14,AP=20,IP=200;function er(...t){return t.filter(Boolean).join(" ")}function MP(t){let[e,n]=t.split("-"),r=[];return e&&r.push(e),n&&r.push(n),r}var DP=t=>{var e,n,r,i,s,a,c,l,d,u,h;let{invert:p,toast:f,unstyled:m,interacting:v,setHeights:g,visibleToasts:w,heights:b,index:x,toasts:E,expanded:N,removeToast:j,defaultRichColors:C,closeButton:R,style:T,cancelButtonStyle:$,actionButtonStyle:B,className:D="",descriptionClassName:q="",duration:F,position:xe,gap:de,loadingIcon:Be,expandByDefault:$e,classNames:pe,icons:Ke,closeButtonAriaLabel:Ye="Close toast",pauseWhenPageIsHidden:Te}=t,[Se,_e]=W.useState(null),[ut,_t]=W.useState(null),[re,Fe]=W.useState(!1),[Qe,K]=W.useState(!1),[M,G]=W.useState(!1),[ne,Q]=W.useState(!1),[ee,ve]=W.useState(!1),[Ne,et]=W.useState(0),[zt,ns]=W.useState(0),vt=W.useRef(f.duration||F||Sv),ii=W.useRef(null),yn=W.useRef(null),to=x===0,rs=x+1<=w,xn=f.type,si=f.dismissible!==!1,Uu=f.className||"",Hu=f.descriptionClassName||"",Ls=W.useMemo(()=>b.findIndex(Re=>Re.toastId===f.id)||0,[b,f.id]),no=W.useMemo(()=>{var Re;return(Re=f.closeButton)!=null?Re:R},[f.closeButton,R]),ai=W.useMemo(()=>f.duration||F||Sv,[f.duration,F]),ro=W.useRef(0),oi=W.useRef(0),qc=W.useRef(0),ci=W.useRef(null),[Vu,Bs]=xe.split("-"),Kc=W.useMemo(()=>b.reduce((Re,ct,ht)=>ht>=Ls?Re:Re+ct.height,0),[b,Ls]),io=xP(),so=f.invert||p,li=xn==="loading";oi.current=W.useMemo(()=>Ls*de+Kc,[Ls,Kc]),W.useEffect(()=>{vt.current=ai},[ai]),W.useEffect(()=>{Fe(!0)},[]),W.useEffect(()=>{let Re=yn.current;if(Re){let ct=Re.getBoundingClientRect().height;return ns(ct),g(ht=>[{toastId:f.id,height:ct,position:f.position},...ht]),()=>g(ht=>ht.filter(It=>It.toastId!==f.id))}},[g,f.id]),W.useLayoutEffect(()=>{if(!re)return;let Re=yn.current,ct=Re.style.height;Re.style.height="auto";let ht=Re.getBoundingClientRect().height;Re.style.height=ct,ns(ht),g(It=>It.find(Xt=>Xt.toastId===f.id)?It.map(Xt=>Xt.toastId===f.id?{...Xt,height:ht}:Xt):[{toastId:f.id,height:ht,position:f.position},...It])},[re,f.title,f.description,g,f.id]);let bn=W.useCallback(()=>{K(!0),et(oi.current),g(Re=>Re.filter(ct=>ct.toastId!==f.id)),setTimeout(()=>{j(f)},IP)},[f,j,g,oi]);W.useEffect(()=>{if(f.promise&&xn==="loading"||f.duration===1/0||f.type==="loading")return;let Re;return N||v||Te&&io?(()=>{if(qc.current<ro.current){let ct=new Date().getTime()-ro.current;vt.current=vt.current-ct}qc.current=new Date().getTime()})():vt.current!==1/0&&(ro.current=new Date().getTime(),Re=setTimeout(()=>{var ct;(ct=f.onAutoClose)==null||ct.call(f,f),bn()},vt.current)),()=>clearTimeout(Re)},[N,v,f,xn,Te,io,bn]),W.useEffect(()=>{f.delete&&bn()},[bn,f.delete]);function ao(){var Re,ct,ht;return Ke!=null&&Ke.loading?W.createElement("div",{className:er(pe==null?void 0:pe.loader,(Re=f==null?void 0:f.classNames)==null?void 0:Re.loader,"sonner-loader"),"data-visible":xn==="loading"},Ke.loading):Be?W.createElement("div",{className:er(pe==null?void 0:pe.loader,(ct=f==null?void 0:f.classNames)==null?void 0:ct.loader,"sonner-loader"),"data-visible":xn==="loading"},Be):W.createElement(pP,{className:er(pe==null?void 0:pe.loader,(ht=f==null?void 0:f.classNames)==null?void 0:ht.loader),visible:xn==="loading"})}return W.createElement("li",{tabIndex:0,ref:yn,className:er(D,Uu,pe==null?void 0:pe.toast,(e=f==null?void 0:f.classNames)==null?void 0:e.toast,pe==null?void 0:pe.default,pe==null?void 0:pe[xn],(n=f==null?void 0:f.classNames)==null?void 0:n[xn]),"data-sonner-toast":"","data-rich-colors":(r=f.richColors)!=null?r:C,"data-styled":!(f.jsx||f.unstyled||m),"data-mounted":re,"data-promise":!!f.promise,"data-swiped":ee,"data-removed":Qe,"data-visible":rs,"data-y-position":Vu,"data-x-position":Bs,"data-index":x,"data-front":to,"data-swiping":M,"data-dismissible":si,"data-type":xn,"data-invert":so,"data-swipe-out":ne,"data-swipe-direction":ut,"data-expanded":!!(N||$e&&re),style:{"--index":x,"--toasts-before":x,"--z-index":E.length-x,"--offset":`${Qe?Ne:oi.current}px`,"--initial-height":$e?"auto":`${zt}px`,...T,...f.style},onDragEnd:()=>{G(!1),_e(null),ci.current=null},onPointerDown:Re=>{li||!si||(ii.current=new Date,et(oi.current),Re.target.setPointerCapture(Re.pointerId),Re.target.tagName!=="BUTTON"&&(G(!0),ci.current={x:Re.clientX,y:Re.clientY}))},onPointerUp:()=>{var Re,ct,ht,It;if(ne||!si)return;ci.current=null;let Xt=Number(((Re=yn.current)==null?void 0:Re.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),$t=Number(((ct=yn.current)==null?void 0:ct.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Rr=new Date().getTime()-((ht=ii.current)==null?void 0:ht.getTime()),kn=Se==="x"?Xt:$t,Qn=Math.abs(kn)/Rr;if(Math.abs(kn)>=AP||Qn>.11){et(oi.current),(It=f.onDismiss)==null||It.call(f,f),_t(Se==="x"?Xt>0?"right":"left":$t>0?"down":"up"),bn(),Q(!0),ve(!1);return}G(!1),_e(null)},onPointerMove:Re=>{var ct,ht,It,Xt;if(!ci.current||!si||((ct=window.getSelection())==null?void 0:ct.toString().length)>0)return;let $t=Re.clientY-ci.current.y,Rr=Re.clientX-ci.current.x,kn=(ht=t.swipeDirections)!=null?ht:MP(xe);!Se&&(Math.abs(Rr)>1||Math.abs($t)>1)&&_e(Math.abs(Rr)>Math.abs($t)?"x":"y");let Qn={x:0,y:0};Se==="y"?(kn.includes("top")||kn.includes("bottom"))&&(kn.includes("top")&&$t<0||kn.includes("bottom")&&$t>0)&&(Qn.y=$t):Se==="x"&&(kn.includes("left")||kn.includes("right"))&&(kn.includes("left")&&Rr<0||kn.includes("right")&&Rr>0)&&(Qn.x=Rr),(Math.abs(Qn.x)>0||Math.abs(Qn.y)>0)&&ve(!0),(It=yn.current)==null||It.style.setProperty("--swipe-amount-x",`${Qn.x}px`),(Xt=yn.current)==null||Xt.style.setProperty("--swipe-amount-y",`${Qn.y}px`)}},no&&!f.jsx?W.createElement("button",{"aria-label":Ye,"data-disabled":li,"data-close-button":!0,onClick:li||!si?()=>{}:()=>{var Re;bn(),(Re=f.onDismiss)==null||Re.call(f,f)},className:er(pe==null?void 0:pe.closeButton,(i=f==null?void 0:f.classNames)==null?void 0:i.closeButton)},(s=Ke==null?void 0:Ke.close)!=null?s:yP):null,f.jsx||y.isValidElement(f.title)?f.jsx?f.jsx:typeof f.title=="function"?f.title():f.title:W.createElement(W.Fragment,null,xn||f.icon||f.promise?W.createElement("div",{"data-icon":"",className:er(pe==null?void 0:pe.icon,(a=f==null?void 0:f.classNames)==null?void 0:a.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||ao():null,f.type!=="loading"?f.icon||(Ke==null?void 0:Ke[xn])||uP(xn):null):null,W.createElement("div",{"data-content":"",className:er(pe==null?void 0:pe.content,(c=f==null?void 0:f.classNames)==null?void 0:c.content)},W.createElement("div",{"data-title":"",className:er(pe==null?void 0:pe.title,(l=f==null?void 0:f.classNames)==null?void 0:l.title)},typeof f.title=="function"?f.title():f.title),f.description?W.createElement("div",{"data-description":"",className:er(q,Hu,pe==null?void 0:pe.description,(d=f==null?void 0:f.classNames)==null?void 0:d.description)},typeof f.description=="function"?f.description():f.description):null),y.isValidElement(f.cancel)?f.cancel:f.cancel&&ol(f.cancel)?W.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||$,onClick:Re=>{var ct,ht;ol(f.cancel)&&si&&((ht=(ct=f.cancel).onClick)==null||ht.call(ct,Re),bn())},className:er(pe==null?void 0:pe.cancelButton,(u=f==null?void 0:f.classNames)==null?void 0:u.cancelButton)},f.cancel.label):null,y.isValidElement(f.action)?f.action:f.action&&ol(f.action)?W.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||B,onClick:Re=>{var ct,ht;ol(f.action)&&((ht=(ct=f.action).onClick)==null||ht.call(ct,Re),!Re.defaultPrevented&&bn())},className:er(pe==null?void 0:pe.actionButton,(h=f==null?void 0:f.classNames)==null?void 0:h.actionButton)},f.action.label):null))};function jv(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function OP(t,e){let n={};return[t,e].forEach((r,i)=>{let s=i===1,a=s?"--mobile-offset":"--offset",c=s?PP:CP;function l(d){["top","right","bottom","left"].forEach(u=>{n[`${a}-${u}`]=typeof d=="number"?`${d}px`:d})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(d=>{r[d]===void 0?n[`${a}-${d}`]=c:n[`${a}-${d}`]=typeof r[d]=="number"?`${r[d]}px`:r[d]}):l(c)}),n}var $P=y.forwardRef(function(t,e){let{invert:n,position:r="bottom-right",hotkey:i=["altKey","KeyT"],expand:s,closeButton:a,className:c,offset:l,mobileOffset:d,theme:u="light",richColors:h,duration:p,style:f,visibleToasts:m=kP,toastOptions:v,dir:g=jv(),gap:w=RP,loadingIcon:b,icons:x,containerAriaLabel:E="Notifications",pauseWhenPageIsHidden:N}=t,[j,C]=W.useState([]),R=W.useMemo(()=>Array.from(new Set([r].concat(j.filter(Te=>Te.position).map(Te=>Te.position)))),[j,r]),[T,$]=W.useState([]),[B,D]=W.useState(!1),[q,F]=W.useState(!1),[xe,de]=W.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Be=W.useRef(null),$e=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),pe=W.useRef(null),Ke=W.useRef(!1),Ye=W.useCallback(Te=>{C(Se=>{var _e;return(_e=Se.find(ut=>ut.id===Te.id))!=null&&_e.delete||En.dismiss(Te.id),Se.filter(({id:ut})=>ut!==Te.id)})},[]);return W.useEffect(()=>En.subscribe(Te=>{if(Te.dismiss){C(Se=>Se.map(_e=>_e.id===Te.id?{..._e,delete:!0}:_e));return}setTimeout(()=>{Nk.flushSync(()=>{C(Se=>{let _e=Se.findIndex(ut=>ut.id===Te.id);return _e!==-1?[...Se.slice(0,_e),{...Se[_e],...Te},...Se.slice(_e+1)]:[Te,...Se]})})})}),[]),W.useEffect(()=>{if(u!=="system"){de(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?de("dark"):de("light")),typeof window>"u")return;let Te=window.matchMedia("(prefers-color-scheme: dark)");try{Te.addEventListener("change",({matches:Se})=>{de(Se?"dark":"light")})}catch{Te.addListener(({matches:_e})=>{try{de(_e?"dark":"light")}catch(ut){console.error(ut)}})}},[u]),W.useEffect(()=>{j.length<=1&&D(!1)},[j]),W.useEffect(()=>{let Te=Se=>{var _e,ut;i.every(_t=>Se[_t]||Se.code===_t)&&(D(!0),(_e=Be.current)==null||_e.focus()),Se.code==="Escape"&&(document.activeElement===Be.current||(ut=Be.current)!=null&&ut.contains(document.activeElement))&&D(!1)};return document.addEventListener("keydown",Te),()=>document.removeEventListener("keydown",Te)},[i]),W.useEffect(()=>{if(Be.current)return()=>{pe.current&&(pe.current.focus({preventScroll:!0}),pe.current=null,Ke.current=!1)}},[Be.current]),W.createElement("section",{ref:e,"aria-label":`${E} ${$e}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},R.map((Te,Se)=>{var _e;let[ut,_t]=Te.split("-");return j.length?W.createElement("ol",{key:Te,dir:g==="auto"?jv():g,tabIndex:-1,ref:Be,className:c,"data-sonner-toaster":!0,"data-theme":xe,"data-y-position":ut,"data-lifted":B&&j.length>1&&!s,"data-x-position":_t,style:{"--front-toast-height":`${((_e=T[0])==null?void 0:_e.height)||0}px`,"--width":`${TP}px`,"--gap":`${w}px`,...f,...OP(l,d)},onBlur:re=>{Ke.current&&!re.currentTarget.contains(re.relatedTarget)&&(Ke.current=!1,pe.current&&(pe.current.focus({preventScroll:!0}),pe.current=null))},onFocus:re=>{re.target instanceof HTMLElement&&re.target.dataset.dismissible==="false"||Ke.current||(Ke.current=!0,pe.current=re.relatedTarget)},onMouseEnter:()=>D(!0),onMouseMove:()=>D(!0),onMouseLeave:()=>{q||D(!1)},onDragEnd:()=>D(!1),onPointerDown:re=>{re.target instanceof HTMLElement&&re.target.dataset.dismissible==="false"||F(!0)},onPointerUp:()=>F(!1)},j.filter(re=>!re.position&&Se===0||re.position===Te).map((re,Fe)=>{var Qe,K;return W.createElement(DP,{key:re.id,icons:x,index:Fe,toast:re,defaultRichColors:h,duration:(Qe=v==null?void 0:v.duration)!=null?Qe:p,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:n,visibleToasts:m,closeButton:(K=v==null?void 0:v.closeButton)!=null?K:a,interacting:q,position:Te,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,removeToast:Ye,toasts:j.filter(M=>M.position==re.position),heights:T.filter(M=>M.position==re.position),setHeights:$,expandByDefault:s,gap:w,loadingIcon:b,expanded:B,pauseWhenPageIsHidden:N,swipeDirections:t.swipeDirections})})):null}))});const LP=({...t})=>{const{theme:e="system"}=dP();return o.jsx($P,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var[Ad,ez]=Vn("Tooltip",[xd]),Cf=xd(),w0="TooltipProvider",BP=700,Nv="tooltip.open",[FP,_0]=Ad(w0),E0=t=>{const{__scopeTooltip:e,delayDuration:n=BP,skipDelayDuration:r=300,disableHoverableContent:i=!1,children:s}=t,a=y.useRef(!0),c=y.useRef(!1),l=y.useRef(0);return y.useEffect(()=>{const d=l.current;return()=>window.clearTimeout(d)},[]),o.jsx(FP,{scope:e,isOpenDelayedRef:a,delayDuration:n,onOpen:y.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:y.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:y.useCallback(d=>{c.current=d},[]),disableHoverableContent:i,children:s})};E0.displayName=w0;var S0="Tooltip",[tz,Id]=Ad(S0),rp="TooltipTrigger",zP=y.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=Id(rp,n),s=_0(rp,n),a=Cf(n),c=y.useRef(null),l=gt(e,c,i.onTriggerChange),d=y.useRef(!1),u=y.useRef(!1),h=y.useCallback(()=>d.current=!1,[]);return y.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),o.jsx(sw,{asChild:!0,...a,children:o.jsx(Pe.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...r,ref:l,onPointerMove:Ee(t.onPointerMove,p=>{p.pointerType!=="touch"&&!u.current&&!s.isPointerInTransitRef.current&&(i.onTriggerEnter(),u.current=!0)}),onPointerLeave:Ee(t.onPointerLeave,()=>{i.onTriggerLeave(),u.current=!1}),onPointerDown:Ee(t.onPointerDown,()=>{i.open&&i.onClose(),d.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Ee(t.onFocus,()=>{d.current||i.onOpen()}),onBlur:Ee(t.onBlur,i.onClose),onClick:Ee(t.onClick,i.onClose)})})});zP.displayName=rp;var UP="TooltipPortal",[nz,HP]=Ad(UP,{forceMount:void 0}),Ea="TooltipContent",j0=y.forwardRef((t,e)=>{const n=HP(Ea,t.__scopeTooltip),{forceMount:r=n.forceMount,side:i="top",...s}=t,a=Id(Ea,t.__scopeTooltip);return o.jsx(Oi,{present:r||a.open,children:a.disableHoverableContent?o.jsx(N0,{side:i,...s,ref:e}):o.jsx(VP,{side:i,...s,ref:e})})}),VP=y.forwardRef((t,e)=>{const n=Id(Ea,t.__scopeTooltip),r=_0(Ea,t.__scopeTooltip),i=y.useRef(null),s=gt(e,i),[a,c]=y.useState(null),{trigger:l,onClose:d}=n,u=i.current,{onPointerInTransitChange:h}=r,p=y.useCallback(()=>{c(null),h(!1)},[h]),f=y.useCallback((m,v)=>{const g=m.currentTarget,w={x:m.clientX,y:m.clientY},b=YP(w,g.getBoundingClientRect()),x=ZP(w,b),E=XP(v.getBoundingClientRect()),N=QP([...x,...E]);c(N),h(!0)},[h]);return y.useEffect(()=>()=>p(),[p]),y.useEffect(()=>{if(l&&u){const m=g=>f(g,u),v=g=>f(g,l);return l.addEventListener("pointerleave",m),u.addEventListener("pointerleave",v),()=>{l.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",v)}}},[l,u,f,p]),y.useEffect(()=>{if(a){const m=v=>{const g=v.target,w={x:v.clientX,y:v.clientY},b=(l==null?void 0:l.contains(g))||(u==null?void 0:u.contains(g)),x=!JP(w,a);b?p():x&&(p(),d())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[l,u,a,d,p]),o.jsx(N0,{...t,ref:s})}),[GP,WP]=Ad(S0,{isInside:!1}),qP=lw("TooltipContent"),N0=y.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":i,onEscapeKeyDown:s,onPointerDownOutside:a,...c}=t,l=Id(Ea,n),d=Cf(n),{onClose:u}=l;return y.useEffect(()=>(document.addEventListener(Nv,u),()=>document.removeEventListener(Nv,u)),[u]),y.useEffect(()=>{if(l.trigger){const h=p=>{const f=p.target;f!=null&&f.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),o.jsx(aw,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:o.jsxs(ow,{"data-state":l.stateAttribute,...d,...c,ref:e,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[o.jsx(qP,{children:r}),o.jsx(GP,{scope:n,isInside:!0,children:o.jsx(jC,{id:l.contentId,role:"tooltip",children:i||r})})]})})});j0.displayName=Ea;var k0="TooltipArrow",KP=y.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=Cf(n);return WP(k0,n).isInside?null:o.jsx(cw,{...i,...r,ref:e})});KP.displayName=k0;function YP(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),i=Math.abs(e.right-t.x),s=Math.abs(e.left-t.x);switch(Math.min(n,r,i,s)){case s:return"left";case i:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function ZP(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function XP(t){const{top:e,right:n,bottom:r,left:i}=t;return[{x:i,y:e},{x:n,y:e},{x:n,y:r},{x:i,y:r}]}function JP(t,e){const{x:n,y:r}=t;let i=!1;for(let s=0,a=e.length-1;s<e.length;a=s++){const c=e[s],l=e[a],d=c.x,u=c.y,h=l.x,p=l.y;u>r!=p>r&&n<(h-d)*(r-u)/(p-u)+d&&(i=!i)}return i}function QP(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),eT(e)}function eT(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const i=t[r];for(;e.length>=2;){const s=e[e.length-1],a=e[e.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))e.pop();else break}e.push(i)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const i=t[r];for(;n.length>=2;){const s=n[n.length-1],a=n[n.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))n.pop();else break}n.push(i)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var tT=E0,C0=j0;const nT=tT,rT=y.forwardRef(({className:t,sideOffset:e=4,...n},r)=>o.jsx(C0,{ref:r,sideOffset:e,className:J("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));rT.displayName=C0.displayName;var Md=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Dd=typeof window>"u"||"Deno"in globalThis;function nr(){}function iT(t,e){return typeof t=="function"?t(e):t}function sT(t){return typeof t=="number"&&t>=0&&t!==1/0}function aT(t,e){return Math.max(t+(e||0)-Date.now(),0)}function ip(t,e){return typeof t=="function"?t(e):t}function oT(t,e){return typeof t=="function"?t(e):t}function kv(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:s,queryKey:a,stale:c}=t;if(a){if(r){if(e.queryHash!==Pf(a,e.options))return!1}else if(!Xo(e.queryKey,a))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||i&&i!==e.state.fetchStatus||s&&!s(e))}function Cv(t,e){const{exact:n,status:r,predicate:i,mutationKey:s}=t;if(s){if(!e.options.mutationKey)return!1;if(n){if(Zo(e.options.mutationKey)!==Zo(s))return!1}else if(!Xo(e.options.mutationKey,s))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function Pf(t,e){return((e==null?void 0:e.queryKeyHashFn)||Zo)(t)}function Zo(t){return JSON.stringify(t,(e,n)=>sp(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function Xo(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Xo(t[n],e[n])):!1}function P0(t,e){if(t===e)return t;const n=Pv(t)&&Pv(e);if(n||sp(t)&&sp(e)){const r=n?t:Object.keys(t),i=r.length,s=n?e:Object.keys(e),a=s.length,c=n?[]:{},l=new Set(r);let d=0;for(let u=0;u<a;u++){const h=n?u:s[u];(!n&&l.has(h)||n)&&t[h]===void 0&&e[h]===void 0?(c[h]=void 0,d++):(c[h]=P0(t[h],e[h]),c[h]===t[h]&&t[h]!==void 0&&d++)}return i===a&&d===i?t:c}return e}function Pv(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function sp(t){if(!Tv(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Tv(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Tv(t){return Object.prototype.toString.call(t)==="[object Object]"}function cT(t){return new Promise(e=>{setTimeout(e,t)})}function lT(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?P0(t,e):e}function dT(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function uT(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var Tf=Symbol();function T0(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Tf?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var vs,Si,da,Kb,hT=(Kb=class extends Md{constructor(){super();nt(this,vs);nt(this,Si);nt(this,da);De(this,da,e=>{if(!Dd&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){z(this,Si)||this.setEventListener(z(this,da))}onUnsubscribe(){var e;this.hasListeners()||((e=z(this,Si))==null||e.call(this),De(this,Si,void 0))}setEventListener(e){var n;De(this,da,e),(n=z(this,Si))==null||n.call(this),De(this,Si,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){z(this,vs)!==e&&(De(this,vs,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof z(this,vs)=="boolean"?z(this,vs):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},vs=new WeakMap,Si=new WeakMap,da=new WeakMap,Kb),R0=new hT,ua,ji,ha,Yb,pT=(Yb=class extends Md{constructor(){super();nt(this,ua,!0);nt(this,ji);nt(this,ha);De(this,ha,e=>{if(!Dd&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){z(this,ji)||this.setEventListener(z(this,ha))}onUnsubscribe(){var e;this.hasListeners()||((e=z(this,ji))==null||e.call(this),De(this,ji,void 0))}setEventListener(e){var n;De(this,ha,e),(n=z(this,ji))==null||n.call(this),De(this,ji,e(this.setOnline.bind(this)))}setOnline(e){z(this,ua)!==e&&(De(this,ua,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return z(this,ua)}},ua=new WeakMap,ji=new WeakMap,ha=new WeakMap,Yb),ql=new pT;function fT(){let t,e;const n=new Promise((i,s)=>{t=i,e=s});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}function mT(t){return Math.min(1e3*2**t,3e4)}function A0(t){return(t??"online")==="online"?ql.isOnline():!0}var I0=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function uh(t){return t instanceof I0}function M0(t){let e=!1,n=0,r=!1,i;const s=fT(),a=v=>{var g;r||(p(new I0(v)),(g=t.abort)==null||g.call(t))},c=()=>{e=!0},l=()=>{e=!1},d=()=>R0.isFocused()&&(t.networkMode==="always"||ql.isOnline())&&t.canRun(),u=()=>A0(t.networkMode)&&t.canRun(),h=v=>{var g;r||(r=!0,(g=t.onSuccess)==null||g.call(t,v),i==null||i(),s.resolve(v))},p=v=>{var g;r||(r=!0,(g=t.onError)==null||g.call(t,v),i==null||i(),s.reject(v))},f=()=>new Promise(v=>{var g;i=w=>{(r||d())&&v(w)},(g=t.onPause)==null||g.call(t)}).then(()=>{var v;i=void 0,r||(v=t.onContinue)==null||v.call(t)}),m=()=>{if(r)return;let v;const g=n===0?t.initialPromise:void 0;try{v=g??t.fn()}catch(w){v=Promise.reject(w)}Promise.resolve(v).then(h).catch(w=>{var j;if(r)return;const b=t.retry??(Dd?0:3),x=t.retryDelay??mT,E=typeof x=="function"?x(n,w):x,N=b===!0||typeof b=="number"&&n<b||typeof b=="function"&&b(n,w);if(e||!N){p(w);return}n++,(j=t.onFail)==null||j.call(t,n,w),cT(E).then(()=>d()?void 0:f()).then(()=>{e?p(w):m()})})};return{promise:s,cancel:a,continue:()=>(i==null||i(),s),cancelRetry:c,continueRetry:l,canStart:u,start:()=>(u()?m():f().then(m),s)}}var gT=t=>setTimeout(t,0);function vT(){let t=[],e=0,n=c=>{c()},r=c=>{c()},i=gT;const s=c=>{e?t.push(c):i(()=>{n(c)})},a=()=>{const c=t;t=[],c.length&&i(()=>{r(()=>{c.forEach(l=>{n(l)})})})};return{batch:c=>{let l;e++;try{l=c()}finally{e--,e||a()}return l},batchCalls:c=>(...l)=>{s(()=>{c(...l)})},schedule:s,setNotifyFunction:c=>{n=c},setBatchNotifyFunction:c=>{r=c},setScheduler:c=>{i=c}}}var fn=vT(),ys,Zb,D0=(Zb=class{constructor(){nt(this,ys)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),sT(this.gcTime)&&De(this,ys,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Dd?1/0:5*60*1e3))}clearGcTimeout(){z(this,ys)&&(clearTimeout(z(this,ys)),De(this,ys,void 0))}},ys=new WeakMap,Zb),pa,xs,Mn,bs,Qt,lc,ws,rr,Or,Xb,yT=(Xb=class extends D0{constructor(e){super();nt(this,rr);nt(this,pa);nt(this,xs);nt(this,Mn);nt(this,bs);nt(this,Qt);nt(this,lc);nt(this,ws);De(this,ws,!1),De(this,lc,e.defaultOptions),this.setOptions(e.options),this.observers=[],De(this,bs,e.client),De(this,Mn,z(this,bs).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,De(this,pa,bT(this.options)),this.state=e.state??z(this,pa),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=z(this,Qt))==null?void 0:e.promise}setOptions(e){this.options={...z(this,lc),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&z(this,Mn).remove(this)}setData(e,n){const r=lT(this.state.data,e,this.options);return Jt(this,rr,Or).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){Jt(this,rr,Or).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,i;const n=(r=z(this,Qt))==null?void 0:r.promise;return(i=z(this,Qt))==null||i.cancel(e),n?n.then(nr).catch(nr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(z(this,pa))}isActive(){return this.observers.some(e=>oT(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Tf||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>ip(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!aT(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=z(this,Qt))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=z(this,Qt))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),z(this,Mn).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(z(this,Qt)&&(z(this,ws)?z(this,Qt).cancel({revert:!0}):z(this,Qt).cancelRetry()),this.scheduleGc()),z(this,Mn).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Jt(this,rr,Or).call(this,{type:"invalidate"})}fetch(e,n){var d,u,h;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(z(this,Qt))return z(this,Qt).continueRetry(),z(this,Qt).promise}if(e&&this.setOptions(e),!this.options.queryFn){const p=this.observers.find(f=>f.options.queryFn);p&&this.setOptions(p.options)}const r=new AbortController,i=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(De(this,ws,!0),r.signal)})},s=()=>{const p=T0(this.options,n),m=(()=>{const v={client:z(this,bs),queryKey:this.queryKey,meta:this.meta};return i(v),v})();return De(this,ws,!1),this.options.persister?this.options.persister(p,m,this):p(m)},c=(()=>{const p={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:z(this,bs),state:this.state,fetchFn:s};return i(p),p})();(d=this.options.behavior)==null||d.onFetch(c,this),De(this,xs,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=c.fetchOptions)==null?void 0:u.meta))&&Jt(this,rr,Or).call(this,{type:"fetch",meta:(h=c.fetchOptions)==null?void 0:h.meta});const l=p=>{var f,m,v,g;uh(p)&&p.silent||Jt(this,rr,Or).call(this,{type:"error",error:p}),uh(p)||((m=(f=z(this,Mn).config).onError)==null||m.call(f,p,this),(g=(v=z(this,Mn).config).onSettled)==null||g.call(v,this.state.data,p,this)),this.scheduleGc()};return De(this,Qt,M0({initialPromise:n==null?void 0:n.initialPromise,fn:c.fetchFn,abort:r.abort.bind(r),onSuccess:p=>{var f,m,v,g;if(p===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(p)}catch(w){l(w);return}(m=(f=z(this,Mn).config).onSuccess)==null||m.call(f,p,this),(g=(v=z(this,Mn).config).onSettled)==null||g.call(v,p,this.state.error,this),this.scheduleGc()},onError:l,onFail:(p,f)=>{Jt(this,rr,Or).call(this,{type:"failed",failureCount:p,error:f})},onPause:()=>{Jt(this,rr,Or).call(this,{type:"pause"})},onContinue:()=>{Jt(this,rr,Or).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0})),z(this,Qt).start()}},pa=new WeakMap,xs=new WeakMap,Mn=new WeakMap,bs=new WeakMap,Qt=new WeakMap,lc=new WeakMap,ws=new WeakMap,rr=new WeakSet,Or=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...xT(r.data,this.options),fetchMeta:e.meta??null};case"success":return De(this,xs,void 0),{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=e.error;return uh(i)&&i.revert&&z(this,xs)?{...z(this,xs),fetchStatus:"idle"}:{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),fn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),z(this,Mn).notify({query:this,type:"updated",action:e})})},Xb);function xT(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:A0(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function bT(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var yr,Jb,wT=(Jb=class extends Md{constructor(e={}){super();nt(this,yr);this.config=e,De(this,yr,new Map)}build(e,n,r){const i=n.queryKey,s=n.queryHash??Pf(i,n);let a=this.get(s);return a||(a=new yT({client:e,queryKey:i,queryHash:s,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(a)),a}add(e){z(this,yr).has(e.queryHash)||(z(this,yr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=z(this,yr).get(e.queryHash);n&&(e.destroy(),n===e&&z(this,yr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){fn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return z(this,yr).get(e)}getAll(){return[...z(this,yr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>kv(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>kv(e,r)):n}notify(e){fn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){fn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){fn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},yr=new WeakMap,Jb),xr,un,_s,br,yi,Qb,_T=(Qb=class extends D0{constructor(e){super();nt(this,br);nt(this,xr);nt(this,un);nt(this,_s);this.mutationId=e.mutationId,De(this,un,e.mutationCache),De(this,xr,[]),this.state=e.state||ET(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){z(this,xr).includes(e)||(z(this,xr).push(e),this.clearGcTimeout(),z(this,un).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){De(this,xr,z(this,xr).filter(n=>n!==e)),this.scheduleGc(),z(this,un).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){z(this,xr).length||(this.state.status==="pending"?this.scheduleGc():z(this,un).remove(this))}continue(){var e;return((e=z(this,_s))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var s,a,c,l,d,u,h,p,f,m,v,g,w,b,x,E,N,j,C,R;const n=()=>{Jt(this,br,yi).call(this,{type:"continue"})};De(this,_s,M0({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(T,$)=>{Jt(this,br,yi).call(this,{type:"failed",failureCount:T,error:$})},onPause:()=>{Jt(this,br,yi).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>z(this,un).canRun(this)}));const r=this.state.status==="pending",i=!z(this,_s).canStart();try{if(r)n();else{Jt(this,br,yi).call(this,{type:"pending",variables:e,isPaused:i}),await((a=(s=z(this,un).config).onMutate)==null?void 0:a.call(s,e,this));const $=await((l=(c=this.options).onMutate)==null?void 0:l.call(c,e));$!==this.state.context&&Jt(this,br,yi).call(this,{type:"pending",context:$,variables:e,isPaused:i})}const T=await z(this,_s).start();return await((u=(d=z(this,un).config).onSuccess)==null?void 0:u.call(d,T,e,this.state.context,this)),await((p=(h=this.options).onSuccess)==null?void 0:p.call(h,T,e,this.state.context)),await((m=(f=z(this,un).config).onSettled)==null?void 0:m.call(f,T,null,this.state.variables,this.state.context,this)),await((g=(v=this.options).onSettled)==null?void 0:g.call(v,T,null,e,this.state.context)),Jt(this,br,yi).call(this,{type:"success",data:T}),T}catch(T){try{throw await((b=(w=z(this,un).config).onError)==null?void 0:b.call(w,T,e,this.state.context,this)),await((E=(x=this.options).onError)==null?void 0:E.call(x,T,e,this.state.context)),await((j=(N=z(this,un).config).onSettled)==null?void 0:j.call(N,void 0,T,this.state.variables,this.state.context,this)),await((R=(C=this.options).onSettled)==null?void 0:R.call(C,void 0,T,e,this.state.context)),T}finally{Jt(this,br,yi).call(this,{type:"error",error:T})}}finally{z(this,un).runNext(this)}}},xr=new WeakMap,un=new WeakMap,_s=new WeakMap,br=new WeakSet,yi=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),fn.batch(()=>{z(this,xr).forEach(r=>{r.onMutationUpdate(e)}),z(this,un).notify({mutation:this,type:"updated",action:e})})},Qb);function ET(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var zr,ir,dc,ew,ST=(ew=class extends Md{constructor(e={}){super();nt(this,zr);nt(this,ir);nt(this,dc);this.config=e,De(this,zr,new Set),De(this,ir,new Map),De(this,dc,0)}build(e,n,r){const i=new _T({mutationCache:this,mutationId:++sl(this,dc)._,options:e.defaultMutationOptions(n),state:r});return this.add(i),i}add(e){z(this,zr).add(e);const n=cl(e);if(typeof n=="string"){const r=z(this,ir).get(n);r?r.push(e):z(this,ir).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(z(this,zr).delete(e)){const n=cl(e);if(typeof n=="string"){const r=z(this,ir).get(n);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&z(this,ir).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=cl(e);if(typeof n=="string"){const r=z(this,ir).get(n),i=r==null?void 0:r.find(s=>s.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const n=cl(e);if(typeof n=="string"){const i=(r=z(this,ir).get(n))==null?void 0:r.find(s=>s!==e&&s.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){fn.batch(()=>{z(this,zr).forEach(e=>{this.notify({type:"removed",mutation:e})}),z(this,zr).clear(),z(this,ir).clear()})}getAll(){return Array.from(z(this,zr))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Cv(n,r))}findAll(e={}){return this.getAll().filter(n=>Cv(e,n))}notify(e){fn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return fn.batch(()=>Promise.all(e.map(n=>n.continue().catch(nr))))}},zr=new WeakMap,ir=new WeakMap,dc=new WeakMap,ew);function cl(t){var e;return(e=t.options.scope)==null?void 0:e.id}function Rv(t){return{onFetch:(e,n)=>{var u,h,p,f,m;const r=e.options,i=(p=(h=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:p.direction,s=((f=e.state.data)==null?void 0:f.pages)||[],a=((m=e.state.data)==null?void 0:m.pageParams)||[];let c={pages:[],pageParams:[]},l=0;const d=async()=>{let v=!1;const g=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(e.signal.aborted?v=!0:e.signal.addEventListener("abort",()=>{v=!0}),e.signal)})},w=T0(e.options,e.fetchOptions),b=async(x,E,N)=>{if(v)return Promise.reject();if(E==null&&x.pages.length)return Promise.resolve(x);const C=(()=>{const B={client:e.client,queryKey:e.queryKey,pageParam:E,direction:N?"backward":"forward",meta:e.options.meta};return g(B),B})(),R=await w(C),{maxPages:T}=e.options,$=N?uT:dT;return{pages:$(x.pages,R,T),pageParams:$(x.pageParams,E,T)}};if(i&&s.length){const x=i==="backward",E=x?jT:Av,N={pages:s,pageParams:a},j=E(r,N);c=await b(N,j,x)}else{const x=t??s.length;do{const E=l===0?a[0]??r.initialPageParam:Av(r,c);if(l>0&&E==null)break;c=await b(c,E),l++}while(l<x)}return c};e.options.persister?e.fetchFn=()=>{var v,g;return(g=(v=e.options).persister)==null?void 0:g.call(v,d,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=d}}}function Av(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function jT(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var St,Ni,ki,fa,ma,Ci,ga,va,tw,NT=(tw=class{constructor(t={}){nt(this,St);nt(this,Ni);nt(this,ki);nt(this,fa);nt(this,ma);nt(this,Ci);nt(this,ga);nt(this,va);De(this,St,t.queryCache||new wT),De(this,Ni,t.mutationCache||new ST),De(this,ki,t.defaultOptions||{}),De(this,fa,new Map),De(this,ma,new Map),De(this,Ci,0)}mount(){sl(this,Ci)._++,z(this,Ci)===1&&(De(this,ga,R0.subscribe(async t=>{t&&(await this.resumePausedMutations(),z(this,St).onFocus())})),De(this,va,ql.subscribe(async t=>{t&&(await this.resumePausedMutations(),z(this,St).onOnline())})))}unmount(){var t,e;sl(this,Ci)._--,z(this,Ci)===0&&((t=z(this,ga))==null||t.call(this),De(this,ga,void 0),(e=z(this,va))==null||e.call(this),De(this,va,void 0))}isFetching(t){return z(this,St).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return z(this,Ni).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=z(this,St).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=z(this,St).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(ip(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return z(this,St).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=z(this,St).get(r.queryHash),s=i==null?void 0:i.state.data,a=iT(e,s);if(a!==void 0)return z(this,St).build(this,r).setData(a,{...n,manual:!0})}setQueriesData(t,e,n){return fn.batch(()=>z(this,St).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=z(this,St).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=z(this,St);fn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=z(this,St);return fn.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=fn.batch(()=>z(this,St).findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(nr).catch(nr)}invalidateQueries(t,e={}){return fn.batch(()=>(z(this,St).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=fn.batch(()=>z(this,St).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,n);return n.throwOnError||(s=s.catch(nr)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(r).then(nr)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=z(this,St).build(this,e);return n.isStaleByTime(ip(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(nr).catch(nr)}fetchInfiniteQuery(t){return t.behavior=Rv(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(nr).catch(nr)}ensureInfiniteQueryData(t){return t.behavior=Rv(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return ql.isOnline()?z(this,Ni).resumePausedMutations():Promise.resolve()}getQueryCache(){return z(this,St)}getMutationCache(){return z(this,Ni)}getDefaultOptions(){return z(this,ki)}setDefaultOptions(t){De(this,ki,t)}setQueryDefaults(t,e){z(this,fa).set(Zo(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...z(this,fa).values()],n={};return e.forEach(r=>{Xo(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){z(this,ma).set(Zo(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...z(this,ma).values()],n={};return e.forEach(r=>{Xo(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...z(this,ki).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Pf(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Tf&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...z(this,ki).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){z(this,St).clear(),z(this,Ni).clear()}},St=new WeakMap,Ni=new WeakMap,ki=new WeakMap,fa=new WeakMap,ma=new WeakMap,Ci=new WeakMap,ga=new WeakMap,va=new WeakMap,tw),kT=y.createContext(void 0),CT=({client:t,children:e})=>(y.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),o.jsx(kT.Provider,{value:t,children:e}));const PT={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20}},TT={type:"tween",ease:"anticipate",duration:.4},Dr=({children:t})=>{const e=af();return o.jsx(nw,{mode:"wait",children:o.jsx(he.div,{initial:"initial",animate:"animate",exit:"exit",variants:PT,transition:TT,children:t},e.pathname)})},RT="modulepreload",AT=function(t){return"/"+t},Iv={},wc=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=AT(l),l in Iv)return;Iv[l]=!0;const d=l.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":RT,d||(h.as="script"),h.crossOrigin="",h.href=l,c&&h.setAttribute("nonce",c),document.head.appendChild(h),d)return new Promise((p,f)=>{h.addEventListener("load",p),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return i.then(a=>{for(const c of a||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})},IT=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>wc(async()=>{const{default:r}=await Promise.resolve().then(()=>za);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Rf extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class Mv extends Rf{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Dv extends Rf{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ov extends Rf{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ap;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ap||(ap={}));var MT=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(u){try{d(r.next(u))}catch(h){a(h)}}function l(u){try{d(r.throw(u))}catch(h){a(h)}}function d(u){u.done?s(u.value):i(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})};class DT{constructor(e,{headers:n={},customFetch:r,region:i=ap.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=IT(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return MT(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a,signal:c}=n;let l={},{region:d}=n;d||(d=this.region);const u=new URL(`${this.url}/${e}`);d&&d!=="any"&&(l["x-region"]=d,u.searchParams.set("forceFunctionRegion",d));let h;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",h=a):typeof a=="string"?(l["Content-Type"]="text/plain",h=a):typeof FormData<"u"&&a instanceof FormData?h=a:(l["Content-Type"]="application/json",h=JSON.stringify(a)));const p=yield this.fetch(u.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:h,signal:c}).catch(g=>{throw g.name==="AbortError"?g:new Mv(g)}),f=p.headers.get("x-relay-error");if(f&&f==="true")throw new Dv(p);if(!p.ok)throw new Ov(p);let m=((r=p.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),v;return m==="application/json"?v=yield p.json():m==="application/octet-stream"?v=yield p.blob():m==="text/event-stream"?v=p:m==="multipart/form-data"?v=yield p.formData():v=yield p.text(),{data:v,error:null,response:p}}catch(i){return i instanceof Error&&i.name==="AbortError"?{data:null,error:new Mv(i)}:{data:null,error:i,response:i instanceof Ov||i instanceof Dv?i.context:void 0}}})}}var Sn={},Af={},Od={},_c={},$d={},Ld={},OT=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Sa=OT();const $T=Sa.fetch,O0=Sa.fetch.bind(Sa),$0=Sa.Headers,LT=Sa.Request,BT=Sa.Response,za=Object.freeze(Object.defineProperty({__proto__:null,Headers:$0,Request:LT,Response:BT,default:O0,fetch:$T},Symbol.toStringTag,{value:"Module"})),FT=kk(za);var Bd={};Object.defineProperty(Bd,"__esModule",{value:!0});let zT=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Bd.default=zT;var L0=Un&&Un.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ld,"__esModule",{value:!0});const UT=L0(FT),HT=L0(Bd);let VT=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=UT.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,c,l,d;let u=null,h=null,p=null,f=s.status,m=s.statusText;if(s.ok){if(this.method!=="HEAD"){const b=await s.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?h=b:h=JSON.parse(b))}const g=(c=this.headers.get("Prefer"))===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),w=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");g&&w&&w.length>1&&(p=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,p=null,f=406,m="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const g=await s.text();try{u=JSON.parse(g),Array.isArray(u)&&s.status===404&&(h=[],u=null,f=200,m="OK")}catch{s.status===404&&g===""?(f=204,m="No Content"):u={message:g}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,f=200,m="OK"),u&&this.shouldThrowOnError)throw new HT.default(u)}return{error:u,data:h,count:p,status:f,statusText:m}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,c,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(c=s==null?void 0:s.stack)!==null&&c!==void 0?c:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}};Ld.default=VT;var GT=Un&&Un.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty($d,"__esModule",{value:!0});const WT=GT(Ld);let qT=class extends WT.default{select(e){let n=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:i,referencedTable:s=i}={}){const a=s?`${s}.order`:"order",c=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${c?`${c},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:i=r}={}){const s=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(a,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var c;const l=[e?"analyze":null,n?"verbose":null,r?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),d=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${d}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};$d.default=qT;var KT=Un&&Un.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(_c,"__esModule",{value:!0});const YT=KT($d);let ZT=class extends YT.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${a}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};_c.default=ZT;var XT=Un&&Un.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Od,"__esModule",{value:!0});const fo=XT(_c);let JT=class{constructor(e,{headers:n={},schema:r,fetch:i}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=i}select(e,{head:n=!1,count:r}={}){const i=n?"HEAD":"GET";let s=!1;const a=(e??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",a),r&&this.headers.append("Prefer",`count=${r}`),new fo.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var i;const s="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((c,l)=>c.concat(Object.keys(l)),[]);if(a.length>0){const c=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",c.join(","))}}return new fo.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:i,defaultToNull:s=!0}={}){var a;const c="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),i&&this.headers.append("Prefer",`count=${i}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(l.length>0){const d=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new fo.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:n}={}){var r;const i="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new fo.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new fo.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};Od.default=JT;var B0=Un&&Un.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Af,"__esModule",{value:!0});const QT=B0(Od),eR=B0(_c);let tR=class F0{constructor(e,{headers:n={},schema:r,fetch:i}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new QT.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new F0(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:i=!1,count:s}={}){var a;let c;const l=new URL(`${this.url}/rpc/${e}`);let d;r||i?(c=r?"HEAD":"GET",Object.entries(n).filter(([h,p])=>p!==void 0).map(([h,p])=>[h,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([h,p])=>{l.searchParams.append(h,p)})):(c="POST",d=n);const u=new Headers(this.headers);return s&&u.set("Prefer",`count=${s}`),new eR.default({method:c,url:l,headers:u,schema:this.schemaName,body:d,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};Af.default=tR;var Ua=Un&&Un.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Sn,"__esModule",{value:!0});Sn.PostgrestError=Sn.PostgrestBuilder=Sn.PostgrestTransformBuilder=Sn.PostgrestFilterBuilder=Sn.PostgrestQueryBuilder=Sn.PostgrestClient=void 0;const z0=Ua(Af);Sn.PostgrestClient=z0.default;const U0=Ua(Od);Sn.PostgrestQueryBuilder=U0.default;const H0=Ua(_c);Sn.PostgrestFilterBuilder=H0.default;const V0=Ua($d);Sn.PostgrestTransformBuilder=V0.default;const G0=Ua(Ld);Sn.PostgrestBuilder=G0.default;const W0=Ua(Bd);Sn.PostgrestError=W0.default;var nR=Sn.default={PostgrestClient:z0.default,PostgrestQueryBuilder:U0.default,PostgrestFilterBuilder:H0.default,PostgrestTransformBuilder:V0.default,PostgrestBuilder:G0.default,PostgrestError:W0.default};const{PostgrestClient:rR,PostgrestQueryBuilder:cz,PostgrestFilterBuilder:lz,PostgrestTransformBuilder:dz,PostgrestBuilder:uz,PostgrestError:hz}=nR;class iR{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,i=parseInt(r.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const sR="2.15.5",aR=`realtime-js/${sR}`,oR="1.0.0",op=1e4,cR=1e3,lR=100;var Bo;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Bo||(Bo={}));var Bt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Bt||(Bt={}));var sr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(sr||(sr={}));var cp;(function(t){t.websocket="websocket"})(cp||(cp={}));var ps;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ps||(ps={}));class dR{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const i=n.getUint8(1),s=n.getUint8(2);let a=this.HEADER_LENGTH+2;const c=r.decode(e.slice(a,a+i));a=a+i;const l=r.decode(e.slice(a,a+s));a=a+s;const d=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:c,event:l,payload:d}}}class q0{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ft;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ft||(ft={}));const $v=(t,e,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,a)=>(s[a]=uR(a,t,e,i),s),{})},uR=(t,e,n,r)=>{const i=e.find(c=>c.name===t),s=i==null?void 0:i.type,a=n[t];return s&&!r.includes(s)?K0(s,a):lp(a)},K0=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return mR(e,n)}switch(t){case ft.bool:return hR(e);case ft.float4:case ft.float8:case ft.int2:case ft.int4:case ft.int8:case ft.numeric:case ft.oid:return pR(e);case ft.json:case ft.jsonb:return fR(e);case ft.timestamp:return gR(e);case ft.abstime:case ft.date:case ft.daterange:case ft.int4range:case ft.int8range:case ft.money:case ft.reltime:case ft.text:case ft.time:case ft.timestamptz:case ft.timetz:case ft.tsrange:case ft.tstzrange:return lp(e);default:return lp(e)}},lp=t=>t,hR=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},pR=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},fR=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},mR=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const a=t.slice(1,n);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(c=>K0(e,c))}return t},gR=t=>typeof t=="string"?t.replace(" ","T"):t,Y0=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class hh{constructor(e,n,r={},i=op){this.channel=e,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Lv;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Lv||(Lv={}));class Fo{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:a,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Fo.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=Fo.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],c()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Fo.syncDiff(this.state,i,s,a),c())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,i){const s=this.cloneDeep(e),a=this.transformState(n),c={},l={};return this.map(s,(d,u)=>{a[d]||(l[d]=u)}),this.map(a,(d,u)=>{const h=s[d];if(h){const p=u.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),m=u.filter(g=>f.indexOf(g.presence_ref)<0),v=h.filter(g=>p.indexOf(g.presence_ref)<0);m.length>0&&(c[d]=m),v.length>0&&(l[d]=v)}else c[d]=u}),this.syncDiff(s,{joins:c,leaves:l},r,i)}static syncDiff(e,n,r,i){const{joins:s,leaves:a}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(c,l)=>{var d;const u=(d=e[c])!==null&&d!==void 0?d:[];if(e[c]=this.cloneDeep(l),u.length>0){const h=e[c].map(f=>f.presence_ref),p=u.filter(f=>h.indexOf(f.presence_ref)<0);e[c].unshift(...p)}r(c,u,l)}),this.map(a,(c,l)=>{let d=e[c];if(!d)return;const u=l.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[c]=d,i(c,d,l),d.length===0&&delete e[c]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const i=e[r];return"metas"in i?n[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Bv;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Bv||(Bv={}));var zo;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(zo||(zo={}));var Br;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Br||(Br={}));class If{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Bt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new hh(this,sr.join,this.params,this.timeout),this.rejoinTimer=new q0(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Bt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Bt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Bt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Bt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Bt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(sr.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new Fo(this),this.broadcastEndpointURL=Y0(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Bt.closed){const{config:{broadcast:a,presence:c,private:l}}=this.params,d=(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(f=>f.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[zo.PRESENCE]&&this.bindings[zo.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},p={broadcast:a,presence:Object.assign(Object.assign({},c),{enabled:u}),postgres_changes:d,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(f=>e==null?void 0:e(Br.CHANNEL_ERROR,f)),this._onClose(()=>e==null?void 0:e(Br.CLOSED)),this.updateJoinPayload(Object.assign({config:p},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:f})=>{var m;if(this.socket.setAuth(),f===void 0){e==null||e(Br.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,g=(m=v==null?void 0:v.length)!==null&&m!==void 0?m:0,w=[];for(let b=0;b<g;b++){const x=v[b],{filter:{event:E,schema:N,table:j,filter:C}}=x,R=f&&f[b];if(R&&R.event===E&&R.schema===N&&R.table===j&&R.filter===C)w.push(Object.assign(Object.assign({},x),{id:R.id}));else{this.unsubscribe(),this.state=Bt.errored,e==null||e(Br.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,e&&e(Br.SUBSCRIBED);return}}).receive("error",f=>{this.state=Bt.errored,e==null||e(Br.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Br.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===Bt.joined&&e===zo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,c,l;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(c=(a=this.params)===null||a===void 0?void 0:a.config)===null||c===void 0?void 0:c.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Bt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(sr.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{r=new hh(this,sr.leave,{},e),r.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Bt.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const i=new AbortController,s=setTimeout(()=>i.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(s),a}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new hh(this,e,n,r);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>lR){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var i,s;const a=e.toLocaleLowerCase(),{close:c,error:l,leave:d,join:u}=sr;if(r&&[c,l,d,u].indexOf(a)>=0&&r!==this._joinRef())return;let p=this._onMessage(a,n,r);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var m,v,g;return((m=f.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(v=f.filter)===null||v===void 0?void 0:v.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===a}).map(f=>f.callback(p,r)):(s=this.bindings[a])===null||s===void 0||s.filter(f=>{var m,v,g,w,b,x;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const E=f.id,N=(m=f.filter)===null||m===void 0?void 0:m.event;return E&&((v=n.ids)===null||v===void 0?void 0:v.includes(E))&&(N==="*"||(N==null?void 0:N.toLocaleLowerCase())===((g=n.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const E=(b=(w=f==null?void 0:f.filter)===null||w===void 0?void 0:w.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return E==="*"||E===((x=n==null?void 0:n.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof p=="object"&&"ids"in p){const m=p.data,{schema:v,table:g,commit_timestamp:w,type:b,errors:x}=m;p=Object.assign(Object.assign({},{schema:v,table:g,commit_timestamp:w,eventType:b,new:{},old:{},errors:x}),this._getPayloadRecords(m))}f.callback(p,r)})}_isClosed(){return this.state===Bt.closed}_isJoined(){return this.state===Bt.joined}_isJoining(){return this.state===Bt.joining}_isLeaving(){return this.state===Bt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const i=e.toLocaleLowerCase(),s={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&If.isEqual(i.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(sr.close,{},e)}_onError(e){this._on(sr.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Bt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=$v(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=$v(e.columns,e.old_record)),n}}const ph=()=>{},ll={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},vR=[1e3,2e3,5e3,1e4],yR=1e4,xR=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bR{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=op,this.transport=null,this.heartbeatIntervalMs=ll.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ph,this.ref=0,this.reconnectTimer=null,this.logger=ph,this.conn=null,this.sendBuffer=[],this.serializer=new dR,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let s;return i?s=i:typeof fetch>"u"?s=(...a)=>wc(async()=>{const{default:c}=await Promise.resolve().then(()=>za);return{default:c}},void 0).then(({default:c})=>c(...a)).catch(c=>{throw new Error(`Failed to load @supabase/node-fetch: ${c.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...a)=>s(...a)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${cp.websocket}`,this.httpEndpoint=Y0(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=iR.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:oR}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Bo.connecting:return ps.Connecting;case Bo.open:return ps.Open;case Bo.closing:return ps.Closing;default:return ps.Closed}}isConnected(){return this.connectionState()===ps.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===r);if(i)return i;{const s=new If(`realtime:${e}`,n,this);return this.channels.push(s),s}}push(e){const{topic:n,event:r,payload:i,ref:s}=e,a=()=>{this.encode(e,c=>{var l;(l=this.conn)===null||l===void 0||l.send(c)})};this.log("push",`${n} ${r} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(cR,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},ll.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:i,payload:s,ref:a}=n,c=a?`(${a})`:"",l=s.status||"";this.log("receive",`${l} ${r} ${i} ${c}`.trim(),s),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(i,s,a)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(sr.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${r}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([xR],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:aR};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(sr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new q0(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ll.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,i,s,a,c,l,d,u;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:op,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:ll.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(c=e==null?void 0:e.heartbeatCallback)!==null&&c!==void 0?c:ph,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:h=>vR[h-1]||yR,this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(h,p)=>p(JSON.stringify(h)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Mf extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Mt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class wR extends Mf{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class dp extends Mf{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var _R=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(u){try{d(r.next(u))}catch(h){a(h)}}function l(u){try{d(r.throw(u))}catch(h){a(h)}}function d(u){u.done?s(u.value):i(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})};const Z0=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>wc(async()=>{const{default:r}=await Promise.resolve().then(()=>za);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},ER=()=>_R(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield wc(()=>Promise.resolve().then(()=>za),void 0)).Response:Response}),up=t=>{if(Array.isArray(t))return t.map(n=>up(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=up(r)}),e},SR=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Ts=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(u){try{d(r.next(u))}catch(h){a(h)}}function l(u){try{d(r.throw(u))}catch(h){a(h)}}function d(u){u.done?s(u.value):i(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})};const fh=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),jR=(t,e,n)=>Ts(void 0,void 0,void 0,function*(){const r=yield ER();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(i=>{const s=t.status||500,a=(i==null?void 0:i.statusCode)||s+"";e(new wR(fh(i),s,a))}).catch(i=>{e(new dp(fh(i),i))}):e(new dp(fh(t),t))}),NR=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?i:(SR(r)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(r)):i.body=r,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),n))};function Ec(t,e,n,r,i,s){return Ts(this,void 0,void 0,function*(){return new Promise((a,c)=>{t(n,NR(e,r,i,s)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>jR(l,c,r))})})}function Kl(t,e,n,r){return Ts(this,void 0,void 0,function*(){return Ec(t,"GET",e,n,r)})}function vr(t,e,n,r,i){return Ts(this,void 0,void 0,function*(){return Ec(t,"POST",e,r,i,n)})}function hp(t,e,n,r,i){return Ts(this,void 0,void 0,function*(){return Ec(t,"PUT",e,r,i,n)})}function kR(t,e,n,r){return Ts(this,void 0,void 0,function*(){return Ec(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function X0(t,e,n,r,i){return Ts(this,void 0,void 0,function*(){return Ec(t,"DELETE",e,r,i,n)})}var CR=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(u){try{d(r.next(u))}catch(h){a(h)}}function l(u){try{d(r.throw(u))}catch(h){a(h)}}function d(u){u.done?s(u.value):i(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})};class PR{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}then(e,n){return this.execute().then(e,n)}execute(){return CR(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Mt(e))return{data:null,error:e};throw e}})}}var TR=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(u){try{d(r.next(u))}catch(h){a(h)}}function l(u){try{d(r.throw(u))}catch(h){a(h)}}function d(u){u.done?s(u.value):i(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})};class RR{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}asStream(){return new PR(this.downloadFn,this.shouldThrowOnError)}then(e,n){return this.execute().then(e,n)}execute(){return TR(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Mt(e))return{data:null,error:e};throw e}})}}var wn=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(u){try{d(r.next(u))}catch(h){a(h)}}function l(u){try{d(r.throw(u))}catch(h){a(h)}}function d(u){u.done?s(u.value):i(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})};const AR={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Fv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class IR{constructor(e,n={},r,i){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=Z0(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,i){return wn(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},Fv),i);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=r,c["cache-control"]=`max-age=${a.cacheControl}`,c["content-type"]=a.contentType,l&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(c=Object.assign(Object.assign({},c),i.headers));const d=this._removeEmptyFolders(n),u=this._getFinalPath(d),h=yield(e=="PUT"?hp:vr)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:c},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Mt(s))return{data:null,error:s};throw s}})}upload(e,n,r){return wn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,i){return wn(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),a=this._getFinalPath(s),c=new URL(this.url+`/object/upload/sign/${a}`);c.searchParams.set("token",n);try{let l;const d=Object.assign({upsert:Fv.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",d.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",d.cacheControl)):(l=r,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield hp(this.fetch,c.toString(),l,{headers:u});return{data:{path:s,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Mt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,n){return wn(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const s=yield vr(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),a=new URL(this.url+s.url),c=a.searchParams.get("token");if(!c)throw new Mf("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:c},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}})}update(e,n,r){return wn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return wn(this,void 0,void 0,function*(){try{return{data:yield vr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Mt(i))return{data:null,error:i};throw i}})}copy(e,n,r){return wn(this,void 0,void 0,function*(){try{return{data:{path:(yield vr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Mt(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,r){return wn(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield vr(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Mt(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,r){return wn(this,void 0,void 0,function*(){try{const i=yield vr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Mt(i))return{data:null,error:i};throw i}})}download(e,n){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),a=s?`?${s}`:"",c=this._getFinalPath(e),l=()=>Kl(this.fetch,`${this.url}/${i}/${c}${a}`,{headers:this.headers,noResolveJson:!0});return new RR(l,this.shouldThrowOnError)}info(e){return wn(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Kl(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:up(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}})}exists(e){return wn(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield kR(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r)&&r instanceof dp){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),i=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&i.push(s);const c=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&i.push(l);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${d}`)}}}remove(e){return wn(this,void 0,void 0,function*(){try{return{data:yield X0(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}})}list(e,n,r){return wn(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},AR),n),{prefix:e||""});return{data:yield vr(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Mt(i))return{data:null,error:i};throw i}})}listV2(e,n){return wn(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield vr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const MR="2.12.2",DR={"X-Client-Info":`storage-js/${MR}`};var zs=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(u){try{d(r.next(u))}catch(h){a(h)}}function l(u){try{d(r.throw(u))}catch(h){a(h)}}function d(u){u.done?s(u.value):i(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})};class OR{constructor(e,n={},r,i){this.shouldThrowOnError=!1;const s=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},DR),n),this.fetch=Z0(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return zs(this,void 0,void 0,function*(){try{return{data:yield Kl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Mt(e))return{data:null,error:e};throw e}})}getBucket(e){return zs(this,void 0,void 0,function*(){try{return{data:yield Kl(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return zs(this,void 0,void 0,function*(){try{return{data:yield vr(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return zs(this,void 0,void 0,function*(){try{return{data:yield hp(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return zs(this,void 0,void 0,function*(){try{return{data:yield vr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}})}deleteBucket(e){return zs(this,void 0,void 0,function*(){try{return{data:yield X0(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}})}}class $R extends OR{constructor(e,n={},r,i){super(e,n,r,i)}from(e){return new IR(this.url,this.headers,e,this.fetch)}}const LR="2.58.0";let No="";typeof Deno<"u"?No="deno":typeof document<"u"?No="web":typeof navigator<"u"&&navigator.product==="ReactNative"?No="react-native":No="node";const BR={"X-Client-Info":`supabase-js-${No}/${LR}`},FR={headers:BR},zR={schema:"public"},UR={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},HR={};var VR=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(u){try{d(r.next(u))}catch(h){a(h)}}function l(u){try{d(r.throw(u))}catch(h){a(h)}}function d(u){u.done?s(u.value):i(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})};const GR=t=>{let e;return t?e=t:typeof fetch>"u"?e=O0:e=fetch,(...n)=>e(...n)},WR=()=>typeof Headers>"u"?$0:Headers,qR=(t,e,n)=>{const r=GR(n),i=WR();return(s,a)=>VR(void 0,void 0,void 0,function*(){var c;const l=(c=yield e())!==null&&c!==void 0?c:t;let d=new i(a==null?void 0:a.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${l}`),r(s,Object.assign(Object.assign({},a),{headers:d}))})};var KR=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(u){try{d(r.next(u))}catch(h){a(h)}}function l(u){try{d(r.throw(u))}catch(h){a(h)}}function d(u){u.done?s(u.value):i(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})};function YR(t){return t.endsWith("/")?t:t+"/"}function ZR(t,e){var n,r;const{db:i,auth:s,realtime:a,global:c}=t,{db:l,auth:d,realtime:u,global:h}=e,p={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},d),s),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},h),c),{headers:Object.assign(Object.assign({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(r=c==null?void 0:c.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>KR(this,void 0,void 0,function*(){return""})};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}function XR(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(YR(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const J0="2.72.0",ta=30*1e3,pp=3,mh=pp*ta,JR="http://localhost:9999",QR="supabase.auth.token",eA={"X-Client-Info":`gotrue-js/${J0}`},fp="X-Supabase-Api-Version",Q0={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},tA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,nA=10*60*1e3;class Df extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Oe(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class rA extends Df{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function iA(t){return Oe(t)&&t.name==="AuthApiError"}class e_ extends Df{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Li extends Df{constructor(e,n,r,i){super(e,r,i),this.name=n,this.status=r}}class xi extends Li{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function sA(t){return Oe(t)&&t.name==="AuthSessionMissingError"}class mo extends Li{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class dl extends Li{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ul extends Li{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function aA(t){return Oe(t)&&t.name==="AuthImplicitGrantRedirectError"}class zv extends Li{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class mp extends Li{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function gh(t){return Oe(t)&&t.name==="AuthRetryableFetchError"}class Uv extends Li{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class gp extends Li{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Yl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Hv=` 	
\r=`.split(""),oA=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Hv.length;e+=1)t[Hv[e].charCodeAt(0)]=-2;for(let e=0;e<Yl.length;e+=1)t[Yl[e].charCodeAt(0)]=e;return t})();function Vv(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Yl[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Yl[r]),e.queuedBits-=6}}function t_(t,e,n){const r=oA[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Gv(t){const e=[],n=a=>{e.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{dA(a,r,n)};for(let a=0;a<t.length;a+=1)t_(t.charCodeAt(a),i,s);return e.join("")}function cA(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function lA(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}cA(r,e)}}function dA(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function uA(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)t_(t.charCodeAt(i),n,r);return new Uint8Array(e)}function hA(t){const e=[];return lA(t,n=>e.push(n)),new Uint8Array(e)}function pA(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};return t.forEach(i=>Vv(i,n,r)),Vv(null,n,r),e.join("")}function fA(t){return Math.round(Date.now()/1e3)+t}function mA(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const In=()=>typeof window<"u"&&typeof document<"u",ss={tested:!1,writable:!1},n_=()=>{if(!In())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ss.tested)return ss.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ss.tested=!0,ss.writable=!0}catch{ss.tested=!0,ss.writable=!1}return ss.writable};function gA(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return n.searchParams.forEach((r,i)=>{e[i]=r}),e}const r_=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>wc(async()=>{const{default:r}=await Promise.resolve().then(()=>za);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},vA=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",na=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},as=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},pi=async(t,e)=>{await t.removeItem(e)};class Fd{constructor(){this.promise=new Fd.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Fd.promiseConstructor=Promise;function vh(t){const e=t.split(".");if(e.length!==3)throw new gp("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!tA.test(e[r]))throw new gp("JWT not in base64url format");return{header:JSON.parse(Gv(e[0])),payload:JSON.parse(Gv(e[1])),signature:uA(e[2]),raw:{header:e[0],payload:e[1]}}}async function yA(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function xA(t,e){return new Promise((r,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await t(s);if(!e(s,null,a)){r(a);return}}catch(a){if(!e(s,a)){i(a);return}}})()})}function bA(t){return("0"+t.toString(16)).substr(-2)}function wA(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let s=0;s<56;s++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,bA).join("")}async function _A(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function EA(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await _A(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Us(t,e,n=!1){const r=wA();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await na(t,`${e}-code-verifier`,i);const s=await EA(r);return[s,r===s?"plain":"s256"]}const SA=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function jA(t){const e=t.headers.get(fp);if(!e||!e.match(SA))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function NA(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function kA(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const CA=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Hs(t){if(!CA.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function yh(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Wv(t){return JSON.parse(JSON.stringify(t))}var PA=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const ds=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),TA=[502,503,504];async function qv(t){var e;if(!vA(t))throw new mp(ds(t),0);if(TA.includes(t.status))throw new mp(ds(t),t.status);let n;try{n=await t.json()}catch(s){throw new e_(ds(s),s)}let r;const i=jA(t);if(i&&i.getTime()>=Q0["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Uv(ds(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new xi}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Uv(ds(n),t.status,n.weak_password.reasons);throw new rA(ds(n),t.status||500,r)}const RA=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function He(t,e,n,r){var i;const s=Object.assign({},r==null?void 0:r.headers);s[fp]||(s[fp]=Q0["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const a=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const c=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await AA(t,e,n+c,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function AA(t,e,n,r,i,s){const a=RA(e,r,i,s);let c;try{c=await t(n,Object.assign({},a))}catch(l){throw console.error(l),new mp(ds(l),0)}if(c.ok||await qv(c),r!=null&&r.noResolveJson)return c;try{return await c.json()}catch(l){await qv(l)}}function mr(t){var e;let n=null;OA(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=fA(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function Kv(t){const e=mr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ei(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function IA(t){return{data:t,error:null}}function MA(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s}=t,a=PA(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:c,user:l},error:null}}function DA(t){return t}function OA(t){return t.access_token&&t.refresh_token&&t.expires_in}const xh=["global","local","others"];var $A=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class LA{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=r_(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=xh[0]){if(xh.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${xh.join(", ")}`);try{return await He(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await He(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ei})}catch(r){if(Oe(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=$A(e,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await He(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:MA,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Oe(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await He(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ei})}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,i,s,a,c,l;try{const d={nextPage:null,lastPage:0,total:0},u=await He(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:DA});if(u.error)throw u.error;const h=await u.json(),p=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(c=u.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(m=>{const v=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);d[`${g}Page`]=v}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(Oe(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Hs(e);try{return await He(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ei})}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Hs(e);try{return await He(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ei})}catch(r){if(Oe(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Hs(e);try{return await He(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ei})}catch(r){if(Oe(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Hs(e.userId);try{const{data:n,error:r}=await He(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Hs(e.userId),Hs(e.id);try{return{data:await He(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}}}function Yv(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function BA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Vs={debug:!!(globalThis&&n_()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class i_ extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class FA extends i_{}async function zA(t,e,n){Vs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Vs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){Vs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{Vs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw Vs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new FA(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Vs.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function s_(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function UA(t){return parseInt(t,16)}function HA(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function VA(t){var e;const{chainId:n,domain:r,expirationTime:i,issuedAt:s=new Date,nonce:a,notBefore:c,requestId:l,resources:d,scheme:u,uri:h,version:p}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const f=s_(t.address),m=u?`${u}://${r}`:r,v=t.statement?`${t.statement}
`:"",g=`${m} wants you to sign in with your Ethereum account:
${f}

${v}`;let w=`URI: ${h}
Version: ${p}
Chain ID: ${n}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(i&&(w+=`
Expiration Time: ${i.toISOString()}`),c&&(w+=`
Not Before: ${c.toISOString()}`),l&&(w+=`
Request ID: ${l}`),d){let b=`
Resources:`;for(const x of d){if(!x||typeof x!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${x}`);b+=`
- ${x}`}w+=b}return`${g}
${w}`}BA();const GA={url:JR,storageKey:QR,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:eA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Zv(t,e,n){return await n()}const Gs={};class Jo{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Jo.nextInstanceID,Jo.nextInstanceID+=1,this.instanceID>0&&In()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},GA),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new LA({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=r_(i.fetch),this.lock=i.lock||Zv,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:In()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=zA:this.lock=Zv,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:n_()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Yv(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Yv(this.memoryStorage)),In()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=Gs[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Gs[this.storageKey]=Object.assign(Object.assign({},Gs[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Gs[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Gs[this.storageKey]=Object.assign(Object.assign({},Gs[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${J0}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=gA(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),In()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),aA(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:c}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",c),await this._saveSession(a),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Oe(n)?{error:n}:{error:new e_("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,i;try{const s=await He(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:mr}),{data:a,error:c}=s;if(c||!a)return{data:{user:null,session:null},error:c};const l=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(s){if(Oe(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,i;try{let s;if("email"in e){const{email:u,password:h,options:p}=e;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await Us(this.storage,this.storageKey)),s=await He(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:u,password:h,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:f,code_challenge_method:m},xform:mr})}else if("phone"in e){const{phone:u,password:h,options:p}=e;s=await He(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},channel:(i=p==null?void 0:p.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:mr})}else throw new dl("You must provide either an email or phone number and a password");const{data:a,error:c}=s;if(c||!a)return{data:{user:null,session:null},error:c};const l=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(s){if(Oe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:a,options:c}=e;n=await He(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:Kv})}else if("phone"in e){const{phone:s,password:a,options:c}=e;n=await He(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:Kv})}else throw new dl("You must provide either an email or phone number and a password");const{data:r,error:i}=n;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new mo}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(Oe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,r,i,s,a,c,l,d,u,h,p;let f,m;if("message"in e)f=e.message,m=e.signature;else{const{chain:v,wallet:g,statement:w,options:b}=e;let x;if(In())if(typeof g=="object")x=g;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")x=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=g}const E=new URL((n=b==null?void 0:b.url)!==null&&n!==void 0?n:window.location.href),N=await x.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!N||N.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const j=s_(N[0]);let C=(r=b==null?void 0:b.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!C){const T=await x.request({method:"eth_chainId"});C=UA(T)}const R={domain:E.host,address:j,statement:w,uri:E.href,version:"1",chainId:C,nonce:(i=b==null?void 0:b.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(s=b==null?void 0:b.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(c=b==null?void 0:b.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(l=b==null?void 0:b.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(d=b==null?void 0:b.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=b==null?void 0:b.signInWithEthereum)===null||u===void 0?void 0:u.resources};f=VA(R),m=await x.request({method:"personal_sign",params:[HA(f),j]})}try{const{data:v,error:g}=await He(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:m},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:mr});if(g)throw g;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new mo}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:g})}catch(v){if(Oe(v))return{data:{user:null,session:null},error:v};throw v}}async signInWithSolana(e){var n,r,i,s,a,c,l,d,u,h,p,f;let m,v;if("message"in e)m=e.message,v=e.signature;else{const{chain:g,wallet:w,statement:b,options:x}=e;let E;if(In())if(typeof w=="object")E=w;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))E=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=w}const N=new URL((n=x==null?void 0:x.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in E&&E.signIn){const j=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),b?{statement:b}:null));let C;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")C=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)C=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)m=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),v=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${N.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(i=(r=x==null?void 0:x.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=x==null?void 0:x.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((a=x==null?void 0:x.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((c=x==null?void 0:x.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((d=x==null?void 0:x.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(u=x==null?void 0:x.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const j=await E.signMessage(new TextEncoder().encode(m),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=j}}try{const{data:g,error:w}=await He(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:pA(v)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:mr});if(w)throw w;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new mo}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:w})}catch(g){if(Oe(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const n=await as(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{const{data:s,error:a}=await He(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:mr});if(await pi(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new mo}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(Oe(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:i,access_token:s,nonce:a}=e,c=await He(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:mr}),{data:l,error:d}=c;return d?{data:{user:null,session:null},error:d}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new mo}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:d})}catch(n){if(Oe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,i,s,a;try{if("email"in e){const{email:c,options:l}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Us(this.storage,this.storageKey));const{error:h}=await He(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:c,options:l}=e,{data:d,error:u}=await He(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new dl("You must provide either an email or phone number.")}catch(c){if(Oe(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var n,r;try{let i,s;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:c}=await He(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:mr});if(c)throw c;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,d=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(i){if(Oe(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,r,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await Us(this.storage,this.storageKey)),await He(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:IA})}catch(s){if(Oe(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new xi;const{error:i}=await He(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(Oe(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:s}=e,{error:a}=await He(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:i,options:s}=e,{data:a,error:c}=await He(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:c}}throw new dl("You must provide either an email or phone number and a type")}catch(n){if(Oe(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await as(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<mh:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const a=await as(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=yh()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,d,u)=>(!a&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,d,u))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await He(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ei}):await this._useSession(async n=>{var r,i,s;const{data:a,error:c}=n;if(c)throw c;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new xi}:await He(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Ei})})}catch(n){if(Oe(n))return sA(n)&&(await this._removeSession(),await pi(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:i,error:s}=r;if(s)throw s;if(!i.session)throw new xi;const a=i.session;let c=null,l=null;this.flowType==="pkce"&&e.email!=null&&([c,l]=await Us(this.storage,this.storageKey));const{data:d,error:u}=await He(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:l}),jwt:a.access_token,xform:Ei});if(u)throw u;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(Oe(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new xi;const n=Date.now()/1e3;let r=n,i=!0,s=null;const{payload:a}=vh(e.access_token);if(a.exp&&(r=a.exp,i=r<=n),i){const{session:c,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!c)return{data:{user:null,session:null},error:null};s=c}else{const{data:c,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(Oe(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:a,error:c}=n;if(c)throw c;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new xi;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Oe(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!In())throw new ul("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ul(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new zv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ul("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new zv("No code detected.");const{data:b,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:c,expires_at:l,token_type:d}=e;if(!s||!c||!a||!d)throw new ul("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(c);let p=u+h;l&&(p=parseInt(l));const f=p-u;f*1e3<=ta&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const m=p-h;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,p,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,p,u);const{data:v,error:g}=await this._getUser(s);if(g)throw g;const w={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:h,expires_at:p,refresh_token:a,token_type:d,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:e.type},error:null}}catch(r){if(Oe(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await as(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{error:s};const a=(r=i.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:c}=await this.admin.signOut(a,e);if(c&&!(iA(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await pi(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=mA(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,i;try{const{data:{session:s},error:a}=n;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await Us(this.storage,this.storageKey,!0));try{return await He(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(Oe(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:i}=await this._useSession(async s=>{var a,c,l,d,u;const{data:h,error:p}=s;if(p)throw p;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await He(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return In()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Oe(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:a}=n;if(a)throw a;return await He(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await xA(async i=>(i>0&&await yA(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await He(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:mr})),(i,s)=>{const a=200*Math.pow(2,i);return s&&gh(s)&&Date.now()+a-r<ta})}catch(r){if(this._debug(n,"error",r),Oe(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),In()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const i=await as(this.storage,this.storageKey);if(i&&this.userStorage){let a=await as(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await na(this.userStorage,this.storageKey+"-user",a)),i.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:yh()}else if(i&&!i.user&&!i.user){const a=await as(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await pi(this.storage,this.storageKey+"-user"),await na(this.storage,this.storageKey,i)):i.user=yh()}if(this._debug(r,"session from storage",i),!this._isValidSession(i)){this._debug(r,"session is not valid"),i!==null&&await this._removeSession();return}const s=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<mh;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${mh}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),gh(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:c}=await this._getUser(i.access_token);!c&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(r,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(r,"error",i),console.error(i);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new xi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Fd;const{data:s,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!s.session)throw new xi;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const c={session:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(i,"error",s),Oe(s)){const a={session:null,error:s};return gh(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,n)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await na(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const s=Wv(i);await na(this.storage,this.storageKey,s)}else{const i=Wv(n);await na(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await pi(this.storage,this.storageKey),await pi(this.storage,this.storageKey+"-code-verifier"),await pi(this.storage,this.storageKey+"-user"),this.userStorage&&await pi(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&In()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ta);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/ta);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ta}ms, refresh threshold is ${pp} ticks`),i<=pp&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof i_)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!In()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,a]=await Us(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(c.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);i.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?{data:null,error:s}:await He(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:a}=n;if(a)return{data:null,error:a};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:d}=await He(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{data:null,error:s};const{data:a,error:c}=await He(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:c})})}catch(n){if(Oe(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?{data:null,error:s}:await He(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Oe(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],i=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=vh(i.access_token);let c=null;a.aal&&(c=a.aal);let l=c;((r=(n=i.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:c,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(c=>c.kid===e);if(r)return r;const i=Date.now();if(r=this.jwks.keys.find(c=>c.kid===e),r&&this.jwks_cached_at+nA>i)return r;const{data:s,error:a}=await He(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,r=s.keys.find(c=>c.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:f,error:m}=await this.getSession();if(m||!f.session)return{data:null,error:m};r=f.session.access_token}const{header:i,payload:s,signature:a,raw:{header:c,payload:l}}=vh(r);n!=null&&n.allowExpired||NA(s.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!d){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:s,header:i,signature:a},error:null}}const u=kA(i.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,a,hA(`${c}.${l}`)))throw new gp("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}}}Jo.nextInstanceID=0;const WA=Jo;class qA extends WA{constructor(e){super(e)}}var KA=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(u){try{d(r.next(u))}catch(h){a(h)}}function l(u){try{d(r.throw(u))}catch(h){a(h)}}function d(u){u.done?s(u.value):i(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})};class YA{constructor(e,n,r){var i,s,a;this.supabaseUrl=e,this.supabaseKey=n;const c=XR(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const l=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:zR,realtime:HR,auth:Object.assign(Object.assign({},UR),{storageKey:l}),global:FR},u=ZR(r??{},d);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=qR(n,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new rR(new URL("rest/v1",c).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new $R(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new DT(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return KA(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,userStorage:s,storageKey:a,flowType:c,lock:l,debug:d},u,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new qA({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),u),storageKey:a,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,userStorage:s,flowType:c,lock:l,debug:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new bR(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ZA=(t,e,n)=>new YA(t,e,n);function XA(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}XA()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const JA="https://lnxbvkcggoyfmpfthhhk.supabase.co",QA="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxueGJ2a2NnZ295Zm1wZnRoaGhrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk0OTg5MzcsImV4cCI6MjA3NTA3NDkzN30.jA9UekW12CqU7vKHBZUPN2dtwG-nhqy1yxE8L70HZjM",eI=QA,oe=ZA(JA,eI,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0},global:{headers:{Accept:"application/json","Content-Type":"application/json"}}}),Of=Ba("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-160 ease-out disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:shadow-[0_0_0_1px_hsl(var(--ring)),0_0_8px_hsl(var(--ring)/0.5)]",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 hover:scale-[1.03] hover:-translate-y-0.5 hover:shadow-lg active:scale-[0.98] active:translate-y-0",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 hover:scale-[1.03] hover:shadow-lg active:scale-[0.98]",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground hover:scale-[1.03] hover:shadow-md active:scale-[0.98]",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 hover:scale-[1.03] hover:shadow-md active:scale-[0.98]",ghost:"hover:bg-accent hover:text-accent-foreground hover:scale-[1.03] active:scale-[0.98]",link:"text-primary underline-offset-4 hover:underline hover:scale-[1.02] active:scale-[0.98]"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),U=y.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...i},s)=>{const a=r?dw:"button";return o.jsx(a,{className:J(Of({variant:e,size:n,className:t})),ref:s,...i})});U.displayName="Button";const tI=t=>{const[e,n]=y.useState(!1),[r,i]=y.useState(!0);return y.useEffect(()=>{(async()=>{if(!t){n(!1),i(!1);return}try{const{data:a,error:c}=await oe.from("user_roles").select("role").eq("user_id",t.id).eq("role","admin").maybeSingle();c?(c.code!=="PGRST116"&&c.code!=="PGRST301"&&console.error("Error checking admin status:",c),n(!1)):n(!!a)}catch(a){console.error("Unexpected error checking admin:",a),n(!1)}finally{i(!1)}})()},[t]),{isAdmin:e,isLoading:r}},nI="/assets/prossmind-logo-transparent-CtKdxO7Z.png",rI=lf,iI=uw,sI=cf,a_=y.forwardRef(({className:t,...e},n)=>o.jsx(uc,{className:J("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));a_.displayName=uc.displayName;const aI=Ba("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),o_=y.forwardRef(({side:t="right",className:e,children:n,...r},i)=>o.jsxs(sI,{children:[o.jsx(a_,{}),o.jsxs(hc,{ref:i,className:J(aI({side:t}),e),...r,children:[n,o.jsxs(bd,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[o.jsx(wr,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));o_.displayName=hc.displayName;const c_=({className:t,...e})=>o.jsx("div",{className:J("flex flex-col space-y-2 text-center sm:text-left",t),...e});c_.displayName="SheetHeader";const l_=y.forwardRef(({className:t,...e},n)=>o.jsx(pc,{ref:n,className:J("text-lg font-semibold text-foreground",t),...e}));l_.displayName=pc.displayName;const oI=y.forwardRef(({className:t,...e},n)=>o.jsx(fc,{ref:n,className:J("text-sm text-muted-foreground",t),...e}));oI.displayName=fc.displayName;const d_=y.createContext(void 0),bh="prossmind-theme";function cI({children:t}){const[e,n]=y.useState(()=>typeof window>"u"?"system":localStorage.getItem(bh)||"system"),[r,i]=y.useState(()=>typeof window>"u"?"light":e==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e);y.useEffect(()=>{if(e==="system"){const a=window.matchMedia("(prefers-color-scheme: dark)"),c=l=>{i(l.matches?"dark":"light")};return c(a),a.addEventListener("change",c),()=>a.removeEventListener("change",c)}else i(e)},[e]),y.useEffect(()=>{const a=window.document.documentElement;a.classList.remove("light","dark"),r==="dark"?a.classList.add("dark"):a.classList.add("light")},[r]);const s=a=>{n(a),typeof window<"u"&&localStorage.setItem(bh,a)};return y.useEffect(()=>{const a=window.document.documentElement,l=localStorage.getItem(bh)||"system";let d="light";l==="system"?d=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":d=l,a.classList.remove("light","dark"),a.classList.add(d)},[]),o.jsx(d_.Provider,{value:{theme:e,setTheme:s,resolvedTheme:r},children:t})}function lI(){const t=y.useContext(d_);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t}const wh=()=>{const{theme:t,setTheme:e,resolvedTheme:n}=lI(),[r,i]=y.useState(!1);if(y.useEffect(()=>{i(!0)},[]),!r)return o.jsx(U,{variant:"ghost",size:"icon",className:"h-9 w-9","aria-label":"Theme toggle",disabled:!0,children:o.jsx(mv,{className:"h-5 w-5","aria-hidden":"true"})});const s=()=>{e(t==="light"?"dark":t==="dark"?"system":"light")};return o.jsxs(U,{variant:"ghost",size:"icon",onClick:s,className:"h-9 w-9 relative transition-all","aria-label":`Switch to ${n==="dark"?"light":"dark"} mode`,title:`Current: ${n==="dark"?"Dark":"Light"} mode (${t==="system"?"Auto":"Manual"})`,children:[n==="dark"?o.jsx(mv,{className:"h-5 w-5 transition-all rotate-0 scale-100","aria-hidden":"true"}):o.jsx(u2,{className:"h-5 w-5 transition-all rotate-0 scale-100","aria-hidden":"true"}),o.jsx("span",{className:"sr-only",children:n==="dark"?"Switch to light mode":"Switch to dark mode"})]})},Bi=()=>{const[t,e]=y.useState(!1);return y.useEffect(()=>{const n=window.matchMedia("(prefers-reduced-motion: reduce)");e(n.matches);const r=i=>{e(i.matches)};return n.addEventListener?(n.addEventListener("change",r),()=>n.removeEventListener("change",r)):(n.addListener(r),()=>n.removeListener(r))},[]),t},Je=t=>{if(t)return{duration:0}},Ha=({user:t})=>{const e=af(),{toast:n}=bf(),r=y.useRef(!1),i=y.useRef(null),s=y.useRef(null),[a,c]=y.useState(()=>{const x=t??null;return s.current=x,x}),{isAdmin:l}=tI(a),d=Bi(),[u,h]=y.useState(!1),[p,f]=y.useState(!1),[m,v]=y.useState(!1),{scrollY:g}=rw();y.useEffect(()=>{oe.auth.getSession().then(({data:{session:E}})=>{r.current=!0;const N=(E==null?void 0:E.user)??null;i.current=N,s.current=N,c(N)});const{data:{subscription:x}}=oe.auth.onAuthStateChange((E,N)=>{r.current=!0;const j=(N==null?void 0:N.user)??null;i.current=j,s.current=j,c(j)});return()=>x.unsubscribe()},[]),y.useEffect(()=>{r.current&&(t!==void 0?(s.current=t,c(t),t&&(i.current=t)):t===void 0&&s.current===null&&i.current!==null&&(s.current=i.current,c(i.current)))},[t]),y.useEffect(()=>{s.current=a},[a]),y.useEffect(()=>{const x=()=>{h(window.innerWidth<1080)};return x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]),y.useEffect(()=>{const x=g.on("change",E=>{v(E>50)});return()=>x()},[g]);const w=async()=>{var E,N;const{error:x}=await oe.auth.signOut();x&&!((E=x.message)!=null&&E.includes("session"))&&!((N=x.message)!=null&&N.includes("Session"))&&n({variant:"destructive",title:"Error signing out",description:x.message}),c(null),i.current=null,s.current=null,window.location.href="/"},b=[{name:"App",path:"/"},{name:"Features",path:"/features"},{name:"Vision AI",path:"/vision-ai"},{name:"Pricing",path:"/pricing"},{name:"Contact",path:"/contact"}];return o.jsx(he.nav,{className:"fixed top-0 left-0 right-0 z-50 border-b border-border/50 h-16 bg-background/95 backdrop-blur-lg",style:{backgroundColor:Do(g,[0,100],["hsl(var(--background) / 0.95)","hsl(var(--background) / 1)"]),backdropFilter:Do(g,[0,100],["blur(16px)","blur(24px)"]),boxShadow:Do(g,[0,100],["0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)","0 4px 30px rgba(37, 99, 235, 0.1)"])},initial:d?{y:0}:{y:-100},animate:{y:0},transition:Je(d)||{duration:.3},children:o.jsx("div",{className:"container mx-auto px-6 h-full",children:o.jsxs("div",{className:"flex items-center justify-between h-full",children:[o.jsx(he.div,{animate:d?{scale:1}:{scale:m?.95:1},transition:Je(d)||{duration:.3},children:o.jsxs(pn,{to:"/",className:"flex items-center space-x-3 group flex-shrink-0","aria-label":"ProssMind Home",children:[o.jsx(he.img,{src:nI,alt:"ProssMind Logo",className:"h-10 w-auto",whileHover:d?{}:{scale:1.05},transition:Je(d)||{duration:.2}}),o.jsx("div",{className:"text-xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent whitespace-nowrap",children:"ProssMind"})]})}),!u&&o.jsxs(o.Fragment,{children:[o.jsx(he.div,{className:"flex items-center space-x-1 bg-secondary/50 rounded-full px-2 py-1.5 shadow-sm flex-shrink-0 relative border border-border/30",style:{borderRadius:"40px"},animate:d?{}:{paddingTop:m?"0.25rem":"0.375rem",paddingBottom:m?"0.25rem":"0.375rem"},transition:Je(d)||{duration:.3},children:b.map(x=>o.jsxs(pn,{to:x.path,className:`px-5 py-2 rounded-full text-sm font-medium transition-all duration-300 whitespace-nowrap relative ${e.pathname===x.path?"text-primary-foreground":"text-foreground/70 hover:text-foreground hover:bg-muted/80 hover:scale-[1.02]"}`,"aria-label":`Navigate to ${x.name} page`,children:[e.pathname===x.path&&o.jsx(he.div,{layoutId:d?void 0:"activeNavIndicator",className:"absolute inset-0 bg-primary rounded-full shadow-md",transition:Je(d)||{type:"spring",stiffness:380,damping:30}}),o.jsx("span",{className:"relative z-10",children:x.name})]},x.path))}),a?o.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[o.jsx(wh,{}),l&&o.jsx(pn,{to:"/admin",children:o.jsxs(U,{variant:"outline",size:"sm",className:"gap-2 hover:bg-primary/10 hover:border-primary/50 transition-all whitespace-nowrap","aria-label":"Admin Dashboard",children:[o.jsx(wa,{className:"h-4 w-4","aria-hidden":"true"}),"Admin"]})}),o.jsx("span",{className:"text-sm text-muted-foreground font-medium whitespace-nowrap truncate max-w-[200px]","aria-label":`Logged in as ${a.email}`,children:a.email}),o.jsxs(U,{onClick:w,variant:"outline",className:"items-center gap-2 hover:bg-destructive/10 hover:border-destructive/50 hover:text-destructive transition-all whitespace-nowrap","aria-label":"Sign out",children:[o.jsx(uv,{className:"h-4 w-4","aria-hidden":"true"}),"Sign Out"]})]}):o.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[o.jsx(wh,{}),o.jsx(pn,{to:"/auth",className:"flex-shrink-0",children:o.jsxs(U,{className:"flex items-center gap-2 bg-primary hover:bg-primary/90 shadow-md hover:shadow-lg transition-all whitespace-nowrap","aria-label":"Sign up or log in",children:["Sign Up",o.jsx(Yo,{className:"h-4 w-4","aria-hidden":"true"})]})})]})]}),u&&o.jsxs(rI,{open:p,onOpenChange:f,children:[o.jsx(iI,{asChild:!0,children:o.jsx(he.div,{whileTap:d?{}:{scale:.95},children:o.jsxs(U,{variant:"ghost",size:"icon",className:"md:hidden","aria-label":"Open navigation menu",children:[o.jsx(he.div,{animate:d?{rotate:p?90:0}:{rotate:p?90:0},transition:Je(d)||{duration:.3},children:o.jsx(c2,{className:"h-6 w-6","aria-hidden":"true"})}),o.jsx("span",{className:"sr-only",children:"Open menu"})]})})}),o.jsxs(o_,{side:"right",className:"w-[300px] sm:w-[400px]",children:[o.jsx(c_,{children:o.jsx(l_,{children:"Menu"})}),o.jsxs("nav",{className:"flex flex-col gap-4 mt-6",children:[o.jsxs(he.div,{className:"flex items-center justify-between px-4 py-2 border-b border-border mb-2",initial:d?{opacity:1,x:0}:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:Je(d)||{delay:.1},children:[o.jsx("span",{className:"text-sm font-medium",children:"Theme"}),o.jsx(wh,{})]}),b.map((x,E)=>o.jsx(he.div,{initial:d?{opacity:1,x:0}:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:Je(d)||{delay:.1+E*.05},children:o.jsx(pn,{to:x.path,onClick:()=>f(!1),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 block ${e.pathname===x.path?"bg-primary text-primary-foreground":"text-foreground/70 hover:text-foreground hover:bg-muted/80"}`,"aria-label":`Navigate to ${x.name} page`,children:x.name})},x.path)),a?o.jsxs(o.Fragment,{children:[l&&o.jsx(pn,{to:"/admin",onClick:()=>f(!1),children:o.jsxs(U,{variant:"outline",className:"w-full justify-start gap-2","aria-label":"Admin Dashboard",children:[o.jsx(wa,{className:"h-4 w-4","aria-hidden":"true"}),"Admin"]})}),o.jsx("div",{className:"px-4 py-2 text-sm text-muted-foreground","aria-label":`Logged in as ${a.email}`,children:a.email}),o.jsxs(U,{onClick:()=>{w(),f(!1)},variant:"outline",className:"w-full justify-start gap-2 hover:bg-destructive/10 hover:border-destructive/50 hover:text-destructive","aria-label":"Sign out",children:[o.jsx(uv,{className:"h-4 w-4","aria-hidden":"true"}),"Sign Out"]})]}):o.jsx(pn,{to:"/auth",onClick:()=>f(!1),children:o.jsxs(U,{className:"w-full gap-2","aria-label":"Sign up or log in",children:["Sign Up",o.jsx(Yo,{className:"h-4 w-4","aria-hidden":"true"})]})})]})]})]})]})})})},dI="/assets/hero-mind-process-CVwas96Y.jpg",uI=()=>{const t=y.useRef(null),e=y.useRef([]),n=y.useRef();return y.useEffect(()=>{const r=t.current;if(!r)return;const i=r.getContext("2d");if(!i)return;const s=()=>{r.width=window.innerWidth,r.height=window.innerHeight};s(),window.addEventListener("resize",s);const a=Math.min(20,Math.max(15,Math.floor(r.width*r.height/2e4)));e.current=Array.from({length:a},()=>({x:Math.random()*r.width,y:Math.random()*r.height,vx:(Math.random()-.5)*.3,vy:(Math.random()-.5)*.3-.2,size:Math.random()*2+1,rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.02,opacity:Math.random()*.5+.3}));const c=()=>{i.clearRect(0,0,r.width,r.height);const l=e.current;l.forEach(d=>{let u=d.x+d.vx,h=d.y+d.vy;d.rotation+=d.rotationSpeed,u<0&&(u=r.width,d.opacity=Math.random()*.5+.3),u>r.width&&(u=0,d.opacity=Math.random()*.5+.3),h<0&&(h=r.height,d.opacity=Math.random()*.5+.3),h>r.height&&(h=0,d.opacity=Math.random()*.5+.3),d.x=u,d.y=h,i.save(),i.translate(d.x,d.y),i.rotate(d.rotation),i.beginPath(),i.arc(0,0,d.size,0,Math.PI*2),i.fillStyle=`rgba(37, 99, 235, ${d.opacity})`,i.fill(),i.restore()}),l.forEach((d,u)=>{l.slice(u+1).forEach(h=>{const p=d.x-h.x,f=d.y-h.y,m=Math.sqrt(p*p+f*f);m<150&&(i.beginPath(),i.moveTo(d.x,d.y),i.lineTo(h.x,h.y),i.strokeStyle=`rgba(37, 99, 235, ${.1*(1-m/150)})`,i.lineWidth=.5,i.stroke())})}),n.current=requestAnimationFrame(c)};return c(),()=>{window.removeEventListener("resize",s),n.current&&cancelAnimationFrame(n.current)}},[]),o.jsx(he.canvas,{ref:t,className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:1},transition:{duration:1}})},hI=({containerRef:t,centerX:e,centerY:n})=>{const r=y.useRef(null),[i,s]=y.useState([]),a=y.useRef();if(y.useEffect(()=>{if(!t.current||e===0||n===0)return;const l=t.current.getBoundingClientRect(),d=e-l.left,u=n-l.top,h=6,p=Array.from({length:h},(m,v)=>{const g=v/h*Math.PI*2,w=150+Math.random()*100,b=d+Math.cos(g)*w,x=u+Math.sin(g)*w,E=3+Math.floor(Math.random()*3),N=Array.from({length:E},()=>({progress:Math.random(),speed:.005+Math.random()*.005}));return{id:v,startX:d,startY:u,endX:b,endY:x,particles:N}});s(p);const f=()=>{s(m=>m.map(v=>({...v,particles:v.particles.map(g=>({...g,progress:(g.progress+g.speed)%1}))}))),a.current=requestAnimationFrame(f)};return f(),()=>{a.current&&cancelAnimationFrame(a.current)}},[e,n,t]),!t.current)return null;const c=t.current.getBoundingClientRect();return o.jsxs("svg",{ref:r,className:"absolute inset-0 pointer-events-none",width:c.width,height:c.height,children:[o.jsx("defs",{children:o.jsxs("filter",{id:"glow",children:[o.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),o.jsxs("feMerge",{children:[o.jsx("feMergeNode",{in:"coloredBlur"}),o.jsx("feMergeNode",{in:"SourceGraphic"})]})]})}),i.map(l=>o.jsxs("g",{children:[o.jsx(he.line,{x1:l.startX,y1:l.startY,x2:l.endX,y2:l.endY,stroke:"rgba(37, 99, 235, 0.2)",strokeWidth:"1",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,ease:"easeOut"}}),l.particles.map((d,u)=>{const h=l.startX+(l.endX-l.startX)*d.progress,p=l.startY+(l.endY-l.startY)*d.progress,f=1-d.progress%.2*5;return o.jsxs("g",{children:[o.jsx("circle",{cx:h,cy:p,r:"8",fill:"rgba(37, 99, 235, 0.1)",opacity:f,filter:"url(#glow)"}),o.jsx(he.circle,{cx:h,cy:p,r:"3",fill:"rgba(37, 99, 235, 0.8)",filter:"url(#glow)",animate:{scale:[1,1.2,1],opacity:[.6,1,.6]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}})]},u)})]},l.id))]})},pI=({src:t,autoplay:e=!0,loop:n=!0,className:r="","aria-label":i,lazy:s=!0,fallback:a})=>{const c=y.useRef(null),l=y.useRef(null),[d,u]=y.useState(!1),[h,p]=y.useState(!1),f=Bi(),[m,v]=y.useState(!s);return y.useEffect(()=>{if(!s||m)return;const g=c.current;if(!g)return;const w=new IntersectionObserver(b=>{b.forEach(x=>{x.isIntersecting&&(v(!0),w.disconnect())})},{rootMargin:"100px",threshold:0});if(w.observe(g),typeof window.requestIdleCallback<"u"){const b=window.requestIdleCallback(()=>{m||v(!0)});return()=>{w.disconnect(),window.cancelIdleCallback(b)}}return()=>w.disconnect()},[s,m]),y.useEffect(()=>{if(!m||!c.current||f){f&&a&&u(!0);return}let g=!0;return(async()=>{try{const b=await fetch(t);if(!b.ok)throw new Error(`Failed to load animation: ${b.statusText}`);const x=await b.json();if(!g||!c.current)return;const E=Kk.loadAnimation({container:c.current,renderer:"svg",loop:n,autoplay:e,animationData:x});l.current=E,u(!0)}catch(b){console.error("Error loading Lottie animation:",b),g&&(p(!0),u(!0))}})(),()=>{g=!1,l.current&&(l.current.destroy(),l.current=null)}},[t,m,f,e,n,a]),f&&a?o.jsx("div",{className:r,children:a}):h&&a?o.jsx("div",{className:r,children:a}):o.jsx("div",{ref:c,className:r,"aria-label":i,"aria-hidden":i?void 0:"true",role:i?"img":void 0})},$f=t=>{const e=y.useRef(null),n=jk(e,{once:(t==null?void 0:t.once)??!0,amount:(t==null?void 0:t.threshold)??.15});return{ref:e,isInView:n}},u_={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6,ease:"easeOut"}}},Lf={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.1}}},Uo={hidden:{opacity:0,y:18},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.2,.9,.3,1]}}},fI=()=>{const t=Bi(),e=y.useRef(null),n=()=>{const a=document.querySelector('[data-section="try-prossmind"]');a==null||a.scrollIntoView({behavior:t?"auto":"smooth",block:"start"})},{scrollY:r}=rw();Do(r,[0,500],[0,100]),Do(r,[0,300],[1,0]);const[i,s]=y.useState({x:0,y:0});return y.useEffect(()=>{if(e.current){const a=e.current.getBoundingClientRect();s({x:a.left+a.width/2,y:a.top+a.height/2})}},[]),o.jsxs("section",{className:"relative min-h-[700px] bg-gradient-to-b from-gray-50 to-white dark:from-background dark:to-card text-hero-foreground dark:text-foreground overflow-hidden",children:[o.jsx(uI,{}),o.jsx("div",{className:"container mx-auto px-8 md:px-12 pb-8 md:pb-16 relative z-10",children:o.jsxs("div",{className:"grid md:grid-cols-2 gap-16 items-center min-h-[600px]",children:[o.jsxs(he.div,{className:"space-y-6 md:space-y-8 flex flex-col justify-center",initial:"hidden",animate:"visible",variants:u_,children:[o.jsxs(he.div,{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-primary/10 dark:bg-primary/20 border border-primary/20 dark:border-primary/30 text-xs font-medium mb-2",style:{width:"fit-content"},initial:t?{opacity:1,x:0}:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:Je(t)||{delay:.2,duration:.5},children:[o.jsx(_a,{className:"h-3 w-3 text-primary"}),o.jsx("span",{children:"AI-Powered Process Intelligence"})]}),o.jsx(he.h1,{className:"text-5xl md:text-7xl font-bold leading-tight tracking-tight",initial:t?{opacity:1,y:0}:{opacity:0,y:20},animate:{opacity:1,y:0},transition:Je(t)||{delay:.4,duration:.7,ease:"easeOut"},children:"ProssMind"}),o.jsx(he.p,{className:"text-lg md:text-xl text-foreground/80 dark:text-foreground/80 max-w-lg leading-relaxed",initial:t?{opacity:1,y:0}:{opacity:0,y:10},animate:{opacity:1,y:0},transition:Je(t)||{delay:1.1,duration:.6},children:"Swiss AI Process Intelligence  GDPR Compliant  Locally Hosted."}),o.jsxs(he.div,{className:"flex flex-col gap-4 sm:flex-row sm:gap-6 pt-2",initial:t?{opacity:1,y:0}:{opacity:0,y:20},animate:{opacity:1,y:0},transition:Je(t)||{delay:.5,duration:.6},children:[o.jsx(he.div,{whileHover:t?{}:{scale:1.02},transition:Je(t)||{duration:.2},children:o.jsx(U,{size:"lg",className:"group text-base px-8 py-6 shadow-lg hover:shadow-xl transition-all focus-visible:outline-2 focus-visible:outline-offset-2 relative overflow-hidden",onClick:n,"aria-label":"Try ProssMind for free",style:{background:"linear-gradient(135deg, hsl(var(--primary)), hsl(var(--primary) / 0.9))"},children:o.jsxs(he.span,{className:"flex items-center",whileHover:t?{}:{scale:1.02},children:["Try It Free",o.jsx(he.span,{className:"ml-2",animate:t?{x:0}:{x:[0,4,0]},transition:Je(t)||{duration:1.5,repeat:1/0,repeatDelay:2},children:o.jsx(qC,{className:"h-5 w-5 group-hover:translate-x-1 transition-transform","aria-hidden":"true"})})]})})}),o.jsx(he.div,{whileHover:t?{}:{scale:1.02},transition:Je(t)||{duration:.2},children:o.jsx(U,{size:"lg",variant:"outline",className:"group text-base px-8 py-6 bg-hero-foreground/5 dark:bg-foreground/5 hover:bg-primary/5 border-2 border-primary/30 hover:border-primary transition-all focus-visible:outline-2 focus-visible:outline-offset-2 relative","aria-label":"View ProssMind features",style:{boxShadow:"0 0 0px rgba(100, 180, 255, 0)"},onMouseEnter:a=>{a.currentTarget.style.boxShadow="0 0 15px rgba(100, 180, 255, 0.5)",a.currentTarget.style.color="hsl(var(--primary))"},onMouseLeave:a=>{a.currentTarget.style.boxShadow="0 0 0px rgba(100, 180, 255, 0)",a.currentTarget.style.color=""},children:o.jsxs("span",{className:"flex items-center",children:["View Features",o.jsx(he.span,{initial:t?{opacity:1,x:0}:{opacity:0,x:-5},whileHover:t?{}:{opacity:1,x:0},transition:Je(t)||{duration:.2},className:"ml-2",children:o.jsx(Yo,{className:"h-5 w-5","aria-hidden":"true"})})]})})})]})]}),o.jsxs(he.div,{ref:e,className:"relative",initial:t?{opacity:1,x:0}:{opacity:0,x:50},animate:{opacity:1,x:0},transition:Je(t)||{delay:.6,duration:.7},children:[i.x>0&&i.y>0&&o.jsx(hI,{containerRef:e,centerX:i.x,centerY:i.y}),o.jsx(he.div,{className:"absolute inset-0 bg-primary/20 dark:bg-primary/10 blur-3xl rounded-full glow-effect",animate:t?{scale:1}:{scale:[1,1.1,1]},transition:Je(t)||{duration:4,repeat:1/0}}),o.jsx(he.div,{className:"relative z-10 rounded-2xl overflow-hidden shadow-2xl border border-hero-foreground/10 dark:border-border/50",whileHover:t?{}:{scale:1.02},animate:t?{scale:1}:{scale:[1,1.02,1]},transition:Je(t)||{duration:2,repeat:1/0,ease:"easeInOut"},children:o.jsx(pI,{src:"/animations/brain-flow.json",autoplay:!0,loop:!0,className:"w-full h-auto","aria-label":"Mind and Process Mining Intelligence animation",lazy:!0,fallback:o.jsx("img",{src:dI,alt:"Mind and Process Mining Intelligence",className:"w-full h-auto",loading:"lazy"})})})]})]})}),o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-24 bg-gradient-to-t from-background to-transparent"})]})},mI=()=>{const t=Bi(),e=[{icon:or,title:"Upload Your Document",description:"Upload images, PDFs, Word documents, or text files describing your process.",color:"text-blue-500",glowColor:"blue"},{icon:KC,title:"AI Analysis",description:"Our AI analyzes your document and extracts process information using advanced NLP.",color:"text-purple-500",glowColor:"purple"},{icon:Nf,title:"BPMN Generation",description:"The AI generates a complete BPMN diagram with tasks, gateways, and flows.",color:"text-green-500",glowColor:"green"},{icon:XC,title:"Ready to Use",description:"Download your BPMN diagram or integrate directly with your workflow tools.",color:"text-primary",glowColor:"primary"}],n=r=>{switch(r){case"blue":return"hover:shadow-[0_0_20px_rgba(59,130,246,0.5)] hover:shadow-blue-500/50";case"purple":return"hover:shadow-[0_0_20px_rgba(168,85,247,0.5)] hover:shadow-purple-500/50";case"green":return"hover:shadow-[0_0_20px_rgba(34,197,94,0.5)] hover:shadow-green-500/50";case"primary":return"hover:shadow-[0_0_20px_hsl(var(--primary))] hover:shadow-primary/50";default:return"hover:shadow-[0_0_20px_rgba(59,130,246,0.5)]"}};return o.jsx("section",{className:"py-24 bg-background relative overflow-hidden",children:o.jsxs("div",{className:"container mx-auto px-6",children:[o.jsxs(he.div,{className:"text-center mb-16",initial:t?{opacity:1,y:0}:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:Je(t)||{duration:.6},children:[o.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-4",children:"How It Works"}),o.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"From document to diagram in seconds"})]}),o.jsx("div",{className:"max-w-4xl mx-auto",children:o.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8",children:e.map((r,i)=>{const s=r.icon;return o.jsxs(he.div,{className:`text-center space-y-4 p-6 rounded-2xl transition-all duration-300 cursor-pointer ${n(r.glowColor)}`,initial:t?{opacity:1,y:0}:{opacity:0,y:20},whileInView:t?{}:{opacity:1,y:0},viewport:{once:!0,amount:.5},transition:Je(t)||{duration:.6,delay:i*.1},whileHover:t?{}:{scale:1.05,y:-5},children:[o.jsx(he.div,{className:"w-16 h-16 mx-auto rounded-full bg-muted flex items-center justify-center transition-all duration-300","aria-hidden":"true",children:o.jsx(s,{className:`h-8 w-8 ${r.color} transition-all duration-300`,"aria-hidden":"true"})}),o.jsx("h3",{className:"text-xl font-semibold",children:r.title}),o.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]},i)})})})]})})},_h="prossmind_free_prompts",go=5,h_=t=>{const[e,n]=y.useState(go),[r,i]=y.useState(!1);return y.useEffect(()=>{if(t)n(1/0),i(!1);else{const a=localStorage.getItem(_h),c=a?parseInt(a,10):0,l=Math.max(0,go-c);n(l),i(l===0)}},[t]),{remainingPrompts:e,hasUsedAllPrompts:r,usePrompt:()=>{if(t)return!0;if(r)return!1;const a=localStorage.getItem(_h),c=a?parseInt(a,10):0;if(c>=go)return i(!0),n(0),!1;const l=c+1;return localStorage.setItem(_h,l.toString()),n(go-l),l>=go&&i(!0),!0},isUnlimited:t}},Er=y.forwardRef(({className:t,...e},n)=>o.jsx("textarea",{className:J("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground transition-all duration-200 ease-in-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:border-ring focus-visible:shadow-[0_0_0_1px_hsl(var(--ring)),0_0_8px_hsl(var(--ring)/0.3)] disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));Er.displayName="Textarea";var Bf="Progress",Ff=100,[gI,pz]=Vn(Bf),[vI,yI]=gI(Bf),p_=y.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:i,getValueLabel:s=xI,...a}=t;(i||i===0)&&!Xv(i)&&console.error(bI(`${i}`,"Progress"));const c=Xv(i)?i:Ff;r!==null&&!Jv(r,c)&&console.error(wI(`${r}`,"Progress"));const l=Jv(r,c)?r:null,d=Zl(l)?s(l,c):void 0;return o.jsx(vI,{scope:n,value:l,max:c,children:o.jsx(Pe.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":Zl(l)?l:void 0,"aria-valuetext":d,role:"progressbar","data-state":g_(l,c),"data-value":l??void 0,"data-max":c,...a,ref:e})})});p_.displayName=Bf;var f_="ProgressIndicator",m_=y.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,i=yI(f_,n);return o.jsx(Pe.div,{"data-state":g_(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...r,ref:e})});m_.displayName=f_;function xI(t,e){return`${Math.round(t/e*100)}%`}function g_(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function Zl(t){return typeof t=="number"}function Xv(t){return Zl(t)&&!isNaN(t)&&t>0}function Jv(t,e){return Zl(t)&&!isNaN(t)&&t<=e&&t>=0}function bI(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Ff}\`.`}function wI(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Ff} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var v_=p_,_I=m_;const Ln=y.forwardRef(({className:t,value:e,...n},r)=>o.jsx(v_,{ref:r,className:J("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:o.jsx(_I,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));Ln.displayName=v_.displayName;function Sc(t){df.call(this,t),this.on("import.parse.complete",function(e){e.error||this._collectIds(e.definitions,e.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}fe(Sc,df);Sc.prototype._createModdle=function(t){var e=df.prototype._createModdle.call(this,t);return e.ids=new Yk([32,36,1]),e};Sc.prototype._collectIds=function(t,e){var n=t.$model,r=n.ids,i;r.clear();for(i in e)r.claim(i,e[i])};var EI=["c","C"],SI=["v","V"],jI=["y","Y"],y_=["z","Z"];function NI(t){return t.ctrlKey||t.metaKey||t.shiftKey||t.altKey}function zn(t){return t.altKey?!1:t.ctrlKey||t.metaKey}function Ft(t,e){return t=Ue(t)?t:[t],t.indexOf(e.key)!==-1||t.indexOf(e.code)!==-1}function zf(t){return t.shiftKey}function kI(t){return zn(t)&&Ft(EI,t)}function CI(t){return zn(t)&&Ft(SI,t)}function PI(t){return zn(t)&&!zf(t)&&Ft(y_,t)}function TI(t){return zn(t)&&(Ft(jI,t)||Ft(y_,t)&&zf(t))}var zd="keyboard.keydown",RI="keyboard.keyup",AI=1e3,x_="Keyboard binding is now implicit; explicit binding to an element got removed. For more information, see https://github.com/bpmn-io/diagram-js/issues/661";function ln(t,e){var n=this;this._config=t=t||{},this._eventBus=e,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),e.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.bindTo&&console.error("unsupported configuration <keyboard.bindTo>",new Error(x_));var r=t&&t.bind!==!1;e.on("canvas.init",function(i){n._target=i.svg,r&&n.bind(),n._fire("init")})}ln.$inject=["config.keyboard","eventBus"];ln.prototype._keydownHandler=function(t){this._keyHandler(t,zd)};ln.prototype._keyupHandler=function(t){this._keyHandler(t,RI)};ln.prototype._keyHandler=function(t,e){var n;if(!this._isEventIgnored(t)){var r={keyEvent:t};n=this._eventBus.fire(e||zd,r),n&&t.preventDefault()}};ln.prototype._isEventIgnored=function(t){return!1};ln.prototype.bind=function(t){t&&console.error("unsupported argument <node>",new Error(x_)),this.unbind(),t=this._node=this._target,je.bind(t,"keydown",this._keydownHandler),je.bind(t,"keyup",this._keyupHandler),this._fire("bind")};ln.prototype.getBinding=function(){return this._node};ln.prototype.unbind=function(){var t=this._node;t&&(this._fire("unbind"),je.unbind(t,"keydown",this._keydownHandler),je.unbind(t,"keyup",this._keyupHandler)),this._node=null};ln.prototype._fire=function(t){this._eventBus.fire("keyboard."+t,{node:this._node})};ln.prototype.addListener=function(t,e,n){Hn(t)&&(n=e,e=t,t=AI),this._eventBus.on(n||zd,t,e)};ln.prototype.removeListener=function(t,e){this._eventBus.off(e||zd,t)};ln.prototype.hasModifier=NI;ln.prototype.isCmd=zn;ln.prototype.isShift=zf;ln.prototype.isKey=Ft;var II=500;function Va(t,e){var n=this;t.on("editorActions.init",II,function(r){var i=r.editorActions;n.registerBindings(e,i)})}Va.$inject=["eventBus","keyboard"];Va.prototype.registerBindings=function(t,e){function n(r,i){e.isRegistered(r)&&t.addListener(i)}n("undo",function(r){var i=r.keyEvent;if(PI(i))return e.trigger("undo"),!0}),n("redo",function(r){var i=r.keyEvent;if(TI(i))return e.trigger("redo"),!0}),n("copy",function(r){var i=r.keyEvent;if(kI(i))return e.trigger("copy"),!0}),n("paste",function(r){var i=r.keyEvent;if(CI(i))return e.trigger("paste"),!0}),n("stepZoom",function(r){var i=r.keyEvent;if(Ft(["+","Add","="],i)&&zn(i))return e.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(r){var i=r.keyEvent;if(Ft(["-","Subtract"],i)&&zn(i))return e.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(r){var i=r.keyEvent;if(Ft("0",i)&&zn(i))return e.trigger("zoom",{value:1}),!0}),n("removeSelection",function(r){var i=r.keyEvent;if(Ft(["Backspace","Delete","Del"],i))return e.trigger("removeSelection"),!0})};const Uf={__init__:["keyboard","keyboardBindings"],keyboard:["type",ln],keyboardBindings:["type",Va]};var MI={moveSpeed:50,moveSpeedAccelerated:200};function b_(t,e,n){var r=this;this._config=L({},MI,t||{}),e.addListener(i);function i(s){var a=s.keyEvent,c=r._config;if(e.isCmd(a)&&e.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],a)){var l=e.isShift(a)?c.moveSpeedAccelerated:c.moveSpeed,d;switch(a.key){case"ArrowLeft":case"Left":d="left";break;case"ArrowUp":case"Up":d="up";break;case"ArrowRight":case"Right":d="right";break;case"ArrowDown":case"Down":d="down";break}return r.moveCanvas({speed:l,direction:d}),!0}}this.moveCanvas=function(s){var a=0,c=0,l=s.speed,d=l/Math.min(Math.sqrt(n.viewbox().scale),1);switch(s.direction){case"left":a=d;break;case"up":c=d;break;case"right":a=-d;break;case"down":c=-d;break}n.scroll({dx:a,dy:c})}}b_.$inject=["config.keyboardMove","keyboard","canvas"];const w_={__depends__:[Uf],__init__:["keyboardMove"],keyboardMove:["type",b_]};var DI=/^djs-cursor-.*$/;function Ud(t){var e=Dt(document.body);e.removeMatching(DI),t&&e.add("djs-cursor-"+t)}function __(){Ud(null)}var OI=5e3;function E_(t,e){e=e||"element.click";function n(){return!1}return t.once(e,OI,n),function(){t.off(e,n)}}function Ho(t){return{x:t.x+t.width/2,y:t.y+t.height/2}}function cr(t,e){return{x:t.x-e.x,y:t.y-e.y}}var $I=15;function S_(t,e){var n;function r(c){return a(c.originalEvent)}t.on("canvas.focus.changed",function(c){c.focused?t.on("element.mousedown",500,r):t.off("element.mousedown",r)});function i(c){var l=n.start,d=n.button,u=Es(c),h=cr(u,l);if(!n.dragging&&LI(h)>$I&&(n.dragging=!0,d===0&&E_(t),Ud("grab")),n.dragging){var p=n.last||n.start;h=cr(u,p),e.scroll({dx:h.x,dy:h.y}),n.last=u}c.preventDefault()}function s(c){je.unbind(document,"mousemove",i),je.unbind(document,"mouseup",s),n=null,__()}function a(c){if(!gc(c.target,".djs-draggable")){var l=c.button;if(!(l>=2||c.ctrlKey||c.shiftKey||c.altKey))return n={button:l,start:Es(c)},je.bind(document,"mousemove",i),je.bind(document,"mouseup",s),!0}}this.isActive=function(){return!!n}}S_.$inject=["eventBus","canvas"];function LI(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}const j_={__init__:["moveCanvas"],moveCanvas:["type",S_]};function vp(t){return Math.log(t)/Math.log(10)}function N_(t,e){var n=vp(t.min),r=vp(t.max),i=Math.abs(n)+Math.abs(r);return i/e}function BI(t,e){return Math.max(t.min,Math.min(t.max,e))}var FI=Math.sign||function(t){return t>=0?1:-1},Hf={min:.2,max:4},k_=10,zI=.1,UI=.75;function kr(t,e,n){t=t||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=Ss(this._handleWheel,this),this._totalDelta=0,this._scale=t.scale||UI;var r=this;e.on("canvas.focus.changed",function(i){r._init(i.focused&&t.enabled!==!1)})}kr.$inject=["config.zoomScroll","eventBus","canvas"];kr.prototype.scroll=function(e){this._canvas.scroll(e)};kr.prototype.reset=function(){this._canvas.zoom("fit-viewport")};kr.prototype.zoom=function(e,n){var r=N_(Hf,k_*2);this._totalDelta+=e,Math.abs(this._totalDelta)>zI&&(this._zoom(e,n,r),this._totalDelta=0)};kr.prototype._handleWheel=function(e){if(this._canvas.isFocused()){var n=this._container;e.preventDefault();var r=e.ctrlKey||Zk()&&e.metaKey,i=e.shiftKey,s=-1*this._scale,a;if(r?s*=e.deltaMode===0?.02:.32:s*=e.deltaMode===0?1:16,r){var c=n.getBoundingClientRect(),l={x:e.clientX-c.left,y:e.clientY-c.top};a=Math.sqrt(Math.pow(e.deltaY,2)+Math.pow(e.deltaX,2))*FI(e.deltaY)*s,this.zoom(a,l)}else i?a={dx:s*e.deltaY,dy:0}:a={dx:s*e.deltaX,dy:s*e.deltaY},this.scroll(a)}};kr.prototype.stepZoom=function(e,n){var r=N_(Hf,k_);this._zoom(e,n,r)};kr.prototype._zoom=function(t,e,n){var r=this._canvas,i=t>0?1:-1,s=vp(r.zoom()),a=Math.round(s/n)*n;a+=n*i;var c=Math.pow(10,a);r.zoom(BI(Hf,c),e)};kr.prototype.toggle=function(e){var n=this._container,r=this._handleWheel,i=this._enabled;return typeof e>"u"&&(e=!i),i!==e&&je[e?"bind":"unbind"](n,"wheel",r,!1),this._enabled=e,e};kr.prototype._init=function(t){this.toggle(t)};const C_={__init__:["zoomScroll"],zoomScroll:["type",kr]};function Qo(t){vc.call(this,t)}fe(Qo,vc);Qo.prototype._navigationModules=[w_,j_,C_];Qo.prototype._modules=[].concat(vc.prototype._modules,Qo.prototype._navigationModules);function Eh(t){return t&&t[t.length-1]}function Qv(t){return t.y}function ey(t){return t.x}var HI={left:ey,center:ey,right:function(t){return t.x+t.width},top:Qv,middle:Qv,bottom:function(t){return t.y+t.height}};function Ga(t,e){this._modeling=t,this._rules=e}Ga.$inject=["modeling","rules"];Ga.prototype._getOrientationDetails=function(t){var e=["top","bottom","middle"],n="x",r="width";return e.indexOf(t)!==-1&&(n="y",r="height"),{axis:n,dimension:r}};Ga.prototype._isType=function(t,e){return e.indexOf(t)!==-1};Ga.prototype._alignmentPosition=function(t,e){var n=this._getOrientationDetails(t),r=n.axis,i=n.dimension,s={},a={},c=!1,l,d,u;function h(p,f){return Math.round((p[r]+f[r]+f[i])/2)}if(this._isType(t,["left","top"]))s[t]=e[0][r];else if(this._isType(t,["right","bottom"]))u=Eh(e),s[t]=u[r]+u[i];else if(this._isType(t,["center","middle"])){if(I(e,function(p){var f=p[r]+Math.round(p[i]/2);a[f]?a[f].elements.push(p):a[f]={elements:[p],center:f}}),l=Kr(a,function(p){return p.elements.length>1&&(c=!0),p.elements.length}),c)return s[t]=Eh(l).center,s;d=e[0],e=Kr(e,function(p){return p[r]+p[i]}),u=Eh(e),s[t]=h(d,u)}return s};Ga.prototype.trigger=function(t,e){var n=this._modeling,r,i=Ve(t,function(l){return!(l.waypoints||l.host||l.labelTarget)});if(r=this._rules.allowed("elements.align",{elements:i}),Ue(r)&&(i=r),!(i.length<2||!r)){var s=HI[e],a=Kr(i,s),c=this._alignmentPosition(e,a);n.alignElements(a,c)}};const VI={__init__:["alignElements"],alignElements:["type",Ga]},GI=new uf;function Wa(t){this._scheduled={},t.on("diagram.destroy",()=>{Object.keys(this._scheduled).forEach(e=>{this.cancel(e)})})}Wa.$inject=["eventBus"];Wa.prototype.schedule=function(t,e=GI.next()){this.cancel(e);const n=this._schedule(t,e);return this._scheduled[e]=n,n.promise};Wa.prototype._schedule=function(t,e){const n=WI();return{executionId:setTimeout(()=>{try{this._scheduled[e]=null;try{n.resolve(t())}catch(i){n.reject(i)}}catch(i){console.error("Scheduler#_schedule execution failed",i)}}),promise:n.promise}};Wa.prototype.cancel=function(t){const e=this._scheduled[t];e&&(this._cancel(e),this._scheduled[t]=null)};Wa.prototype._cancel=function(t){clearTimeout(t.executionId)};function WI(){const t={};return t.promise=new Promise((e,n)=>{t.resolve=e,t.reject=n}),t}const qI={scheduler:["type",Wa]};var KI="djs-element-hidden",hl=".entry",YI=1e3,ty=8,ZI=300;function Tt(t,e,n,r){this._canvas=t,this._elementRegistry=e,this._eventBus=n,this._scheduler=r,this._current=null,this._init()}Tt.$inject=["canvas","elementRegistry","eventBus","scheduler"];Tt.prototype._init=function(){var t=this;this._eventBus.on("selection.changed",function(e){var n=e.newSelection,r=n.length?n.length===1?n[0]:n:null;r?t.open(r,!0):t.close()}),this._eventBus.on("elements.changed",function(e){var n=e.elements,r=t._current;if(r){var i=r.target,s=Ue(i)?i:[i],a=s.filter(function(l){return n.includes(l)});if(a.length){t.close();var c=s.filter(function(l){return t._elementRegistry.get(l.id)});c.length&&t._updateAndOpen(c.length>1?c:c[0])}}}),this._eventBus.on("canvas.viewbox.changed",function(){t._updatePosition()}),this._eventBus.on("element.marker.update",function(e){if(t.isOpen()){var n=e.element,r=t._current,i=Ue(r.target)?r.target:[r.target];i.includes(n)&&t._updateVisibility()}}),this._container=this._createContainer()};Tt.prototype._createContainer=function(){var t=Ht('<div class="djs-context-pad-parent"></div>');return this._canvas.getContainer().appendChild(t),t};Tt.prototype.registerProvider=function(t,e){e||(e=t,t=YI),this._eventBus.on("contextPad.getProviders",t,function(n){n.providers.push(e)})};Tt.prototype.getEntries=function(t){var e=this._getProviders(),n=Ue(t)?"getMultiElementContextPadEntries":"getContextPadEntries",r={};return I(e,function(i){if(Hn(i[n])){var s=i[n](t);Hn(s)?r=s(r):I(s,function(a,c){r[c]=a})}}),r};Tt.prototype.trigger=function(t,e,n){var r=this,i,s,a=e.delegateTarget||e.target;if(!a)return e.preventDefault();if(i=mn(a,"data-action"),s=e.originalEvent||e,t==="mouseover"){this._timeout=setTimeout(function(){r._mouseout=r.triggerEntry(i,"hover",s,n)},ZI);return}else if(t==="mouseout"){clearTimeout(this._timeout),this._mouseout&&(this._mouseout(),this._mouseout=null);return}return this.triggerEntry(i,t,s,n)};Tt.prototype.triggerEntry=function(t,e,n,r){if(this.isShown()){var i=this._current.target,s=this._current.entries,a=s[t];if(a){var c=a.action;if(this._eventBus.fire("contextPad.trigger",{entry:a,event:n})!==!1){if(Hn(c)){if(e==="click")return c(n,i,r)}else if(c[e])return c[e](n,i,r);n.preventDefault()}}}};Tt.prototype.open=function(t,e){!e&&this.isOpen(t)||(this.close(),this._updateAndOpen(t))};Tt.prototype._getProviders=function(){var t=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(t),t.providers};Tt.prototype._updateAndOpen=function(t){var e=this.getEntries(t),n=this._createHtml(t),r;I(e,function(i,s){var a=i.group||"default",c=Ht(i.html||'<div class="entry" draggable="true"></div>'),l;mn(c,"data-action",s),l=Ct("[data-group="+Wo(a)+"]",n),l||(l=Ht('<div class="group"></div>'),mn(l,"data-group",a),n.appendChild(l)),l.appendChild(c),i.className&&XI(c,i.className),i.title&&mn(c,"title",i.title),i.imageUrl&&(r=Ht("<img>"),mn(r,"src",i.imageUrl),r.style.width="100%",r.style.height="100%",c.appendChild(r))}),Dt(n).add("open"),this._current={entries:e,html:n,target:t},this._updatePosition(),this._updateVisibility(),this._eventBus.fire("contextPad.open",{current:this._current})};Tt.prototype._createHtml=function(t){var e=this,n=Ht('<div class="djs-context-pad"></div>');return ar.bind(n,hl,"click",function(r){e.trigger("click",r)}),ar.bind(n,hl,"dragstart",function(r){e.trigger("dragstart",r)}),ar.bind(n,hl,"mouseover",function(r){e.trigger("mouseover",r)}),ar.bind(n,hl,"mouseout",function(r){e.trigger("mouseout",r)}),je.bind(n,"mousedown",function(r){r.stopPropagation()}),this._container.appendChild(n),this._eventBus.fire("contextPad.create",{target:t,pad:n}),n};Tt.prototype.getPad=function(t){console.warn(new Error("ContextPad#getPad is deprecated and will be removed in future library versions, cf. https://github.com/bpmn-io/diagram-js/pull/888"));let e;return this.isOpen()&&QI(this._current.target,t)?e=this._current.html:e=this._createHtml(t),{html:e}};Tt.prototype.close=function(){this.isOpen()&&(clearTimeout(this._timeout),this._container.innerHTML="",this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)};Tt.prototype.isOpen=function(t){var e=this._current;if(!e)return!1;if(!t)return!0;var n=e.target;return Ue(t)!==Ue(n)?!1:Ue(t)?t.length===n.length&&_d(t,function(r){return n.includes(r)}):n===t};Tt.prototype.isShown=function(){return this.isOpen()&&Dt(this._current.html).has("open")};Tt.prototype.show=function(){this.isOpen()&&(Dt(this._current.html).add("open"),this._updatePosition(),this._eventBus.fire("contextPad.show",{current:this._current}))};Tt.prototype.hide=function(){this.isOpen()&&(Dt(this._current.html).remove("open"),this._eventBus.fire("contextPad.hide",{current:this._current}))};Tt.prototype._getPosition=function(t){if(!Ue(t)&&lt(t)){var e=this._canvas.viewbox(),n=JI(t),r=n.x*e.scale-e.x*e.scale,i=n.y*e.scale-e.y*e.scale;return{left:r+ty*this._canvas.zoom(),top:i}}var s=this._canvas.getContainer(),a=s.getBoundingClientRect(),c=this._getTargetBounds(t);return{left:c.right-a.left+ty*this._canvas.zoom(),top:c.top-a.top}};Tt.prototype._updatePosition=function(){const t=()=>{if(this.isOpen()){var e=this._current.html,n=this._getPosition(this._current.target);"x"in n&&"y"in n?(e.style.left=n.x+"px",e.style.top=n.y+"px"):["top","right","bottom","left"].forEach(function(r){r in n&&(e.style[r]=n[r]+"px")})}};this._scheduler.schedule(t,"ContextPad#_updatePosition")};Tt.prototype._updateVisibility=function(){const t=()=>{if(this.isOpen()){var e=this,n=this._current.target,r=Ue(n)?n:[n],i=r.some(function(s){return e._canvas.hasMarker(s,KI)});i?e.hide():e.show()}};this._scheduler.schedule(t,"ContextPad#_updateVisibility")};Tt.prototype._getTargetBounds=function(t){var e=this,n=Ue(t)?t:[t],r=n.map(function(i){return e._canvas.getGraphics(i)});return r.reduce(function(i,s){const a=s.getBoundingClientRect();return i.top=Math.min(i.top,a.top),i.right=Math.max(i.right,a.right),i.bottom=Math.max(i.bottom,a.bottom),i.left=Math.min(i.left,a.left),i.x=i.left,i.y=i.top,i.width=i.right-i.left,i.height=i.bottom-i.top,i},{top:1/0,right:-1/0,bottom:-1/0,left:1/0})};function XI(t,e){var n=Dt(t);e=Ue(e)?e:e.split(/\s+/g),e.forEach(function(r){n.add(r)})}function JI(t){return t.waypoints[t.waypoints.length-1]}function QI(t,e){return t=Ue(t)?t:[t],e=Ue(e)?e:[e],t.length===e.length&&_d(t,function(n){return e.includes(n)})}const P_={__depends__:[hf,qI,jw],contextPad:["type",Tt]};var Hd,xt,T_,fs,ny,R_,A_,I_,Vf,yp,xp,ec={},M_=[],eM=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Vd=Array.isArray;function Hr(t,e){for(var n in e)t[n]=e[n];return t}function Gf(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function D_(t,e,n){var r,i,s,a={};for(s in e)s=="key"?r=e[s]:s=="ref"?i=e[s]:a[s]=e[s];if(arguments.length>2&&(a.children=arguments.length>3?Hd.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(s in t.defaultProps)a[s]===void 0&&(a[s]=t.defaultProps[s]);return Dl(t,a,r,i,null)}function Dl(t,e,n,r,i){var s={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++T_,__i:-1,__u:0};return i==null&&xt.vnode!=null&&xt.vnode(s),s}function Gd(t){return t.children}function Ol(t,e){this.props=t,this.context=e}function ja(t,e){if(e==null)return t.__?ja(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?ja(t):null}function O_(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return O_(t)}}function ry(t){(!t.__d&&(t.__d=!0)&&fs.push(t)&&!Xl.__r++||ny!=xt.debounceRendering)&&((ny=xt.debounceRendering)||R_)(Xl)}function Xl(){for(var t,e,n,r,i,s,a,c=1;fs.length;)fs.length>c&&fs.sort(A_),t=fs.shift(),c=fs.length,t.__d&&(n=void 0,r=void 0,i=(r=(e=t).__v).__e,s=[],a=[],e.__P&&((n=Hr({},r)).__v=r.__v+1,xt.vnode&&xt.vnode(n),Wf(e.__P,n,r,e.__n,e.__P.namespaceURI,32&r.__u?[i]:null,s,i??ja(r),!!(32&r.__u),a),n.__v=r.__v,n.__.__k[n.__i]=n,B_(s,n,a),r.__e=r.__=null,n.__e!=i&&O_(n)));Xl.__r=0}function $_(t,e,n,r,i,s,a,c,l,d,u){var h,p,f,m,v,g,w,b=r&&r.__k||M_,x=e.length;for(l=tM(n,e,b,l,x),h=0;h<x;h++)(f=n.__k[h])!=null&&(p=f.__i==-1?ec:b[f.__i]||ec,f.__i=h,g=Wf(t,f,p,i,s,a,c,l,d,u),m=f.__e,f.ref&&p.ref!=f.ref&&(p.ref&&qf(p.ref,null,f),u.push(f.ref,f.__c||m,f)),v==null&&m!=null&&(v=m),(w=!!(4&f.__u))||p.__k===f.__k?l=L_(f,l,t,w):typeof f.type=="function"&&g!==void 0?l=g:m&&(l=m.nextSibling),f.__u&=-7);return n.__e=v,l}function tM(t,e,n,r,i){var s,a,c,l,d,u=n.length,h=u,p=0;for(t.__k=new Array(i),s=0;s<i;s++)(a=e[s])!=null&&typeof a!="boolean"&&typeof a!="function"?(l=s+p,(a=t.__k[s]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?Dl(null,a,null,null,null):Vd(a)?Dl(Gd,{children:a},null,null,null):a.constructor==null&&a.__b>0?Dl(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=t,a.__b=t.__b+1,c=null,(d=a.__i=nM(a,n,l,h))!=-1&&(h--,(c=n[d])&&(c.__u|=2)),c==null||c.__v==null?(d==-1&&(i>u?p--:i<u&&p++),typeof a.type!="function"&&(a.__u|=4)):d!=l&&(d==l-1?p--:d==l+1?p++:(d>l?p--:p++,a.__u|=4))):t.__k[s]=null;if(h)for(s=0;s<u;s++)(c=n[s])!=null&&!(2&c.__u)&&(c.__e==r&&(r=ja(c)),z_(c,c));return r}function L_(t,e,n,r){var i,s;if(typeof t.type=="function"){for(i=t.__k,s=0;i&&s<i.length;s++)i[s]&&(i[s].__=t,e=L_(i[s],e,n,r));return e}t.__e!=e&&(r&&(e&&t.type&&!e.parentNode&&(e=ja(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function nM(t,e,n,r){var i,s,a,c=t.key,l=t.type,d=e[n],u=d!=null&&(2&d.__u)==0;if(d===null&&t.key==null||u&&c==d.key&&l==d.type)return n;if(r>(u?1:0)){for(i=n-1,s=n+1;i>=0||s<e.length;)if((d=e[a=i>=0?i--:s++])!=null&&!(2&d.__u)&&c==d.key&&l==d.type)return a}return-1}function iy(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||eM.test(e)?n:n+"px"}function pl(t,e,n,r,i){var s,a;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||iy(t.style,e,"");if(n)for(e in n)r&&n[e]==r[e]||iy(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(I_,"$1")),a=e.toLowerCase(),e=a in t||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+s]=n,n?r?n.u=r.u:(n.u=Vf,t.addEventListener(e,s?xp:yp,s)):t.removeEventListener(e,s?xp:yp,s);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function sy(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=Vf++;else if(e.t<n.u)return;return n(xt.event?xt.event(e):e)}}}function Wf(t,e,n,r,i,s,a,c,l,d){var u,h,p,f,m,v,g,w,b,x,E,N,j,C,R,T,$,B=e.type;if(e.constructor!=null)return null;128&n.__u&&(l=!!(32&n.__u),s=[c=e.__e=n.__e]),(u=xt.__b)&&u(e);e:if(typeof B=="function")try{if(w=e.props,b="prototype"in B&&B.prototype.render,x=(u=B.contextType)&&r[u.__c],E=u?x?x.props.value:u.__:r,n.__c?g=(h=e.__c=n.__c).__=h.__E:(b?e.__c=h=new B(w,E):(e.__c=h=new Ol(w,E),h.constructor=B,h.render=iM),x&&x.sub(h),h.props=w,h.state||(h.state={}),h.context=E,h.__n=r,p=h.__d=!0,h.__h=[],h._sb=[]),b&&h.__s==null&&(h.__s=h.state),b&&B.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=Hr({},h.__s)),Hr(h.__s,B.getDerivedStateFromProps(w,h.__s))),f=h.props,m=h.state,h.__v=e,p)b&&B.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),b&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(b&&B.getDerivedStateFromProps==null&&w!==f&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(w,E),!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(w,h.__s,E)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(h.props=w,h.state=h.__s,h.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(D){D&&(D.__=e)}),N=0;N<h._sb.length;N++)h.__h.push(h._sb[N]);h._sb=[],h.__h.length&&a.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(w,h.__s,E),b&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(f,m,v)})}if(h.context=E,h.props=w,h.__P=t,h.__e=!1,j=xt.__r,C=0,b){for(h.state=h.__s,h.__d=!1,j&&j(e),u=h.render(h.props,h.state,h.context),R=0;R<h._sb.length;R++)h.__h.push(h._sb[R]);h._sb=[]}else do h.__d=!1,j&&j(e),u=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++C<25);h.state=h.__s,h.getChildContext!=null&&(r=Hr(Hr({},r),h.getChildContext())),b&&!p&&h.getSnapshotBeforeUpdate!=null&&(v=h.getSnapshotBeforeUpdate(f,m)),T=u,u!=null&&u.type===Gd&&u.key==null&&(T=F_(u.props.children)),c=$_(t,Vd(T)?T:[T],e,n,r,i,s,a,c,l,d),h.base=e.__e,e.__u&=-161,h.__h.length&&a.push(h),g&&(h.__E=h.__=null)}catch(D){if(e.__v=null,l||s!=null)if(D.then){for(e.__u|=l?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;s[s.indexOf(c)]=null,e.__e=c}else{for($=s.length;$--;)Gf(s[$]);bp(e)}else e.__e=n.__e,e.__k=n.__k,D.then||bp(e);xt.__e(D,e,n)}else s==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):c=e.__e=rM(n.__e,e,n,r,i,s,a,l,d);return(u=xt.diffed)&&u(e),128&e.__u?void 0:c}function bp(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(bp)}function B_(t,e,n){for(var r=0;r<n.length;r++)qf(n[r],n[++r],n[++r]);xt.__c&&xt.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(s){s.call(i)})}catch(s){xt.__e(s,i.__v)}})}function F_(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:Vd(t)?t.map(F_):Hr({},t)}function rM(t,e,n,r,i,s,a,c,l){var d,u,h,p,f,m,v,g=n.props,w=e.props,b=e.type;if(b=="svg"?i="http://www.w3.org/2000/svg":b=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),s!=null){for(d=0;d<s.length;d++)if((f=s[d])&&"setAttribute"in f==!!b&&(b?f.localName==b:f.nodeType==3)){t=f,s[d]=null;break}}if(t==null){if(b==null)return document.createTextNode(w);t=document.createElementNS(i,b,w.is&&w),c&&(xt.__m&&xt.__m(e,s),c=!1),s=null}if(b==null)g===w||c&&t.data==w||(t.data=w);else{if(s=s&&Hd.call(t.childNodes),g=n.props||ec,!c&&s!=null)for(g={},d=0;d<t.attributes.length;d++)g[(f=t.attributes[d]).name]=f.value;for(d in g)if(f=g[d],d!="children"){if(d=="dangerouslySetInnerHTML")h=f;else if(!(d in w)){if(d=="value"&&"defaultValue"in w||d=="checked"&&"defaultChecked"in w)continue;pl(t,d,null,f,i)}}for(d in w)f=w[d],d=="children"?p=f:d=="dangerouslySetInnerHTML"?u=f:d=="value"?m=f:d=="checked"?v=f:c&&typeof f!="function"||g[d]===f||pl(t,d,f,g[d],i);if(u)c||h&&(u.__html==h.__html||u.__html==t.innerHTML)||(t.innerHTML=u.__html),e.__k=[];else if(h&&(t.innerHTML=""),$_(e.type=="template"?t.content:t,Vd(p)?p:[p],e,n,r,b=="foreignObject"?"http://www.w3.org/1999/xhtml":i,s,a,s?s[0]:n.__k&&ja(n,0),c,l),s!=null)for(d=s.length;d--;)Gf(s[d]);c||(d="value",b=="progress"&&m==null?t.removeAttribute("value"):m!=null&&(m!==t[d]||b=="progress"&&!m||b=="option"&&m!=g[d])&&pl(t,d,m,g[d],i),d="checked",v!=null&&v!=t[d]&&pl(t,d,v,g[d],i))}return t}function qf(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(i){xt.__e(i,n)}}function z_(t,e,n){var r,i;if(xt.unmount&&xt.unmount(t),(r=t.ref)&&(r.current&&r.current!=t.__e||qf(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(s){xt.__e(s,e)}r.base=r.__P=null}if(r=t.__k)for(i=0;i<r.length;i++)r[i]&&z_(r[i],e,n||typeof t.type!="function");n||Gf(t.__e),t.__c=t.__=t.__e=void 0}function iM(t,e,n){return this.constructor(t,n)}function U_(t,e,n){var r,i,s,a;e==document&&(e=document.documentElement),xt.__&&xt.__(t,e),i=(r=typeof n=="function")?null:e.__k,s=[],a=[],Wf(e,t=(!r&&n||e).__k=D_(Gd,null,[t]),i||ec,ec,e.namespaceURI,!r&&n?[n]:i?null:e.firstChild?Hd.call(e.childNodes):null,s,!r&&n?n:i?i.__e:e.firstChild,r,a),B_(s,t,a)}Hd=M_.slice,xt={__e:function(t,e,n,r){for(var i,s,a;e=e.__;)if((i=e.__c)&&!i.__)try{if((s=i.constructor)&&s.getDerivedStateFromError!=null&&(i.setState(s.getDerivedStateFromError(t)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,r||{}),a=i.__d),a)return i.__E=i}catch(c){t=c}throw t}},T_=0,Ol.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Hr({},this.state),typeof t=="function"&&(t=t(Hr({},n),this.props)),t&&Hr(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),ry(this))},Ol.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),ry(this))},Ol.prototype.render=Gd,fs=[],R_=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,A_=function(t,e){return t.__v.__b-e.__v.__b},Xl.__r=0,I_=/(PointerCapture)$|Capture$/i,Vf=0,yp=sy(!1),xp=sy(!0);var H_=function(t,e,n,r){var i;e[0]=0;for(var s=1;s<e.length;s++){var a=e[s++],c=e[s]?(e[0]|=a?1:2,n[e[s++]]):e[++s];a===3?r[0]=c:a===4?r[1]=Object.assign(r[1]||{},c):a===5?(r[1]=r[1]||{})[e[++s]]=c:a===6?r[1][e[++s]]+=c+"":a?(i=t.apply(c,H_(t,c,n,["",null])),r.push(i),c[0]?e[0]|=2:(e[s-2]=0,e[s]=i)):r.push(c)}return r},ay=new Map;function sM(t){var e=ay.get(this);return e||(e=new Map,ay.set(this,e)),(e=H_(this,e.get(t)||(e.set(t,e=function(n){for(var r,i,s=1,a="",c="",l=[0],d=function(p){s===1&&(p||(a=a.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?l.push(0,p,a):s===3&&(p||a)?(l.push(3,p,a),s=2):s===2&&a==="..."&&p?l.push(4,p,0):s===2&&a&&!p?l.push(5,0,!0,a):s>=5&&((a||!p&&s===5)&&(l.push(s,0,a,i),s=6),p&&(l.push(s,p,0,i),s=6)),a=""},u=0;u<n.length;u++){u&&(s===1&&d(),d(u));for(var h=0;h<n[u].length;h++)r=n[u][h],s===1?r==="<"?(d(),l=[l],s=3):a+=r:s===4?a==="--"&&r===">"?(s=1,a=""):a=r+a[0]:c?r===c?c="":a+=r:r==='"'||r==="'"?c=r:r===">"?(d(),s=1):s&&(r==="="?(s=5,i=a,a=""):r==="/"&&(s<5||n[u][h+1]===">")?(d(),s===3&&(l=l[0]),s=l,(l=l[0]).push(2,0,s),s=0):r===" "||r==="	"||r===`
`||r==="\r"?(d(),s=2):a+=r),s===3&&a==="!--"&&(s=4,l=l[0])}return d(),l}(t)),e),arguments,[])).length>1?e:e[0]}var Et=sM.bind(D_),Na,Nt,Sh,oy,tc=0,V_=[],Rt=xt,cy=Rt.__b,ly=Rt.__r,dy=Rt.diffed,uy=Rt.__c,hy=Rt.unmount,py=Rt.__;function Wd(t,e){Rt.__h&&Rt.__h(Nt,t,tc||e),tc=0;var n=Nt.__H||(Nt.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function jh(t){return tc=1,aM(W_,t)}function aM(t,e,n){var r=Wd(Na++,2);if(r.t=t,!r.__c&&(r.__=[W_(void 0,e),function(c){var l=r.__N?r.__N[0]:r.__[0],d=r.t(l,c);l!==d&&(r.__N=[d,r.__[1]],r.__c.setState({}))}],r.__c=Nt,!Nt.__f)){var i=function(c,l,d){if(!r.__c.__H)return!0;var u=r.__c.__H.__.filter(function(p){return!!p.__c});if(u.every(function(p){return!p.__N}))return!s||s.call(this,c,l,d);var h=r.__c.props!==c;return u.forEach(function(p){if(p.__N){var f=p.__[0];p.__=p.__N,p.__N=void 0,f!==p.__[0]&&(h=!0)}}),s&&s.call(this,c,l,d)||h};Nt.__f=!0;var s=Nt.shouldComponentUpdate,a=Nt.componentWillUpdate;Nt.componentWillUpdate=function(c,l,d){if(this.__e){var u=s;s=void 0,i(c,l,d),s=u}a&&a.call(this,c,l,d)},Nt.shouldComponentUpdate=i}return r.__N||r.__}function wp(t,e){var n=Wd(Na++,3);!Rt.__s&&Kf(n.__H,e)&&(n.__=t,n.u=e,Nt.__H.__h.push(n))}function _p(t,e){var n=Wd(Na++,4);!Rt.__s&&Kf(n.__H,e)&&(n.__=t,n.u=e,Nt.__h.push(n))}function G_(t){return tc=5,ca(function(){return{current:t}},[])}function ca(t,e){var n=Wd(Na++,7);return Kf(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function vo(t,e){return tc=8,ca(function(){return t},e)}function oM(){for(var t;t=V_.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach($l),t.__H.__h.forEach(Ep),t.__H.__h=[]}catch(e){t.__H.__h=[],Rt.__e(e,t.__v)}}Rt.__b=function(t){Nt=null,cy&&cy(t)},Rt.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),py&&py(t,e)},Rt.__r=function(t){ly&&ly(t),Na=0;var e=(Nt=t.__c).__H;e&&(Sh===Nt?(e.__h=[],Nt.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach($l),e.__h.forEach(Ep),e.__h=[],Na=0)),Sh=Nt},Rt.diffed=function(t){dy&&dy(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(V_.push(e)!==1&&oy===Rt.requestAnimationFrame||((oy=Rt.requestAnimationFrame)||cM)(oM)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Sh=Nt=null},Rt.__c=function(t,e){e.some(function(n){try{n.__h.forEach($l),n.__h=n.__h.filter(function(r){return!r.__||Ep(r)})}catch(r){e.some(function(i){i.__h&&(i.__h=[])}),e=[],Rt.__e(r,n.__v)}}),uy&&uy(t,e)},Rt.unmount=function(t){hy&&hy(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{$l(r)}catch(i){e=i}}),n.__H=void 0,e&&Rt.__e(e,n.__v))};var fy=typeof requestAnimationFrame=="function";function cM(t){var e,n=function(){clearTimeout(r),fy&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,35);fy&&(e=requestAnimationFrame(n))}function $l(t){var e=Nt,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),Nt=e}function Ep(t){var e=Nt;t.__c=t.__(),Nt=e}function Kf(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function W_(t,e){return typeof e=="function"?e(t):e}function lM(t){const{headerEntries:e,onSelect:n,selectedEntry:r,setSelectedEntry:i,title:s}=t,a=ca(()=>dM(e),[e]),c=d=>d.action&&!d.disabled,l=(d,u)=>{if(c(u))return n(d,u)};return Et`
    <div class="djs-popup-header">
      <h3 class="djs-popup-title" title=${s}>${s}</h3>
      ${a.map(d=>Et`
        <ul key=${d.id} class="djs-popup-header-group" data-header-group=${d.id}>

          ${d.entries.map(u=>Et`
            <li key=${u.id}>
              <${c(u)?"button":"span"}
                class=${uM(u,u===r)}
                onClick=${h=>l(h,u)}
                title=${u.title||u.label}
                data-id=${u.id}
                aria-disabled=${u.disabled||void 0}
                onMouseEnter=${()=>c(u)&&i(u)}
                onMouseLeave=${()=>c(u)&&i(null)}
                onFocus=${()=>c(u)&&i(u)}
                onBlur=${()=>c(u)&&i(null)}
              >
                ${u.imageUrl&&Et`<img class="djs-popup-entry-icon" src=${u.imageUrl} alt="" />`||u.imageHtml&&Et`<div class="djs-popup-entry-icon" dangerouslySetInnerHTML=${{__html:u.imageHtml}} />`}
                ${u.label?Et`
                  <span class="djs-popup-label">${u.label}</span>
                `:null}
              </${u.action?"button":"span"}>
            </li>
          `)}
        </ul>
      `)}
    </div>
  `}function dM(t){return t.reduce((e,n)=>{const r=n.group||"default",i=e.find(s=>s.id===r);return i?i.entries.push(n):e.push({id:r,entries:[n]}),e},[])}function uM(t,e){return ba("entry",t.className,t.active?"active":"",t.disabled?"disabled":"",e?"selected":"")}function hM(t){const{entry:e,selected:n,onMouseEnter:r,onMouseLeave:i,onAction:s}=t,a=(c,l)=>{if(!e.disabled)return s(c,e,l)};return Et`
    <li
      class=${ba("entry",{selected:n,disabled:e.disabled})}
      data-id=${e.id}
      title=${e.title||e.label}
      aria-disabled=${e.disabled||void 0}
      tabIndex="0"
      onClick=${a}
      onFocus=${r}
      onBlur=${i}
      onMouseEnter=${r}
      onMouseLeave=${i}
      onDragStart=${c=>a(c,"dragstart")}
      draggable=${!0}
    >
      <div class="djs-popup-entry-content">
        <span
          class=${ba("djs-popup-entry-name",e.className)}
        >
          ${e.imageUrl&&Et`<img class="djs-popup-entry-icon" src=${e.imageUrl} alt="" />`||e.imageHtml&&Et`<div class="djs-popup-entry-icon" dangerouslySetInnerHTML=${{__html:e.imageHtml}} />`}

          ${e.label?Et`
            <span class="djs-popup-label">
              ${e.label}
            </span>
          `:null}
        </span>
        ${e.description&&Et`
          <span
            class="djs-popup-entry-description"
            title=${e.description}
          >
            ${e.description}
          </span>
        `}
      </div>
      ${e.documentationRef&&Et`
        <div class="djs-popup-entry-docs">
          <a
            href="${e.documentationRef}"
            onClick=${c=>c.stopPropagation()}
            title="Open element documentation"
            target="_blank"
            rel="noopener"
          >
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M10.6368 10.6375V5.91761H11.9995V10.6382C11.9995 10.9973 11.8623 11.3141 11.5878 11.5885C11.3134 11.863 10.9966 12.0002 10.6375 12.0002H1.36266C0.982345 12.0002 0.660159 11.8681 0.396102 11.6041C0.132044 11.34 1.52588e-05 11.0178 1.52588e-05 10.6375V1.36267C1.52588e-05 0.98236 0.132044 0.660173 0.396102 0.396116C0.660159 0.132058 0.982345 2.95639e-05 1.36266 2.95639e-05H5.91624V1.36267H1.36266V10.6375H10.6368ZM12 0H7.2794L7.27873 1.36197H9.68701L3.06507 7.98391L4.01541 8.93425L10.6373 2.31231V4.72059H12V0Z" fill="#818798"/>
            </svg>
          </a>
        </div>
      `}
    </li>
  `}function pM(t){const{selectedEntry:e,setSelectedEntry:n,groupedEntries:r,...i}=t,s=G_();return _p(()=>{const a=s.current;if(!a)return;const c=a.querySelector(".selected");c&&fM(c)},[e]),Et`
    <div class="djs-popup-results" ref=${s}>
      ${r.map(a=>Et`
        ${a.name&&Et`
          <div key=${a.id} class="entry-header" title=${a.name}>
            ${a.name}
          </div>
        `}
        <ul class="djs-popup-group" data-group=${a.id}>
          ${a.entries.map(c=>Et`
            <${hM}
              key=${c.id}
              entry=${c}
              selected=${c===e}
              onMouseEnter=${()=>n(c)}
              onMouseLeave=${()=>n(null)}
              ...${i}
            />
          `)}
        </ul>
      `)}
    </div>
  `}function fM(t){typeof t.scrollIntoViewIfNeeded=="function"?t.scrollIntoViewIfNeeded():t.scrollIntoView({scrollMode:"if-needed",block:"nearest"})}function mM(t){const{onClose:e,onSelect:n,className:r,headerEntries:i,position:s,title:a,width:c,scale:l,search:d,emptyPlaceholder:u,searchFn:h,entries:p,onOpened:f,onClosed:m}=t,v=ca(()=>Pn(d)?p.length>5:!1,[d,p]),[g,w]=jh(""),b=vo((q,F)=>{if(!v)return q;if(!F.trim())return q.filter(({rank:de=0})=>de>=0);const xe=q.filter(({searchable:de})=>de!==!1);return h(xe,F,{keys:["label","search","description"]}).map(({item:de})=>de)},[v]),[x,E]=jh(b(p,g)),[N,j]=jh(x[0]),C=ca(()=>yM(x),[x]),R=vo(q=>{j(q[0]),E(q)},[E,j]);wp(()=>{R(b(p,g))},[g,p]);const T=vo(q=>{const F=vM(C);let de=F.indexOf(N)+q;de<0&&(de=F.length-1),de>=F.length&&(de=0),j(F[de])},[C,N,j]),$=vo(q=>{if(q.key==="Enter"&&N)return N.disabled?void 0:n(q,N);if(q.key==="ArrowUp")return T(-1),q.preventDefault();if(q.key==="ArrowDown")return T(1),q.preventDefault()},[n,N,T]),B=vo(q=>{Nw(q.target,"input")&&w(()=>q.target.value)},[w]);wp(()=>(f(),()=>{m()}),[]);const D=ca(()=>a||i.length>0,[a,i]);return Et`
    <${my}
      onClose=${e}
      onKeyup=${B}
      onKeydown=${$}
      className=${r}
      position=${s}
      width=${c}
      scale=${l}
    >
      ${D&&Et`
        <${lM}
          headerEntries=${i}
          onSelect=${n}
          selectedEntry=${N}
          setSelectedEntry=${j}
          title=${a}
        />
      `}
      ${p.length>0&&Et`
        <div class="djs-popup-body">

          ${v&&Et`
          <div class="djs-popup-search">
            <svg class="djs-popup-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M9.0325 8.5H9.625L13.3675 12.25L12.25 13.3675L8.5 9.625V9.0325L8.2975 8.8225C7.4425 9.5575 6.3325 10 5.125 10C2.4325 10 0.25 7.8175 0.25 5.125C0.25 2.4325 2.4325 0.25 5.125 0.25C7.8175 0.25 10 2.4325 10 5.125C10 6.3325 9.5575 7.4425 8.8225 8.2975L9.0325 8.5ZM1.75 5.125C1.75 6.9925 3.2575 8.5 5.125 8.5C6.9925 8.5 8.5 6.9925 8.5 5.125C8.5 3.2575 6.9925 1.75 5.125 1.75C3.2575 1.75 1.75 3.2575 1.75 5.125Z" fill="#22242A"/>
            </svg>
            <input type="text" spellcheck=${!1} aria-label="${a}" />
          </div>
          `}

          <${pM}
            groupedEntries=${C}
            selectedEntry=${N}
            setSelectedEntry=${j}
            onAction=${n}
          />
        </div>
      `}
    ${u&&x.length===0&&Et`
      <div class="djs-popup-no-results">${Hn(u)?u(g):u}</div>
    `}
    </${my}>
  `}function my(t){const{onClose:e,onKeydown:n,onKeyup:r,className:i,children:s,position:a}=t,c=G_();return _p(()=>{if(typeof a!="function")return;const l=c.current,d=a(l);l.style.left=`${d.x}px`,l.style.top=`${d.y}px`},[c.current,a]),_p(()=>{const l=c.current;if(!l)return;(l.querySelector("input")||l).focus()},[]),wp(()=>{const l=u=>{if(u.key==="Escape")return u.preventDefault(),e()},d=u=>{if(!gc(u.target,".djs-popup",!0))return e()};return document.documentElement.addEventListener("keydown",l),document.body.addEventListener("click",d),()=>{document.documentElement.removeEventListener("keydown",l),document.body.removeEventListener("click",d)}},[]),Et`
    <div
      class=${ba("djs-popup",i)}
      style=${gM(t)}
      onKeydown=${n}
      onKeyup=${r}
      ref=${c}
      tabIndex="-1"
    >
      ${s}
    </div>
  `}function gM(t){return{transform:`scale(${t.scale})`,width:`${t.width}px`,"transform-origin":"top left"}}function vM(t){const e=[];return t.forEach(n=>{n.entries.forEach(r=>{e.push(r)})}),e}function yM(t){const e=[],n=s=>e.find(a=>s.id===a.id),r=s=>!!n(s),i=s=>typeof s=="string"?{id:s}:s;return t.forEach(s=>{const a=s.group?i(s.group):{id:"default"};r(a)?n(a).entries.push(s):e.push({...a,entries:[s]})}),e}var xM="data-id",q_=["contextPad.close","canvas.viewbox.changing","commandStack.changed"],bM=1e3;function bt(t,e,n,r){this._eventBus=e,this._canvas=n,this._search=r,this._current=null;var i=Pn(t&&t.scale)?t.scale:{min:1,max:1};this._config={scale:i},e.on("diagram.destroy",()=>{this.close()}),e.on("element.changed",s=>{const a=this.isOpen()&&this._current.target;s.element===a&&this.refresh()})}bt.$inject=["config.popupMenu","eventBus","canvas","search"];bt.prototype._render=function(){const{position:t,providerId:e,entries:n,headerEntries:r,emptyPlaceholder:i,options:s}=this._current,a=Object.entries(n).map(([p,f])=>({id:p,...f})),c=Object.entries(r).map(([p,f])=>({id:p,...f})),l=t&&(p=>this._ensureVisible(p,t)),d=this._updateScale(this._current.container);U_(Et`
      <${mM}
        onClose=${p=>this.close(p)}
        onSelect=${(p,f,m)=>this.trigger(p,f,m)}
        position=${l}
        className=${e}
        entries=${a}
        headerEntries=${c}
        emptyPlaceholder=${i}
        scale=${d}
        onOpened=${this._onOpened.bind(this)}
        onClosed=${this._onClosed.bind(this)}
        searchFn=${this._search}
        ...${{...s}}
      />
    `,this._current.container)};bt.prototype.open=function(t,e,n,r){if(!t)throw new Error("target is missing");if(!e)throw new Error("providers for <"+e+"> not found");if(!n)throw new Error("position is missing");this.isOpen()&&this.close();const{entries:i,headerEntries:s,emptyPlaceholder:a}=this._getContext(t,e);this._current={position:n,providerId:e,target:t,entries:i,headerEntries:s,emptyPlaceholder:a,container:this._createContainer({provider:e}),options:r},this._emit("open"),this._bindAutoClose(),this._render()};bt.prototype.refresh=function(){if(!this.isOpen())return;const{target:t,providerId:e}=this._current,{entries:n,headerEntries:r,emptyPlaceholder:i}=this._getContext(t,e);this._current={...this._current,entries:n,headerEntries:r,emptyPlaceholder:i},this._emit("refresh"),this._render()};bt.prototype._getContext=function(t,e){const n=this._getProviders(e);if(!n||!n.length)throw new Error("provider for <"+e+"> not found");const r=this._getEntries(t,n),i=this._getHeaderEntries(t,n),s=this._getEmptyPlaceholder(n);return{entries:r,headerEntries:i,emptyPlaceholder:s,empty:!(Object.keys(r).length||Object.keys(i).length)}};bt.prototype.close=function(){this.isOpen()&&(this._emit("close"),this.reset(),this._canvas.restoreFocus(),this._current=null)};bt.prototype.reset=function(){const t=this._current.container;U_(null,t),ya(t)};bt.prototype._emit=function(t,e){this._eventBus.fire(`popupMenu.${t}`,e)};bt.prototype._onOpened=function(){this._emit("opened")};bt.prototype._onClosed=function(){this._emit("closed")};bt.prototype._createContainer=function(t){var e=this._canvas,n=e.getContainer();const r=Ht(`<div class="djs-popup-parent djs-scrollable" data-popup=${t.provider}></div>`);return n.appendChild(r),r};bt.prototype._bindAutoClose=function(){this._eventBus.once(q_,this.close,this)};bt.prototype._unbindAutoClose=function(){this._eventBus.off(q_,this.close,this)};bt.prototype._updateScale=function(){var t=this._canvas.zoom(),e=this._config.scale,n,r,i=t;return e!==!0&&(e===!1?(n=1,r=1):(n=e.min,r=e.max),Pn(n)&&t<n&&(i=n),Pn(r)&&t>r&&(i=r)),i};bt.prototype._ensureVisible=function(t,e){var n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect(),i={},s=e.x,a=e.y;return e.x+r.width>n.width&&(i.x=!0),e.y+r.height>n.height&&(i.y=!0),i.x&&i.y?(s=e.x-r.width,a=e.y-r.height):i.x?(s=e.x-r.width,a=e.y):i.y&&e.y<r.height?(s=e.x,a=10):i.y&&(s=e.x,a=e.y-r.height),e.y<n.top&&(a=e.y+r.height),{x:s,y:a}};bt.prototype.isEmpty=function(t,e){if(!t)throw new Error("target is missing");if(!e)throw new Error("provider ID is missing");const n=this._getProviders(e);return!n||!n.length?!0:this._getContext(t,e).empty};bt.prototype.registerProvider=function(t,e,n){n||(n=e,e=bM),this._eventBus.on("popupMenu.getProviders."+t,e,function(r){r.providers.push(n)})};bt.prototype._getProviders=function(t){var e=this._eventBus.createEvent({type:"popupMenu.getProviders."+t,providers:[]});return this._eventBus.fire(e),e.providers};bt.prototype._getEntries=function(t,e){var n={};return I(e,function(r){if(!r.getPopupMenuEntries){I(r.getEntries(t),function(s){var a=s.id;if(!a)throw new Error("entry ID is missing");n[a]=Xr(s,["id"])});return}var i=r.getPopupMenuEntries(t);Hn(i)?n=i(n):I(i,function(s,a){n[a]=s})}),n};bt.prototype._getHeaderEntries=function(t,e){var n={};return I(e,function(r){if(!r.getPopupMenuHeaderEntries){if(!r.getHeaderEntries)return;I(r.getHeaderEntries(t),function(s){var a=s.id;if(!a)throw new Error("entry ID is missing");n[a]=Xr(s,["id"])});return}var i=r.getPopupMenuHeaderEntries(t);Hn(i)?n=i(n):I(i,function(s,a){n[a]=s})}),n};bt.prototype._getEmptyPlaceholder=function(t){const e=t.find(n=>Hn(n.getEmptyPlaceholder));return e&&e.getEmptyPlaceholder()};bt.prototype.isOpen=function(){return!!this._current};bt.prototype.trigger=function(t,e,n="click"){if(t.preventDefault(),!e){let i=gc(t.delegateTarget||t.target,".entry",!0),s=mn(i,xM);e={id:s,...this._getEntry(s)}}const r=e.action;if(this._emit("trigger",{entry:e,event:t})!==!1){if(Hn(r)){if(n==="click")return r(t,e)}else if(r[n])return r[n](t,e)}};bt.prototype._getEntry=function(t){var e=this._current.entries[t]||this._current.headerEntries[t];if(!e)throw new Error("entry not found");return e};function wM(t,e,n){const{keys:r}=n;if(e=e.trim().toLowerCase(),!e)throw new Error("<pattern> must not be empty");const i=e.trim().toLowerCase().split(/\s+/);return t.flatMap(s=>{const a=_M(s,i,r);return a?{item:s,tokens:a}:[]}).sort(EM(r))}function _M(t,e,n){const{matchedWords:r,tokens:i}=n.reduce((s,a)=>{const c=t[a],{tokens:l,matchedWords:d}=Ue(c)?c.reduce((u,h)=>{const{tokens:p,matchedWords:f}=yy(h,e);return{tokens:[...u.tokens,p],matchedWords:{...u.matchedWords,...f}}},{matchedWords:{},tokens:[]}):yy(c,e);return{tokens:{...s.tokens,[a]:l},matchedWords:{...s.matchedWords,...d}}},{matchedWords:{},tokens:{}});return Object.keys(r).length!==e.length?null:i}function EM(t){return(e,n)=>{let r=0,i=1;for(const s of t){const a=SM(e.tokens[s],n.tokens[s]);if(a!==0){r+=a*i,i*=.9;continue}const c=jM(e.item[s],n.item[s]);if(c!==0){r+=c*i,i*=.9;continue}}return r}}function SM(t,e){return gy(e)-gy(t)}function gy(t){return t.reduce((e,n)=>e+K_(n),0)}function K_(t){if(Ue(t))return Math.max(...t.map(K_));const e=Math.log(t.value.length);return t.match?(t.start?t.end?131.9:7.87:t.wordStart?2.19:1)*e:-.07*e}function vy(t=""){return Ue(t)?t.join(", "):t}function jM(t,e){return vy(t).localeCompare(vy(e))}function yy(t,e){if(!t)return{tokens:[],matchedWords:{}};const n=[],r={},i=e.map(NM),s=[`(?<all>${i.join("\\s+")})`,...i].join("|"),a=new RegExp(s,"ig");let c,l=0;for(;c=a.exec(t);){const[d]=c,u=c.index,h=c.index+d.length,p=u===0,f=h===t.length,m=!!c.groups.all,v=p||/\s/.test(t.charAt(u-1)),g=f||/\s/.test(t.charAt(h));c.index>l&&n.push({value:t.slice(l,c.index),index:l}),n.push({value:d,index:c.index,match:!0,wordStart:v,wordEnd:g,start:p,end:f,all:m});const w=m?e:[d];for(const b of w)r[b.toLowerCase()]=!0;l=c.index+d.length}return l<t.length&&n.push({value:t.slice(l),index:l}),{tokens:n,matchedWords:r}}function NM(t){return t.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}const Y_={search:["value",wM]},Yf={__depends__:[Y_],__init__:["popupMenu"],popupMenu:["type",bt]};var Z_={align:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 2000">
              <line x1="200" y1="150" x2="200" y2="1850" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
              <rect x="500" y="150" width="1300" height="700" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
              <rect x="500" y="1150" width="700" height="700" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,bottom:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="1650" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="350" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="850" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,center:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="900" y1="150" x2="900" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="250" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="500" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,left:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="100" y1="150" x2="100" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="100" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="100" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,right:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="1650" y1="150" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="350" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="850" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,top:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="150" x2="1650" y2="150" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="150" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="150" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,middle:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="900" x2="1650" y2="900" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="250" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="500" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`},kM=900;function qa(t,e,n,r){t.registerProvider(kM,this),this._contextPad=t,this._popupMenu=e,this._translate=n,this._canvas=r}qa.$inject=["contextPad","popupMenu","translate","canvas"];qa.prototype.getMultiElementContextPadEntries=function(t){var e={};return this._isAllowed(t)&&L(e,this._getEntries(t)),e};qa.prototype._isAllowed=function(t){return!this._popupMenu.isEmpty(t,"align-elements")};qa.prototype._getEntries=function(){var t=this;return{"align-elements":{group:"align-elements",title:t._translate("Align elements"),html:`<div class="entry">${Z_.align}</div>`,action:{click:function(e,n){var r=t._getMenuPosition(n);L(r,{cursor:{x:e.x,y:e.y}}),t._popupMenu.open(n,"align-elements",r)}}}}};qa.prototype._getMenuPosition=function(t){var e=5,n=this._contextPad.getPad(t).html,r=n.getBoundingClientRect(),i={x:r.left,y:r.bottom+e};return i};var CM=["left","center","right","top","middle","bottom"];function jc(t,e,n,r){this._alignElements=e,this._translate=n,this._popupMenu=t,this._rules=r,t.registerProvider("align-elements",this)}jc.$inject=["popupMenu","alignElements","translate","rules"];jc.prototype.getPopupMenuEntries=function(t){var e={};return this._isAllowed(t)&&L(e,this._getEntries(t)),e};jc.prototype._isAllowed=function(t){return this._rules.allowed("elements.align",{elements:t})};jc.prototype._getEntries=function(t){var e=this._alignElements,n=this._translate,r=this._popupMenu,i={};return I(CM,function(s){i["align-elements-"+s]={group:"align",title:n("Align elements "+s),className:"bjs-align-elements-menu-entry",imageHtml:Z_[s],action:function(){e.trigger(t,s),r.close()}}}),i};function Gn(t){Z.call(this,t),this.init()}Gn.$inject=["eventBus"];fe(Gn,Z);Gn.prototype.addRule=function(t,e,n){var r=this;typeof t=="string"&&(t=[t]),t.forEach(function(i){r.canExecute(i,e,function(s,a,c){return n(s)},!0)})};Gn.prototype.init=function(){};function qd(t){Gn.call(this,t)}qd.$inject=["eventBus"];fe(qd,Gn);qd.prototype.init=function(){this.addRule("elements.align",function(t){var e=t.elements,n=Ve(e,function(r){return!(r.waypoints||r.host||r.labelTarget)});return n=Ed(n),n.length<2?!1:n})};const PM={__depends__:[VI,P_,Yf],__init__:["alignElementsContextPadProvider","alignElementsMenuProvider","bpmnAlignElements"],alignElementsContextPadProvider:["type",qa],alignElementsMenuProvider:["type",jc],bpmnAlignElements:["type",qd]};var TM=10,X_=50,RM=250;function Zf(t,e,n,r){for(var i;i=AM(t,n,e);)n=r(e,n,i);return n}function Xf(t){return function(e,n,r){var i={x:n.x,y:n.y};return["x","y"].forEach(function(s){var a=t[s];if(a){var c=s==="x"?"width":"height",l=a.margin,d=a.minDistance;l<0?i[s]=Math.min(r[s]+l-e[c]/2,n[s]-d+l):i[s]=Math.max(r[s]+r[c]+l+e[c]/2,n[s]+d+l)}}),i}}function AM(t,e,n){var r={x:e.x-n.width/2,y:e.y-n.height/2,width:n.width,height:n.height},i=MM(t);return mt(i,function(s){if(s===n)return!1;var a=Yt(s,r,TM);return a==="intersect"})}function IM(t,e){e||(e={});function n(m){return m.source===t?1:-1}var r=e.defaultDistance||X_,i=e.direction||"e",s=e.filter,a=e.getWeight||n,c=e.maxDistance||RM,l=e.reference||"start";s||(s=$M);function d(m,v){return i==="n"?l==="start"?ye(m).top-ye(v).bottom:l==="center"?ye(m).top-we(v).y:ye(m).top-ye(v).top:i==="w"?l==="start"?ye(m).left-ye(v).right:l==="center"?ye(m).left-we(v).x:ye(m).left-ye(v).left:i==="s"?l==="start"?ye(v).top-ye(m).bottom:l==="center"?we(v).y-ye(m).bottom:ye(v).bottom-ye(m).bottom:l==="start"?ye(v).left-ye(m).right:l==="center"?we(v).x-ye(m).right:ye(v).right-ye(m).right}var u=t.incoming.filter(s).map(function(m){var v=a(m),g=v<0?d(m.source,t):d(t,m.source);return{id:m.source.id,distance:g,weight:v}}),h=t.outgoing.filter(s).map(function(m){var v=a(m),g=v>0?d(t,m.target):d(m.target,t);return{id:m.target.id,distance:g,weight:v}}),p=u.concat(h).reduce(function(m,v){return m[v.id+"__weight_"+v.weight]=v,m},{}),f=$i(p,function(m,v){var g=v.distance,w=v.weight;return g<0||g>c||(m[String(g)]||(m[String(g)]=0),m[String(g)]+=1*w,(!m.distance||m[m.distance]<m[String(g)])&&(m.distance=g)),m},{});return f.distance||r}function MM(t){var e=Nh(t);return t.host&&(e=e.concat(Nh(t.host))),t.attachers&&(e=e.concat(t.attachers.reduce(function(n,r){return n.concat(Nh(r))},[]))),e}function Nh(t){return OM(t).concat(DM(t))}function DM(t){return t.incoming.map(function(e){return e.source})}function OM(t){return t.outgoing.map(function(e){return e.target})}function $M(){return!0}var LM=100;function J_(t,e,n){t.on("autoPlace",LM,function(r){var i=r.shape,s=r.source;return BM(s,i)}),t.on("autoPlace.end",function(r){n.scrollToElement(r.shape)}),this.append=function(r,i,s){t.fire("autoPlace.start",{source:r,shape:i});var a=t.fire("autoPlace",{source:r,shape:i}),c=e.appendShape(r,i,a,r.parent,s);return t.fire("autoPlace.end",{source:r,shape:c}),c}}J_.$inject=["eventBus","modeling","canvas"];function BM(t,e,n){n||(n={});var r=n.defaultDistance||X_,i=we(t),s=ye(t);return{x:s.right+r+e.width/2,y:i.y}}function Q_(t,e){t.on("autoPlace.end",500,function(n){e.select(n.shape)})}Q_.$inject=["eventBus","selection"];const FM={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",J_],autoPlaceSelectionBehavior:["type",Q_]};function ka(t,e){for(Sd(e)&&(e=[e]);t=t.parent;)if(Me(t,e))return t;return null}function e1(t,e){var n=ka(t,"bpmn:Process");if(n)return!0;var r=["bpmn:Participant","bpmn:Lane"];if(n=ka(t,r),n)return Vt(n);if(Me(t,r))return Vt(t);var i;for(i=ce(t);i&&!_(i,"bpmn:Process");i=i.$parent);if(!e)return!0;var s=e.find(function(a){var c=ce(a);return c&&c.get("processRef")===i});return s?Vt(s):!0}function t1(t,e,n){var r=e1(t,n);if(_(e,"bpmn:TextAnnotation"))return UM(t,e,r);if(Me(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"]))return HM(t,e,r);if(_(e,"bpmn:FlowNode"))return zM(t,e,r)}function zM(t,e,n){var r=ye(t),i=we(t),s=n?{directionHint:"e",minDistance:80,baseOrientation:"left",boundaryOrientation:"top",start:"top",end:"bottom"}:{directionHint:"s",minDistance:90,baseOrientation:"top",boundaryOrientation:"left",start:"left",end:"right"},a=IM(t,{filter:function(f){return _(f,"bpmn:SequenceFlow")},direction:s.directionHint}),c=30,l=s.minDistance,d=s.baseOrientation;_(t,"bpmn:BoundaryEvent")&&(d=Yt(t,t.host,-25),d.indexOf(s.boundaryOrientation)!==-1&&(c*=-1));var u=n?{x:r.right+a+e.width/2,y:i.y+xy(d,l,s)}:{x:i.x+xy(d,l,s),y:r.bottom+a+e.height/2},h={margin:c,minDistance:l},p=n?{y:h}:{x:h};return Zf(t,e,u,Xf(p))}function xy(t,e,n){return t.includes(n.start)?-1*e:t.includes(n.end)?e:0}function UM(t,e,n){var r=ye(t),i=n?{x:r.right+e.width/2,y:r.top-50-e.height/2}:{x:r.right+50+e.width/2,y:r.bottom+e.height/2};lt(t)&&(i=we(t),n?(i.x+=100,i.y-=50):(i.x+=100,i.y+=50));var s={margin:n?-30:30,minDistance:20},a=n?{y:s}:{x:s};return Zf(t,e,i,Xf(a))}function HM(t,e,n){var r=ye(t),i=n?{x:r.right-10+e.width/2,y:r.bottom+40+e.width/2}:{x:r.left-40-e.width/2,y:r.bottom-10+e.height/2},s={margin:30,minDistance:30},a=n?{x:s}:{y:s};return Zf(t,e,i,Xf(a))}function n1(t,e){t.on("autoPlace",function(n){var r=n.shape,i=n.source;return t1(i,r,e)})}n1.$inject=["eventBus","elementRegistry"];const Jf={__depends__:[FM],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",n1]};function Jr(t,e,n,r){Z.call(this,t),this._elementRegistry=e,this._modeling=n,this._rules=r;var i=this;this.postExecuted(["shape.create"],function(s){var a=s.context,c=a.hints||{},l=a.shape,d=a.parent||a.newParent;c.autoResize!==!1&&i._expand([l],d)}),this.postExecuted(["elements.move"],function(s){var a=s.context,c=pf(jd(a.closure.topLevel)),l=a.hints,d=l?l.autoResize:!0;if(d!==!1){var u=Nd(c,function(h){return h.parent.id});I(u,function(h,p){Ue(d)&&(h=h.filter(function(f){return mt(d,Vr({id:f.id}))})),i._expand(h,p)})}}),this.postExecuted(["shape.toggleCollapse"],function(s){var a=s.context,c=a.hints,l=a.shape;c&&c.autoResize===!1||l.collapsed||i._expand(l.children||[],l)}),this.postExecuted(["shape.resize"],function(s){var a=s.context,c=a.hints,l=a.shape,d=l.parent;c&&c.autoResize===!1||d&&i._expand([l],d)})}Jr.$inject=["eventBus","elementRegistry","modeling","rules"];fe(Jr,Z);Jr.prototype._getOptimalBounds=function(t,e){var n=this.getOffset(e),r=this.getPadding(e),i=ye(gn(t)),s=ye(e),a={};return i.top-s.top<r.top&&(a.top=i.top-n.top),i.left-s.left<r.left&&(a.left=i.left-n.left),s.right-i.right<r.right&&(a.right=i.right+n.right),s.bottom-i.bottom<r.bottom&&(a.bottom=i.bottom+n.bottom),ff(L({},s,a))};Jr.prototype._expand=function(t,e){typeof e=="string"&&(e=this._elementRegistry.get(e));var n=this._rules.allowed("element.autoResize",{elements:t,target:e});if(n){var r=this._getOptimalBounds(t,e);if(VM(r,e)){var i=GM(jr(e,["x","y","width","height"]),r);this.resize(e,r,{autoResize:i});var s=e.parent;s&&this._expand([e],s)}}};Jr.prototype.getOffset=function(t){return{top:60,bottom:60,left:100,right:100}};Jr.prototype.getPadding=function(t){return{top:2,bottom:2,left:15,right:15}};Jr.prototype.resize=function(t,e,n){this._modeling.resizeShape(t,e,null,n)};function VM(t,e){return t.x!==e.x||t.y!==e.y||t.width!==e.width||t.height!==e.height}function GM(t,e){var n="";return t=ye(t),e=ye(e),t.top>e.top&&(n=n.concat("n")),t.right<e.right&&(n=n.concat("w")),t.bottom<e.bottom&&(n=n.concat("s")),t.left>e.left&&(n=n.concat("e")),n}function Kd(t){t.invoke(Jr,this)}Kd.$inject=["injector"];fe(Kd,Jr);Kd.prototype.resize=function(t,e,n){_(t,"bpmn:Participant")?this._modeling.resizeLane(t,e,null,n):this._modeling.resizeShape(t,e,null,n)};function Nc(t){Gn.call(this,t);var e=this;this.addRule("element.autoResize",function(n){return e.canResize(n.elements,n.target)})}Nc.$inject=["eventBus"];fe(Nc,Gn);Nc.prototype.canResize=function(t,e){return!1};function Yd(t,e){Nc.call(this,t),this._modeling=e}fe(Yd,Nc);Yd.$inject=["eventBus","modeling"];Yd.prototype.canResize=function(t,e){if(_(e.di,"bpmndi:BPMNPlane")||!_(e,"bpmn:Participant")&&!_(e,"bpmn:Lane")&&!_(e,"bpmn:SubProcess"))return!1;var n=!0;return I(t,function(r){if(_(r,"bpmn:Lane")||We(r)){n=!1;return}}),n};const WM={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",Kd],bpmnAutoResizeProvider:["type",Yd]};var by=1500;function r1(t,e,n){var r=this,i=n.get("dragging",!1);function s(a){if(!a.hover){var c=a.originalEvent,l=r._findTargetGfx(c),d=l&&t.get(l);l&&d&&(a.stopPropagation(),i.hover({element:d,gfx:l}),i.move(c))}}i&&e.on("drag.start",function(a){e.once("drag.move",by,function(c){s(c)})}),function(){var a,c;e.on("element.hover",function(l){a=l.gfx,c=l.element}),e.on("element.hover",by,function(l){c&&e.fire("element.out",{element:c,gfx:a})}),e.on("element.out",function(){a=null,c=null})}(),this._findTargetGfx=function(a){var c,l;if(a instanceof MouseEvent)return c=Es(a),l=document.elementFromPoint(c.x,c.y),qM(l)}}r1.$inject=["elementRegistry","eventBus","injector"];function qM(t){return gc(t,"svg, .djs-element",!0)}const KM={__init__:["hoverFix"],hoverFix:["type",r1]};var Ws=Math.round,wy="djs-drag-active";function os(t){t.preventDefault()}function YM(t){return typeof TouchEvent<"u"&&t instanceof TouchEvent}function ZM(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}function i1(t,e,n,r){var i={threshold:5,trapClick:!0},s;function a(x){var E=e.viewbox(),N=e._container.getBoundingClientRect();return{x:E.x+(x.x-N.left)/E.scale,y:E.y+(x.y-N.top)/E.scale}}function c(x,E){E=E||s;var N=t.createEvent(L({},E.payload,E.data,{isTouch:E.isTouch}));return t.fire("drag."+x,N)===!1?!1:t.fire(E.prefix+"."+x,N)}function l(x){var E=x.filter(function(N){return r.get(N.id)});E.length&&n.select(E)}function d(x,E){var N=s.payload,j=s.displacement,C=s.globalStart,R=Es(x),T=cr(R,C),$=s.localStart,B=a(R),D=cr(B,$);if(!s.active&&(E||ZM(T)>s.threshold)){if(L(N,{x:Ws($.x+j.x),y:Ws($.y+j.y),dx:0,dy:0},{originalEvent:x}),c("start")===!1)return g();s.active=!0,s.keepSelection||(N.previousSelection=n.get(),n.select(null)),s.cursor&&Ud(s.cursor),e.addMarker(e.getRootElement(),wy)}nh(x),s.active&&(L(N,{x:Ws(B.x+j.x),y:Ws(B.y+j.y),dx:Ws(D.x),dy:Ws(D.y)},{originalEvent:x}),c("move"))}function u(x){var E,N=!0;s.active&&(x&&(s.payload.originalEvent=x,nh(x)),N=c("end")),N===!1&&c("rejected"),E=w(N!==!0),c("ended",E)}function h(x){Ft("Escape",x)&&(os(x),g())}function p(x){var E;s.active&&(E=E_(t),setTimeout(E,400),os(x)),u(x)}function f(x){d(x)}function m(x){var E=s.payload;E.hoverGfx=x.gfx,E.hover=x.element,c("hover")}function v(x){c("out");var E=s.payload;E.hoverGfx=null,E.hover=null}function g(x){var E;if(s){var N=s.active;N&&c("cancel"),E=w(x),N&&c("canceled",E)}}function w(x){var E,N;c("cleanup"),__(),s.trapClick?N=p:N=u,je.unbind(document,"mousemove",d),je.unbind(document,"dragstart",os),je.unbind(document,"selectstart",os),je.unbind(document,"mousedown",N,!0),je.unbind(document,"mouseup",N,!0),je.unbind(document,"keyup",h),je.unbind(document,"touchstart",f,!0),je.unbind(document,"touchcancel",g,!0),je.unbind(document,"touchmove",d,!0),je.unbind(document,"touchend",u,!0),t.off("element.hover",m),t.off("element.out",v),e.removeMarker(e.getRootElement(),wy);var j=s.payload.previousSelection;return x!==!1&&j&&!n.get().length&&l(j),E=s,s=null,E}function b(x,E,N,j){s&&g(!1),typeof E=="string"&&(j=N,N=E,E=null),j=L({},i,j||{});var C=j.data||{},R,T,$,B,D;j.trapClick?B=p:B=u,x?(R=kw(x)||x,T=Es(x),nh(x),R.type==="dragstart"&&os(R)):(R=null,T={x:0,y:0}),$=a(T),E||(E=$),D=YM(R),s=L({prefix:N,data:C,payload:{},globalStart:T,displacement:cr(E,$),localStart:$,isTouch:D},j),j.manual||(D?(je.bind(document,"touchstart",f,!0),je.bind(document,"touchcancel",g,!0),je.bind(document,"touchmove",d,!0),je.bind(document,"touchend",u,!0)):(je.bind(document,"mousemove",d),je.bind(document,"dragstart",os),je.bind(document,"selectstart",os),je.bind(document,"mousedown",B,!0),je.bind(document,"mouseup",B,!0)),je.bind(document,"keyup",h),t.on("element.hover",m),t.on("element.out",v)),c("init"),j.autoActivate&&d(x,!0)}t.on("diagram.destroy",g),this.init=b,this.move=d,this.hover=m,this.out=v,this.end=u,this.cancel=g,this.context=function(){return s},this.setOptions=function(x){L(i,x)}}i1.$inject=["eventBus","canvas","selection","elementRegistry"];const Qr={__depends__:[KM,Nr],dragging:["type",i1]};function Ka(t,e,n){this._canvas=n,this._opts=L({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},t);var r=this;e.on("drag.move",function(i){var s=r._toBorderPoint(i);r.startScroll(s)}),e.on(["drag.cleanup"],function(){r.stopScroll()})}Ka.$inject=["config.autoScroll","eventBus","canvas"];Ka.prototype.startScroll=function(t){var e=this._canvas,n=this._opts,r=this,i=e.getContainer().getBoundingClientRect(),s=[t.x,t.y,i.width-t.x,i.height-t.y];this.stopScroll();for(var a=0,c=0,l=0;l<4;l++)XM(s[l],n.scrollThresholdOut[l],n.scrollThresholdIn[l])&&(l===0?a=n.scrollStep:l==1?c=n.scrollStep:l==2?a=-n.scrollStep:l==3&&(c=-n.scrollStep));(a!==0||c!==0)&&(e.scroll({dx:a,dy:c}),this._scrolling=setTimeout(function(){r.startScroll(t)},n.scrollRepeatTimeout))};function XM(t,e,n){return e<t&&t<n}Ka.prototype.stopScroll=function(){clearTimeout(this._scrolling)};Ka.prototype.setOptions=function(t){this._opts=L({},this._opts,t)};Ka.prototype._toBorderPoint=function(t){var e=this._canvas._container.getBoundingClientRect(),n=Es(t.originalEvent);return{x:n.x-e.left,y:n.y-e.top}};const JM={__depends__:[Qr],__init__:["autoScroll"],autoScroll:["type",Ka]};function Qf(t){this._commandStack=t.get("commandStack",!1)}Qf.$inject=["injector"];Qf.prototype.allowed=function(t,e){var n=!0,r=this._commandStack;return r&&(n=r.canExecute(t,e)),n===void 0?!0:n};const Cr={__init__:["rules"],rules:["type",Qf]};var fl=Math.round,QM=Math.max;function eD(t,e){var n=t.x,r=t.y;return[["M",n,r],["m",0,-e],["a",e,e,0,1,1,0,2*e],["a",e,e,0,1,1,0,-2*e],["z"]]}function tD(t){var e=[];return t.forEach(function(n,r){e.push([r===0?"M":"L",n.x,n.y])}),e}var s1=10;function nD(t,e){var n,r;for(n=0;r=t[n];n++)if(Cw(r,e)<=s1)return{point:t[n],bendpoint:!0,index:n};return null}function rD(t,e){var n=Xk(eD(e,s1),tD(t)),r=n[0],i=n[n.length-1],s;return r?r!==i?r.segment2!==i.segment2?(s=QM(r.segment2,i.segment2)-1,{point:t[s],bendpoint:!0,index:s}):{point:{x:fl(r.x+i.x)/2,y:fl(r.y+i.y)/2},index:r.segment2}:{point:{x:fl(r.x),y:fl(r.y)},index:r.segment2}:null}function Sp(t,e){return nD(t,e)||rD(t,e)}function a1(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}function _y(t){return Math.atan((t[1].y-t[0].y)/(t[1].x-t[0].x))}function iD(t,e){return e?{x:Math.cos(e)*t.x-Math.sin(e)*t.y,y:Math.sin(e)*t.x+Math.cos(e)*t.y}:t}function sD(t,e,n){var r=[{n:t[0]-n[0],lambda:e[0]},{n:t[1]-n[1],lambda:e[1]}],i=r[0].n*e[0]+r[1].n*e[1],s=r[0].lambda*e[0]+r[1].lambda*e[1];return-i/s}function em(t,e){var n=e[0],r=e[1],i={x:r.x-n.x,y:r.y-n.y},s=sD([n.x,n.y],[i.x,i.y],[t.x,t.y]);return{x:n.x+s*i.x,y:n.y+s*i.y}}function o1(t,e){var n=em(t,e),r={x:n.x-t.x,y:n.y-t.y};return a1(r)}function Jl(t,e){return a1({x:t.x-e.x,y:t.y-e.y})}var c1="djs-bendpoint",l1="djs-segment-dragger";function aD(t,e){var n=Es(e),r=t._container.getBoundingClientRect(),i;i={x:r.left,y:r.top};var s=t.viewbox();return{x:s.x+(n.x-i.x)/s.scale,y:s.y+(n.y-i.y)/s.scale}}function jp(t,e,n){var r=aD(t,n),i=Sp(e,r);return i}function Np(t,e){var n=ie("g");dt(n).add(c1),ae(t,n);var r=ie("circle");Y(r,{cx:0,cy:0,r:4}),dt(r).add("djs-visual"),ae(n,r);var i=ie("circle");return Y(i,{cx:0,cy:0,r:10}),dt(i).add("djs-hit"),ae(n,i),e&&dt(n).add(e),n}function oD(t,e,n,r){var i=ie("g");ae(t,i);var s=18,a=6,c=11,l=lD(e,n,r),d=a+c,u=ie("rect");Y(u,{x:-s/2,y:-a/2,width:s,height:a}),dt(u).add("djs-visual"),ae(i,u);var h=ie("rect");return Y(h,{x:-l/2,y:-d/2,width:l,height:d}),dt(h).add("djs-hit"),ae(i,h),Jk(i,r==="v"?90:0),i}function d1(t,e,n){var r=ie("g"),i=Vh(e,n),s=Ur(e,n);return ae(t,r),oD(r,e,n,s),dt(r).add(l1),dt(r).add(s==="h"?"horizontal":"vertical"),an(r,i.x,i.y),r}function kp(t){return Math.abs(Math.round(t*2/3))}function cD(t,e){var n=dD(t,e);return em(t,n)}function lD(t,e,n){var r=e.x-t.x,i=e.y-t.y;return kp(n==="h"?r:i)}function dD(t,e){for(var n=e.waypoints,r=1/0,i,s=0;s<n.length-1;s++){var a=n[s],c=n[s+1],l=o1(t,[a,c]);l<r&&(r=l,i=s)}return[n[i],n[i+1]]}function u1(t,e,n,r,i){function s(x,E,N){var j=x.index,C=x.point,R,T,$,B,D,q;return j<=0||x.bendpoint?!1:(R=E[j-1],T=E[j],$=Vh(R,T),B=Ur(R,T),D=Math.abs(C.x-$.x),q=Math.abs(C.y-$.y),B&&D<=N&&q<=N)}function a(x,E){var N=x.waypoints,j,C,R,T;return E.index<=0||E.bendpoint||(j={start:N[E.index-1],end:N[E.index]},C=Ur(j.start,j.end),!C)?null:(C==="h"?R=j.end.x-j.start.x:R=j.end.y-j.start.y,T=kp(R)/2,T)}function c(x,E){var N=E.waypoints,j=jp(e,N,x),C;if(j)return C=a(E,j),s(j,N,C)?i.start(x,E,j.index):r.start(x,E,j.index,!j.bendpoint),!0}function l(x,E,N){je.bind(x,E,function(j){n.triggerMouseEvent(E,j,N),j.stopPropagation()})}function d(x,E){var N=e.getLayer("overlays"),j=Ct('.djs-bendpoints[data-element-id="'+Wo(x.id)+'"]',N);return!j&&E&&(j=ie("g"),Y(j,{"data-element-id":x.id}),dt(j).add("djs-bendpoints"),ae(N,j),l(j,"mousedown",x),l(j,"click",x),l(j,"dblclick",x)),j}function u(x,E){return Ct('.djs-segment-dragger[data-segment-idx="'+x+'"]',E)}function h(x,E){E.waypoints.forEach(function(N,j){var C=Np(x);ae(x,C),an(C,N.x,N.y)}),Np(x,"floating")}function p(x,E){for(var N=E.waypoints,j,C,R,T=1;T<N.length;T++)j=N[T-1],C=N[T],Ur(j,C)&&(R=d1(x,j,C),Y(R,{"data-segment-idx":T}),l(R,"mousemove",E))}function f(x){I(Xg("."+c1,x),function(E){on(E)})}function m(x){I(Xg("."+l1,x),function(E){on(E)})}function v(x){var E=d(x);return E||(E=d(x,!0),h(E,x),p(E,x)),E}function g(x){var E=d(x);E&&(m(E),f(E),p(E,x),h(E,x))}function w(x,E){var N=Ct(".floating",x),j=E.point;N&&an(N,j.x,j.y)}function b(x,E,N){var j=u(E.index,x),C=N[E.index-1],R=N[E.index],T=E.point,$=Vh(C,R),B=Ur(C,R),D,q;j&&(D=uD(j),q={x:T.x-$.x,y:T.y-$.y},B==="v"&&(q={x:q.y,y:q.x}),an(D,q.x,q.y))}t.on("connection.changed",function(x){g(x.element)}),t.on("connection.remove",function(x){var E=d(x.element);E&&on(E)}),t.on("element.marker.update",function(x){var E=x.element,N;E.waypoints&&(N=v(E),x.add?dt(N).add(x.marker):dt(N).remove(x.marker))}),t.on("element.mousemove",function(x){var E=x.element,N=E.waypoints,j,C;if(N){if(j=d(E,!0),C=jp(e,N,x.originalEvent),!C)return;w(j,C),C.bendpoint||b(j,C,N)}}),t.on("element.mousedown",function(x){if(mf(x)){var E=x.originalEvent,N=x.element;if(N.waypoints)return c(E,N)}}),t.on("selection.changed",function(x){var E=x.newSelection,N=E[0];N&&N.waypoints&&v(N)}),t.on("element.hover",function(x){var E=x.element;E.waypoints&&(v(E),n.registerEvent(x.gfx,"mousemove","element.mousemove"))}),t.on("element.out",function(x){n.unregisterEvent(x.gfx,"mousemove","element.mousemove")}),t.on("element.updateId",function(x){var E=x.element,N=x.newId;if(E.waypoints){var j=d(E);j&&Y(j,{"data-element-id":N})}}),this.addHandles=v,this.updateHandles=g,this.getBendpointsContainer=d,this.getSegmentDragger=u}u1.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];function uD(t){return Ct(".djs-visual",t)}var Ey=Math.round,us="reconnectStart",hs="reconnectEnd",yo="updateWaypoints";function tm(t,e,n,r,i,s){this._injector=t,this.start=function(a,c,l,d){var u=n.getGraphics(c),h=c.source,p=c.target,f=c.waypoints,m;!d&&l===0?m=us:!d&&l===f.length-1?m=hs:m=yo;var v=m===yo?"connection.updateWaypoints":"connection.reconnect",g=i.allowed(v,{connection:c,source:h,target:p});g===!1&&(g=i.allowed(v,{connection:c,source:p,target:h})),g!==!1&&r.init(a,"bendpoint.move",{data:{connection:c,connectionGfx:u,context:{allowed:g,bendpointIndex:l,connection:c,source:h,target:p,insert:d,type:m}}})},e.on("bendpoint.move.hover",function(a){var c=a.context,l=c.connection,d=l.source,u=l.target,h=a.hover,p=c.type;c.hover=h;var f;if(h){var m=p===yo?"connection.updateWaypoints":"connection.reconnect";if(f=c.allowed=i.allowed(m,{connection:l,source:p===us?h:d,target:p===hs?h:u}),f){c.source=p===us?h:d,c.target=p===hs?h:u;return}f===!1&&(f=c.allowed=i.allowed(m,{connection:l,source:p===hs?h:u,target:p===us?h:d})),f&&(c.source=p===hs?h:u,c.target=p===us?h:d)}}),e.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(a){var c=a.context,l=c.type;c.hover=null,c.source=null,c.target=null,l!==yo&&(c.allowed=!1)}),e.on("bendpoint.move.end",function(a){var c=a.context,l=c.allowed,d=c.bendpointIndex,u=c.connection,h=c.insert,p=u.waypoints.slice(),f=c.source,m=c.target,v=c.type,g=c.hints||{},w={x:Ey(a.x),y:Ey(a.y)};if(!l)return!1;v===yo?(h?p.splice(d,0,w):p[d]=w,g.bendpointMove={insert:h,bendpointIndex:d},p=this.cropWaypoints(u,p),s.updateWaypoints(u,Qk(p),g)):(v===us?(g.docking="source",Ql(c)&&(g.docking="target",g.newWaypoints=p.reverse())):v===hs&&(g.docking="target",Ql(c)&&(g.docking="source",g.newWaypoints=p.reverse())),s.reconnect(u,f,m,w,g))},this)}tm.$inject=["injector","eventBus","canvas","dragging","rules","modeling"];tm.prototype.cropWaypoints=function(t,e){var n=this._injector.get("connectionDocking",!1);if(!n)return e;var r=t.waypoints;return t.waypoints=e,t.waypoints=n.getCroppedWaypoints(t),e=t.waypoints,t.waypoints=r,e};function Ql(t){var e=t.hover,n=t.source,r=t.target,i=t.type;if(i===us)return e&&r&&e===r&&n!==r;if(i===hs)return e&&n&&e===n&&n!==r}var hD="reconnectStart",pD="reconnectEnd",Sy="updateWaypoints",xo="connect-ok",ml="connect-not-ok",jy="connect-hover",Ny="djs-updating",ky="djs-dragging",Cy=1100;function h1(t,e,n,r){this._injector=e;var i=e.get("connectionPreview",!1);n.on("bendpoint.move.start",function(s){var a=s.context,c=a.bendpointIndex,l=a.connection,d=a.insert,u=l.waypoints,h=u.slice();a.waypoints=u,d&&h.splice(c,0,{x:s.x,y:s.y}),l.waypoints=h;var p=a.draggerGfx=Np(r.getLayer("overlays"));dt(p).add("djs-dragging"),r.addMarker(l,ky),r.addMarker(l,Ny)}),n.on("bendpoint.move.hover",function(s){var a=s.context,c=a.allowed,l=a.hover,d=a.type;if(l){if(r.addMarker(l,jy),d===Sy)return;c?(r.removeMarker(l,ml),r.addMarker(l,xo)):c===!1&&(r.removeMarker(l,xo),r.addMarker(l,ml))}}),n.on(["bendpoint.move.out","bendpoint.move.cleanup"],Cy,function(s){var a=s.context,c=a.hover,l=a.target;c&&(r.removeMarker(c,jy),r.removeMarker(c,l?xo:ml))}),n.on("bendpoint.move.move",function(s){var a=s.context,c=a.allowed,l=a.bendpointIndex,d=a.draggerGfx,u=a.hover,h=a.type,p=a.connection,f=p.source,m=p.target,v=p.waypoints.slice(),g={x:s.x,y:s.y},w=a.hints||{},b={};i&&(w.connectionStart&&(b.connectionStart=w.connectionStart),w.connectionEnd&&(b.connectionEnd=w.connectionEnd),h===hD?Ql(a)?(b.connectionEnd=b.connectionEnd||g,b.source=m,b.target=u||f,v=v.reverse()):(b.connectionStart=b.connectionStart||g,b.source=u||f,b.target=m):h===pD?Ql(a)?(b.connectionStart=b.connectionStart||g,b.source=u||m,b.target=f,v=v.reverse()):(b.connectionEnd=b.connectionEnd||g,b.source=f,b.target=u||m):(b.noCropping=!0,b.noLayout=!0,v[l]=g),h===Sy&&(v=t.cropWaypoints(p,v)),b.waypoints=v,i.drawPreview(a,c,b)),an(d,s.x,s.y)},this),n.on(["bendpoint.move.end","bendpoint.move.cancel"],Cy,function(s){var a=s.context,c=a.connection,l=a.draggerGfx,d=a.hover,u=a.target,h=a.waypoints;c.waypoints=h,on(l),r.removeMarker(c,Ny),r.removeMarker(c,ky),d&&(r.removeMarker(d,xo),r.removeMarker(d,u?xo:ml)),i&&i.cleanUp(a)})}h1.$inject=["bendpointMove","injector","eventBus","canvas"];var Py="connect-hover",Ty="djs-updating";function Ry(t,e,n){return nm(t,e,t[e]+n)}function nm(t,e,n){return{x:e==="x"?n:t.x,y:e==="y"?n:t.y}}function fD(t,e,n,r){var i=Math.max(e[r],n[r]),s=Math.min(e[r],n[r]),a=20,c=Math.min(Math.max(s+a,t[r]),i-a);return nm(e,r,c)}function p1(t){return t==="x"?"y":"x"}function Ay(t,e,n){var r,i;return t.original?t.original:(r=we(e),i=p1(n),nm(t,i,r[i]))}function f1(t,e,n,r,i,s){var a=t.get("connectionDocking",!1);this.start=function(h,p,f){var m,v=n.getGraphics(p),g=f-1,w=f,b=p.waypoints,x=b[g],E=b[w],N=jp(n,b,h),j,C,R;j=Ur(x,E),j&&(C=j==="v"?"x":"y",g===0&&(x=Ay(x,p.source,C)),w===b.length-1&&(E=Ay(E,p.target,C)),N?R=N.point:R={x:(x.x+E.x)/2,y:(x.y+E.y)/2},m={connection:p,segmentStartIndex:g,segmentEndIndex:w,segmentStart:x,segmentEnd:E,axis:C,dragPosition:R},r.init(h,R,"connectionSegment.move",{cursor:C==="x"?"resize-ew":"resize-ns",data:{connection:p,connectionGfx:v,context:m}}))};function c(h,p){if(!a)return p;var f=h.waypoints,m;return h.waypoints=p,m=a.getCroppedWaypoints(h),h.waypoints=f,m}function l(h){i.update("connection",h.connection,h.connectionGfx)}function d(h,p,f){var m=h.newWaypoints,v=h.segmentStartIndex+p,g=m[v],w=h.segmentEndIndex+p,b=m[w],x=p1(h.axis),E=fD(f,g,b,x);an(h.draggerGfx,E.x,E.y)}function u(h,p){var f=0,m=h.filter(function(v,g){return Pw(h[g-1],h[g+1],v)?(f=g<=p?f-1:f,!1):!0});return{waypoints:m,segmentOffset:f}}e.on("connectionSegment.move.start",function(h){var p=h.context,f=h.connection,m=n.getLayer("overlays");p.originalWaypoints=f.waypoints.slice(),p.draggerGfx=d1(m,p.segmentStart,p.segmentEnd),dt(p.draggerGfx).add("djs-dragging"),n.addMarker(f,Ty)}),e.on("connectionSegment.move.move",function(h){var p=h.context,f=p.connection,m=p.segmentStartIndex,v=p.segmentEndIndex,g=p.segmentStart,w=p.segmentEnd,b=p.axis,x=p.originalWaypoints.slice(),E=Ry(g,b,h["d"+b]),N=Ry(w,b,h["d"+b]),j=x.length,C=0;x[m]=E,x[v]=N;var R,T;m<2&&(R=Yt(f.source,E),m===1?R==="intersect"&&(x.shift(),x[0]=E,C--):R!=="intersect"&&(x.unshift(g),C++)),v>j-3&&(T=Yt(f.target,N),v===j-2?T==="intersect"&&(x.pop(),x[x.length-1]=N):T!=="intersect"&&x.push(w)),p.newWaypoints=f.waypoints=c(f,x),d(p,C,h),p.newSegmentStartIndex=m+C,l(h)}),e.on("connectionSegment.move.hover",function(h){h.context.hover=h.hover,n.addMarker(h.hover,Py)}),e.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(h){var p=h.context.hover;p&&n.removeMarker(p,Py)}),e.on("connectionSegment.move.cleanup",function(h){var p=h.context,f=p.connection;p.draggerGfx&&on(p.draggerGfx),n.removeMarker(f,Ty)}),e.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(h){var p=h.context,f=p.connection;f.waypoints=p.originalWaypoints,l(h)}),e.on("connectionSegment.move.end",function(h){var p=h.context,f=p.connection,m=p.newWaypoints,v=p.newSegmentStartIndex;m=m.map(function(N){return{original:N.original,x:Math.round(N.x),y:Math.round(N.y)}});var g=u(m,v),w=g.waypoints,b=c(f,w),x=g.segmentOffset,E={segmentMove:{segmentStartIndex:p.segmentStartIndex,newSegmentStartIndex:v+x}};s.updateWaypoints(f,b,E)})}f1.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var mD=Math.abs,Iy=Math.round;function gD(t,e,n){n=n===void 0?10:n;var r,i;for(r=0;r<e.length;r++)if(i=e[r],mD(i-t)<=n)return i}function m1(t){return{x:t.x,y:t.y}}function g1(t){return{x:t.x+t.width,y:t.y+t.height}}function Fn(t,e){return!t||isNaN(t.x)||isNaN(t.y)?e:{x:Iy(t.x+t.width/2),y:Iy(t.y+t.height/2)}}function Ca(t,e){var n=t.snapped;return n?typeof e=="string"?n[e]:n.x&&n.y:!1}function kt(t,e,n){if(typeof e!="string")throw new Error("axis must be in [x, y]");if(typeof n!="number"&&n!==!1)throw new Error("value must be Number or false");var r,i=t[e],s=t.snapped=t.snapped||{};return n===!1?s[e]=!1:(s[e]=!0,r=n-i,t[e]+=r,t["d"+e]+=r),i}function v1(t){return t.children||[]}var vD=Math.abs,My=Math.round,kh=10;function y1(t){function e(s,a){if(Ue(s)){for(var c=s.length;c--;)if(vD(s[c]-a)<=kh)return s[c]}else{s=+s;var l=a%s;if(l<kh)return a-l;if(l>s-kh)return a-l+s}return a}function n(s,a){if(s.waypoints)return cD(a,s);if(s.width)return{x:My(s.width/2+s.x),y:My(s.height/2+s.y)}}function r(s){var a=s.context,c=a.snapPoints,l=a.connection,d=l.waypoints,u=a.segmentStart,h=a.segmentStartIndex,p=a.segmentEnd,f=a.segmentEndIndex,m=a.axis;if(c)return c;var v=[d[h-1],u,p,d[f+1]];return h<2&&v.unshift(n(l.source,s)),f>d.length-3&&v.unshift(n(l.target,s)),a.snapPoints=c={horizontal:[],vertical:[]},I(v,function(g){g&&(g=g.original||g,m==="y"&&c.horizontal.push(g.y),m==="x"&&c.vertical.push(g.x))}),c}t.on("connectionSegment.move.move",1500,function(s){var a=r(s),c=s.x,l=s.y,d,u;if(a){d=e(a.vertical,c),u=e(a.horizontal,l);var h=c-d,p=l-u;L(s,{dx:s.dx-h,dy:s.dy-p,x:d,y:u}),(h||a.vertical.indexOf(c)!==-1)&&kt(s,"x",d),(p||a.horizontal.indexOf(l)!==-1)&&kt(s,"y",u)}});function i(s){var a=s.snapPoints,c=s.connection.waypoints,l=s.bendpointIndex;if(a)return a;var d=[c[l-1],c[l+1]];return s.snapPoints=a={horizontal:[],vertical:[]},I(d,function(u){u&&(u=u.original||u,a.horizontal.push(u.y),a.vertical.push(u.x))}),a}t.on(["connect.hover","connect.move","connect.end"],1500,function(s){var a=s.context,c=a.hover,l=c&&n(c,s);!lt(c)||!l||!l.x||!l.y||(kt(s,"x",l.x),kt(s,"y",l.y))}),t.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(s){var a=s.context,c=i(a),l=a.hover,d=l&&n(l,s),u=s.x,h=s.y,p,f;if(c){p=e(d?c.vertical.concat([d.x]):c.vertical,u),f=e(d?c.horizontal.concat([d.y]):c.horizontal,h);var m=u-p,v=h-f;L(s,{dx:s.dx-m,dy:s.dy-v,x:s.x-m,y:s.y-v}),(m||c.vertical.indexOf(u)!==-1)&&kt(s,"x",p),(v||c.horizontal.indexOf(h)!==-1)&&kt(s,"y",f)}})}y1.$inject=["eventBus"];const yD={__depends__:[Qr,Cr],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",u1],bendpointMove:["type",tm],bendpointMovePreview:["type",h1],connectionSegmentMove:["type",f1],bendpointSnapping:["type",y1]};function x1(t,e,n,r){function i(a,c){return r.allowed("connection.create",{source:a,target:c})}function s(a,c){return i(c,a)}t.on("connect.hover",function(a){var c=a.context,l=c.start,d=a.hover,u;if(c.hover=d,u=c.canExecute=i(l,d),!Gh(u)){if(u!==!1){c.source=l,c.target=d;return}u=c.canExecute=s(l,d),!Gh(u)&&u!==!1&&(c.source=d,c.target=l)}}),t.on(["connect.out","connect.cleanup"],function(a){var c=a.context;c.hover=null,c.source=null,c.target=null,c.canExecute=!1}),t.on("connect.end",function(a){var c=a.context,l=c.canExecute,d=c.connectionStart,u={x:a.x,y:a.y},h=c.source,p=c.target;if(!l)return!1;var f=null,m={connectionStart:Cp(c)?u:d,connectionEnd:Cp(c)?d:u};Yr(l)&&(f=l),c.connection=n.connect(h,p,f,m)}),this.start=function(a,c,l,d){Yr(l)||(d=l,l=we(c)),e.init(a,"connect",{autoActivate:d,data:{shape:c,context:{start:c,connectionStart:l}}})}}x1.$inject=["eventBus","dragging","modeling","rules"];function Cp(t){var e=t.hover,n=t.source,r=t.target;return e&&n&&e===n&&n!==r}var xD=1100,bD=900,Dy="connect-ok",Oy="connect-not-ok";function b1(t,e,n){var r=t.get("connectionPreview",!1);r&&e.on("connect.move",function(i){var s=i.context,a=s.canExecute,c=s.hover,l=s.source,d=s.start,u=s.startPosition,h=s.target,p=s.connectionStart||u,f=s.connectionEnd||{x:i.x,y:i.y},m=p,v=f;Cp(s)&&(m=f,v=p),r.drawPreview(s,a,{source:l||d,target:h||c,connectionStart:m,connectionEnd:v})}),e.on("connect.hover",bD,function(i){var s=i.context,a=i.hover,c=s.canExecute;c!==null&&n.addMarker(a,c?Dy:Oy)}),e.on(["connect.out","connect.cleanup"],xD,function(i){var s=i.hover;s&&(n.removeMarker(s,Dy),n.removeMarker(s,Oy))}),r&&e.on("connect.cleanup",function(i){r.cleanUp(i.context)})}b1.$inject=["injector","eventBus","canvas"];const rm={__depends__:[Nr,Cr,Qr],__init__:["connectPreview"],connect:["type",x1],connectPreview:["type",b1]};var wD="djs-dragger";function ei(t,e,n,r){this._canvas=e,this._graphicsFactory=n,this._elementFactory=r,this._connectionDocking=t.get("connectionDocking",!1),this._layouter=t.get("layouter",!1)}ei.$inject=["injector","canvas","graphicsFactory","elementFactory"];ei.prototype.drawPreview=function(t,e,n){n=n||{};var r=t.connectionPreviewGfx,i=t.getConnection,s=n.source,a=n.target,c=n.waypoints,l=n.connectionStart,d=n.connectionEnd,u=n.noLayout,h=n.noCropping,p=n.noNoop,f,m=this;if(r||(r=t.connectionPreviewGfx=this.createConnectionPreviewGfx()),kd(r),i||(i=t.getConnection=_D(function(v,g,w){return m.getConnection(v,g,w)})),e&&(f=i(e,s,a)),!f){!p&&this.drawNoopPreview(r,n);return}f.waypoints=c||[],this._layouter&&!u&&(f.waypoints=this._layouter.layoutConnection(f,{source:s,target:a,connectionStart:l,connectionEnd:d,waypoints:n.waypoints||f.waypoints})),(!f.waypoints||!f.waypoints.length)&&(f.waypoints=[s?we(s):l,a?we(a):d]),this._connectionDocking&&(s||a)&&!h&&(f.waypoints=this._connectionDocking.getCroppedWaypoints(f,s,a)),this._graphicsFactory.drawConnection(r,f,{stroke:"var(--element-dragger-color)"})};ei.prototype.drawNoopPreview=function(t,e){var n=e.source,r=e.target,i=e.connectionStart||we(n),s=e.connectionEnd||we(r),a=this.cropWaypoints(i,s,n,r),c=this.createNoopConnection(a[0],a[1]);ae(t,c)};ei.prototype.cropWaypoints=function(t,e,n,r){var i=this._graphicsFactory,s=n&&i.getShapePath(n),a=r&&i.getShapePath(r),c=i.getConnectionPath({waypoints:[t,e]});return t=n&&Wh(s,c,!0)||t,e=r&&Wh(a,c,!1)||e,[t,e]};ei.prototype.cleanUp=function(t){t&&t.connectionPreviewGfx&&on(t.connectionPreviewGfx)};ei.prototype.getConnection=function(t){var e=ED(t);return this._elementFactory.createConnection(e)};ei.prototype.createConnectionPreviewGfx=function(){var t=ie("g");return Y(t,{pointerEvents:"none"}),dt(t).add(wD),ae(this._canvas.getActiveLayer(),t),t};ei.prototype.createNoopConnection=function(t,e){return eC([t,e],{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"})};function _D(t){var e={};return function(n){var r=JSON.stringify(n),i=e[r];return i||(i=e[r]=t.apply(null,arguments)),i}}function ED(t){return Yr(t)?t:{}}const SD={__init__:["connectionPreview"],connectionPreview:["type",ei]},jD=new uf("ps");var ND=["marker-start","marker-mid","marker-end"],kD=["circle","ellipse","line","path","polygon","polyline","path","rect"];function Fi(t,e,n,r){this._elementRegistry=t,this._canvas=n,this._styles=r}Fi.$inject=["elementRegistry","eventBus","canvas","styles"];Fi.prototype.cleanUp=function(){console.warn("PreviewSupport#cleanUp is deprecated and will be removed in future versions. You do not need to manually clean up previews anymore. cf. https://github.com/bpmn-io/diagram-js/pull/906")};Fi.prototype.getGfx=function(t){return this._elementRegistry.getGraphics(t)};Fi.prototype.addDragger=function(t,e,n,r="djs-dragger"){n=n||this.getGfx(t);var i=Tw(n),s=n.getBoundingClientRect();return this._cloneMarkers(sa(i),r),Y(i,this._styles.cls(r,[],{x:s.top,y:s.left})),ae(e,i),Y(i,"data-preview-support-element-id",t.id),i};Fi.prototype.addFrame=function(t,e){var n=ie("rect",{class:"djs-resize-overlay",width:t.width,height:t.height,x:t.x,y:t.y});return ae(e,n),Y(n,"data-preview-support-element-id",t.id),n};Fi.prototype._cloneMarkers=function(t,e="djs-dragger",n=t){var r=this;t.childNodes&&t.childNodes.forEach(i=>{r._cloneMarkers(i,e,n)}),RD(t)&&ND.forEach(function(i){if(Y(t,i)){var s=CD(t,i,r._canvas.getContainer());s&&r._cloneMarker(n,t,s,i,e)}})};Fi.prototype._cloneMarker=function(t,e,n,r,i="djs-dragger"){var s=[n.id,i,jD.next()].join("-"),a=Ct("marker#"+n.id,t);t=t||this._canvas._svg;var c=a||Tw(n);c.id=s,dt(c).add(i);var l=Ct(":scope > defs",t);l||(l=ie("defs"),ae(t,l)),ae(l,c);var d=TD(c.id);Y(e,r,d)};function CD(t,e,n){var r=PD(Y(t,e));return Ct("marker#"+r,n||document)}function PD(t){return t.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]}function TD(t){return"url(#"+t+")"}function RD(t){return kD.indexOf(t.nodeName)!==-1}const Ya={__init__:["previewSupport"],previewSupport:["type",Fi]},gl="complex-preview";class w1{constructor(e,n,r){this._canvas=e,this._graphicsFactory=n,this._previewSupport=r,this._markers=[]}create(e){this.cleanUp();const{created:n=[],moved:r=[],removed:i=[],resized:s=[]}=e,a=this._canvas.getLayer(gl);n.filter(c=>!AD(c)).forEach(c=>{let l;lt(c)?(l=this._graphicsFactory._createContainer("connection",ie("g")),this._graphicsFactory.drawConnection(sa(l),c)):(l=this._graphicsFactory._createContainer("shape",ie("g")),this._graphicsFactory.drawShape(sa(l),c),an(l,c.x,c.y)),this._previewSupport.addDragger(c,a,l)}),r.forEach(({element:c,delta:l})=>{this._previewSupport.addDragger(c,a,void 0,"djs-dragging"),this._canvas.addMarker(c,"djs-element-hidden"),this._markers.push([c,"djs-element-hidden"]);const d=this._previewSupport.addDragger(c,a);lt(c)?an(d,l.x,l.y):an(d,c.x+l.x,c.y+l.y)}),i.forEach(c=>{this._previewSupport.addDragger(c,a,void 0,"djs-dragging"),this._canvas.addMarker(c,"djs-element-hidden"),this._markers.push([c,"djs-element-hidden"])}),s.forEach(({shape:c,bounds:l})=>{this._canvas.addMarker(c,"djs-hidden"),this._markers.push([c,"djs-hidden"]),this._previewSupport.addDragger(c,a,void 0,"djs-dragging");const d=this._graphicsFactory._createContainer("shape",ie("g"));this._graphicsFactory.drawShape(sa(d),c,{width:l.width,height:l.height}),an(d,l.x,l.y),this._previewSupport.addDragger(c,a,d)})}cleanUp(){kd(this._canvas.getLayer(gl)),this._markers.forEach(([e,n])=>this._canvas.removeMarker(e,n)),this._markers=[]}show(){this._canvas.showLayer(gl)}hide(){this._canvas.hideLayer(gl)}}w1.$inject=["canvas","graphicsFactory","previewSupport"];function AD(t){return t.hidden}const ID={__depends__:[Ya],__init__:["complexPreview"],complexPreview:["type",w1]};var im=["top","bottom","left","right"],vl=10;function sm(t,e){Z.call(this,t),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(i){var s=i.context,a=s.connection,c=a.source,l=a.target,d=s.hints||{};d.createElementsBehavior!==!1&&(n(c),n(l))}),this.postExecuted(["label.create"],function(i){var s=i.context,a=s.shape,c=s.hints||{};c.createElementsBehavior!==!1&&n(a.labelTarget)}),this.postExecuted(["elements.create"],function(i){var s=i.context,a=s.elements,c=s.hints||{};c.createElementsBehavior!==!1&&a.forEach(function(l){n(l)})});function n(i){if(Cd(i)&&!lt(i)){var s=OD(i);s&&r(i,s)}}function r(i,s){var a=we(i),c=i.label,l=we(c);if(c.parent){var d=ye(i),u;switch(s){case"top":u={x:a.x,y:d.top-vl-c.height/2};break;case"left":u={x:d.left-vl-c.width/2,y:a.y};break;case"bottom":u={x:a.x,y:d.bottom+vl+c.height/2};break;case"right":u={x:d.right+vl+c.width/2,y:a.y};break}var h=cr(u,l);e.moveShape(c,h)}}}fe(sm,Z);sm.$inject=["eventBus","modeling"];function MD(t){var e=t.host,n=we(t),r=Yt(n,e),i;r.indexOf("-")>=0?i=r.split("-"):i=[r];var s=im.filter(function(a){return i.indexOf(a)===-1});return s}function DD(t){var e=we(t),n=[].concat(t.incoming.map(function(r){return r.waypoints[r.waypoints.length-2]}),t.outgoing.map(function(r){return r.waypoints[1]})).map(function(r){return _1(e,r)});return n}function OD(t){var e=we(t.label),n=we(t),r=_1(n,e);if($D(r)){var i=DD(t);if(t.host){var s=MD(t);i=i.concat(s)}var a=im.filter(function(c){return i.indexOf(c)===-1});if(a.indexOf(r)===-1)return a[0]}}function _1(t,e){return Yt(e,t,5)}function $D(t){return im.indexOf(t)!==-1}function am(t){Z.call(this,t),this.preExecute("shape.append",function(e){var n=e.source,r=e.shape;e.position||(_(r,"bpmn:TextAnnotation")?e.position={x:n.x+n.width/2+75,y:n.y-50-r.height/2}:e.position={x:n.x+n.width+80+r.width/2,y:n.y+n.height/2})},!0)}fe(am,Z);am.$inject=["eventBus"];function om(t,e){t.invoke(Z,this),this.postExecute("shape.move",function(n){var r=n.newParent,i=n.shape,s=Ve(i.incoming.concat(i.outgoing),function(a){return _(a,"bpmn:Association")});I(s,function(a){e.moveConnection(a,{x:0,y:0},r)})},!0)}fe(om,Z);om.$inject=["injector","modeling"];var $y=500;function Zd(t,e){e.invoke(Z,this),this._bpmnReplace=t;var n=this;this.postExecuted("elements.create",$y,function(r){var i=r.elements;i=i.filter(function(s){var a=s.host;return Ly(s,a)}),i.length===1&&i.map(function(s){return i.indexOf(s)}).forEach(function(s){var a=i[s];r.elements[s]=n._replaceShape(i[s],a)})},!0),this.preExecute("elements.move",$y,function(r){var i=r.shapes,s=r.newHost;if(i.length===1){var a=i[0];Ly(a,s)&&(r.shapes=[n._replaceShape(a,s)])}},!0)}Zd.$inject=["bpmnReplace","injector"];fe(Zd,Z);Zd.prototype._replaceShape=function(t,e){var n=LD(t),r={type:"bpmn:BoundaryEvent",host:e};return n&&(r.eventDefinitionType=n.$type),this._bpmnReplace.replaceElement(t,r,{layoutConnection:!1})};function LD(t){var e=ce(t),n=e.eventDefinitions;return n&&n[0]}function Ly(t,e){return!We(t)&&Me(t,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!e}function cm(t,e){Z.call(this,t);function n(r){return Ve(r.attachers,function(i){return _(i,"bpmn:BoundaryEvent")})}this.postExecute("connection.create",function(r){var i=r.context.source,s=r.context.target,a=n(s);_(i,"bpmn:EventBasedGateway")&&_(s,"bpmn:ReceiveTask")&&a.length>0&&e.removeElements(a)}),this.postExecute("connection.reconnect",function(r){var i=r.context.oldSource,s=r.context.newSource;_(i,"bpmn:Gateway")&&_(s,"bpmn:EventBasedGateway")&&I(s.outgoing,function(a){var c=a.target,l=n(c);_(c,"bpmn:ReceiveTask")&&l.length>0&&e.removeElements(l)})})}cm.$inject=["eventBus","modeling"];fe(cm,Z);function lm(t,e,n){Z.call(this,t),this.preExecute("shape.replace",c,!0),this.postExecuted("shape.replace",l,!0),this.preExecute("connection.create",i,!0),this.postExecuted("connection.delete",r,!0),this.postExecuted("connection.reconnect",s,!0),this.postExecuted("element.updateProperties",a,!0);function r(g){const w=g.source,b=g.target;qs(w)&&bo(b)&&u(b)}function i(g){const w=g.connection,b=g.source,x=g.target;qs(b)&&yl(x)&&(d(x),p(b,[w]))}function s(g){const w=g.newTarget,b=g.oldSource,x=g.oldTarget;if(x!==w){const E=b;bo(x)&&u(x),qs(E)&&yl(w)&&d(w)}}function a(g){const{element:w}=g;bo(w)?(h(w),f(w)):yl(w)&&m(w)}function c(g){const{newData:w,oldShape:b}=g;if(qs(g.oldShape)&&w.eventDefinitionType!=="bpmn:CompensateEventDefinition"||w.type!=="bpmn:BoundaryEvent"){const x=b.outgoing.find(({target:E})=>bo(E));x&&x.target&&(g._connectionTarget=x.target)}else if(!qs(g.oldShape)&&w.eventDefinitionType==="bpmn:CompensateEventDefinition"&&w.type==="bpmn:BoundaryEvent"){const x=b.outgoing.find(({target:E})=>yl(E));x&&x.target&&(g._connectionTarget=x.target),v(b)}}function l(g){const{_connectionTarget:w,newShape:b}=g;w&&e.connect(b,w)}function d(g){e.updateProperties(g,{isForCompensation:!0})}function u(g){e.updateProperties(g,{isForCompensation:void 0})}function h(g){for(const w of g.incoming)n.canConnect(w.source,g)||e.removeConnection(w);for(const w of g.outgoing)n.canConnect(g,w.target)||e.removeConnection(w)}function p(g,w){g.outgoing.filter(E=>_(E,"bpmn:Association")).filter(E=>bo(E.target)&&!w.includes(E)).forEach(E=>e.removeConnection(E))}function f(g){const w=g.attachers.slice();w.length&&e.removeElements(w)}function m(g){const w=g.incoming.filter(b=>qs(b.source));e.removeElements(w)}function v(g){const w=g.outgoing.filter(b=>_(b,"bpmn:SequenceFlow"));e.removeElements(w)}}fe(lm,Z);lm.$inject=["eventBus","modeling","bpmnRules"];function bo(t){const e=ce(t);return e&&e.get("isForCompensation")}function qs(t){return t&&_(t,"bpmn:BoundaryEvent")&&gf(t,"bpmn:CompensateEventDefinition")}function yl(t){return t&&_(t,"bpmn:Activity")&&!cn(t)}function dm(t){t.invoke(Z,this),this.preExecute("shape.create",1500,function(e){var n=e.context,r=n.parent,i=n.shape;_(r,"bpmn:Lane")&&!_(i,"bpmn:Lane")&&(n.parent=ka(r,"bpmn:Participant"))})}dm.$inject=["injector"];fe(dm,Z);function um(t,e){Z.call(this,t),this.preExecute("shape.create",function(n){var r=n.context,i=r.shape;if(_(i,"bpmn:DataObjectReference")&&i.type!=="label"){var s=e.create("bpmn:DataObject");i.businessObject.dataObjectRef=s}})}um.$inject=["eventBus","bpmnFactory"];fe(um,Z);var Pp=20,Tp=20,E1=30,xl=2e3;function hm(t,e,n){Z.call(this,e),e.on(["create.start","shape.move.start"],xl,function(i){var s=i.context,a=s.shape,c=t.getRootElement();if(!(!_(a,"bpmn:Participant")||!_(c,"bpmn:Process")||!c.children.length)){var l=c.children.filter(function(h){return!_(h,"bpmn:Group")&&!We(h)&&!lt(h)});if(l.length){var d=gn(l),u=BD(a,d);L(a,u),s.createConstraints=FD(a,d)}}}),e.on("create.start",xl,function(i){var s=i.context,a=s.shape,c=t.getRootElement(),l=t.getGraphics(c);function d(u){u.element=c,u.gfx=l}_(a,"bpmn:Participant")&&_(c,"bpmn:Process")&&(e.on("element.hover",xl,d),e.once("create.cleanup",function(){e.off("element.hover",d)}))});function r(){var i=t.getRootElement();return _(i,"bpmn:Collaboration")?i:n.makeCollaboration()}this.preExecute("elements.create",xl,function(i){var s=i.elements,a=i.parent,c=zD(s),l;c&&_(a,"bpmn:Process")&&(i.parent=r(),l=i.hints=i.hints||{},l.participant=c,l.process=a,l.processRef=ce(c).get("processRef"))},!0),this.preExecute("shape.create",function(i){var s=i.parent,a=i.shape;_(a,"bpmn:Participant")&&_(s,"bpmn:Process")&&(i.parent=r(),i.process=s,i.processRef=ce(a).get("processRef"))},!0),this.execute("shape.create",function(i){var s=i.hints||{},a=i.process||s.process,c=i.shape,l=s.participant;a&&(!l||c===l)&&ce(c).set("processRef",ce(a))},!0),this.revert("shape.create",function(i){var s=i.hints||{},a=i.process||s.process,c=i.processRef||s.processRef,l=i.shape,d=s.participant;a&&(!d||l===d)&&ce(l).set("processRef",c)},!0),this.postExecute("shape.create",function(i){var s=i.hints||{},a=i.process||i.hints.process,c=i.shape,l=s.participant;if(a){var d=a.children.slice();l?c===l&&n.moveElements(d,{x:0,y:0},l):n.moveElements(d,{x:0,y:0},c)}},!0)}hm.$inject=["canvas","eventBus","modeling"];fe(hm,Z);function BD(t,e){e={width:e.width+Pp*2+E1,height:e.height+Tp*2};var n=Math.max(t.width,e.width),r=Math.max(t.height,e.height);return{x:-n/2,y:-r/2,width:n,height:r}}function FD(t,e){return e=ye(e),{bottom:e.top+t.height/2-Tp,left:e.right-t.width/2+Pp,top:e.bottom-t.height/2+Tp,right:e.left+t.width/2-Pp-E1}}function zD(t){return mt(t,function(e){return _(e,"bpmn:Participant")})}var By="__targetRef_placeholder";function pm(t,e){Z.call(this,t),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],Fy(s)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],Fy(s));function n(a,c,l){var d=a.get("dataInputAssociations");return mt(d,function(u){return u!==l&&u.targetRef===c})}function r(a,c){var l=a.get("properties"),d=mt(l,function(u){return u.name===By});return!d&&c&&(d=e.create("bpmn:Property",{name:By}),Ot(l,d)),d}function i(a,c){var l=r(a);l&&(n(a,l,c)||At(a.get("properties"),l))}function s(a){var c=a.context,l=c.connection,d=l.businessObject,u=l.target,h=u&&u.businessObject,p=c.newTarget,f=p&&p.businessObject,m=c.oldTarget||c.target,v=m&&m.businessObject,g=l.businessObject,w;v&&v!==h&&i(v,d),f&&f!==h&&i(f,d),h?(w=r(h,!0),g.targetRef=w):g.targetRef=null}}pm.$inject=["eventBus","bpmnFactory"];fe(pm,Z);function Fy(t){return function(e){var n=e.context,r=n.connection;if(_(r,"bpmn:DataInputAssociation"))return t(e)}}function Xd(t){this._bpmnUpdater=t}Xd.$inject=["bpmnUpdater"];Xd.prototype.execute=function(t){var e=t.dataStoreBo,n=t.dataStoreDi,r=t.newSemanticParent,i=t.newDiParent;return t.oldSemanticParent=e.$parent,t.oldDiParent=n.$parent,this._bpmnUpdater.updateSemanticParent(e,r),this._bpmnUpdater.updateDiParent(n,i),[]};Xd.prototype.revert=function(t){var e=t.dataStoreBo,n=t.dataStoreDi,r=t.oldSemanticParent,i=t.oldDiParent;return this._bpmnUpdater.updateSemanticParent(e,r),this._bpmnUpdater.updateDiParent(n,i),[]};function fm(t,e,n,r){Z.call(this,r),e.registerHandler("dataStore.updateContainment",Xd);function i(){return n.filter(function(c){return _(c,"bpmn:Participant")&&ce(c).processRef})[0]}function s(c){return c.children.filter(function(l){return _(l,"bpmn:DataStoreReference")&&!l.labelTarget})}function a(c,l){var d=c.businessObject||c;if(l=l||i(),l){var u=l.businessObject||l;e.execute("dataStore.updateContainment",{dataStoreBo:d,dataStoreDi:at(c),newSemanticParent:u.processRef||u,newDiParent:at(l)})}}this.preExecute("shape.create",function(c){var l=c.context,d=l.shape;_(d,"bpmn:DataStoreReference")&&d.type!=="label"&&(l.hints||(l.hints={}),l.hints.autoResize=!1)}),this.preExecute("elements.move",function(c){var l=c.context,d=l.shapes,u=d.filter(function(h){return _(h,"bpmn:DataStoreReference")});u.length&&(l.hints||(l.hints={}),l.hints.autoResize=d.filter(function(h){return!_(h,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(c){var l=c.context,d=l.shape,u=d.parent;_(d,"bpmn:DataStoreReference")&&d.type!=="label"&&_(u,"bpmn:Collaboration")&&a(d)}),this.postExecute("shape.move",function(c){var l=c.context,d=l.shape,u=l.oldParent,h=d.parent;if(!_(u,"bpmn:Collaboration")&&_(d,"bpmn:DataStoreReference")&&d.type!=="label"&&_(h,"bpmn:Collaboration")){var p=_(u,"bpmn:Participant")?u:HD(u,"bpmn:Participant");a(d,p)}}),this.postExecute("shape.delete",function(c){var l=c.context,d=l.shape,u=t.getRootElement();Me(d,["bpmn:Participant","bpmn:SubProcess"])&&_(u,"bpmn:Collaboration")&&s(u).filter(function(h){return UD(h,d)}).forEach(function(h){a(h)})}),this.postExecute("canvas.updateRoot",function(c){var l=c.context,d=l.oldRoot,u=l.newRoot,h=s(d);h.forEach(function(p){_(u,"bpmn:Process")&&a(p,u)})})}fm.$inject=["canvas","commandStack","elementRegistry","eventBus"];fe(fm,Z);function UD(t,e){for(var n=t.businessObject||t,r=e.businessObject||e;n.$parent;){if(n.$parent===r.processRef||r)return!0;n=n.$parent}return!1}function HD(t,e){for(;t.parent;){if(_(t.parent,e))return t.parent;t=t.parent}}var ed=Math.max,td=Math.min,VD=20;function S1(t,e){return{top:t.top-e.top,right:t.right-e.right,bottom:t.bottom-e.bottom,left:t.left-e.left}}function GD(t,e,n){var r=n.x,i=n.y,s={x:t.x,y:t.y,width:t.width,height:t.height};return e.indexOf("n")!==-1?(s.y=t.y+i,s.height=t.height-i):e.indexOf("s")!==-1&&(s.height=t.height+i),e.indexOf("e")!==-1?s.width=t.width+r:e.indexOf("w")!==-1&&(s.x=t.x+r,s.width=t.width-r),s}function WD(t,e){return{x:t.x+(e.left||0),y:t.y+(e.top||0),width:t.width-(e.left||0)+(e.right||0),height:t.height-(e.top||0)+(e.bottom||0)}}function bl(t,e,n){var r=e[t],i=n.min&&n.min[t],s=n.max&&n.max[t];return ze(i)&&(r=(/top|left/.test(t)?td:ed)(r,i)),ze(s)&&(r=(/top|left/.test(t)?ed:td)(r,s)),r}function qD(t,e){if(!e)return t;var n=ye(t);return ff({top:bl("top",n,e),right:bl("right",n,e),bottom:bl("bottom",n,e),left:bl("left",n,e)})}function KD(t,e,n,r){var i=ye(e),s={top:/n/.test(t)?i.bottom-n.height:i.top,left:/w/.test(t)?i.right-n.width:i.left,bottom:/s/.test(t)?i.top+n.height:i.bottom,right:/e/.test(t)?i.left+n.width:i.right},a=r?ye(r):s,c={top:td(s.top,a.top),left:td(s.left,a.left),bottom:ed(s.bottom,a.bottom),right:ed(s.right,a.right)};return ff(c)}function wo(t,e){return typeof t<"u"?t:VD}function YD(t,e){var n,r,i,s;return typeof e=="object"?(n=wo(e.left),r=wo(e.right),i=wo(e.top),s=wo(e.bottom)):n=r=i=s=wo(e),{x:t.x-n,y:t.y-i,width:t.width+n+r,height:t.height+i+s}}function ZD(t){return!(t.waypoints||t.type==="label")}function j1(t,e){var n;if(t.length===void 0?n=Ve(t.children,ZD):n=t,n.length)return YD(gn(n),e)}var fi=Math.abs;function XD(t,e){return S1(ye(e),ye(t))}var JD=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],Dn=30;function Jd(t,e){return e=e||[],t.children.filter(function(n){_(n,"bpmn:Lane")&&(Jd(n,e),e.push(n))}),e}function zi(t){return t.children.filter(function(e){return _(e,"bpmn:Lane")})}function Bn(t){return ka(t,JD)||t}function QD(t,e){var n=Bn(t),r=_(n,"bpmn:Process")?[]:[n],i=Jd(n,r),s=ye(t),a=ye(e),c=XD(t,e),l=[],d=Vt(t);return i.forEach(function(u){if(u!==t){var h=d?0:c.top,p=d?c.right:0,f=d?0:c.bottom,m=d?c.left:0,v=ye(u);c.top&&(fi(v.bottom-s.top)<10&&(f=a.top-v.bottom),fi(v.top-s.top)<5&&(h=a.top-v.top)),c.left&&(fi(v.right-s.left)<10&&(p=a.left-v.right),fi(v.left-s.left)<5&&(m=a.left-v.left)),c.bottom&&(fi(v.top-s.bottom)<10&&(h=a.bottom-v.top),fi(v.bottom-s.bottom)<5&&(f=a.bottom-v.bottom)),c.right&&(fi(v.left-s.right)<10&&(m=a.right-v.left),fi(v.right-s.right)<5&&(p=a.right-v.right)),(h||p||f||m)&&l.push({shape:u,newBounds:WD(u,{top:h,right:p,bottom:f,left:m})})}}),l}var eO=500;function mm(t,e){Z.call(this,t);function n(r,i){var s=Vt(r),a=zi(i),c=[],l=[],d=[],u=[];if(Pd(a,function(g){return s?g.y>r.y?l.push(g):c.push(g):g.x>r.x?u.push(g):d.push(g),g.children}),!!a.length){var h;s?l.length&&c.length?h=r.height/2:h=r.height:u.length&&d.length?h=r.width/2:h=r.width;var p,f,m,v;c.length&&(p=e.calculateAdjustments(c,"y",h,r.y-10),e.makeSpace(p.movingShapes,p.resizingShapes,{x:0,y:h},"s")),l.length&&(f=e.calculateAdjustments(l,"y",-h,r.y+r.height+10),e.makeSpace(f.movingShapes,f.resizingShapes,{x:0,y:-h},"n")),d.length&&(m=e.calculateAdjustments(d,"x",h,r.x-10),e.makeSpace(m.movingShapes,m.resizingShapes,{x:h,y:0},"e")),u.length&&(v=e.calculateAdjustments(u,"x",-h,r.x+r.width+10),e.makeSpace(v.movingShapes,v.resizingShapes,{x:-h,y:0},"w"))}}this.postExecuted("shape.delete",eO,function(r){var i=r.context,s=i.hints,a=i.shape,c=i.oldParent;_(a,"bpmn:Lane")&&(s&&s.nested||n(a,c))})}mm.$inject=["eventBus","spaceTool"];fe(mm,Z);var zy=500;function Qd(t,e){e.invoke(Z,this),this._bpmnReplace=t;var n=this;this.postExecuted("elements.create",zy,function(r){var i=r.elements;i.filter(function(s){var a=s.host;return Uy(s,a)}).map(function(s){return i.indexOf(s)}).forEach(function(s){r.elements[s]=n._replaceShape(i[s])})},!0),this.preExecute("elements.move",zy,function(r){var i=r.shapes,s=r.newHost;i.forEach(function(a,c){var l=a.host;Uy(a,nO(i,l)?l:s)&&(i[c]=n._replaceShape(a))})},!0)}Qd.$inject=["bpmnReplace","injector"];fe(Qd,Z);Qd.prototype._replaceShape=function(t){var e=tO(t),n;return e?n={type:"bpmn:IntermediateCatchEvent",eventDefinitionType:e.$type}:n={type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(t,n,{layoutConnection:!1})};function tO(t){var e=ce(t),n=e.eventDefinitions;return n&&n[0]}function Uy(t,e){return!We(t)&&_(t,"bpmn:BoundaryEvent")&&!e}function nO(t,e){return t.indexOf(e)!==-1}function gm(t,e,n){Z.call(this,t);function r(i,s,a){var c=s.waypoints,l,d,u,h,p,f,m,v=i.outgoing.slice(),g=i.incoming.slice(),w;ze(a.width)?w=we(a):w=a;var b=Sp(c,w);if(b){if(l=c.slice(0,b.index),d=c.slice(b.index+(b.bendpoint?1:0)),!l.length||!d.length)return;u=b.bendpoint?c[b.index]:w,(l.length===1||!Hy(i,l[l.length-1]))&&l.push(Vy(u)),(d.length===1||!Hy(i,d[0]))&&d.unshift(Vy(u))}h=s.source,p=s.target,e.canConnect(h,i,s)&&(n.reconnectEnd(s,i,l||w),f=s),e.canConnect(i,p,s)&&(f?m=n.connect(i,p,{type:s.type,waypoints:d}):(n.reconnectStart(s,i,d||w),m=s));var x=[].concat(f&&Ve(g,function(E){return E.source===f.source})||[],m&&Ve(v,function(E){return E.target===m.target})||[]);x.length&&n.removeElements(x)}this.preExecute("elements.move",function(i){var s=i.newParent,a=i.shapes,c=i.delta,l=a[0];if(!(!l||!s)){s&&s.waypoints&&(i.newParent=s=s.parent);var d=we(l),u={x:d.x+c.x,y:d.y+c.y},h=mt(s.children,function(p){var f=e.canInsert(a,p);return f&&Sp(p.waypoints,u)});h&&(i.targetFlow=h,i.position=u)}},!0),this.postExecuted("elements.move",function(i){var s=i.shapes,a=i.targetFlow,c=i.position;a&&r(s[0],a,c)},!0),this.preExecute("shape.create",function(i){var s=i.parent,a=i.shape;e.canInsert(a,s)&&(i.targetFlow=s,i.parent=s.parent)},!0),this.postExecuted("shape.create",function(i){var s=i.shape,a=i.targetFlow,c=i.position;a&&r(s,a,c)},!0)}fe(gm,Z);gm.$inject=["eventBus","bpmnRules","modeling"];function Hy(t,e){var n=e.x,r=e.y;return n>=t.x&&n<=t.x+t.width&&r>=t.y&&r<=t.y+t.height}function Vy(t){return L({},t)}function vm(t,e){Z.call(this,t),this.preExecuted("connection.create",function(n){var r=n.context,i=r.connection,s=r.source,a=r.target,c=r.hints;if(!(c&&c.createElementsBehavior===!1)&&Ks(i)){var l=[];_(s,"bpmn:EventBasedGateway")?l=a.incoming.filter(d=>d!==i&&Ks(d)):l=a.incoming.filter(d=>d!==i&&Ks(d)&&_(d.source,"bpmn:EventBasedGateway")),l.forEach(function(d){e.removeConnection(d)})}}),this.preExecuted("shape.replace",function(n){var r=n.context,i=r.newShape;if(_(i,"bpmn:EventBasedGateway")){var s=i.outgoing.filter(Ks).reduce(function(a,c){return a.includes(c.target)?a:a.concat(c.target)},[]);s.forEach(function(a){a.incoming.filter(Ks).forEach(function(c){const l=a.incoming.filter(Ks).filter(function(d){return d.source===i});(c.source!==i||l.length>1)&&e.removeConnection(c)})})}})}vm.$inject=["eventBus","modeling"];fe(vm,Z);function Ks(t){return _(t,"bpmn:SequenceFlow")}var wl=1500,Gy=2e3;function N1(t,e,n){e.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],wl,function(r){var i=r.context,s=i.shape||r.shape,a=r.hover;_(a,"bpmn:Lane")&&!Me(s,["bpmn:Lane","bpmn:Participant"])&&(r.hover=Bn(a),r.hoverGfx=t.getGraphics(r.hover));var c=n.getRootElement();a!==c&&(s.labelTarget||Me(s,["bpmn:Group","bpmn:TextAnnotation"]))&&(r.hover=c,r.hoverGfx=t.getGraphics(r.hover))}),e.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],wl,function(r){var i=r.hover;_(i,"bpmn:Lane")&&(r.hover=Bn(i)||i,r.hoverGfx=t.getGraphics(r.hover))}),e.on(["bendpoint.move.hover"],wl,function(r){var i=r.context,s=r.hover,a=i.type;_(s,"bpmn:Lane")&&/reconnect/.test(a)&&(r.hover=Bn(s)||s,r.hoverGfx=t.getGraphics(r.hover))}),e.on(["connect.start"],wl,function(r){var i=r.context,s=i.start;_(s,"bpmn:Lane")&&(i.start=Bn(s)||s)}),e.on("shape.move.start",Gy,function(r){var i=r.shape;_(i,"bpmn:Lane")&&(r.shape=Bn(i)||i)}),e.on("spaceTool.move",Gy,function(r){var i=r.hover;i&&_(i,"bpmn:Lane")&&(r.hover=Bn(i))})}N1.$inject=["elementRegistry","eventBus","canvas"];function rO(t){return t.create("bpmn:Category")}function iO(t){return t.create("bpmn:CategoryValue")}function sO(t,e,n){return Ot(e.get("categoryValue"),t),t.$parent=e,Ot(n.get("rootElements"),e),e.$parent=n,t}function aO(t){var e=t.$parent;return e&&(At(e.get("categoryValue"),t),t.$parent=null),t}function oO(t){var e=t.$parent;return e&&(At(e.get("rootElements"),t),t.$parent=null),t}var Wy=770;function ym(t,e,n,r,i,s){i.invoke(Z,this);function a(){return n.filter(function(m){return _(m,"bpmn:Group")})}function c(m,v){return m.some(function(g){var w=ce(g),b=w.categoryValueRef&&w.categoryValueRef.$parent;return b===v})}function l(m,v){return m.some(function(g){var w=ce(g);return w.categoryValueRef===v})}function d(m,v,g){var w=a().filter(function(b){return b.businessObject!==g});v&&!c(w,v)&&oO(v),m&&!l(w,m)&&aO(m)}function u(m,v){return sO(m,v,e.getDefinitions())}function h(m,v){var g=ce(m),w=g.categoryValueRef;w||(w=g.categoryValueRef=v.categoryValue=v.categoryValue||iO(t));var b=w.$parent;b||(b=w.$parent=v.category=v.category||rO(t)),u(w,b,e.getDefinitions())}function p(m,v){var g=v.category,w=v.categoryValue,b=ce(m);w?(b.categoryValueRef=null,d(w,g,b)):d(null,b.categoryValueRef.$parent,b)}this.execute("label.create",function(m){var v=m.context,g=v.labelTarget;_(g,"bpmn:Group")&&h(g,v)}),this.revert("label.create",function(m){var v=m.context,g=v.labelTarget;_(g,"bpmn:Group")&&p(g,v)}),this.execute("shape.delete",function(m){var v=m.context,g=v.shape,w=ce(g);if(!(!_(g,"bpmn:Group")||g.labelTarget)){var b=v.categoryValue=w.categoryValueRef,x;b&&(x=v.category=b.$parent,d(b,x,w),w.categoryValueRef=null)}}),this.reverted("shape.delete",function(m){var v=m.context,g=v.shape;if(!(!_(g,"bpmn:Group")||g.labelTarget)){var w=v.category,b=v.categoryValue,x=ce(g);b&&(x.categoryValueRef=b,u(b,w))}}),this.execute("shape.create",function(m){var v=m.context,g=v.shape;!_(g,"bpmn:Group")||g.labelTarget||ce(g).categoryValueRef&&h(g,v)}),this.reverted("shape.create",function(m){var v=m.context,g=v.shape;!_(g,"bpmn:Group")||g.labelTarget||ce(g).categoryValueRef&&p(g,v)});function f(m,v){var g=t.create(m.$type);return s.copyElement(m,g,null,v)}r.on("copyPaste.copyElement",Wy,function(m){var v=m.descriptor,g=m.element;if(!(!_(g,"bpmn:Group")||g.labelTarget)){var w=ce(g);if(w.categoryValueRef){var b=w.categoryValueRef;v.categoryValue=f(b,!0),b.$parent&&(v.category=f(b.$parent,!0))}}}),r.on("copyPaste.pasteElement",Wy,function(m){var v=m.descriptor,g=v.businessObject,w=v.categoryValue,b=v.category;w&&(w=g.categoryValueRef=f(w)),b&&(w.$parent=f(b)),delete v.category,delete v.categoryValue})}ym.$inject=["bpmnFactory","bpmnjs","elementRegistry","eventBus","injector","moddleCopy"];fe(ym,Z);function Rp(t,e,n,r){var i,s,a,c,l;return i=(r.y-n.y)*(e.x-t.x)-(r.x-n.x)*(e.y-t.y),i==0?null:(s=t.y-n.y,a=t.x-n.x,l=(r.x-n.x)*s-(r.y-n.y)*a,c=l/i,{x:Math.round(t.x+c*(e.x-t.x)),y:Math.round(t.y+c*(e.y-t.y))})}function k1(t){function e(r,i,s){var a={x:s.x,y:s.y-50},c={x:s.x-50,y:s.y},l=Rp(r,i,s,a),d=Rp(r,i,s,c),u;l&&d?qy(l,s)>qy(d,s)?u=d:u=l:u=l||d,r.original=u}function n(r){var i=r.waypoints;e(i[0],i[1],we(r.source)),e(i[i.length-1],i[i.length-2],we(r.target))}t.on("bpmnElement.added",function(r){var i=r.element;i.waypoints&&n(i)})}k1.$inject=["eventBus"];function qy(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function xm(t){Z.call(this,t);var e=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(n){var r=n.context.shape,i=ce(r),s=at(r);if(Me(i,e)){var a=s.get("isHorizontal");a===void 0&&(a=!0),s.set("isHorizontal",a)}})}xm.$inject=["eventBus"];fe(xm,Z);var C1=Math.sqrt,P1=Math.min,cO=Math.max,Ky=Math.abs;function Yy(t){return Math.pow(t,2)}function _o(t,e){return C1(Yy(t.x-e.x)+Yy(t.y-e.y))}function lO(t,e){var n=0,r,i,s,a,c,l,d,u,h,p,f;for(n=0;n<e.length-1;n++){if(r=e[n],i=e[n+1],Xy(r,i)?d=[r]:(s=_o(t,r),a=_o(t,i),l=P1(s,a),d=dO(r,i,t,l)),d.length<1)throw new Error("expected between [1, 2] circle -> line intersections");d.length===1&&(u={type:"bendpoint",position:d[0],segmentIndex:n,bendpointIndex:Xy(r,d[0])?n:n+1}),d.length===2&&(c=hO(d[0],d[1]),u={type:"segment",position:c,segmentIndex:n,relativeLocation:_o(r,c)/_o(r,i)}),h=_o(u.position,t),(!f||p>h)&&(f=u,p=h)}return f}function dO(t,e,n,r){var i=e.x-t.x,s=e.y-t.y,a=n.x-t.x,c=n.y-t.y,l=i*i+s*s,d=i*a+s*c,u=a*a+c*c-r*r,h=d/l,p=u/l,f=h*h-p;if(f<0&&f>-1e-6&&(f=0),f<0)return[];var m=C1(f),v=-h+m,g=-h-m,w={x:t.x-i*v,y:t.y-s*v};if(f===0)return[w];var b={x:t.x-i*g,y:t.y-s*g};return[w,b].filter(function(x){return uO(x,t,e)})}function uO(t,e,n){return Zy(t.x,e.x,n.x)&&Zy(t.y,e.y,n.y)}function Zy(t,e,n){return t>=P1(e,n)-nd&&t<=cO(e,n)+nd}function hO(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}var nd=.1;function Xy(t,e){return Ky(t.x-e.x)<=nd&&Ky(t.y-e.y)<=nd}function pO(t,e,n,r){var i=n.segmentIndex,s=e.length-t.length;if(r.segmentMove){var a=r.segmentMove.segmentStartIndex,c=r.segmentMove.newSegmentStartIndex;return i===a?c:i>=c?i+s<c?c:i+s:i}if(r.bendpointMove){var l=r.bendpointMove.insert,d=r.bendpointMove.bendpointIndex,u;if(s===0)return i;if(i>=d&&(u=l?i+1:i-1),i<d&&(u=i,l&&n.type!=="bendpoint"&&d-1===i)){var h=R1(e,d);h<n.relativeLocation&&u++}return u}return s===0?i:r.connectionStart&&i===0?0:r.connectionEnd&&i===t.length-2?e.length-2:Math.floor((e.length-2)/2)}function T1(t,e,n,r){var i=0,s=0,a={point:t,delta:{x:0,y:0}},c=lO(t,n),l=c.segmentIndex,d=pO(n,e,c,r);if(d<0||d>e.length-2||d===null)return a;var u=Jy(n,l),h=Jy(e,d),p=c.position,f=mO(u,p),m=fO(u,h);if(c.type==="bendpoint"){var v=e.length-n.length,g=c.bendpointIndex,w=n[g];if(e.indexOf(w)!==-1)return a;if(v===0){var b=e[g];return i=b.x-c.position.x,s=b.y-c.position.y,{delta:{x:i,y:s},point:{x:t.x+i,y:t.y+s}}}v<0&&g!==0&&g<n.length-1&&(f=R1(n,g))}var x={x:(h[1].x-h[0].x)*f+h[0].x,y:(h[1].y-h[0].y)*f+h[0].y},E=iD({x:t.x-p.x,y:t.y-p.y},m);return i=x.x+E.x-t.x,s=x.y+E.y-t.y,{point:qo(x),delta:qo({x:i,y:s})}}function R1(t,e){var n=Jl(t[e-1],t[e]),r=Jl(t[e],t[e+1]),i=n/(n+r);return i}function fO(t,e){var n=_y(t),r=_y(e);return r-n}function Jy(t,e){return[t[e],t[e+1]]}function mO(t,e){var n=Jl(t[0],t[1]),r=Jl(t[0],e);return n===0?0:r/n}function gO(t,e,n,r){var i=we(t);return T1(i,e,n,r).delta}function kc(t,e,n){var r=Ho(e),i=Ho(n),s=cr(t,r),a={x:s.x*(n.width/e.width),y:s.y*(n.height/e.height)};return qo({x:i.x+a.x,y:i.y+a.y})}function Qy(t,e,n){var r=Ho(t),i=Ho(e),s=Ho(n),a=cr(t,r),c=cr(r,i),l=vO(r,e,n);if(l)return l;var d={x:c.x*(n.width/e.width),y:c.y*(n.height/e.height)},u={x:s.x+d.x,y:s.y+d.y};return qo({x:u.x+a.x-t.x,y:u.y+a.y-t.y})}function vO(t,e,n){var r=ye(e),i=ye(n);if(yO(r,i))return null;var s=Yt(e,t),a,c,l;if(s==="top")a={x:0,y:i.bottom-r.bottom};else if(s==="bottom")a={x:0,y:i.top-r.top};else if(s==="right")a={x:i.left-r.left,y:0};else if(s==="left")a={x:i.right-r.right,y:0};else return null;return c={x:t.x+a.x,y:t.y+a.y},l=Yt(n,c),l!==s?null:a}function yO(t,e){return xO(t,e)||bO(t,e)}function xO(t,e){return t.right!==e.right&&t.left!==e.left}function bO(t,e){return t.top!==e.top&&t.bottom!==e.bottom}var ex="name",tx="text";function bm(t,e,n,r){Z.call(this,t),this.postExecute("element.updateProperties",i),this.postExecute("element.updateModdleProperties",a=>{ce(a.context.element)===a.context.moddleElement&&i(a)});function i(a){var c=a.context,l=c.element,d=c.properties;if(ex in d&&e.updateLabel(l,d[ex]),tx in d&&_(l,"bpmn:TextAnnotation")){var u=r.getTextAnnotationBounds({x:l.x,y:l.y,width:l.width,height:l.height},d[tx]||"");e.updateLabel(l,d.text,u)}}this.postExecute(["shape.create","connection.create"],function(a){var c=a.context,l=c.hints||{};if(l.createElementsBehavior!==!1){var d=c.shape||c.connection;We(d)||!xa(d)||js(d)&&e.updateLabel(d,js(d))}}),this.postExecute("shape.delete",function(a){var c=a.context,l=c.labelTarget,d=c.hints||{};l&&d.unsetLabel!==!1&&e.updateLabel(l,null,null,{removeShape:!1})});function s(a){var c=a.context,l=c.connection,d=l.label,u=L({},c.hints),h=c.newWaypoints||l.waypoints,p=c.oldWaypoints;return typeof u.startChanged>"u"&&(u.startChanged=!!u.connectionStart),typeof u.endChanged>"u"&&(u.endChanged=!!u.connectionEnd),gO(d,h,p,u)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(a){var c=a.context,l=c.hints||{};if(l.labelBehavior!==!1){var d=c.connection,u=d.label,h;!u||!u.parent||(h=s(a),e.moveShape(u,h))}}),this.postExecute(["shape.replace"],function(a){var c=a.context,l=c.newShape,d=c.oldShape,u=ce(l);u&&xa(u)&&d.label&&l.label&&(l.label.x=d.label.x,l.label.y=d.label.y)}),this.postExecute("shape.resize",function(a){var c=a.context,l=c.shape,d=c.newBounds,u=c.oldBounds;if(Cd(l)){var h=l.label,p=we(h),f=EO(u),m=_O(p,f),v=wO(m,u,d);e.moveShape(h,v)}})}fe(bm,Z);bm.$inject=["eventBus","modeling","bpmnFactory","textRenderer"];function wO(t,e,n){var r=kc(t,e,n);return qo(cr(r,t))}function _O(t,e){if(e.length){var n=SO(t,e);return em(t,n)}}function EO(t){return[[{x:t.x,y:t.y},{x:t.x+(t.width||0),y:t.y}],[{x:t.x+(t.width||0),y:t.y},{x:t.x+(t.width||0),y:t.y+(t.height||0)}],[{x:t.x,y:t.y+(t.height||0)},{x:t.x+(t.width||0),y:t.y+(t.height||0)}],[{x:t.x,y:t.y},{x:t.x,y:t.y+(t.height||0)}]]}function SO(t,e){var n=e.map(function(i){return{line:i,distance:o1(t,i)}}),r=Kr(n,"distance");return r[0].line}function jO(t,e,n,r){return T1(t,e,n,r).point}function wm(t,e){Z.call(this,t);function n(r,i){var s=r.context,a=s.connection,c=L({},s.hints),l=s.newWaypoints||a.waypoints,d=s.oldWaypoints;return typeof c.startChanged>"u"&&(c.startChanged=!!c.connectionStart),typeof c.endChanged>"u"&&(c.endChanged=!!c.connectionEnd),jO(i,l,d,c)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(r){var i=r.context,s=i.connection,a=s.outgoing,c=s.incoming;c.forEach(function(l){var d=l.waypoints[l.waypoints.length-1],u=n(r,d),h=[].concat(l.waypoints.slice(0,-1),[u]);e.updateWaypoints(l,h)}),a.forEach(function(l){var d=l.waypoints[0],u=n(r,d),h=[].concat([u],l.waypoints.slice(1));e.updateWaypoints(l,h)})}),this.postExecute(["connection.move"],function(r){var i=r.context,s=i.connection,a=s.outgoing,c=s.incoming,l=i.delta;c.forEach(function(d){var u=d.waypoints[d.waypoints.length-1],h={x:u.x+l.x,y:u.y+l.y},p=[].concat(d.waypoints.slice(0,-1),[h]);e.updateWaypoints(d,p)}),a.forEach(function(d){var u=d.waypoints[0],h={x:u.x+l.x,y:u.y+l.y},p=[].concat([h],d.waypoints.slice(1));e.updateWaypoints(d,p)})})}fe(wm,Z);wm.$inject=["eventBus","modeling"];function eu(t,e,n){var r=nu(t),i=I1(r,e),s=r[0];return i.length?i[i.length-1]:kc(s.original||s,n,e)}function tu(t,e,n){var r=nu(t),i=I1(r,e),s=r[r.length-1];return i.length?i[0]:kc(s.original||s,n,e)}function _m(t,e,n){var r=nu(t),i=A1(e,n),s=r[0];return kc(s.original||s,i,e)}function Em(t,e,n){var r=nu(t),i=A1(e,n),s=r[r.length-1];return kc(s.original||s,i,e)}function A1(t,e){return{x:t.x-e.x,y:t.y-e.y,width:t.width,height:t.height}}function nu(t){var e=t.waypoints;if(!e.length)throw new Error("connection#"+t.id+": no waypoints");return e}function I1(t,e){var n=Rn(t,kO);return Ve(n,function(r){return NO(r,e)})}function NO(t,e){return Yt(e,t,1)==="intersect"}function kO(t){return t.original||t}function Sm(t,e){Z.call(this,t),this.postExecute("shape.replace",function(n){var r=n.oldShape,i=n.newShape;if(CO(r,i)){var s=PO(r);s.incoming.forEach(function(a){var c=tu(a,i,r);e.reconnectEnd(a,i,c)}),s.outgoing.forEach(function(a){var c=eu(a,i,r);e.reconnectStart(a,i,c)})}},!0)}Sm.$inject=["eventBus","modeling"];fe(Sm,Z);function CO(t,e){return _(t,"bpmn:Participant")&&Ze(t)&&_(e,"bpmn:Participant")&&!Ze(e)}function PO(t){var e=yc([t],!1),n=[],r=[];return e.forEach(function(i){i!==t&&(i.incoming.forEach(function(s){_(s,"bpmn:MessageFlow")&&n.push(s)}),i.outgoing.forEach(function(s){_(s,"bpmn:MessageFlow")&&r.push(s)}))},[]),{incoming:n,outgoing:r}}const TO=["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:EscalationEventDefinition","bpmn:ConditionalEventDefinition","bpmn:SignalEventDefinition"];function M1(t){const e=ce(t);if(!_(e,"bpmn:BoundaryEvent")&&!(_(e,"bpmn:StartEvent")&&cn(e.$parent)))return!1;const n=e.get("eventDefinitions");return!n||!n.length?!1:TO.some(r=>_(n[0],r))}function D1(t){return _(t,"bpmn:BoundaryEvent")?"cancelActivity":"isInterrupting"}function jm(t,e){t.invoke(Z,this),this.postExecuted("shape.replace",function(n){const r=n.context.oldShape,i=n.context.newShape,s=n.context.hints;if(!M1(i))return;const a=D1(i);if(s.targetElement&&s.targetElement[a]!==void 0)return;const l=ce(r).get(a),d=ce(i).get(a);l!==d&&e.updateProperties(i,{[a]:l})})}jm.$inject=["injector","modeling"];fe(jm,Z);function Nm(t,e){Z.call(this,t),this.preExecute("shape.resize",function(n){var r=n.shape,i=at(r),s=i&&i.get("label"),a=s&&s.get("bounds");a&&e.updateModdleProperties(r,s,{bounds:void 0})},!0)}fe(Nm,Z);Nm.$inject=["eventBus","modeling"];function km(t,e,n){Z.call(this,t),this.preExecute("shape.delete",function(r){var i=r.context.shape;if(!(i.incoming.length!==1||i.outgoing.length!==1)){var s=i.incoming[0],a=i.outgoing[0];if(!(!_(s,"bpmn:SequenceFlow")||!_(a,"bpmn:SequenceFlow"))&&e.canConnect(s.source,a.target,s)){var c=RO(s.waypoints,a.waypoints);n.reconnectEnd(s,a.target,c)}}})}fe(km,Z);km.$inject=["eventBus","bpmnRules","modeling"];function Ys(t){return t.original||t}function RO(t,e){var n=Rp(Ys(t[t.length-2]),Ys(t[t.length-1]),Ys(e[1]),Ys(e[0]));return n?[].concat(t.slice(0,t.length-1),[n],e.slice(1)):[Ys(t[0]),Ys(e[e.length-1])]}function Cm(t,e){Z.call(this,t),this.preExecute("shape.delete",function(n){var r=n.shape,i=r.parent;_(r,"bpmn:Participant")&&(n.collaborationRoot=i)},!0),this.postExecute("shape.delete",function(n){var r=n.collaborationRoot;if(r&&!r.businessObject.participants.length){var i=e.makeProcess(),s=r.children.slice();e.moveElements(s,{x:0,y:0},i)}},!0)}Cm.$inject=["eventBus","modeling"];fe(Cm,Z);function Pm(t,e,n,r){Z.call(this,t);var i=r.get("dragging",!1);function s(l){var d=l.source,u=l.target,h=l.parent;if(h){var p,f;_(l,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(d,u)||(f=!0),n.canConnectMessageFlow(d,u)&&(p="bpmn:MessageFlow")),_(l,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(d,u)||(f=!0),n.canConnectSequenceFlow(d,u)&&(p="bpmn:SequenceFlow")),f&&e.removeConnection(l),p&&e.connect(d,u,{type:p,waypoints:l.waypoints.slice()})}}function a(l){var d=l.context,u=d.connection,h=d.newSource||u.source,p=d.newTarget||u.target,f,m;f=n.canConnect(h,p),!(!f||f.type===u.type)&&(m=e.connect(h,p,{type:f.type,associationDirection:f.associationDirection,waypoints:u.waypoints.slice()}),u.parent&&e.removeConnection(u),d.connection=m,i&&c(u,m))}function c(l,d){var u=i.context(),h=u&&u.payload.previousSelection,p;!h||!h.length||(p=h.indexOf(l),p!==-1&&h.splice(p,1,d))}this.postExecuted("elements.move",function(l){var d=l.closure,u=d.allConnections;I(u,s)},!0),this.preExecute("connection.reconnect",a),this.postExecuted("element.updateProperties",function(l){var d=l.context,u=d.properties,h=d.element,p=h.businessObject,f;u.default&&(f=mt(h.outgoing,Vr({id:h.businessObject.default.id})),f&&e.updateProperties(f,{conditionExpression:void 0})),u.conditionExpression&&p.sourceRef.default===p&&e.updateProperties(h.source,{default:void 0})})}fe(Pm,Z);Pm.$inject=["eventBus","modeling","bpmnRules","injector"];function ru(t,e,n,r,i,s){r.invoke(Z,this),this._bpmnReplace=t,this._elementRegistry=n,this._selection=s,this.postExecuted(["elements.create"],500,function(a){var c=a.context,l=c.parent,d=c.elements,u=$i(d,function(h,p){var f=e.canReplace([p],p.host||p.parent||l);return f?h.concat(f.replacements):h},[]);u.length&&this._replaceElements(d,u)},this),this.postExecuted(["elements.move"],500,function(a){var c=a.context,l=c.newParent,d=c.newHost,u=[];I(c.closure.topLevel,function(p){cn(p)?u=u.concat(p.children):u=u.concat(p)}),u.length===1&&d&&(l=d);var h=e.canReplace(u,l);h&&this._replaceElements(u,h.replacements,d)},this),this.postExecute(["shape.replace"],1500,function(a){var c=a.context,l=c.oldShape,d=c.newShape,u=l.attachers,h;u&&u.length&&(h=e.canReplace(u,d),this._replaceElements(u,h.replacements))},this),this.postExecuted(["shape.replace"],1500,function(a){var c=a.context,l=c.oldShape,d=c.newShape;i.unclaimId(l.businessObject.id,l.businessObject),i.updateProperties(d,{id:l.id})})}fe(ru,Z);ru.prototype._replaceElements=function(t,e){var n=this._elementRegistry,r=this._bpmnReplace,i=this._selection;I(e,function(s){var a={type:s.newElementType},c=n.get(s.oldElementId),l=t.indexOf(c);t[l]=r.replaceElement(c,a,{select:!1})}),e&&i.select(t)};ru.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var AO=1500,IO={width:140,height:120},Tm={width:300,height:60},Rm={width:60,height:300},Ll={width:300,height:150},Bl={width:150,height:300},O1={width:140,height:120},$1={width:50,height:30};function L1(t){t.on("resize.start",AO,function(e){var n=e.context,r=n.shape,i=n.direction,s=n.balanced;(_(r,"bpmn:Lane")||_(r,"bpmn:Participant"))&&(n.resizeConstraints=LO(r,i,s)),_(r,"bpmn:SubProcess")&&Ze(r)&&(n.minDimensions=O1),_(r,"bpmn:TextAnnotation")&&(n.minDimensions=$1)})}L1.$inject=["eventBus"];var mi=Math.abs,MO=Math.min,DO=Math.max;function B1(t,e,n,r){var i=t[e];t[e]=i===void 0?n:r(n,i)}function Zs(t,e,n){return B1(t,e,n,MO)}function Xs(t,e,n){return B1(t,e,n,DO)}var OO={top:20,left:50,right:20,bottom:20},$O={top:50,left:20,right:20,bottom:20};function LO(t,e,n){var r=Bn(t),i=!0,s=!0,a=Jd(r,[r]),c=ye(t),l={},d={},u=Vt(t),h=u?Tm:Rm;/n/.test(e)?d.top=c.bottom-h.height:/e/.test(e)?d.right=c.left+h.width:/s/.test(e)?d.bottom=c.top+h.height:/w/.test(e)&&(d.left=c.right-h.width),a.forEach(function(m){var v=ye(m);u?(v.top<c.top-10&&(i=!1),v.bottom>c.bottom+10&&(s=!1)):(v.left<c.left-10&&(i=!1),v.right>c.right+10&&(s=!1)),/n/.test(e)&&(n&&mi(c.top-v.bottom)<10&&Xs(l,"top",v.top+h.height),mi(c.top-v.top)<5&&Zs(d,"top",v.bottom-h.height)),/e/.test(e)&&(n&&mi(c.right-v.left)<10&&Zs(l,"right",v.right-h.width),mi(c.right-v.right)<5&&Xs(d,"right",v.left+h.width)),/s/.test(e)&&(n&&mi(c.bottom-v.top)<10&&Zs(l,"bottom",v.bottom-h.height),mi(c.bottom-v.bottom)<5&&Xs(d,"bottom",v.top+h.height)),/w/.test(e)&&(n&&mi(c.left-v.right)<10&&Xs(l,"left",v.left+h.width),mi(c.left-v.left)<5&&Zs(d,"left",v.right-h.width))});var p=r.children.filter(function(m){return!m.hidden&&!m.waypoints&&(_(m,"bpmn:FlowElement")||_(m,"bpmn:Artifact"))}),f=u?OO:$O;return p.forEach(function(m){var v=ye(m);/n/.test(e)&&(!u||i)&&Zs(d,"top",v.top-f.top),/e/.test(e)&&(u||s)&&Xs(d,"right",v.right+f.right),/s/.test(e)&&(!u||s)&&Xs(d,"bottom",v.bottom+f.bottom),/w/.test(e)&&(u||i)&&Zs(d,"left",v.left-f.left)}),{min:d,max:l}}var nx=1001;function F1(t,e){t.on("resize.start",nx+500,function(n){var r=n.context,i=r.shape;(_(i,"bpmn:Lane")||_(i,"bpmn:Participant"))&&(r.balanced=!Ko(n))}),t.on("resize.end",nx,function(n){var r=n.context,i=r.shape,s=r.canExecute,a=r.newBounds;if(_(i,"bpmn:Lane")||_(i,"bpmn:Participant"))return s&&(a=Rw(a),e.resizeLane(i,a,r.balanced)),!1})}F1.$inject=["eventBus","modeling"];var BO=500;function Am(t,e,n,r,i){n.invoke(Z,this);function s(u){return Me(u,["bpmn:ReceiveTask","bpmn:SendTask"])||FO(u,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function a(u){var h=t.getDefinitions(),p=h.get("rootElements");return!!mt(p,Vr({id:u.id}))}function c(u){if(_(u,"bpmn:ErrorEventDefinition"))return"errorRef";if(_(u,"bpmn:EscalationEventDefinition"))return"escalationRef";if(_(u,"bpmn:MessageEventDefinition"))return"messageRef";if(_(u,"bpmn:SignalEventDefinition"))return"signalRef"}function l(u){if(Me(u,["bpmn:ReceiveTask","bpmn:SendTask"]))return u.get("messageRef");var h=u.get("eventDefinitions"),p=h[0];return p.get(c(p))}function d(u,h){if(Me(u,["bpmn:ReceiveTask","bpmn:SendTask"]))return u.set("messageRef",h);var p=u.get("eventDefinitions"),f=p[0];return f.set(c(f),h)}this.executed(["shape.create","element.updateProperties","element.updateModdleProperties"],function(u){var h=u.shape||u.element;if(s(h)){var p=ce(h),f=l(p),m;f&&!a(f)&&(m=t.getDefinitions().get("rootElements"),Ot(m,f),u.addedRootElement=f)}},!0),this.reverted(["shape.create","element.updateProperties","element.updateModdleProperties"],function(u){var h=u.addedRootElement;if(h){var p=t.getDefinitions().get("rootElements");At(p,h)}},!0),e.on("copyPaste.copyElement",function(u){var h=u.descriptor,p=u.element;if(!(p.labelTarget||!s(p))){var f=ce(p),m=l(f);m&&(h.referencedRootElement=m)}}),e.on("copyPaste.pasteElement",BO,function(u){var h=u.descriptor,p=h.businessObject,f=h.referencedRootElement;f&&(a(f)||(f=r.copyElement(f,i.create(f.$type))),d(p,f),delete h.referencedRootElement)})}Am.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"];fe(Am,Z);function FO(t,e){return Ue(e)||(e=[e]),xc(e,function(n){return gf(t,n)})}var z1=Math.max;function U1(t){t.on("spaceTool.getMinDimensions",function(e){var n=e.shapes,r=e.axis,i=e.start,s={};return I(n,function(a){var c=a.id;_(a,"bpmn:Participant")&&(s[c]=UO(a,r,i)),_(a,"bpmn:Lane")&&(s[c]=Vt(a)?Tm:Rm),_(a,"bpmn:SubProcess")&&Ze(a)&&(s[c]=O1),_(a,"bpmn:TextAnnotation")&&(s[c]=$1),_(a,"bpmn:Group")&&(s[c]=IO)}),s})}U1.$inject=["eventBus"];function zO(t){return t==="x"}function UO(t,e,n){var r=Vt(t);if(!GO(t))return r?Ll:Bl;var i=zO(e),s={};return i?r?s=Ll:s={width:VO(t,n,i),height:Bl.height}:r?s={width:Ll.width,height:HO(t,n,i)}:s=Bl,s}function HO(t,e,n){var r;return r=WO(t,e,n),z1(Ll.height,r)}function VO(t,e,n){var r;return r=qO(t,e,n),z1(Bl.width,r)}function GO(t){return!!zi(t).length}function WO(t,e,n){var r=zi(t),i;return i=Im(r,e,n),t.height-i.height+Tm.height}function qO(t,e,n){var r=zi(t),i;return i=Im(r,e,n),t.width-i.width+Rm.width}function Im(t,e,n){var r,i,s;for(r=0;r<t.length;r++)if(i=t[r],!n&&e>=i.y&&e<=i.y+i.height||n&&e>=i.x&&e<=i.x+i.width)return s=zi(i),s.length?Im(s,e,n):i}var rx=400,KO=600,ix={x:180,y:160};function Ui(t,e,n,r,i,s,a){Z.call(this,e),this._canvas=t,this._eventBus=e,this._modeling=n,this._elementFactory=r,this._bpmnFactory=i,this._bpmnjs=s,this._elementRegistry=a;var c=this;function l(h){return _(h,"bpmn:SubProcess")&&!Ze(h)}function d(h){var p=h.shape,f=h.newRootElement,m=ce(p);f=c._addDiagram(f||m),h.newRootElement=t.addRootElement(f)}function u(h){var p=h.shape,f=ce(p);c._removeDiagram(f);var m=h.newRootElement=a.get(ea(f));t.removeRootElement(m)}this.executed("shape.create",function(h){var p=h.shape;l(p)&&d(h)},!0),this.postExecuted("shape.create",function(h){var p=h.shape,f=h.newRootElement;!f||!p.children||(c._showRecursively(p.children),c._moveChildrenToShape(p,f))},!0),this.reverted("shape.create",function(h){var p=h.shape;l(p)&&u(h)},!0),this.preExecuted("shape.delete",function(h){var p=h.shape;if(l(p)){var f=a.get(ea(p));f&&n.removeElements(f.children.slice())}},!0),this.executed("shape.delete",function(h){var p=h.shape;l(p)&&u(h)},!0),this.reverted("shape.delete",function(h){var p=h.shape;l(p)&&d(h)},!0),this.preExecuted("shape.replace",function(h){var p=h.oldShape,f=h.newShape;!l(p)||!l(f)||(h.oldRoot=t.removeRootElement(ea(p)))},!0),this.postExecuted("shape.replace",function(h){var p=h.newShape,f=h.oldRoot,m=t.findRoot(ea(p));if(!(!f||!m)){var v=f.children;n.moveElements(v,{x:0,y:0},m)}},!0),this.executed("element.updateProperties",function(h){var p=h.element;if(_(p,"bpmn:SubProcess")){var f=h.properties,m=h.oldProperties,v=m.id,g=f.id;if(v!==g){if(Al(p)){a.updateId(p,is(g)),a.updateId(v,g);return}var w=a.get(is(v));w&&a.updateId(is(v),is(g))}}},!0),this.reverted("element.updateProperties",function(h){var p=h.element;if(_(p,"bpmn:SubProcess")){var f=h.properties,m=h.oldProperties,v=m.id,g=f.id;if(v!==g){if(Al(p)){a.updateId(p,is(v)),a.updateId(g,v);return}var w=a.get(is(g));w&&a.updateId(w,is(v))}}},!0),e.on("element.changed",function(h){var p=h.element;if(Al(p)){var f=p,m=a.get(Jg(f));!m||m===f||e.fire("element.changed",{element:m})}}),this.executed("shape.toggleCollapse",rx,function(h){var p=h.shape;_(p,"bpmn:SubProcess")&&(Ze(p)?u(h):(d(h),c._showRecursively(p.children)))},!0),this.reverted("shape.toggleCollapse",rx,function(h){var p=h.shape;_(p,"bpmn:SubProcess")&&(Ze(p)?u(h):(d(h),c._showRecursively(p.children)))},!0),this.postExecuted("shape.toggleCollapse",KO,function(h){var p=h.shape;if(_(p,"bpmn:SubProcess")){var f=h.newRootElement;f&&(Ze(p)?c._moveChildrenToShape(f,p):c._moveChildrenToShape(p,f))}},!0),e.on("copyPaste.createTree",function(h){var p=h.element,f=h.children;if(l(p)){var m=ea(p),v=a.get(m);v&&f.push.apply(f,v.children)}}),e.on("copyPaste.copyElement",function(h){var p=h.descriptor,f=h.element,m=h.elements,v=f.parent,g=_(at(v),"bpmndi:BPMNPlane");if(g){var w=Jg(v),b=mt(m,function(x){return x.id===w});b&&(p.parent=b.id)}}),e.on("copyPaste.pasteElement",function(h){var p=h.descriptor;p.parent&&(l(p.parent)||p.parent.hidden)&&(p.hidden=!0)})}fe(Ui,Z);Ui.prototype._moveChildrenToShape=function(t,e){var n=this._modeling,r=t.children,i;if(r){r=r.concat(r.reduce(function(d,u){return u.label&&u.label.parent!==t?d.concat(u.label):d},[]));var s=r.filter(function(d){return!d.hidden});if(!s.length){n.moveElements(r,{x:0,y:0},e,{autoResize:!1});return}var a=gn(s);if(!e.x)i={x:ix.x-a.x,y:ix.y-a.y};else{var c=we(e),l=we(a);i={x:c.x-l.x,y:c.y-l.y}}n.moveElements(r,i,e,{autoResize:!1})}};Ui.prototype._showRecursively=function(t,e){var n=this,r=[];return t.forEach(function(i){i.hidden=!!e,r=r.concat(i),i.children&&(r=r.concat(n._showRecursively(i.children,i.collapsed||e)))}),r};Ui.prototype._addDiagram=function(t){var e=this._bpmnjs,n=e.getDefinitions().diagrams;return t.businessObject||(t=this._createNewDiagram(t)),n.push(t.di.$parent),t};Ui.prototype._createNewDiagram=function(t){var e=this._bpmnFactory,n=this._elementFactory,r=e.create("bpmndi:BPMNPlane",{bpmnElement:t}),i=e.create("bpmndi:BPMNDiagram",{plane:r});r.$parent=i;var s=n.createRoot({id:ea(t),type:t.$type,di:r,businessObject:t,collapsed:!0});return s};Ui.prototype._removeDiagram=function(t){var e=this._bpmnjs,n=e.getDefinitions().diagrams,r=mt(n,function(i){return i.plane.bpmnElement.id===t.id});return n.splice(n.indexOf(r),1),r};Ui.$inject=["canvas","eventBus","modeling","elementFactory","bpmnFactory","bpmnjs","elementRegistry"];function Mm(t,e){t.invoke(Z,this),this.postExecuted("shape.replace",function(n){var r=n.context.oldShape,i=n.context.newShape;if(!(!_(i,"bpmn:SubProcess")||_(i,"bpmn:AdHocSubProcess")||!(_(r,"bpmn:Task")||_(r,"bpmn:CallActivity"))||!Ze(i))){var s=YO(i);e.createShape({type:"bpmn:StartEvent"},s,i)}})}Mm.$inject=["injector","modeling"];fe(Mm,Z);function YO(t){return{x:t.x+t.width/6,y:t.y+t.height/2}}function Dm(t){Z.call(this,t),this.preExecute("connection.create",function(e){const{target:n}=e;_(n,"bpmn:TextAnnotation")&&(e.parent=n.parent)},!0),this.preExecute(["shape.create","shape.resize","elements.move"],function(e){const n=e.shapes||[e.shape];n.length===1&&_(n[0],"bpmn:TextAnnotation")&&(e.hints=e.hints||{},e.hints.autoResize=!1)},!0)}fe(Dm,Z);Dm.$inject=["eventBus"];function Om(t,e){Z.call(this,t),this.postExecuted("shape.toggleCollapse",1500,function(n){var r=n.shape;if(Ze(r))return;var i=yc(r);i.forEach(function(a){var c=a.incoming.slice(),l=a.outgoing.slice();I(c,function(d){s(d,!0)}),I(l,function(d){s(d,!1)})});function s(a,c){i.indexOf(a.source)!==-1&&i.indexOf(a.target)!==-1||(c?e.reconnectEnd(a,r,we(r)):e.reconnectStart(a,r,we(r)))}},!0)}fe(Om,Z);Om.$inject=["eventBus","modeling"];var Ch=500;function $m(t,e,n){Z.call(this,t);function r(a){a.length&&a.forEach(function(c){c.type==="label"&&!c.businessObject.name&&(c.hidden=!0)})}function i(a,c){var l=a.children,d=c,u,h;return u=ZO(l).concat([a]),h=j1(u),h?(d.width=Math.max(h.width,d.width),d.height=Math.max(h.height,d.height),d.x=h.x+(h.width-d.width)/2,d.y=h.y+(h.height-d.height)/2):(d.x=a.x+(a.width-d.width)/2,d.y=a.y+(a.height-d.height)/2),d}function s(a,c){return{x:a.x+(a.width-c.width)/2,y:a.y+(a.height-c.height)/2,width:c.width,height:c.height}}this.executed(["shape.toggleCollapse"],Ch,function(a){var c=a.context,l=c.shape;_(l,"bpmn:SubProcess")&&(l.collapsed?at(l).isExpanded=!1:(r(l.children),at(l).isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],Ch,function(a){var c=a.context,l=c.shape;l.collapsed?at(l).isExpanded=!1:at(l).isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],Ch,function(a){var c=a.context.shape,l=e.getDefaultSize(c),d;c.collapsed?d=s(c,l):d=i(c,l),n.resizeShape(c,d,null,{autoResize:c.collapsed?!1:"nwse"})})}fe($m,Z);$m.$inject=["eventBus","elementFactory","modeling"];function ZO(t){return t.filter(function(e){return!e.hidden})}function Lm(t,e,n,r){e.invoke(Z,this),this.preExecute("shape.delete",function(i){var s=i.context,a=s.shape,c=a.businessObject;We(a)||(_(a,"bpmn:Participant")&&Ze(a)&&n.ids.unclaim(c.processRef.id),r.unclaimId(c.id,c))}),this.preExecute("connection.delete",function(i){var s=i.context,a=s.connection,c=a.businessObject;r.unclaimId(c.id,c)}),this.preExecute("canvas.updateRoot",function(){var i=t.getRootElement(),s=i.businessObject;_(i,"bpmn:Collaboration")&&n.ids.unclaim(s.id)})}fe(Lm,Z);Lm.$inject=["canvas","injector","moddle","modeling"];function Bm(t,e){Z.call(this,t),this.preExecute("connection.delete",function(n){var r=n.context,i=r.connection,s=i.source;XO(i,s)&&e.updateProperties(s,{default:null})})}fe(Bm,Z);Bm.$inject=["eventBus","modeling"];function XO(t,e){if(!_(t,"bpmn:SequenceFlow"))return!1;var n=ce(e),r=ce(t);return n.get("default")===r}var JO=500,QO=5e3;function Fm(t,e){Z.call(this,t);var n;function r(){return n=n||new e5,n.enter(),n}function i(){if(!n)throw new Error("out of bounds release");return n}function s(){if(!n)throw new Error("out of bounds release");var c=n.leave();return c&&(e.updateLaneRefs(n.flowNodes,n.lanes),n=null),c}var a=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(a,QO,function(c){r()}),this.postExecuted(a,JO,function(c){s()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(c){var l=c.context,d=l.shape,u=i();d.labelTarget||(_(d,"bpmn:Lane")&&u.addLane(d),_(d,"bpmn:FlowNode")&&u.addFlowNode(d))})}Fm.$inject=["eventBus","modeling"];fe(Fm,Z);function e5(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(t){this.lanes.push(t)},this.addFlowNode=function(t){this.flowNodes.push(t)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}function zm(t,e){Z.call(this,t),this.postExecuted("elements.create",function(n){const r=n.context,i=r.elements;for(const s of i)t5(s)&&!r5(s)&&e.updateProperties(s,{isForCompensation:void 0})})}fe(zm,Z);zm.$inject=["eventBus","modeling"];function t5(t){const e=ce(t);return e&&e.isForCompensation}function n5(t){return t&&_(t,"bpmn:BoundaryEvent")&&gf(t,"bpmn:CompensateEventDefinition")}function r5(t){return t.incoming.filter(n=>n5(n.source)).length>0}const i5={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","compensateBoundaryEventBehaviour","createBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","fixHoverBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","layoutConnectionBehavior","messageFlowBehavior","nonInterruptingBehavior","removeElementBehavior","removeEmbeddedLabelBoundsBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","rootElementReferenceBehavior","spaceToolBehavior","subProcessPlaneBehavior","subProcessStartEventBehavior","textAnnotationBehavior","toggleCollapseConnectionBehaviour","toggleElementCollapseBehaviour","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior","setCompensationActivityAfterPasteBehavior"],adaptiveLabelPositioningBehavior:["type",sm],appendBehavior:["type",am],associationBehavior:["type",om],attachEventBehavior:["type",Zd],boundaryEventBehavior:["type",cm],compensateBoundaryEventBehaviour:["type",lm],createBehavior:["type",dm],createDataObjectBehavior:["type",um],createParticipantBehavior:["type",hm],dataInputAssociationBehavior:["type",pm],dataStoreBehavior:["type",fm],deleteLaneBehavior:["type",mm],detachEventBehavior:["type",Qd],dropOnFlowBehavior:["type",gm],eventBasedGatewayBehavior:["type",vm],fixHoverBehavior:["type",N1],groupBehavior:["type",ym],importDockingFix:["type",k1],isHorizontalFix:["type",xm],labelBehavior:["type",bm],layoutConnectionBehavior:["type",wm],messageFlowBehavior:["type",Sm],nonInterruptingBehavior:["type",jm],removeElementBehavior:["type",km],removeEmbeddedLabelBoundsBehavior:["type",Nm],removeParticipantBehavior:["type",Cm],replaceConnectionBehavior:["type",Pm],replaceElementBehaviour:["type",ru],resizeBehavior:["type",L1],resizeLaneBehavior:["type",F1],rootElementReferenceBehavior:["type",Am],spaceToolBehavior:["type",U1],subProcessPlaneBehavior:["type",Ui],subProcessStartEventBehavior:["type",Mm],textAnnotationBehavior:["type",Dm],toggleCollapseConnectionBehaviour:["type",Om],toggleElementCollapseBehaviour:["type",$m],unclaimIdBehavior:["type",Lm],unsetDefaultFlowBehavior:["type",Bm],updateFlowNodeRefsBehavior:["type",Fm],setCompensationActivityAfterPasteBehavior:["type",zm]};function H1(t,e){var n=Yt(t,e,-15);return n!=="intersect"?n:null}function Gt(t){Gn.call(this,t)}fe(Gt,Gn);Gt.$inject=["eventBus"];Gt.prototype.init=function(){this.addRule("connection.start",function(t){var e=t.source;return s5(e)}),this.addRule("connection.create",function(t){var e=t.source,n=t.target,r=t.hints||{},i=r.targetParent,s=r.targetAttach;if(s)return!1;i&&(n.parent=i);try{return Fl(e,n)}finally{i&&(n.parent=null)}}),this.addRule("connection.reconnect",function(t){var e=t.connection,n=t.source,r=t.target;return Fl(n,r,e)}),this.addRule("connection.updateWaypoints",function(t){return{type:t.connection.type}}),this.addRule("shape.resize",function(t){var e=t.shape,n=t.newBounds;return J1(e,n)}),this.addRule("elements.create",function(t){var e=t.elements,n=t.position,r=t.target;return lt(r)&&!rd(e,r)?!1:_d(e,function(i){return lt(i)?Fl(i.source,i.target,i):i.host?Vo(i,i.host,null,n):Dp(i,r,null)})}),this.addRule("elements.move",function(t){var e=t.target,n=t.shapes,r=t.position;return Vo(n,e,null,r)||Z1(n,e,r)||X1(n,e)||rd(n,e)}),this.addRule("shape.create",function(t){return Dp(t.shape,t.target,t.source,t.position)}),this.addRule("shape.attach",function(t){return Vo(t.shape,t.target,null,t.position)}),this.addRule("element.copy",function(t){var e=t.element,n=t.elements;return rE(n,e)})};Gt.prototype.canConnectMessageFlow=tE;Gt.prototype.canConnectSequenceFlow=nE;Gt.prototype.canConnectDataAssociation=Hm;Gt.prototype.canConnectAssociation=Q1;Gt.prototype.canConnectCompensationAssociation=eE;Gt.prototype.canMove=X1;Gt.prototype.canAttach=Vo;Gt.prototype.canReplace=Z1;Gt.prototype.canDrop=Pa;Gt.prototype.canInsert=rd;Gt.prototype.canCreate=Dp;Gt.prototype.canConnect=Fl;Gt.prototype.canResize=J1;Gt.prototype.canCopy=rE;function s5(t){return Ap(t)?null:Me(t,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"])}function Ap(t){return!t||We(t)}function a5(t,e){return t===e}function sx(t){do{if(_(t,"bpmn:Process"))return ce(t);if(_(t,"bpmn:Participant"))return ce(t).processRef||ce(t)}while(t=t.parent)}function Ip(t){return _(t,"bpmn:TextAnnotation")}function Um(t){return _(t,"bpmn:Group")&&!t.labelTarget}function V1(t){return _(t,"bpmn:BoundaryEvent")&&_r(t,"bpmn:CompensateEventDefinition")}function iu(t){return ce(t).isForCompensation}function o5(t,e){var n=sx(t),r=sx(e);return n===r}function c5(t){return _(t,"bpmn:InteractionNode")&&!_(t,"bpmn:BoundaryEvent")&&(!_(t,"bpmn:Event")||_(t,"bpmn:ThrowEvent")&&W1(t,"bpmn:MessageEventDefinition"))}function l5(t){return _(t,"bpmn:InteractionNode")&&!iu(t)&&(!_(t,"bpmn:Event")||_(t,"bpmn:CatchEvent")&&W1(t,"bpmn:MessageEventDefinition"))&&!(_(t,"bpmn:BoundaryEvent")&&!_r(t,"bpmn:MessageEventDefinition"))}function ax(t){for(var e=t;e=e.parent;){if(_(e,"bpmn:FlowElementsContainer"))return ce(e);if(_(e,"bpmn:Participant"))return ce(e).processRef}return null}function G1(t,e){var n=ax(t),r=ax(e);return n===r}function _r(t,e){var n=ce(t);return!!mt(n.eventDefinitions||[],function(r){return _(r,e)})}function W1(t,e){var n=ce(t);return(n.eventDefinitions||[]).every(function(r){return _(r,e)})}function d5(t){return _(t,"bpmn:FlowNode")&&!_(t,"bpmn:EndEvent")&&!cn(t)&&!(_(t,"bpmn:IntermediateThrowEvent")&&_r(t,"bpmn:LinkEventDefinition"))&&!V1(t)&&!iu(t)}function u5(t){return _(t,"bpmn:FlowNode")&&!_(t,"bpmn:StartEvent")&&!_(t,"bpmn:BoundaryEvent")&&!cn(t)&&!(_(t,"bpmn:IntermediateCatchEvent")&&_r(t,"bpmn:LinkEventDefinition"))&&!iu(t)}function h5(t){return _(t,"bpmn:ReceiveTask")||_(t,"bpmn:IntermediateCatchEvent")&&(_r(t,"bpmn:MessageEventDefinition")||_r(t,"bpmn:TimerEventDefinition")||_r(t,"bpmn:ConditionalEventDefinition")||_r(t,"bpmn:SignalEventDefinition"))}function p5(t){for(var e=[];t;)t=t.parent,t&&e.push(t);return e}function Mp(t,e){var n=p5(e);return n.indexOf(t)!==-1}function Fl(t,e,n){if(Ap(t)||Ap(e))return null;if(!_(n,"bpmn:DataAssociation")){if(tE(t,e))return{type:"bpmn:MessageFlow"};if(nE(t,e))return{type:"bpmn:SequenceFlow"}}var r=Hm(t,e);return r||(eE(t,e)?{type:"bpmn:Association",associationDirection:"One"}:Q1(t,e)?{type:"bpmn:Association",associationDirection:"None"}:!1)}function Pa(t,e){return We(t)||Um(t)?!0:_(e,"bpmn:Participant")&&!Ze(e)?!1:_(t,"bpmn:Participant")?_(e,"bpmn:Process")||_(e,"bpmn:Collaboration"):Me(t,["bpmn:DataInput","bpmn:DataOutput"])&&t.parent?e===t.parent:_(t,"bpmn:Lane")?_(e,"bpmn:Participant")||_(e,"bpmn:Lane"):_(t,"bpmn:BoundaryEvent")&&!f5(t)?!1:_(t,"bpmn:FlowElement")&&!_(t,"bpmn:DataStoreReference")?_(e,"bpmn:FlowElementsContainer")?Ze(e):Me(e,["bpmn:Participant","bpmn:Lane"]):_(t,"bpmn:DataStoreReference")&&_(e,"bpmn:Collaboration")?xc(ce(e).get("participants"),function(n){return!!n.get("processRef")}):Me(t,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?Me(e,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):_(t,"bpmn:MessageFlow")?_(e,"bpmn:Collaboration")||t.source.parent==e||t.target.parent==e:!1}function f5(t){return ce(t).cancelActivity&&(q1(t)||K1(t))}function m5(t){return!We(t)&&_(t,"bpmn:BoundaryEvent")}function g5(t){return _(t,"bpmn:Lane")}function v5(t){return m5(t)||_(t,"bpmn:IntermediateThrowEvent")&&q1(t)?!0:_(t,"bpmn:IntermediateCatchEvent")&&K1(t)}function q1(t){var e=ce(t);return e&&!(e.eventDefinitions&&e.eventDefinitions.length)}function K1(t){return Y1(t,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function Y1(t,e){return e.some(function(n){return _r(t,n)})}function y5(t){return _(t,"bpmn:ReceiveTask")&&mt(t.incoming,function(e){return _(e.source,"bpmn:EventBasedGateway")})}function Vo(t,e,n,r){if(Array.isArray(t)||(t=[t]),t.length!==1)return!1;var i=t[0];return We(i)||!v5(i)||cn(e)||!_(e,"bpmn:Activity")||iu(e)||r&&!H1(r,e)||y5(e)?!1:"attach"}function Z1(t,e,n){if(!e)return!1;var r={replacements:[]};return I(t,function(i){cn(e)||_(i,"bpmn:StartEvent")&&i.type!=="label"&&Pa(i,e)&&(tC(i)||r.replacements.push({oldElementId:i.id,newElementType:"bpmn:StartEvent"}),(nC(i)||rC(i)||iC(i))&&r.replacements.push({oldElementId:i.id,newElementType:"bpmn:StartEvent"}),Y1(i,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&_(e,"bpmn:SubProcess")&&r.replacements.push({oldElementId:i.id,newElementType:"bpmn:StartEvent"})),_(e,"bpmn:Transaction")||_r(i,"bpmn:CancelEventDefinition")&&i.type!=="label"&&(_(i,"bpmn:EndEvent")&&Pa(i,e)&&r.replacements.push({oldElementId:i.id,newElementType:"bpmn:EndEvent"}),_(i,"bpmn:BoundaryEvent")&&Vo(i,e,null,n)&&r.replacements.push({oldElementId:i.id,newElementType:"bpmn:BoundaryEvent"}))}),r.replacements.length?r:!1}function X1(t,e){return xc(t,g5)?!1:e?t.every(function(n){return Pa(n,e)}):!0}function Dp(t,e,n,r){return e?We(t)||Um(t)?!0:a5(n,e)||n&&Mp(n,e)?!1:Pa(t,e)||rd(t,e):!1}function J1(t,e){return _(t,"bpmn:SubProcess")?Ze(t)&&(!e||e.width>=100&&e.height>=80):!!(_(t,"bpmn:Lane")||_(t,"bpmn:Participant")||Ip(t)||Um(t))}function x5(t,e){var n=Ip(t),r=Ip(e);return(n||r)&&n!==r}function Q1(t,e){return Mp(e,t)||Mp(t,e)?!1:x5(t,e)?!0:!!Hm(t,e)}function eE(t,e){return G1(t,e)&&V1(t)&&_(e,"bpmn:Activity")&&!w5(e,t)&&!cn(e)}function tE(t,e){return ox(t)&&!ox(e)?!1:c5(t)&&l5(e)&&!o5(t,e)}function nE(t,e){return d5(t)&&u5(e)&&G1(t,e)&&!(_(t,"bpmn:EventBasedGateway")&&!h5(e))}function Hm(t,e){return Me(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&Me(e,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:Me(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&Me(t,["bpmn:Activity","bpmn:CatchEvent"])?{type:"bpmn:DataOutputAssociation"}:!1}function rd(t,e,n){if(!e)return!1;if(Array.isArray(t)){if(t.length!==1)return!1;t=t[0]}return e.source===t||e.target===t?!1:Me(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!We(e)&&_(t,"bpmn:FlowNode")&&!_(t,"bpmn:BoundaryEvent")&&Pa(t,e.parent)}function b5(t,e){return t&&e&&t.indexOf(e)!==-1}function rE(t,e){return We(e)?!0:!(_(e,"bpmn:Lane")&&!b5(t,e.parent))}function ox(t){return ka(t,"bpmn:Process")||ka(t,"bpmn:Collaboration")}function w5(t,e){return t.attachers.includes(e)}const _5={__depends__:[Cr],__init__:["bpmnRules"],bpmnRules:["type",Gt]};var E5=2e3;function iE(t,e){t.on("saveXML.start",E5,n);function n(){var r=e.getRootElements();I(r,function(i){var s=at(i),a,c;a=yc([i],!1),a=Ve(a,function(l){return l!==i&&!l.labelTarget}),c=Rn(a,at),s.set("planeElement",c)})}}iE.$inject=["eventBus","canvas"];const S5={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",iE]};function su(t){Z.call(this,t);var e=this;this.preExecute(["shape.create","connection.create"],function(n){var r=n.context,i=r.shape||r.connection,s=r.parent,a=e.getOrdering(i,s);a&&(a.parent!==void 0&&(r.parent=a.parent),r.parentIndex=a.index)}),this.preExecute(["shape.move","connection.move"],function(n){var r=n.context,i=r.shape||r.connection,s=r.newParent||i.parent,a=e.getOrdering(i,s);a&&(a.parent!==void 0&&(r.newParent=a.parent),r.newParentIndex=a.index)})}su.prototype.getOrdering=function(t,e){return null};fe(su,Z);function Vm(t,e){su.call(this,t);var n=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:9,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:TextAnnotation",order:{level:9}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function r(a){if(a.labelTarget)return{level:10};var c=mt(n,function(l){return Me(a,[l.type])});return c&&c.order||{level:1}}function i(a){var c=a.order;if(c||(a.order=c=r(a)),!c)throw new Error(`no order for <${a.id}>`);return c}function s(a,c,l){for(var d=c;d&&!Me(d,l);)d=d.parent;if(!d)throw new Error(`no parent for <${a.id}> in <${c&&c.id}>`);return d}this.getOrdering=function(a,c){if(a.labelTarget||_(a,"bpmn:TextAnnotation"))return{parent:e.findRoot(c)||e.getRootElement(),index:-1};var l=i(a);l.containers&&(c=s(a,c,l.containers));var d=c.children.indexOf(a),u=sC(c.children,function(h){return!a.labelTarget&&h.labelTarget?!1:l.level<i(h).level});return u!==-1&&d!==-1&&d<u&&(u-=1),{index:u,parent:c}}}Vm.$inject=["eventBus","canvas"];fe(Vm,su);const j5={__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",Vm]};function Cc(){}Cc.prototype.get=function(){return this._data};Cc.prototype.set=function(t){this._data=t};Cc.prototype.clear=function(){var t=this._data;return delete this._data,t};Cc.prototype.isEmpty=function(){return!this._data};const N5={clipboard:["type",Cc]};var k5="drop-ok",cx="drop-not-ok",lx="attach-ok",dx="new-parent",ux="create",C5=2e3;function sE(t,e,n,r,i){function s(l,d,u,h,p){if(!d)return!1;l=Ve(l,function(b){var x=b.labelTarget;return!b.parent&&!(We(b)&&l.indexOf(x)!==-1)});var f=mt(l,function(b){return!lt(b)}),m=!1,v=!1,g=!1;px(l)&&(m=i.allowed("shape.attach",{position:u,shape:f,target:d})),m||(px(l)?g=i.allowed("shape.create",{position:u,shape:f,source:h,target:d}):g=i.allowed("elements.create",{elements:l,position:u,target:d}));var w=p.connectionTarget;return g||m?(f&&h&&(v=i.allowed("connection.create",{source:w===h?f:h,target:w===h?h:f,hints:{targetParent:d,targetAttach:m}})),{attach:m,connect:v}):g===null||m===null?null:!1}function a(l,d){[lx,k5,cx,dx].forEach(function(u){u===d?t.addMarker(l,u):t.removeMarker(l,u)})}n.on(["create.move","create.hover"],function(l){var d=l.context,u=d.elements,h=l.hover,p=d.source,f=d.hints||{};if(!h){d.canExecute=!1,d.target=null;return}hx(l);var m={x:l.x,y:l.y},v=d.canExecute=h&&s(u,h,m,p,f);h&&v!==null&&(d.target=h,v&&v.attach?a(h,lx):a(h,v?dx:cx))}),n.on(["create.end","create.out","create.cleanup"],function(l){var d=l.hover;d&&a(d,null)}),n.on("create.end",function(l){var d=l.context,u=d.source,h=d.shape,p=d.elements,f=d.target,m=d.canExecute,v=m&&m.attach,g=m&&m.connect,w=d.hints||{};if(m===!1||!f)return!1;hx(l);var b={x:l.x,y:l.y};g?h=r.appendShape(u,h,b,f,{attach:v,connection:g===!0?{}:g,connectionTarget:w.connectionTarget}):(p=r.createElements(p,b,f,L({},w,{attach:v})),h=mt(p,function(x){return!lt(x)})),L(d,{elements:p,shape:h}),L(l,{elements:p,shape:h})});function c(){var l=e.context();l&&l.prefix===ux&&e.cancel()}n.on("create.init",function(){n.on("elements.changed",c),n.once(["create.cancel","create.end"],C5,function(){n.off("elements.changed",c)})}),this.start=function(l,d,u){Ue(d)||(d=[d]);var h=mt(d,function(m){return!lt(m)});if(h){u=L({elements:d,hints:{},shape:h},u||{}),I(d,function(m){ze(m.x)||(m.x=0),ze(m.y)||(m.y=0)});var p=Ve(d,function(m){return!m.hidden}),f=gn(p);I(d,function(m){lt(m)&&(m.waypoints=Rn(m.waypoints,function(v){return{x:v.x-f.x-f.width/2,y:v.y-f.y-f.height/2}})),L(m,{x:m.x-f.x-f.width/2,y:m.y-f.y-f.height/2})}),e.init(l,ux,{cursor:"grabbing",autoActivate:!0,data:{shape:h,elements:d,context:u}})}}}sE.$inject=["canvas","dragging","eventBus","modeling","rules"];function hx(t){var e=t.context,n=e.createConstraints;n&&(n.left&&(t.x=Math.max(t.x,n.left)),n.right&&(t.x=Math.min(t.x,n.right)),n.top&&(t.y=Math.max(t.y,n.top)),n.bottom&&(t.y=Math.min(t.y,n.bottom)))}function px(t){return t&&t.length===1&&!lt(t[0])}var P5=750;function aE(t,e,n,r,i){function s(a){var c=ie("g");Y(c,i.cls("djs-drag-group",["no-events"]));var l=ie("g");return a.forEach(function(d){var u;d.hidden||(d.waypoints?(u=n._createContainer("connection",l),n.drawConnection(sa(u),d)):(u=n._createContainer("shape",l),n.drawShape(sa(u),d),an(u,d.x,d.y)),r.addDragger(d,c,u))}),c}e.on("create.move",P5,function(a){var c=a.hover,l=a.context,d=l.elements,u=l.dragGroup;u||(u=l.dragGroup=s(d));var h;c?(u.parentNode||(h=t.getActiveLayer(),ae(h,u)),an(u,a.x,a.y)):on(u)}),e.on("create.cleanup",function(a){var c=a.context,l=c.dragGroup;l&&on(l)})}aE.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];const au={__depends__:[Qr,Ya,Cr,Nr],__init__:["create","createPreview"],create:["type",sE],createPreview:["type",aE]};function Gm(t){var e=this;this._lastMoveEvent=null;function n(r){e._lastMoveEvent=r}t.on("canvas.init",function(r){var i=e._svg=r.svg;i.addEventListener("mousemove",n)}),t.on("canvas.destroy",function(){e._lastMouseEvent=null,e._svg.removeEventListener("mousemove",n)})}Gm.$inject=["eventBus"];Gm.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||T5(0,0)};function T5(t,e){var n=document.createEvent("MouseEvent"),r=t,i=e,s=t,a=e;return n.initMouseEvent&&n.initMouseEvent("mousemove",!0,!0,window,0,r,i,s,a,!1,!1,!1,!1,0,null),n}const Pc={__init__:["mouse"],mouse:["type",Gm]};function ur(t,e,n,r,i,s,a,c){this._canvas=t,this._create=e,this._clipboard=n,this._elementFactory=r,this._eventBus=i,this._modeling=s,this._mouse=a,this._rules=c,i.on("copyPaste.copyElement",function(l){var d=l.descriptor,u=l.element,h=l.elements;d.priority=1,d.id=u.id;var p=mt(h,function(f){return f===u.parent});p&&(d.parent=u.parent.id),R5(u)&&(d.priority=2,d.host=u.host.id),lt(u)&&(d.priority=3,d.source=u.source.id,d.target=u.target.id,d.waypoints=A5(u)),We(u)&&(d.priority=4,d.labelTarget=u.labelTarget.id),I(["x","y","width","height"],function(f){ze(u[f])&&(d[f]=u[f])}),d.hidden=u.hidden,d.collapsed=u.collapsed}),i.on("copyPaste.pasteElements",function(l){var d=l.hints;L(d,{createElementsBehavior:!1})})}ur.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"];ur.prototype.copy=function(t){var e,n;return Ue(t)||(t=t?[t]:[]),e=this._eventBus.fire("copyPaste.canCopyElements",{elements:t}),e===!1?n={}:n=this.createTree(Ue(e)?e:t),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:t,tree:n}),n};ur.prototype.paste=function(t){var e=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=t&&t.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var r=this._createElements(e);if(t&&t.element&&t.point)return this._paste(r,t.element,t.point,n);this._create.start(this._mouse.getLastMoveEvent(),r,{hints:n||{}})}};ur.prototype._paste=function(t,e,n,r){I(t,function(s){ze(s.x)||(s.x=0),ze(s.y)||(s.y=0)});var i=gn(t);return I(t,function(s){lt(s)&&(s.waypoints=Rn(s.waypoints,function(a){return{x:a.x-i.x-i.width/2,y:a.y-i.y-i.height/2}})),L(s,{x:s.x-i.x-i.width/2,y:s.y-i.y-i.height/2})}),this._modeling.createElements(t,n,e,L({},r))};ur.prototype._createElements=function(t){var e=this,n=this._eventBus,r={},i=[];return I(t,function(s,a){s=Kr(s,"priority"),I(s,function(c){var l=L({},Xr(c,["priority"]));r[c.parent]?l.parent=r[c.parent]:delete l.parent,n.fire("copyPaste.pasteElement",{cache:r,descriptor:l});var d;if(lt(l)){l.source=r[c.source],l.target=r[c.target],d=r[c.id]=e.createConnection(l),i.push(d);return}if(We(l)){l.labelTarget=r[l.labelTarget],d=r[c.id]=e.createLabel(l),i.push(d);return}l.host&&(l.host=r[l.host]),d=r[c.id]=e.createShape(l),i.push(d)})}),i};ur.prototype.createConnection=function(t){var e=this._elementFactory.createConnection(Xr(t,["id"]));return e};ur.prototype.createLabel=function(t){var e=this._elementFactory.createLabel(Xr(t,["id"]));return e};ur.prototype.createShape=function(t){var e=this._elementFactory.createShape(Xr(t,["id"]));return e};ur.prototype.hasRelations=function(t,e){var n,r,i;return!(lt(t)&&(r=mt(e,Vr({id:t.source.id})),i=mt(e,Vr({id:t.target.id})),!r||!i)||We(t)&&(n=mt(e,Vr({id:t.labelTarget.id})),!n))};ur.prototype.createTree=function(t){var e=this._rules,n=this,r={},i=[],s=Ed(t);function a(d,u){return e.allowed("element.copy",{element:d,elements:u})}function c(d,u){var h=mt(i,function(p){return d===p.element});if(!h){i.push({element:d,depth:u});return}h.depth<u&&(i=l(h,i),i.push({element:h.element,depth:u}))}function l(d,u){var h=u.indexOf(d);return h!==-1&&u.splice(h,1),u}return Pd(s,function(d,u,h){if(We(d))return;I(d.labels,function(m){c(m,h)});function p(m){m&&m.length&&I(m,function(v){I(v.labels,function(g){c(g,h)}),c(v,h)})}I([d.attachers,d.incoming,d.outgoing],p),c(d,h);var f=[];return d.children&&(f=d.children.slice()),n._eventBus.fire("copyPaste.createTree",{element:d,children:f}),f}),t=Rn(i,function(d){return d.element}),i=Rn(i,function(d){return d.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:d.descriptor,element:d.element,elements:t}),d}),i=Kr(i,function(d){return d.descriptor.priority}),t=Rn(i,function(d){return d.element}),I(i,function(d){var u=d.depth;if(!n.hasRelations(d.element,t)){mx(d.element,t);return}if(!a(d.element,t)){mx(d.element,t);return}r[u]||(r[u]=[]),r[u].push(d.descriptor)}),r};function R5(t){return!!t.host}function A5(t){return Rn(t.waypoints,function(e){return e=fx(e),e.original&&(e.original=fx(e.original)),e})}function fx(t){return L({},t)}function mx(t,e){var n=e.indexOf(t);return n===-1?e:e.splice(n,1)}const I5={__depends__:[N5,au,Pc,Cr],__init__:["copyPaste"],copyPaste:["type",ur]};function Ph(t,e,n){Ue(n)||(n=[n]),I(n,function(r){Aw(t[r])||(e[r]=t[r])})}var Th=750;function oE(t,e,n){function r(l,d){var u=t.create(l.$type);return n.copyElement(l,u,null,d)}e.on("copyPaste.copyElement",Th,function(l){var d=l.descriptor,u=l.element,h=ce(u);if(We(u))return d;var p=d.businessObject=r(h,!0),f=d.di=r(at(u),!0);f.bpmnElement=p,Ph(p,d,"name"),Ph(f,d,"isExpanded"),h.default&&(d.default=h.default.id)});var i="-bpmn-js-refs";function s(l){return l[i]=l[i]||{}}function a(l,d){l[i]=d}function c(l,d,u){var h=ce(l);return l.default&&(u[l.default]={element:h,property:"default"}),l.host&&(ce(l).attachedToRef=ce(d[l.host])),Xr(u,$i(u,function(p,f,m){var v=f.element,g=f.property;return m===l.id&&(v.set(g,h),p.push(l.id)),p},[]))}e.on("copyPaste.pasteElement",function(l){var d=l.cache,u=l.descriptor,h=u.businessObject,p=u.di;if(We(u)){u.businessObject=ce(d[u.labelTarget]),u.di=at(d[u.labelTarget]);return}h=u.businessObject=r(h),p=u.di=r(p),p.bpmnElement=h,Ph(u,h,["isExpanded","name"]),u.type=h.$type}),e.on("copyPaste.copyElement",Th,function(l){var d=l.descriptor,u=l.element;if(_(u,"bpmn:Participant")){var h=ce(u);h.processRef&&(d.processRef=r(h.processRef,!0))}}),e.on("copyPaste.pasteElement",function(l){var d=l.descriptor,u=d.processRef;u&&(d.processRef=r(u))}),e.on("copyPaste.pasteElement",Th,function(l){var d=l.cache,u=l.descriptor;a(d,c(u,d,s(d)))})}oE.$inject=["bpmnFactory","eventBus","moddleCopy"];const M5=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing","categoryValue"],D5=["errorRef","escalationRef","messageRef","signalRef"];function Tc(t,e,n){this._bpmnFactory=e,this._eventBus=t,this._moddle=n,t.on("moddleCopy.canCopyProperties",r=>{const{propertyNames:i}=r;if(!(!i||!i.length))return Kr(i,s=>s==="extensionElements")}),t.on("moddleCopy.canCopyProperty",r=>{const{parent:i,property:s,propertyName:a}=r,c=Yr(i)&&i.$descriptor;if(a&&D5.includes(a))return s;if(a&&M5.includes(a)||a&&c&&!mt(c.properties,Vr({name:a})))return!1}),t.on("moddleCopy.canSetCopiedProperty",r=>{const{property:i}=r;if(_(i,"bpmn:ExtensionElements")&&(!i.values||!i.values.length))return!1})}Tc.$inject=["eventBus","bpmnFactory","moddle"];Tc.prototype.copyElement=function(t,e,n,r=!1){n&&!Ue(n)&&(n=[n]),n=n||Op(t.$descriptor);const i=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:t,targetElement:e,clone:r});return i===!1||(Ue(i)&&(n=i),I(n,s=>{let a;Pi(t,s)&&(a=t.get(s));const c=this.copyProperty(a,e,s,r);!Pn(c)||this._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:e,property:c,propertyName:s})===!1||e.set(s,c)})),e};Tc.prototype.copyProperty=function(t,e,n,r=!1){let i=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:e,property:t,propertyName:n,clone:r});if(i===!1)return;if(i)return Yr(i)&&i.$type&&!i.$parent&&(i.$parent=e),i;const s=this._moddle.getPropertyDescriptor(e,n);if(!s.isReference)return s.isId?t&&this._copyId(t,e,r):Ue(t)?$i(t,(a,c)=>{const l=this.copyProperty(c,e,n,r);return l?a.concat(l):a},[]):Yr(t)&&t.$type?this._moddle.getElementDescriptor(t).isGeneric?void 0:(i=this._bpmnFactory.create(t.$type),i.$parent=e,i=this.copyElement(t,i,null,r),i):t};Tc.prototype._copyId=function(t,e,n=!1){if(n)return t;if(!this._moddle.ids.assigned(t))return this._moddle.ids.claim(t,e),t};function Op(t,e){return $i(t.properties,(n,r)=>e&&r.default?n:n.concat(r.name),[])}const cE={__depends__:[I5],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",oE],moddleCopy:["type",Tc]};var gx=Math.round;function Wm(t,e){this._modeling=t,this._eventBus=e}Wm.$inject=["modeling","eventBus"];Wm.prototype.replaceElement=function(t,e,n){if(t.waypoints)return null;var r=this._modeling,i=this._eventBus;i.fire("replace.start",{element:t,attrs:e,hints:n});var s=e.width||t.width,a=e.height||t.height,c=e.x||t.x,l=e.y||t.y,d=gx(c+s/2),u=gx(l+a/2),h=r.replaceShape(t,L({},e,{x:d,y:u,width:s,height:a}),n);return i.fire("replace.end",{element:t,newElement:h,hints:n}),h};function lE(t,e){e.on("replace.end",500,function(n){const{newElement:r,hints:i={}}=n;i.select!==!1&&t.select(r)})}lE.$inject=["selection","eventBus"];const O5={__init__:["replace","replaceSelectionBehavior"],replaceSelectionBehavior:["type",lE],replace:["type",Wm]};function $5(t,e,n){Ue(n)||(n=[n]),I(n,function(r){Aw(t[r])||(e[r]=t[r])})}var L5=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function B5(t,e){var n=t&&Pi(t,"collapsed")?t.collapsed:!Ze(t),r;return e&&(Pi(e,"collapsed")||Pi(e,"isExpanded"))?r=Pi(e,"collapsed")?e.collapsed:!e.isExpanded:r=n,n!==r}function dE(t,e,n,r,i,s){function a(c,l,d){d=d||{};var u=l.type,h=c.businessObject;if(_l(h)&&(u==="bpmn:SubProcess"||u==="bpmn:AdHocSubProcess")&&B5(c,l))return r.toggleCollapse(c),c;var p=t.create(u),f={type:u,businessObject:p};f.di={},u==="bpmn:ExclusiveGateway"&&(f.di.isMarkerVisible=!0),$5(c.di,f.di,["fill","stroke","background-color","border-color","color"]);var m=Op(h.$descriptor),v=Op(p.$descriptor,!0),g=F5(m,v);L(p,jr(l,L5));var w=Ve(g,function(E){return E==="eventDefinitions"?vx(c,l.eventDefinitionType):E==="loopCharacteristics"?!cn(p):Pi(p,E)||E==="processRef"&&l.isExpanded===!1||E==="triggeredByEvent"?!1:E==="isForCompensation"?!cn(p):!0});if(p=n.copyElement(h,p,w),l.eventDefinitionType&&(vx(p,l.eventDefinitionType)||(f.eventDefinitionType=l.eventDefinitionType,f.eventDefinitionAttrs=l.eventDefinitionAttrs)),_(h,"bpmn:Activity")){if(_l(h))f.isExpanded=Ze(c);else if(l&&Pi(l,"isExpanded")){f.isExpanded=l.isExpanded;var b=e.getDefaultSize(p,{isExpanded:f.isExpanded});f.width=b.width,f.height=b.height,f.x=c.x-(f.width-c.width)/2,f.y=c.y-(f.height-c.height)/2}Ze(c)&&!_(h,"bpmn:Task")&&f.isExpanded&&(f.width=c.width,f.height=c.height)}if(_l(h)&&!_l(p)&&(d.moveChildren=!1),_(h,"bpmn:Participant")){l.isExpanded===!0?p.processRef=t.create("bpmn:Process"):d.moveChildren=!1;var x=Vt(c);at(c).isHorizontal||(at(f).isHorizontal=x),f.width=x?c.width:e.getDefaultSize(f).width,f.height=x?e.getDefaultSize(f).height:c.height}return s.allowed("shape.resize",{shape:p})||(f.height=e.getDefaultSize(f).height,f.width=e.getDefaultSize(f).width),p.name=h.name,Me(h,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&Me(p,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(p.default=h.default),l.host&&!_(h,"bpmn:BoundaryEvent")&&_(p,"bpmn:BoundaryEvent")&&(f.host=l.host),(f.type==="bpmn:DataStoreReference"||f.type==="bpmn:DataObjectReference")&&(f.x=c.x+(c.width-f.width)/2),i.replaceElement(c,f,{...d,targetElement:l})}this.replaceElement=a}dE.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules"];function _l(t){return _(t,"bpmn:SubProcess")}function vx(t,e){var n=ce(t);return e&&n.get("eventDefinitions").some(function(r){return _(r,e)})}function F5(t,e){return t.filter(function(n){return e.includes(n)})}const uE={__depends__:[cE,O5,Nr],bpmnReplace:["type",dE]};var z5=250;function Rs(t){this._eventBus=t,this._tools=[],this._active=null}Rs.$inject=["eventBus"];Rs.prototype.registerTool=function(t,e){var n=this._tools;if(!e)throw new Error(`A tool has to be registered with it's "events"`);n.push(t),this.bindEvents(t,e)};Rs.prototype.isActive=function(t){return t&&this._active===t};Rs.prototype.length=function(t){return this._tools.length};Rs.prototype.setActive=function(t){var e=this._eventBus;this._active!==t&&(this._active=t,e.fire("tool-manager.update",{tool:t}))};Rs.prototype.bindEvents=function(t,e){var n=this._eventBus,r=[];n.on(e.tool+".init",function(i){var s=i.context;if(!s.reactivate&&this.isActive(t)){this.setActive(null);return}this.setActive(t)},this),I(e,function(i){r.push(i+".ended"),r.push(i+".canceled")}),n.on(r,z5,function(i){this._active&&(U5(i)||this.setActive(null))},this)};function U5(t){var e=t.originalEvent&&t.originalEvent.target;return e&&gc(e,'.group[data-group="tools"]')}const ou={__depends__:[Qr],__init__:["toolManager"],toolManager:["type",Rs]};function H5(t,e){if(t==="x"){if(e>0)return"e";if(e<0)return"w"}if(t==="y"){if(e>0)return"s";if(e<0)return"n"}return null}function V5(t,e){var n=[];return I(t.concat(e),function(r){var i=r.incoming,s=r.outgoing;I(i.concat(s),function(a){var c=a.source,l=a.target;(Eo(t,c)||Eo(t,l)||Eo(e,c)||Eo(e,l))&&(Eo(n,a)||n.push(a))})}),n}function Eo(t,e){return t.indexOf(e)!==-1}function G5(t,e,n){var r=t.x,i=t.y,s=t.width,a=t.height,c=n.x,l=n.y;switch(e){case"n":return{x:r,y:i+l,width:s,height:a-l};case"s":return{x:r,y:i,width:s,height:a+l};case"w":return{x:r+c,y:i,width:s-c,height:a};case"e":return{x:r,y:i,width:s+c,height:a};default:throw new Error("unknown direction: "+e)}}var Rh=Math.abs,W5=Math.round,$r={x:"width",y:"height"},hE="crosshair",gi={n:"top",w:"left",s:"bottom",e:"right"},q5=1500,El={n:"s",w:"e",s:"n",e:"w"},Sl=20;function Wn(t,e,n,r,i,s,a){this._canvas=t,this._dragging=e,this._eventBus=n,this._modeling=r,this._rules=i,this._toolManager=s,this._mouse=a;var c=this;s.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",function(l){n.once("spaceTool.selection.ended",function(){c.activateMakeSpace(l.originalEvent)})}),n.on("spaceTool.move",q5,function(l){var d=l.context,u=d.initialized;u||(u=d.initialized=c.init(l,d)),u&&xx(l)}),n.on("spaceTool.end",function(l){var d=l.context,u=d.axis,h=d.direction,p=d.movingShapes,f=d.resizingShapes,m=d.start;if(d.initialized){xx(l);var v={x:0,y:0};v[u]=W5(l["d"+u]),c.makeSpace(p,f,v,h,m),n.once("spaceTool.ended",function(g){c.activateSelection(g.originalEvent,!0,!0)})}})}Wn.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"];Wn.prototype.activateSelection=function(t,e,n){this._dragging.init(t,"spaceTool.selection",{autoActivate:e,cursor:hE,data:{context:{reactivate:n}},trapClick:!1})};Wn.prototype.activateMakeSpace=function(t){this._dragging.init(t,"spaceTool",{autoActivate:!0,cursor:hE,data:{context:{}}})};Wn.prototype.makeSpace=function(t,e,n,r,i){return this._modeling.createSpace(t,e,n,r,i)};Wn.prototype.init=function(t,e){var n=Rh(t.dx)>Rh(t.dy)?"x":"y",r=t["d"+n],i=t[n]-r;if(Rh(r)<5)return!1;r<0&&(r*=-1),Ko(t)&&(r*=-1);var s=H5(n,r),a=this._canvas.getRootElement();!qh(t)&&t.hover&&(a=t.hover);var c=[...yc(a,!0),...a.attachers||[]],l=this.calculateAdjustments(c,n,r,i),d=this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:s,shapes:l.resizingShapes,start:i}),u=K5(l,n,s,i,d);return L(e,l,{axis:n,direction:s,spaceToolConstraints:u,start:i}),Ud("resize-"+(n==="x"?"ew":"ns")),!0};Wn.prototype.calculateAdjustments=function(t,e,n,r){var i=this._rules,s=[],a=[],c=[],l=[];function d(p){s.includes(p)||s.push(p);var f=p.label;f&&!s.includes(f)&&s.push(f)}function u(p){a.includes(p)||a.push(p)}I(t,function(p){if(!(!p.parent||We(p))){if(lt(p)){l.push(p);return}var f=p[e],m=f+p[$r[e]];if(Y5(p)&&(n>0&&we(p)[e]>r||n<0&&we(p)[e]<r)){c.push(p);return}if(n>0&&f>r||n<0&&m<r){d(p);return}if(f<r&&m>r&&i.allowed("shape.resize",{shape:p})){u(p);return}}}),I(s,function(p){var f=p.attachers;f&&I(f,function(m){d(m)})});var h=s.concat(a);return I(c,function(p){var f=p.host;ms(h,f)&&d(p)}),h=s.concat(a),I(l,function(p){var f=p.source,m=p.target,v=p.label;ms(h,f)&&ms(h,m)&&v&&d(v)}),{movingShapes:s,resizingShapes:a}};Wn.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var t=this._mouse.getLastMoveEvent();this.activateSelection(t,!!t)};Wn.prototype.isActive=function(){var t=this._dragging.context();return t?/^spaceTool/.test(t.prefix):!1};function yx(t){return{top:t.top-Sl,right:t.right+Sl,bottom:t.bottom+Sl,left:t.left-Sl}}function xx(t){var e=t.context,n=e.spaceToolConstraints;if(n){var r,i;ze(n.left)&&(r=Math.max(t.x,n.left),t.dx=t.dx+r-t.x,t.x=r),ze(n.right)&&(r=Math.min(t.x,n.right),t.dx=t.dx+r-t.x,t.x=r),ze(n.top)&&(i=Math.max(t.y,n.top),t.dy=t.dy+i-t.y,t.y=i),ze(n.bottom)&&(i=Math.min(t.y,n.bottom),t.dy=t.dy+i-t.y,t.y=i)}}function K5(t,e,n,r,i){var s=t.movingShapes,a=t.resizingShapes;if(a.length){var c={},l,d;return I(a,function(u){var h=u.attachers,p=u.children,f=ye(u),m=Ve(p,function($){return!lt($)&&!We($)&&!ms(s,$)&&!ms(a,$)}),v=Ve(p,function($){return!lt($)&&!We($)&&ms(s,$)}),g,w,b,x=[],E=[],N,j,C,R;m.length&&(w=yx(ye(gn(m))),g=r-f[gi[n]]+w[gi[n]],n==="n"?c.bottom=d=ze(d)?Math.min(d,g):g:n==="w"?c.right=d=ze(d)?Math.min(d,g):g:n==="s"?c.top=l=ze(l)?Math.max(l,g):g:n==="e"&&(c.left=l=ze(l)?Math.max(l,g):g)),v.length&&(b=yx(ye(gn(v))),g=r-b[gi[El[n]]]+f[gi[El[n]]],n==="n"?c.bottom=d=ze(d)?Math.min(d,g):g:n==="w"?c.right=d=ze(d)?Math.min(d,g):g:n==="s"?c.top=l=ze(l)?Math.max(l,g):g:n==="e"&&(c.left=l=ze(l)?Math.max(l,g):g)),h&&h.length&&(h.forEach(function($){ms(s,$)?x.push($):E.push($)}),x.length&&(N=ye(gn(x.map(we))),j=f[gi[El[n]]]-(N[gi[El[n]]]-r)),E.length&&(C=ye(gn(E.map(we))),R=C[gi[n]]-(f[gi[n]]-r)),n==="n"?(g=Math.min(j||1/0,R||1/0),c.bottom=d=ze(d)?Math.min(d,g):g):n==="w"?(g=Math.min(j||1/0,R||1/0),c.right=d=ze(d)?Math.min(d,g):g):n==="s"?(g=Math.max(j||-1/0,R||-1/0),c.top=l=ze(l)?Math.max(l,g):g):n==="e"&&(g=Math.max(j||-1/0,R||-1/0),c.left=l=ze(l)?Math.max(l,g):g));var T=i&&i[u.id];T&&(n==="n"?(g=r+u[$r[e]]-T[$r[e]],c.bottom=d=ze(d)?Math.min(d,g):g):n==="w"?(g=r+u[$r[e]]-T[$r[e]],c.right=d=ze(d)?Math.min(d,g):g):n==="s"?(g=r-u[$r[e]]+T[$r[e]],c.top=l=ze(l)?Math.max(l,g):g):n==="e"&&(g=r-u[$r[e]]+T[$r[e]],c.left=l=ze(l)?Math.max(l,g):g))}),c}}function ms(t,e){return t.indexOf(e)!==-1}function Y5(t){return!!t.host}var Ah="djs-dragging",bx="djs-resizing",Z5=250,jl=Math.max;function pE(t,e,n,r,i){function s(a,c){I(a,function(l){i.addDragger(l,c),n.addMarker(l,Ah)})}t.on("spaceTool.selection.start",function(a){var c=n.getLayer("space"),l=a.context,d={x:"M 0,-10000 L 0,10000",y:"M -10000,0 L 10000,0"},u=ie("g");Y(u,r.cls("djs-crosshair-group",["no-events"])),ae(c,u);var h=ie("path");Y(h,"d",d.x),dt(h).add("djs-crosshair"),ae(u,h);var p=ie("path");Y(p,"d",d.y),dt(p).add("djs-crosshair"),ae(u,p),l.crosshairGroup=u}),t.on("spaceTool.selection.move",function(a){var c=a.context.crosshairGroup;an(c,a.x,a.y)}),t.on("spaceTool.selection.cleanup",function(a){var c=a.context,l=c.crosshairGroup;l&&on(l)}),t.on("spaceTool.move",Z5,function(a){var c=a.context,l=c.line,d=c.axis,u=c.movingShapes,h=c.resizingShapes;if(c.initialized){if(!c.dragGroup){var p=n.getLayer("space");l=ie("path"),Y(l,"d","M0,0 L0,0"),dt(l).add("djs-crosshair"),ae(p,l),c.line=l;var f=ie("g");Y(f,r.cls("djs-drag-group",["no-events"])),ae(n.getActiveLayer(),f),s(u,f);var m=c.movingConnections=e.filter(function(E){var N=!1;I(u,function(T){I(T.outgoing,function($){E===$&&(N=!0)})});var j=!1;I(u,function(T){I(T.incoming,function($){E===$&&(j=!0)})});var C=!1;I(h,function(T){I(T.outgoing,function($){E===$&&(C=!0)})});var R=!1;return I(h,function(T){I(T.incoming,function($){E===$&&(R=!0)})}),lt(E)&&(N||C)&&(j||R)});s(m,f),c.dragGroup=f}if(!c.frameGroup){var v=ie("g");Y(v,r.cls("djs-frame-group",["no-events"])),ae(n.getActiveLayer(),v);var g=[];I(h,function(E){var N=i.addFrame(E,v),j=N.getBBox();g.push({element:N,initialBounds:j}),n.addMarker(E,bx)}),c.frameGroup=v,c.frames=g}var w={x:"M"+a.x+", -10000 L"+a.x+", 10000",y:"M -10000, "+a.y+" L 10000, "+a.y};Y(l,{d:w[d]});var b={x:"y",y:"x"},x={x:a.dx,y:a.dy};x[b[c.axis]]=0,an(c.dragGroup,x.x,x.y),I(c.frames,function(E){var N=E.element,j=E.initialBounds,C,R;c.direction==="e"?Y(N,{width:jl(j.width+x.x,5)}):(C=jl(j.width-x.x,5),Y(N,{width:C,x:j.x+j.width-C})),c.direction==="s"?Y(N,{height:jl(j.height+x.y,5)}):(R=jl(j.height-x.y,5),Y(N,{height:R,y:j.y+j.height-R}))})}}),t.on("spaceTool.cleanup",function(a){var c=a.context,l=c.movingShapes,d=c.movingConnections,u=c.resizingShapes,h=c.line,p=c.dragGroup,f=c.frameGroup;I(l,function(m){n.removeMarker(m,Ah)}),I(d,function(m){n.removeMarker(m,Ah)}),p&&(on(h),on(p)),I(u,function(m){n.removeMarker(m,bx)}),f&&on(f)})}pE.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];const X5={__init__:["spaceToolPreview"],__depends__:[Qr,Cr,ou,Ya,Pc],spaceTool:["type",Wn],spaceToolPreview:["type",pE]};function cu(t,e){t.invoke(Wn,this),this._canvas=e}cu.$inject=["injector","canvas"];fe(cu,Wn);cu.prototype.calculateAdjustments=function(t,e,n,r){var i=this._canvas.getRootElement(),s=t[0]===i?null:t[0],a=[];s&&(a=jd(Iw(i.children.filter(d=>_(d,"bpmn:Artifact")),gn(s))));const c=[...t,...a];var l=Wn.prototype.calculateAdjustments.call(this,c,e,n,r);return l.resizingShapes=l.resizingShapes.filter(function(d){return!(_(d,"bpmn:TextAnnotation")||J5(d)&&(e==="y"&&Vt(d)||e==="x"&&!Vt(d)))}),l};function J5(t){return _(t,"bpmn:Participant")&&!ce(t).processRef}const fE={__depends__:[X5],spaceTool:["type",cu]};function wt(t,e){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=e,this._eventBus=t,this._uid=1,t.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}wt.$inject=["eventBus","injector"];wt.prototype.execute=function(t,e){if(!t)throw new Error("command required");this._currentExecution.trigger="execute";const n={command:t,context:e};this._pushAction(n),this._internalExecute(n),this._popAction()};wt.prototype.canExecute=function(t,e){const n={command:t,context:e},r=this._getHandler(t);let i=this._fire(t,"canExecute",n);if(i===void 0){if(!r)return!1;r.canExecute&&(i=r.canExecute(e))}return i};wt.prototype.clear=function(t){this._stack.length=0,this._stackIdx=-1,t!==!1&&this._fire("changed",{trigger:"clear"})};wt.prototype.undo=function(){let t=this._getUndoAction(),e;if(t){for(this._currentExecution.trigger="undo",this._pushAction(t);t&&(this._internalUndo(t),e=this._getUndoAction(),!(!e||e.id!==t.id));)t=e;this._popAction()}};wt.prototype.redo=function(){let t=this._getRedoAction(),e;if(t){for(this._currentExecution.trigger="redo",this._pushAction(t);t&&(this._internalExecute(t,!0),e=this._getRedoAction(),!(!e||e.id!==t.id));)t=e;this._popAction()}};wt.prototype.register=function(t,e){this._setHandler(t,e)};wt.prototype.registerHandler=function(t,e){if(!t||!e)throw new Error("command and handlerCls must be defined");const n=this._injector.instantiate(e);this.register(t,n)};wt.prototype.canUndo=function(){return!!this._getUndoAction()};wt.prototype.canRedo=function(){return!!this._getRedoAction()};wt.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]};wt.prototype._getUndoAction=function(){return this._stack[this._stackIdx]};wt.prototype._internalUndo=function(t){const e=t.command,n=t.context,r=this._getHandler(e);this._atomicDo(()=>{this._fire(e,"revert",t),r.revert&&this._markDirty(r.revert(n)),this._revertedAction(t),this._fire(e,"reverted",t)})};wt.prototype._fire=function(t,e,n){arguments.length<3&&(n=e,e=null);const r=e?[t+"."+e,e]:[t];let i;n=this._eventBus.createEvent(n);for(const s of r)if(i=this._eventBus.fire("commandStack."+s,n),n.cancelBubble)break;return i};wt.prototype._createId=function(){return this._uid++};wt.prototype._atomicDo=function(t){const e=this._currentExecution;e.atomic=!0;try{t()}finally{e.atomic=!1}};wt.prototype._internalExecute=function(t,e){const n=t.command,r=t.context,i=this._getHandler(n);if(!i)throw new Error("no command handler registered for <"+n+">");this._pushAction(t),e||(this._fire(n,"preExecute",t),i.preExecute&&i.preExecute(r),this._fire(n,"preExecuted",t)),this._atomicDo(()=>{this._fire(n,"execute",t),i.execute&&this._markDirty(i.execute(r)),this._executedAction(t,e),this._fire(n,"executed",t)}),e||(this._fire(n,"postExecute",t),i.postExecute&&i.postExecute(r),this._fire(n,"postExecuted",t)),this._popAction()};wt.prototype._pushAction=function(t){const e=this._currentExecution,n=e.actions,r=n[0];if(e.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+t.command+")");t.id||(t.id=r&&r.id||this._createId()),n.push(t)};wt.prototype._popAction=function(){const t=this._currentExecution,e=t.trigger,n=t.actions,r=t.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:aC("id",r.reverse())}),r.length=0,this._fire("changed",{trigger:e}),t.trigger=null)};wt.prototype._markDirty=function(t){const e=this._currentExecution;t&&(t=Ue(t)?t:[t],e.dirty=e.dirty.concat(t))};wt.prototype._executedAction=function(t,e){const n=++this._stackIdx;e||this._stack.splice(n,this._stack.length,t)};wt.prototype._revertedAction=function(t){this._stackIdx--};wt.prototype._getHandler=function(t){return this._handlerMap[t]};wt.prototype._setHandler=function(t,e){if(!t||!e)throw new Error("command and handler required");if(this._handlerMap[t])throw new Error("overriding handler for command <"+t+">");this._handlerMap[t]=e};const Q5={commandStack:["type",wt]};function Ai(t,e){if(typeof e!="function")throw new Error("removeFn iterator must be a function");if(t){for(var n;n=t[0];)e(n);return t}}var e$=250,wx=1400;function qm(t,e,n){Z.call(this,e);var r=t.get("movePreview",!1);e.on("shape.move.start",wx,function(i){var s=i.context,a=s.shapes,c=s.validatedShapes;s.shapes=_x(a),s.validatedShapes=_x(c)}),r&&e.on("shape.move.start",e$,function(i){var s=i.context,a=s.shapes,c=[];I(a,function(l){I(l.labels,function(d){!d.hidden&&s.shapes.indexOf(d)===-1&&c.push(d),l.labelTarget&&c.push(l)})}),I(c,function(l){r.makeDraggable(s,l,!0)})}),this.preExecuted("elements.move",wx,function(i){var s=i.context,a=s.closure,c=a.enclosedElements,l=[];I(c,function(d){I(d.labels,function(u){c[u.id]||l.push(u)})}),a.addAll(l)}),this.preExecute(["connection.delete","shape.delete"],function(i){var s=i.context,a=s.connection||s.shape;Ai(a.labels,function(c){n.removeShape(c,{nested:!0})})}),this.execute("shape.delete",function(i){var s=i.context,a=s.shape,c=a.labelTarget;c&&(s.labelTargetIndex=vf(c.labels,a),s.labelTarget=c,a.labelTarget=null)}),this.revert("shape.delete",function(i){var s=i.context,a=s.shape,c=s.labelTarget,l=s.labelTargetIndex;c&&(Ot(c.labels,a,l),a.labelTarget=c)})}fe(qm,Z);qm.$inject=["injector","eventBus","modeling"];function _x(t){return Ve(t,function(e){return t.indexOf(e.labelTarget)===-1})}const t$={__init__:["labelSupport"],labelSupport:["type",qm]};var n$=251,Ex=1401,Sx="attach-ok";function Km(t,e,n,r,i){Z.call(this,e);var s=t.get("movePreview",!1);e.on("shape.move.start",Ex,function(a){var c=a.context,l=c.shapes,d=c.validatedShapes;c.shapes=r$(l),c.validatedShapes=i$(d)}),s&&e.on("shape.move.start",n$,function(a){var c=a.context,l=c.shapes,d=$p(l);I(d,function(u){s.makeDraggable(c,u,!0),I(u.labels,function(h){s.makeDraggable(c,h,!0)})})}),s&&e.on("shape.move.start",function(a){var c=a.context,l=c.shapes;if(l.length===1){var d=l[0],u=d.host;u&&(n.addMarker(u,Sx),e.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(u,Sx)}))}}),this.preExecuted("elements.move",Ex,function(a){var c=a.context,l=c.closure,d=c.shapes,u=$p(d);I(u,function(h){l.add(h,l.topLevel[h.host.id])})}),this.postExecuted("elements.move",function(a){var c=a.context,l=c.shapes,d=c.newHost,u;d&&l.length!==1||(d?u=l:u=Ve(l,function(h){var p=h.host;return s$(h)&&!a$(l,p)}),I(u,function(h){i.updateAttachment(h,d)}))}),this.postExecuted("elements.move",function(a){var c=a.context.shapes;I(c,function(l){I(l.attachers,function(d){I(d.outgoing.slice(),function(u){var h=r.allowed("connection.reconnect",{connection:u,source:u.source,target:u.target});h||i.removeConnection(u)}),I(d.incoming.slice(),function(u){var h=r.allowed("connection.reconnect",{connection:u,source:u.source,target:u.target});h||i.removeConnection(u)})})})}),this.postExecute("shape.create",function(a){var c=a.context,l=c.shape,d=c.host;d&&i.updateAttachment(l,d)}),this.postExecute("shape.replace",function(a){var c=a.context,l=c.oldShape,d=c.newShape;Ai(l.attachers,function(u){var h=r.allowed("elements.move",{target:d,shapes:[u]});h==="attach"?i.updateAttachment(u,d):i.removeShape(u)}),d.attachers.length&&I(d.attachers,function(u){var h=Qy(u,l,d);i.moveShape(u,h,u.parent)})}),this.postExecute("shape.resize",function(a){var c=a.context,l=c.shape,d=c.oldBounds,u=c.newBounds,h=l.attachers,p=c.hints||{};p.attachSupport!==!1&&I(h,function(f){var m=Qy(f,d,u);i.moveShape(f,m,f.parent),I(f.labels,function(v){i.moveShape(v,m,v.parent)})})}),this.preExecute("shape.delete",function(a){var c=a.context.shape;Ai(c.attachers,function(l){i.removeShape(l)}),c.host&&i.updateAttachment(c,null)})}fe(Km,Z);Km.$inject=["injector","eventBus","canvas","rules","modeling"];function $p(t){return pf(Rn(t,function(e){return e.attachers||[]}))}function r$(t){var e=$p(t);return oC("id",t,e)}function i$(t){var e=Nd(t,"id");return Ve(t,function(n){for(;n;){if(n.host&&e[n.host.id])return!1;n=n.parent}return!0})}function s$(t){return!!t.host}function a$(t,e){return t.indexOf(e)!==-1}const o$={__depends__:[Cr],__init__:["attachSupport"],attachSupport:["type",Km]};function qn(t){this._model=t}qn.$inject=["moddle"];qn.prototype._needsId=function(t){return Me(t,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])};qn.prototype._ensureId=function(t){if(t.id){this._model.ids.claim(t.id,t);return}var e;_(t,"bpmn:Activity")?e="Activity":_(t,"bpmn:Event")?e="Event":_(t,"bpmn:Gateway")?e="Gateway":Me(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])?e="Flow":e=(t.$type||"").replace(/^[^:]*:/g,""),e+="_",!t.id&&this._needsId(t)&&(t.id=this._model.ids.nextPrefixed(e,t))};qn.prototype.create=function(t,e){var n=this._model.create(t,e||{});return this._ensureId(n),n};qn.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})};qn.prototype.createDiShape=function(t,e){return this.create("bpmndi:BPMNShape",L({bpmnElement:t,bounds:this.createDiBounds()},e))};qn.prototype.createDiBounds=function(t){return this.create("dc:Bounds",t)};qn.prototype.createDiWaypoints=function(t){var e=this;return Rn(t,function(n){return e.createDiWaypoint(n)})};qn.prototype.createDiWaypoint=function(t){return this.create("dc:Point",jr(t,["x","y"]))};qn.prototype.createDiEdge=function(t,e){return this.create("bpmndi:BPMNEdge",L({bpmnElement:t,waypoint:this.createDiWaypoints([])},e))};qn.prototype.createDiPlane=function(t,e){return this.create("bpmndi:BPMNPlane",L({bpmnElement:t},e))};function Nn(t,e,n){Z.call(this,t),this._bpmnFactory=e;var r=this;function i(f){var m=f.context,v=m.hints||{},g;!m.cropped&&v.createElementsBehavior!==!1&&(g=m.connection,g.waypoints=n.getCroppedWaypoints(g),m.cropped=!0)}this.executed(["connection.layout","connection.create"],i),this.reverted(["connection.layout"],function(f){delete f.context.cropped});function s(f){var m=f.context;r.updateParent(m.shape||m.connection,m.oldParent)}function a(f){var m=f.context,v=m.shape||m.connection,g=m.parent||m.newParent;r.updateParent(v,g)}this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],_n(s)),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],_n(a));function c(f){var m=f.context,v=m.oldRoot,g=v.children;I(g,function(w){_(w,"bpmn:BaseElement")&&r.updateParent(w)})}this.executed(["canvas.updateRoot"],c),this.reverted(["canvas.updateRoot"],c);function l(f){var m=f.context.shape;_(m,"bpmn:BaseElement")&&r.updateBounds(m)}this.executed(["shape.move","shape.create","shape.resize"],_n(function(f){f.context.shape.type!=="label"&&l(f)})),this.reverted(["shape.move","shape.create","shape.resize"],_n(function(f){f.context.shape.type!=="label"&&l(f)})),t.on("shape.changed",function(f){f.element.type==="label"&&l({context:{shape:f.element}})});function d(f){r.updateConnection(f.context)}this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],_n(d)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],_n(d));function u(f){r.updateConnectionWaypoints(f.context.connection)}this.executed(["connection.layout","connection.move","connection.updateWaypoints"],_n(u)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],_n(u)),this.executed("connection.reconnect",_n(function(f){var m=f.context,v=m.connection,g=m.oldSource,w=m.newSource,b=ce(v),x=ce(g),E=ce(w);b.conditionExpression&&!Me(E,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(m.oldConditionExpression=b.conditionExpression,delete b.conditionExpression),g!==w&&x.default===b&&(m.oldDefault=x.default,delete x.default)})),this.reverted("connection.reconnect",_n(function(f){var m=f.context,v=m.connection,g=m.oldSource,w=m.newSource,b=ce(v),x=ce(g),E=ce(w);m.oldConditionExpression&&(b.conditionExpression=m.oldConditionExpression),m.oldDefault&&(x.default=m.oldDefault,delete E.default)}));function h(f){r.updateAttachment(f.context)}this.executed(["element.updateAttachment"],_n(h)),this.reverted(["element.updateAttachment"],_n(h)),this.executed("element.updateLabel",_n(p)),this.reverted("element.updateLabel",_n(p));function p(f){const{element:m}=f.context,v=js(m),g=at(m),w=g&&g.get("label");xa(m)||Al(m)||(v&&!w?g.set("label",e.create("bpmndi:BPMNLabel")):!v&&w&&g.set("label",void 0))}}fe(Nn,Z);Nn.$inject=["eventBus","bpmnFactory","connectionDocking"];Nn.prototype.updateAttachment=function(t){var e=t.shape,n=e.businessObject,r=e.host;n.attachedToRef=r&&r.businessObject};Nn.prototype.updateParent=function(t,e){if(!We(t)&&!(_(t,"bpmn:DataStoreReference")&&t.parent&&_(t.parent,"bpmn:Collaboration"))){var n=t.parent,r=t.businessObject,i=at(t),s=n&&n.businessObject,a=at(n);_(t,"bpmn:FlowNode")&&this.updateFlowNodeRefs(r,s,e&&e.businessObject),_(t,"bpmn:DataOutputAssociation")&&(t.source?s=t.source.businessObject:s=null),_(t,"bpmn:DataInputAssociation")&&(t.target?s=t.target.businessObject:s=null),this.updateSemanticParent(r,s),_(t,"bpmn:DataObjectReference")&&r.dataObjectRef&&this.updateSemanticParent(r.dataObjectRef,s),this.updateDiParent(i,a)}};Nn.prototype.updateBounds=function(t){var e=at(t),n=l$(t);if(n){var r=cr(n,e.get("bounds"));L(n,{x:t.x+r.x,y:t.y+r.y})}var i=We(t)?this._getLabel(e):e,s=i.bounds;s||(s=this._bpmnFactory.createDiBounds(),i.set("bounds",s)),L(s,{x:t.x,y:t.y,width:t.width,height:t.height})};Nn.prototype.updateFlowNodeRefs=function(t,e,n){if(n!==e){var r,i;_(n,"bpmn:Lane")&&(r=n.get("flowNodeRef"),At(r,t)),_(e,"bpmn:Lane")&&(i=e.get("flowNodeRef"),Ot(i,t))}};Nn.prototype.updateDiConnection=function(t,e,n){var r=at(t),i=at(e),s=at(n);r.sourceElement&&r.sourceElement.bpmnElement!==ce(e)&&(r.sourceElement=e&&i),r.targetElement&&r.targetElement.bpmnElement!==ce(n)&&(r.targetElement=n&&s)};Nn.prototype.updateDiParent=function(t,e){if(e&&!_(e,"bpmndi:BPMNPlane")&&(e=e.$parent),t.$parent!==e){var n=(e||t.$parent).get("planeElement");e?(n.push(t),t.$parent=e):(At(n,t),t.$parent=null)}};function c$(t){for(;t&&!_(t,"bpmn:Definitions");)t=t.$parent;return t}Nn.prototype.getLaneSet=function(t){var e,n;return _(t,"bpmn:Lane")?(e=t.childLaneSet,e||(e=this._bpmnFactory.create("bpmn:LaneSet"),t.childLaneSet=e,e.$parent=t),e):(_(t,"bpmn:Participant")&&(t=t.processRef),n=t.get("laneSets"),e=n[0],e||(e=this._bpmnFactory.create("bpmn:LaneSet"),e.$parent=t,n.push(e)),e)};Nn.prototype.updateSemanticParent=function(t,e,n){var r;if(t.$parent!==e&&!((_(t,"bpmn:DataInput")||_(t,"bpmn:DataOutput"))&&(_(e,"bpmn:Participant")&&"processRef"in e&&(e=e.processRef),"ioSpecification"in e&&e.ioSpecification===t.$parent))){if(_(t,"bpmn:Lane"))e&&(e=this.getLaneSet(e)),r="lanes";else if(_(t,"bpmn:FlowElement")){if(e){if(_(e,"bpmn:Participant"))e=e.processRef;else if(_(e,"bpmn:Lane"))do e=e.$parent.$parent;while(_(e,"bpmn:Lane"))}r="flowElements"}else if(_(t,"bpmn:Artifact")){for(;e&&!_(e,"bpmn:Process")&&!_(e,"bpmn:SubProcess")&&!_(e,"bpmn:Collaboration");)if(_(e,"bpmn:Participant")){e=e.processRef;break}else e=e.$parent;r="artifacts"}else if(_(t,"bpmn:MessageFlow"))r="messageFlows";else if(_(t,"bpmn:Participant")){r="participants";var i=t.processRef,s;i&&(s=c$(t.$parent||e),t.$parent&&(At(s.get("rootElements"),i),i.$parent=null),e&&(Ot(s.get("rootElements"),i),i.$parent=s))}else _(t,"bpmn:DataOutputAssociation")?r="dataOutputAssociations":_(t,"bpmn:DataInputAssociation")&&(r="dataInputAssociations");if(!r)throw new Error(`no parent for <${t.id}> in <${e.id}>`);var a;if(t.$parent&&(a=t.$parent.get(r),At(a,t)),e?(a=e.get(r),a.push(t),t.$parent=e):t.$parent=null,n){var c=n.get(r);At(a,t),e&&(c||(c=[],e.set(r,c)),c.push(t))}}};Nn.prototype.updateConnectionWaypoints=function(t){var e=at(t);e.set("waypoint",this._bpmnFactory.createDiWaypoints(t.waypoints))};Nn.prototype.updateConnection=function(t){var e=t.connection,n=ce(e),r=e.source,i=ce(r),s=e.target,a=ce(e.target),c;if(_(n,"bpmn:DataAssociation"))_(n,"bpmn:DataInputAssociation")?(n.get("sourceRef")[0]=i,c=t.parent||t.newParent||a,this.updateSemanticParent(n,a,c)):_(n,"bpmn:DataOutputAssociation")&&(c=t.parent||t.newParent||i,this.updateSemanticParent(n,i,c),n.targetRef=a);else{var l=_(n,"bpmn:SequenceFlow");n.sourceRef!==i&&(l&&(At(n.sourceRef&&n.sourceRef.get("outgoing"),n),i&&i.get("outgoing")&&i.get("outgoing").push(n)),n.sourceRef=i),n.targetRef!==a&&(l&&(At(n.targetRef&&n.targetRef.get("incoming"),n),a&&a.get("incoming")&&a.get("incoming").push(n)),n.targetRef=a)}this.updateConnectionWaypoints(e),this.updateDiConnection(e,r,s)};Nn.prototype._getLabel=function(t){return t.label||(t.label=this._bpmnFactory.createDiLabel()),t.label};function _n(t){return function(e){var n=e.context,r=n.shape||n.connection||n.element;_(r,"bpmn:BaseElement")&&t(e)}}function l$(t){if(_(t,"bpmn:Activity")){var e=at(t);if(e){var n=e.get("label");if(n)return n.get("bounds")}}}function Hi(t,e){yf.call(this),this._bpmnFactory=t,this._moddle=e}fe(Hi,yf);Hi.$inject=["bpmnFactory","moddle"];Hi.prototype._baseCreate=yf.prototype.create;Hi.prototype.create=function(t,e){if(t==="label"){var n=e.di||this._bpmnFactory.createDiLabel();return this._baseCreate(t,L({type:"label",di:n},cC,e))}return this.createElement(t,e)};Hi.prototype.createElement=function(t,e){e=L({},e||{});var n,r=e.businessObject,i=e.di;if(!r){if(!e.type)throw new Error("no shape type specified");r=this._bpmnFactory.create(e.type),lC(r)}if(!u$(i)){var s=L({},i||{},{id:r.id+"_di"});t==="root"?i=this._bpmnFactory.createDiPlane(r,s):t==="connection"?i=this._bpmnFactory.createDiEdge(r,s):i=this._bpmnFactory.createDiShape(r,s)}_(r,"bpmn:Group")&&(e=L({isFrame:!0},e)),e=d$(r,e,["processRef","isInterrupting","associationDirection","isForCompensation"]),e.isExpanded&&(e=Lp(i,e,"isExpanded")),Me(r,["bpmn:Lane","bpmn:Participant"])&&(e=Lp(i,e,"isHorizontal")),_(r,"bpmn:SubProcess")&&(e.collapsed=!Ze(r,i)),_(r,"bpmn:ExclusiveGateway")&&(Pi(i,"isMarkerVisible")?i.isMarkerVisible===void 0&&(i.isMarkerVisible=!1):i.isMarkerVisible=!0),Pn(e.triggeredByEvent)&&(r.triggeredByEvent=e.triggeredByEvent,delete e.triggeredByEvent),Pn(e.cancelActivity)&&(r.cancelActivity=e.cancelActivity,delete e.cancelActivity);var a,c;return e.eventDefinitionType&&(a=r.get("eventDefinitions")||[],c=this._bpmnFactory.create(e.eventDefinitionType,e.eventDefinitionAttrs),e.eventDefinitionType==="bpmn:ConditionalEventDefinition"&&(c.condition=this._bpmnFactory.create("bpmn:FormalExpression")),a.push(c),c.$parent=r,r.eventDefinitions=a,delete e.eventDefinitionType),n=this.getDefaultSize(r,i),e=L({id:r.id},n,e,{businessObject:r,di:i}),this._baseCreate(t,e)};Hi.prototype.getDefaultSize=function(t,e){var n=ce(t);if(e=e||at(t),_(n,"bpmn:SubProcess"))return Ze(n,e)?{width:350,height:200}:{width:100,height:80};if(_(n,"bpmn:Task"))return{width:100,height:80};if(_(n,"bpmn:Gateway"))return{width:50,height:50};if(_(n,"bpmn:Event"))return{width:36,height:36};if(_(n,"bpmn:Participant")){var r=e.isHorizontal===void 0||e.isHorizontal===!0;return Ze(n,e)?r?{width:600,height:250}:{width:250,height:600}:r?{width:400,height:60}:{width:60,height:400}}return _(n,"bpmn:Lane")?{width:400,height:100}:_(n,"bpmn:DataObjectReference")?{width:36,height:50}:_(n,"bpmn:DataStoreReference")?{width:50,height:50}:_(n,"bpmn:TextAnnotation")?{width:100,height:30}:_(n,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}};Hi.prototype.createParticipantShape=function(t){return Yr(t)||(t={isExpanded:t}),t=L({type:"bpmn:Participant"},t||{}),t.isExpanded!==!1&&(t.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(t)};function d$(t,e,n){return I(n,function(r){e=Lp(t,e,r)}),e}function Lp(t,e,n){return e[n]===void 0?e:(t[n]=e[n],Xr(e,[n]))}function u$(t){return Me(t,["bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane"])}function lu(t,e){this._modeling=t,this._canvas=e}lu.$inject=["modeling","canvas"];lu.prototype.preExecute=function(t){var e=this._modeling,n=t.elements,r=t.alignment;I(n,function(i){var s={x:0,y:0};Pn(r.left)?s.x=r.left-i.x:Pn(r.right)?s.x=r.right-i.width-i.x:Pn(r.center)?s.x=r.center-Math.round(i.width/2)-i.x:Pn(r.top)?s.y=r.top-i.y:Pn(r.bottom)?s.y=r.bottom-i.height-i.y:Pn(r.middle)&&(s.y=r.middle-Math.round(i.height/2)-i.y),e.moveElements([i],s,i.parent)})};lu.prototype.postExecute=function(t){};function du(t){this._modeling=t}du.$inject=["modeling"];du.prototype.preExecute=function(t){var e=t.source;if(!e)throw new Error("source required");var n=t.target||e.parent,r=t.shape,i=t.hints||{};r=t.shape=this._modeling.createShape(r,t.position,n,{attach:i.attach}),t.shape=r};du.prototype.postExecute=function(t){var e=t.hints||{};h$(t.source,t.shape)||(e.connectionTarget===t.source?this._modeling.connect(t.shape,t.source,t.connection):this._modeling.connect(t.source,t.shape,t.connection))};function h$(t,e){return xc(t.outgoing,function(n){return n.target===e})}function uu(t,e){this._canvas=t,this._layouter=e}uu.$inject=["canvas","layouter"];uu.prototype.execute=function(t){var e=t.connection,n=t.source,r=t.target,i=t.parent,s=t.parentIndex,a=t.hints;if(!n||!r)throw new Error("source and target required");if(!i)throw new Error("parent required");return e.source=n,e.target=r,e.waypoints||(e.waypoints=this._layouter.layoutConnection(e,a)),this._canvas.addConnection(e,i,s),e};uu.prototype.revert=function(t){var e=t.connection;return this._canvas.removeConnection(e),e.source=null,e.target=null,e};var Nl=Math.round;function Ym(t){this._modeling=t}Ym.$inject=["modeling"];Ym.prototype.preExecute=function(t){var e=t.elements,n=t.parent,r=t.parentIndex,i=t.position,s=t.hints,a=this._modeling;I(e,function(h){ze(h.x)||(h.x=0),ze(h.y)||(h.y=0)});var c=Ve(e,function(h){return!h.hidden}),l=gn(c);I(e,function(h){lt(h)&&(h.waypoints=Rn(h.waypoints,function(p){return{x:Nl(p.x-l.x-l.width/2+i.x),y:Nl(p.y-l.y-l.height/2+i.y)}})),L(h,{x:Nl(h.x-l.x-l.width/2+i.x),y:Nl(h.y-l.y-l.height/2+i.y)})});var d=Ed(e),u={};I(e,function(h){if(lt(h)){u[h.id]=ze(r)?a.createConnection(u[h.source.id],u[h.target.id],r,h,h.parent||n,s):a.createConnection(u[h.source.id],u[h.target.id],h,h.parent||n,s);return}var p=L({},s);d.indexOf(h)===-1&&(p.autoResize=!1),We(h)&&(p=Xr(p,["attach"])),u[h.id]=ze(r)?a.createShape(h,jr(h,["x","y","width","height"]),h.parent||n,r,p):a.createShape(h,jr(h,["x","y","width","height"]),h.parent||n,p)}),t.elements=jd(u)};var jx=Math.round;function Vi(t){this._canvas=t}Vi.$inject=["canvas"];Vi.prototype.execute=function(t){var e=t.shape,n=t.position,r=t.parent,i=t.parentIndex;if(!r)throw new Error("parent required");if(!n)throw new Error("position required");return n.width!==void 0?L(e,n):L(e,{x:n.x-jx(e.width/2),y:n.y-jx(e.height/2)}),this._canvas.addShape(e,r,i),e};Vi.prototype.revert=function(t){var e=t.shape;return this._canvas.removeShape(e),e};function Rc(t){Vi.call(this,t)}fe(Rc,Vi);Rc.$inject=["canvas"];var p$=Vi.prototype.execute;Rc.prototype.execute=function(t){var e=t.shape;return m$(e),e.labelTarget=t.labelTarget,p$.call(this,t)};var f$=Vi.prototype.revert;Rc.prototype.revert=function(t){return t.shape.labelTarget=null,f$.call(this,t)};function m$(t){["width","height"].forEach(function(e){typeof t[e]>"u"&&(t[e]=0)})}function Ac(t,e){this._canvas=t,this._modeling=e}Ac.$inject=["canvas","modeling"];Ac.prototype.preExecute=function(t){var e=this._modeling,n=t.connection;Ai(n.incoming,function(r){e.removeConnection(r,{nested:!0})}),Ai(n.outgoing,function(r){e.removeConnection(r,{nested:!0})})};Ac.prototype.execute=function(t){var e=t.connection,n=e.parent;return t.parent=n,t.parentIndex=vf(n.children,e),t.source=e.source,t.target=e.target,this._canvas.removeConnection(e),e.source=null,e.target=null,e};Ac.prototype.revert=function(t){var e=t.connection,n=t.parent,r=t.parentIndex;return e.source=t.source,e.target=t.target,Ot(n.children,e,r),this._canvas.addConnection(e,n),e};function Zm(t,e){this._modeling=t,this._elementRegistry=e}Zm.$inject=["modeling","elementRegistry"];Zm.prototype.postExecute=function(t){var e=this._modeling,n=this._elementRegistry,r=t.elements;I(r,function(i){n.get(i.id)&&(i.waypoints?e.removeConnection(i):e.removeShape(i))})};function Ic(t,e){this._canvas=t,this._modeling=e}Ic.$inject=["canvas","modeling"];Ic.prototype.preExecute=function(t){var e=this._modeling,n=t.shape;Ai(n.incoming,function(r){e.removeConnection(r,{nested:!0})}),Ai(n.outgoing,function(r){e.removeConnection(r,{nested:!0})}),Ai(n.children,function(r){lt(r)?e.removeConnection(r,{nested:!0}):e.removeShape(r,{nested:!0})})};Ic.prototype.execute=function(t){var e=this._canvas,n=t.shape,r=n.parent;return t.oldParent=r,t.oldParentIndex=vf(r.children,n),e.removeShape(n),n};Ic.prototype.revert=function(t){var e=this._canvas,n=t.shape,r=t.oldParent,i=t.oldParentIndex;return Ot(r.children,n,i),e.addShape(n,r),n};function hu(t){this._modeling=t}hu.$inject=["modeling"];var Nx={x:"y",y:"x"};hu.prototype.preExecute=function(t){var e=this._modeling,n=t.groups,r=t.axis,i=t.dimension;function s(g,w){g.range.min=Math.min(w[r],g.range.min),g.range.max=Math.max(w[r]+w[i],g.range.max)}function a(g){return g[r]+g[i]/2}function c(g){return g.length-1}function l(g){return g.max-g.min}function d(g,w){var b={y:0};b[r]=g-a(w),b[r]&&(b[Nx[r]]=0,e.moveElements([w],b,w.parent))}var u=n[0],h=c(n),p=n[h],f,m,v=0;I(n,function(g,w){var b,x,E;if(g.elements.length<2){w&&w!==n.length-1&&(s(g,g.elements[0]),v+=l(g.range));return}b=Kr(g.elements,r),x=b[0],w===h&&(x=b[c(b)]),E=a(x),g.range=null,I(b,function(N){if(d(E,N),g.range===null){g.range={min:N[r],max:N[r]+N[i]};return}s(g,N)}),w&&w!==n.length-1&&(v+=l(g.range))}),m=Math.abs(p.range.min-u.range.max),f=Math.round((m-v)/(n.length-1)),!(f<n.length-1)&&I(n,function(g,w){var b={},x;g===u||g===p||(x=n[w-1],g.range.max=0,I(g.elements,function(E,N){b[Nx[r]]=0,b[r]=x.range.max-E[r]+f,g.range.min!==E[r]&&(b[r]+=E[r]-g.range.min),b[r]&&e.moveElements([E],b,E.parent),g.range.max=Math.max(E[r]+E[i],N?g.range.max:0)}))})};hu.prototype.postExecute=function(t){};function pu(t,e){this._layouter=t,this._canvas=e}pu.$inject=["layouter","canvas"];pu.prototype.execute=function(t){var e=t.connection,n=e.waypoints;return L(t,{oldWaypoints:n}),e.waypoints=this._layouter.layoutConnection(e,t.hints),e};pu.prototype.revert=function(t){var e=t.connection;return e.waypoints=t.oldWaypoints,e};function Xm(){}Xm.prototype.execute=function(t){var e=t.connection,n=t.delta,r=t.newParent||e.parent,i=t.newParentIndex,s=e.parent;return t.oldParent=s,t.oldParentIndex=At(s.children,e),Ot(r.children,e,i),e.parent=r,I(e.waypoints,function(a){a.x+=n.x,a.y+=n.y,a.original&&(a.original.x+=n.x,a.original.y+=n.y)}),e};Xm.prototype.revert=function(t){var e=t.connection,n=e.parent,r=t.oldParent,i=t.oldParentIndex,s=t.delta;return At(n.children,e),Ot(r.children,e,i),e.parent=r,I(e.waypoints,function(a){a.x-=s.x,a.y-=s.y,a.original&&(a.original.x-=s.x,a.original.y-=s.y)}),e};function Jm(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}Jm.prototype.add=function(t,e){return this.addAll([t],e)};Jm.prototype.addAll=function(t,e){var n=dC(t,!!e,this);return L(this,n),this};function Mc(t){this._modeling=t}Mc.prototype.moveRecursive=function(t,e,n){return t?this.moveClosure(this.getClosure(t),e,n):[]};Mc.prototype.moveClosure=function(t,e,n,r,i){var s=this._modeling,a=t.allShapes,c=t.allConnections,l=t.enclosedConnections,d=t.topLevel,u=!1;i&&i.parent===n&&(u=!0),I(a,function(h){s.moveShape(h,e,d[h.id]&&!u&&n,{recurse:!1,layout:!1})}),I(c,function(h){var p=!!a[h.source.id],f=!!a[h.target.id];l[h.id]&&p&&f?s.moveConnection(h,e,d[h.id]&&!u&&n):s.layoutConnection(h,{connectionStart:p&&_m(h,h.source,e),connectionEnd:f&&Em(h,h.target,e)})})};Mc.prototype.getClosure=function(t){return new Jm().addAll(t,!0)};function fu(t){this._helper=new Mc(t)}fu.$inject=["modeling"];fu.prototype.preExecute=function(t){t.closure=this._helper.getClosure(t.shapes)};fu.prototype.postExecute=function(t){var e=t.hints,n;e&&e.primaryShape&&(n=e.primaryShape,e.oldParent=n.parent),this._helper.moveClosure(t.closure,t.delta,t.newParent,t.newHost,n)};function As(t){this._modeling=t,this._helper=new Mc(t)}As.$inject=["modeling"];As.prototype.execute=function(t){var e=t.shape,n=t.delta,r=t.newParent||e.parent,i=t.newParentIndex,s=e.parent;return t.oldBounds=jr(e,["x","y","width","height"]),t.oldParent=s,t.oldParentIndex=At(s.children,e),Ot(r.children,e,i),L(e,{parent:r,x:e.x+n.x,y:e.y+n.y}),e};As.prototype.postExecute=function(t){var e=t.shape,n=t.delta,r=t.hints,i=this._modeling;r.layout!==!1&&(I(e.incoming,function(s){i.layoutConnection(s,{connectionEnd:Em(s,e,n)})}),I(e.outgoing,function(s){i.layoutConnection(s,{connectionStart:_m(s,e,n)})})),r.recurse!==!1&&this.moveChildren(t)};As.prototype.revert=function(t){var e=t.shape,n=t.oldParent,r=t.oldParentIndex,i=t.delta;return Ot(n.children,e,r),L(e,{parent:n,x:e.x-i.x,y:e.y-i.y}),e};As.prototype.moveChildren=function(t){var e=t.delta,n=t.shape;this._helper.moveRecursive(n.children,e,null)};As.prototype.getNewParent=function(t){return t.newParent||t.shape.parent};function Dc(t){this._modeling=t}Dc.$inject=["modeling"];Dc.prototype.execute=function(t){var e=t.newSource,n=t.newTarget,r=t.connection,i=t.dockingOrPoints;if(!e&&!n)throw new Error("newSource or newTarget required");return Ue(i)&&(t.oldWaypoints=r.waypoints,r.waypoints=i),e&&(t.oldSource=r.source,r.source=e),n&&(t.oldTarget=r.target,r.target=n),r};Dc.prototype.postExecute=function(t){var e=t.connection,n=t.newSource,r=t.newTarget,i=t.dockingOrPoints,s=t.hints||{},a={};s.connectionStart&&(a.connectionStart=s.connectionStart),s.connectionEnd&&(a.connectionEnd=s.connectionEnd),s.layoutConnection!==!1&&(n&&(!r||s.docking==="source")&&(a.connectionStart=a.connectionStart||kx(Ue(i)?i[0]:i)),r&&(!n||s.docking==="target")&&(a.connectionEnd=a.connectionEnd||kx(Ue(i)?i[i.length-1]:i)),s.newWaypoints&&(a.waypoints=s.newWaypoints),this._modeling.layoutConnection(e,a))};Dc.prototype.revert=function(t){var e=t.oldSource,n=t.oldTarget,r=t.oldWaypoints,i=t.connection;return e&&(i.source=e),n&&(i.target=n),r&&(i.waypoints=r),i};function kx(t){return t.original||t}function ti(t,e){this._modeling=t,this._rules=e}ti.$inject=["modeling","rules"];ti.prototype.preExecute=function(t){var e=this,n=this._modeling,r=this._rules,i=t.oldShape,s=t.newData,a=t.hints||{},c;function l(m,v,g){return r.allowed("connection.reconnect",{connection:g,source:m,target:v})}var d={x:s.x,y:s.y},u={x:i.x,y:i.y,width:i.width,height:i.height};c=t.newShape=t.newShape||e.createShape(s,d,i.parent,a),i.host&&n.updateAttachment(c,i.host);var h;a.moveChildren!==!1&&(h=i.children.slice(),n.moveElements(h,{x:0,y:0},c,a));var p=i.incoming.slice(),f=i.outgoing.slice();I(p,function(m){var v=m.source,g=l(v,c,m);g&&e.reconnectEnd(m,c,tu(m,c,u),a)}),I(f,function(m){var v=m.target,g=l(c,v,m);g&&e.reconnectStart(m,c,eu(m,c,u),a)})};ti.prototype.postExecute=function(t){var e=t.oldShape;this._modeling.removeShape(e)};ti.prototype.execute=function(t){};ti.prototype.revert=function(t){};ti.prototype.createShape=function(t,e,n,r){return this._modeling.createShape(t,e,n,r)};ti.prototype.reconnectStart=function(t,e,n,r){this._modeling.reconnectStart(t,e,n,r)};ti.prototype.reconnectEnd=function(t,e,n,r){this._modeling.reconnectEnd(t,e,n,r)};function Oc(t){this._modeling=t}Oc.$inject=["modeling"];Oc.prototype.execute=function(t){var e=t.shape,n=t.newBounds,r=t.minBounds;if(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)throw new Error("newBounds must have {x, y, width, height} properties");if(r&&(n.width<r.width||n.height<r.height))throw new Error("width and height cannot be less than minimum height and width");if(!r&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return t.oldBounds={width:e.width,height:e.height,x:e.x,y:e.y},L(e,{width:n.width,height:n.height,x:n.x,y:n.y}),e};Oc.prototype.postExecute=function(t){var e=this._modeling,n=t.shape,r=t.oldBounds,i=t.hints||{};i.layout!==!1&&(I(n.incoming,function(s){e.layoutConnection(s,{connectionEnd:tu(s,n,r)})}),I(n.outgoing,function(s){e.layoutConnection(s,{connectionStart:eu(s,n,r)})}))};Oc.prototype.revert=function(t){var e=t.shape,n=t.oldBounds;return L(e,{width:n.width,height:n.height,x:n.x,y:n.y}),e};function Gi(t){this._modeling=t}Gi.$inject=["modeling"];Gi.prototype.preExecute=function(t){var e=t.delta,n=t.direction,r=t.movingShapes,i=t.resizingShapes,s=t.start,a={};this.moveShapes(r,e),I(i,function(c){a[c.id]=v$(c)}),this.resizeShapes(i,e,n),this.updateConnectionWaypoints(V5(r,i),e,n,s,r,i,a)};Gi.prototype.execute=function(){};Gi.prototype.revert=function(){};Gi.prototype.moveShapes=function(t,e){var n=this;I(t,function(r){n._modeling.moveShape(r,e,null,{autoResize:!1,layout:!1,recurse:!1})})};Gi.prototype.resizeShapes=function(t,e,n){var r=this;I(t,function(i){var s=G5(i,n,e);r._modeling.resizeShape(i,s,null,{attachSupport:!1,autoResize:!1,layout:!1})})};Gi.prototype.updateConnectionWaypoints=function(t,e,n,r,i,s,a){var c=this,l=i.concat(s);I(t,function(d){var u=d.source,h=d.target,p=g$(d),f=mE(n),m={};vi(l,u)&&vi(l,h)?(p=Rn(p,function(v){return Px(v,r,n)&&(v[f]=v[f]+e[f]),v.original&&Px(v.original,r,n)&&(v.original[f]=v.original[f]+e[f]),v}),c._modeling.updateWaypoints(d,p,{labelBehavior:!1})):(vi(l,u)||vi(l,h))&&(vi(i,u)?m.connectionStart=_m(d,u,e):vi(i,h)?m.connectionEnd=Em(d,h,e):vi(s,u)?m.connectionStart=eu(d,u,a[u.id]):vi(s,h)&&(m.connectionEnd=tu(d,h,a[h.id])),c._modeling.layoutConnection(d,m))})};function Cx(t){return L({},t)}function g$(t){return Rn(t.waypoints,function(e){return e=Cx(e),e.original&&(e.original=Cx(e.original)),e})}function mE(t){switch(t){case"n":return"y";case"w":return"x";case"s":return"y";case"e":return"x"}}function Px(t,e,n){var r=mE(n);if(/e|s/.test(n))return t[r]>e;if(/n|w/.test(n))return t[r]<e}function vi(t,e){return t.indexOf(e)!==-1}function v$(t){return{x:t.x,y:t.y,height:t.height,width:t.width}}function mu(t){this._modeling=t}mu.$inject=["modeling"];mu.prototype.execute=function(t){var e=t.shape,n=e.children;t.oldChildrenVisibility=gE(n),e.collapsed=!e.collapsed;var r=vE(n,e.collapsed);return[e].concat(r)};mu.prototype.revert=function(t){var e=t.shape,n=t.oldChildrenVisibility,r=e.children,i=yE(r,n);return e.collapsed=!e.collapsed,[e].concat(i)};function gE(t){var e={};return I(t,function(n){e[n.id]=n.hidden,n.children&&(e=L({},e,gE(n.children)))}),e}function vE(t,e){var n=[];return I(t,function(r){r.hidden=e,n=n.concat(r),r.children&&(n=n.concat(vE(r.children,r.collapsed||e)))}),n}function yE(t,e){var n=[];return I(t,function(r){r.hidden=e[r.id],n=n.concat(r),r.children&&(n=n.concat(yE(r.children,e)))}),n}function gu(t){this._modeling=t}gu.$inject=["modeling"];gu.prototype.execute=function(t){var e=t.shape,n=t.newHost,r=e.host;return t.oldHost=r,t.attacherIdx=xE(r,e),bE(n,e),e.host=n,e};gu.prototype.revert=function(t){var e=t.shape,n=t.newHost,r=t.oldHost,i=t.attacherIdx;return e.host=r,xE(n,e),bE(r,e,i),e};function xE(t,e){return At(t&&t.attachers,e)}function bE(t,e,n){if(t){var r=t.attachers;r||(t.attachers=r=[]),Ot(r,e,n)}}function Qm(){}Qm.prototype.execute=function(t){var e=t.connection,n=t.newWaypoints;return t.oldWaypoints=e.waypoints,e.waypoints=n,e};Qm.prototype.revert=function(t){var e=t.connection,n=t.oldWaypoints;return e.waypoints=n,e};function ot(t,e,n){this._eventBus=t,this._elementFactory=e,this._commandStack=n;var r=this;t.on("diagram.init",function(){r.registerHandlers(n)})}ot.$inject=["eventBus","elementFactory","commandStack"];ot.prototype.getHandlers=function(){return{"shape.append":du,"shape.create":Vi,"shape.delete":Ic,"shape.move":As,"shape.resize":Oc,"shape.replace":ti,"shape.toggleCollapse":mu,spaceTool:Gi,"label.create":Rc,"connection.create":uu,"connection.delete":Ac,"connection.move":Xm,"connection.layout":pu,"connection.updateWaypoints":Qm,"connection.reconnect":Dc,"elements.create":Ym,"elements.move":fu,"elements.delete":Zm,"elements.distribute":hu,"elements.align":lu,"element.updateAttachment":gu}};ot.prototype.registerHandlers=function(t){I(this.getHandlers(),function(e,n){t.registerHandler(n,e)})};ot.prototype.moveShape=function(t,e,n,r,i){typeof r=="object"&&(i=r,r=null);var s={shape:t,delta:e,newParent:n,newParentIndex:r,hints:i||{}};this._commandStack.execute("shape.move",s)};ot.prototype.updateAttachment=function(t,e){var n={shape:t,newHost:e};this._commandStack.execute("element.updateAttachment",n)};ot.prototype.moveElements=function(t,e,n,r){r=r||{};var i=r.attach,s=n,a;i===!0?(a=n,s=n.parent):i===!1&&(a=null);var c={shapes:t,delta:e,newParent:s,newHost:a,hints:r};this._commandStack.execute("elements.move",c)};ot.prototype.moveConnection=function(t,e,n,r,i){typeof r=="object"&&(i=r,r=void 0);var s={connection:t,delta:e,newParent:n,newParentIndex:r,hints:i||{}};this._commandStack.execute("connection.move",s)};ot.prototype.layoutConnection=function(t,e){var n={connection:t,hints:e||{}};this._commandStack.execute("connection.layout",n)};ot.prototype.createConnection=function(t,e,n,r,i,s){typeof n=="object"&&(s=i,i=r,r=n,n=void 0),r=this._create("connection",r);var a={source:t,target:e,parent:i,parentIndex:n,connection:r,hints:s};return this._commandStack.execute("connection.create",a),a.connection};ot.prototype.createShape=function(t,e,n,r,i){typeof r!="number"&&(i=r,r=void 0),i=i||{};var s=i.attach,a,c;t=this._create("shape",t),s?(a=n.parent,c=n):a=n;var l={position:e,shape:t,parent:a,parentIndex:r,host:c,hints:i};return this._commandStack.execute("shape.create",l),l.shape};ot.prototype.createElements=function(t,e,n,r,i){Ue(t)||(t=[t]),typeof r!="number"&&(i=r,r=void 0),i=i||{};var s={position:e,elements:t,parent:n,parentIndex:r,hints:i};return this._commandStack.execute("elements.create",s),s.elements};ot.prototype.createLabel=function(t,e,n,r){n=this._create("label",n);var i={labelTarget:t,position:e,parent:r||t.parent,shape:n};return this._commandStack.execute("label.create",i),i.shape};ot.prototype.appendShape=function(t,e,n,r,i){i=i||{},e=this._create("shape",e);var s={source:t,position:n,target:r,shape:e,connection:i.connection,connectionParent:i.connectionParent,hints:i};return this._commandStack.execute("shape.append",s),s.shape};ot.prototype.removeElements=function(t){var e={elements:t};this._commandStack.execute("elements.delete",e)};ot.prototype.distributeElements=function(t,e,n){var r={groups:t,axis:e,dimension:n};this._commandStack.execute("elements.distribute",r)};ot.prototype.removeShape=function(t,e){var n={shape:t,hints:e||{}};this._commandStack.execute("shape.delete",n)};ot.prototype.removeConnection=function(t,e){var n={connection:t,hints:e||{}};this._commandStack.execute("connection.delete",n)};ot.prototype.replaceShape=function(t,e,n){var r={oldShape:t,newData:e,hints:n||{}};return this._commandStack.execute("shape.replace",r),r.newShape};ot.prototype.alignElements=function(t,e){var n={elements:t,alignment:e};this._commandStack.execute("elements.align",n)};ot.prototype.resizeShape=function(t,e,n,r){var i={shape:t,newBounds:e,minBounds:n,hints:r};this._commandStack.execute("shape.resize",i)};ot.prototype.createSpace=function(t,e,n,r,i){var s={delta:n,direction:r,movingShapes:t,resizingShapes:e,start:i};this._commandStack.execute("spaceTool",s)};ot.prototype.updateWaypoints=function(t,e,n){var r={connection:t,newWaypoints:e,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",r)};ot.prototype.reconnect=function(t,e,n,r,i){var s={connection:t,newSource:e,newTarget:n,dockingOrPoints:r,hints:i||{}};this._commandStack.execute("connection.reconnect",s)};ot.prototype.reconnectStart=function(t,e,n,r){r||(r={}),this.reconnect(t,e,t.target,n,L(r,{docking:"source"}))};ot.prototype.reconnectEnd=function(t,e,n,r){r||(r={}),this.reconnect(t,t.source,e,n,L(r,{docking:"target"}))};ot.prototype.connect=function(t,e,n,r){return this.createConnection(t,e,n||{},t.parent,r)};ot.prototype._create=function(t,e){return uC(e)?e:this._elementFactory.create(t,e)};ot.prototype.toggleCollapse=function(t,e){var n={shape:t,hints:e||{}};this._commandStack.execute("shape.toggleCollapse",n)};function $c(t){this._elementRegistry=t}$c.$inject=["elementRegistry"];$c.prototype.execute=function(t){var e=t.element,n=t.moddleElement,r=t.properties;if(!n)throw new Error("<moddleElement> required");var i=t.changed||this._getVisualReferences(n).concat(e),s=t.oldProperties||y$(n,Kh(r));return wE(n,r),t.oldProperties=s,t.changed=i,i};$c.prototype.revert=function(t){var e=t.oldProperties,n=t.moddleElement,r=t.changed;return wE(n,e),r};$c.prototype._getVisualReferences=function(t){var e=this._elementRegistry;return _(t,"bpmn:DataObject")?x$(t,e):[]};function y$(t,e){return $i(e,function(n,r){return n[r]=t.get(r),n},{})}function wE(t,e){I(e,function(n,r){t.set(r,n)})}function x$(t,e){return e.filter(function(n){return _(n,"bpmn:DataObjectReference")&&ce(n).dataObjectRef===t})}var So="default",Gr="id",_E="di",b$={width:0,height:0};function Lc(t,e,n,r){this._elementRegistry=t,this._moddle=e,this._modeling=n,this._textRenderer=r}Lc.$inject=["elementRegistry","moddle","modeling","textRenderer"];Lc.prototype.execute=function(t){var e=t.element,n=[e];if(!e)throw new Error("element required");var r=this._elementRegistry,i=this._moddle.ids,s=e.businessObject,a=j$(t.properties),c=t.oldProperties||w$(e,a);return EE(a,s)&&(i.unclaim(s[Gr]),r.updateId(e,a[Gr]),i.claim(a[Gr],s)),So in a&&(a[So]&&n.push(r.get(a[So].id)),s[So]&&n.push(r.get(s[So].id))),SE(e,a),t.oldProperties=c,t.changed=n,n};Lc.prototype.postExecute=function(t){var e=t.element,n=e.label,r=n&&ce(n).name;if(r){var i=this._textRenderer.getExternalLabelBounds(n,r);this._modeling.resizeShape(n,i,b$)}};Lc.prototype.revert=function(t){var e=t.element,n=t.properties,r=t.oldProperties,i=e.businessObject,s=this._elementRegistry,a=this._moddle.ids;return SE(e,r),EE(n,i)&&(a.unclaim(n[Gr]),s.updateId(e,r[Gr]),a.claim(r[Gr],i)),t.changed};function EE(t,e){return Gr in t&&t[Gr]!==e[Gr]}function w$(t,e){var n=Kh(e),r=t.businessObject,i=at(t);return $i(n,function(s,a){return a!==_E?s[a]=r.get(a):s[a]=_$(i,Kh(e.di)),s},{})}function _$(t,e){return $i(e,function(n,r){return n[r]=t&&t.get(r),n},{})}function SE(t,e){var n=t.businessObject,r=at(t);I(e,function(i,s){s!==_E?n.set(s,i):r&&E$(r,i)})}function E$(t,e){I(e,function(n,r){t.set(r,n)})}var S$=["default"];function j$(t){var e=L({},t);return S$.forEach(function(n){n in t&&(e[n]=ce(e[n]))}),e}function vu(t,e){this._canvas=t,this._modeling=e}vu.$inject=["canvas","modeling"];vu.prototype.execute=function(t){var e=this._canvas,n=t.newRoot,r=n.businessObject,i=e.getRootElement(),s=i.businessObject,a=s.$parent,c=at(i);return e.setRootElement(n),e.removeRootElement(i),Ot(a.rootElements,r),r.$parent=a,At(a.rootElements,s),s.$parent=null,i.di=null,c.bpmnElement=r,n.di=c,t.oldRoot=i,[]};vu.prototype.revert=function(t){var e=this._canvas,n=t.newRoot,r=n.businessObject,i=t.oldRoot,s=i.businessObject,a=r.$parent,c=at(n);return e.setRootElement(i),e.removeRootElement(n),At(a.rootElements,r),r.$parent=null,Ot(a.rootElements,s),s.$parent=a,n.di=null,c.bpmnElement=s,i.di=c,[]};function eg(t,e){this._modeling=t,this._spaceTool=e}eg.$inject=["modeling","spaceTool"];eg.prototype.preExecute=function(t){var e=this._spaceTool,n=this._modeling,r=t.shape,i=t.location,s=Bn(r),a=s===r,c=a?r:r.parent,l=zi(c),d=Vt(r);if(d?i==="left"?i="top":i==="right"&&(i="bottom"):i==="top"?i="left":i==="bottom"&&(i="right"),!l.length){var u=d?{x:r.x+Dn,y:r.y,width:r.width-Dn,height:r.height}:{x:r.x,y:r.y+Dn,width:r.width,height:r.height-Dn};n.createShape({type:"bpmn:Lane",isHorizontal:d},u,c)}var h=[];Pd(s,function(E){return h.push(E),E.label&&h.push(E.label),E===r?[]:Ve(E.children,function(N){return N!==r})});var p,f,m,v,g;i==="top"?(p=-120,f=r.y,m=f+10,v="n",g="y"):i==="left"?(p=-120,f=r.x,m=f+10,v="w",g="x"):i==="bottom"?(p=120,f=r.y+r.height,m=f-10,v="s",g="y"):i==="right"&&(p=120,f=r.x+r.width,m=f-10,v="e",g="x");var w=e.calculateAdjustments(h,g,p,m),b=d?{x:0,y:p}:{x:p,y:0};e.makeSpace(w.movingShapes,w.resizingShapes,b,v,m);var x=d?{x:r.x+(a?Dn:0),y:f-(i==="top"?120:0),width:r.width-(a?Dn:0),height:120}:{x:f-(i==="left"?120:0),y:r.y+(a?Dn:0),width:120,height:r.height-(a?Dn:0)};t.newLane=n.createShape({type:"bpmn:Lane",isHorizontal:d},x,c)};function tg(t){this._modeling=t}tg.$inject=["modeling"];tg.prototype.preExecute=function(t){var e=this._modeling,n=t.shape,r=t.count,i=zi(n),s=i.length;if(s>r)throw new Error(`more than <${r}> child lanes`);var a=Vt(n),c=a?n.height:n.width,l=Math.round(c/r),d,u,h,p;for(p=0;p<r;p++)p===r-1?d=c-l*p:d=l,u=a?{x:n.x+Dn,y:n.y+p*l,width:n.width-Dn,height:d}:{x:n.x+p*l,y:n.y+Dn,width:d,height:n.height-Dn},p<s?e.resizeShape(i[p],u):(h={type:"bpmn:Lane",isHorizontal:a},e.createShape(h,u,n))};function Bc(t,e){this._modeling=t,this._spaceTool=e}Bc.$inject=["modeling","spaceTool"];Bc.prototype.preExecute=function(t){var e=t.shape,n=t.newBounds,r=t.balanced;r!==!1?this.resizeBalanced(e,n):this.resizeSpace(e,n)};Bc.prototype.resizeBalanced=function(t,e){var n=this._modeling,r=QD(t,e);n.resizeShape(t,e),r.forEach(function(i){n.resizeShape(i.shape,i.newBounds)})};Bc.prototype.resizeSpace=function(t,e){var n=this._spaceTool,r=ye(t),i=ye(e),s=S1(i,r),a=Bn(t),c=[],l=[];Pd(a,function(m){return c.push(m),(_(m,"bpmn:Lane")||_(m,"bpmn:Participant"))&&l.push(m),m.children});var d,u,h,p,f;(s.bottom||s.top)&&(d=s.bottom||s.top,u=t.y+(s.bottom?t.height:0)+(s.bottom?-10:10),h=s.bottom?"s":"n",p=s.top>0||s.bottom<0?-d:d,f=n.calculateAdjustments(c,"y",p,u),n.makeSpace(f.movingShapes,f.resizingShapes,{x:0,y:d},h)),(s.left||s.right)&&(d=s.right||s.left,u=t.x+(s.right?t.width:0)+(s.right?-10:100),h=s.right?"e":"w",p=s.left>0||s.right<0?-d:d,f=n.calculateAdjustments(l,"x",p,u),n.makeSpace(f.movingShapes,f.resizingShapes,{x:d,y:0},h))};var nc="flowNodeRef",ng="lanes";function Fc(t){this._elementRegistry=t}Fc.$inject=["elementRegistry"];Fc.prototype._computeUpdates=function(t,e){var n=[],r=[],i={},s=[];function a(u,h){var p=ye(h),f={x:u.x+u.width/2,y:u.y+u.height/2};return f.x>p.left&&f.x<p.right&&f.y>p.top&&f.y<p.bottom}function c(u){n.indexOf(u)===-1&&(s.push(u),n.push(u))}function l(u){var h=Bn(u);return i[h.id]||(i[h.id]=Jd(h)),i[h.id]}function d(u){if(!u.parent)return[];var h=l(u);return h.filter(function(p){return a(u,p)}).map(function(p){return p.businessObject})}return e.forEach(function(u){var h=Bn(u);if(!(!h||n.indexOf(h)!==-1)){var p=h.children.filter(function(f){return _(f,"bpmn:FlowNode")});p.forEach(c),n.push(h)}}),t.forEach(c),s.forEach(function(u){var h=u.businessObject,p=h.get(ng),f=p.slice(),m=d(u);r.push({flowNode:h,remove:f,add:m})}),e.forEach(function(u){var h=u.businessObject;u.parent||h.get(nc).forEach(function(p){r.push({flowNode:p,remove:[h],add:[]})})}),r};Fc.prototype.execute=function(t){var e=t.updates;return e||(e=t.updates=this._computeUpdates(t.flowNodeShapes,t.laneShapes)),e.forEach(function(n){var r=n.flowNode,i=r.get(ng);n.remove.forEach(function(s){At(i,s),At(s.get(nc),r)}),n.add.forEach(function(s){Ot(i,s),Ot(s.get(nc),r)})}),[]};Fc.prototype.revert=function(t){var e=t.updates;return e.forEach(function(n){var r=n.flowNode,i=r.get(ng);n.add.forEach(function(s){At(i,s),At(s.get(nc),r)}),n.remove.forEach(function(s){Ot(i,s),Ot(s.get(nc),r)})}),[]};function yu(t){this._moddle=t}yu.$inject=["moddle"];yu.prototype.execute=function(t){var e=this._moddle.ids,n=t.id,r=t.element,i=t.claiming;return i?e.claim(n,r):e.unclaim(n),[]};yu.prototype.revert=function(t){var e=this._moddle.ids,n=t.id,r=t.element,i=t.claiming;return i?e.unclaim(n):e.claim(n,r),[]};var N$={fill:void 0,stroke:void 0};function rg(t){this._commandStack=t,this._normalizeColor=function(e){if(e){if(Sd(e)){var n=k$(e);if(n)return n}throw new Error(`invalid color value: ${e}`)}}}rg.$inject=["commandStack"];rg.prototype.postExecute=function(t){var e=t.elements,n=t.colors||N$,r=this,i={};"fill"in n&&L(i,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&L(i,{"border-color":this._normalizeColor(n.stroke)}),I(e,function(s){var a=lt(s)?jr(i,["border-color"]):i,c=at(s);if(C$(a),We(s))r._commandStack.execute("element.updateModdleProperties",{element:s,moddleElement:c.label,properties:{color:i["border-color"]}});else{if(!Me(c,["bpmndi:BPMNEdge","bpmndi:BPMNShape"]))return;r._commandStack.execute("element.updateProperties",{element:s,properties:{di:a}})}})};function k$(t){var e=document.createElement("canvas").getContext("2d");return e.fillStyle="transparent",e.fillStyle=t,/^#[0-9a-fA-F]{6}$/.test(e.fillStyle)?e.fillStyle:null}function C$(t){"border-color"in t&&(t.stroke=t["border-color"]),"background-color"in t&&(t.fill=t["background-color"])}var P$={width:0,height:0};function jE(t,e,n){function r(l,d){var u=l.label||l,h=l.labelTarget||l;return hC(u,d),[u,h]}function i(l){var d=l.element,u=d.businessObject,h=l.newLabel;if(!We(d)&&xa(d)&&!Cd(d)&&!Tx(h)){var p=7,f=Mw(d);f={x:f.x,y:f.y+p},t.createLabel(d,f,{id:u.id+"_label",businessObject:u,di:d.di})}}function s(l){return l.oldLabel=js(l.element),r(l.element,l.newLabel)}function a(l){return r(l.element,l.oldLabel)}function c(l){var d=l.element,u=d.label||d,h=l.newLabel,p=l.newBounds,f=l.hints||{};if(!(!We(u)&&!_(u,"bpmn:TextAnnotation"))){if(We(u)&&Tx(h)){f.removeShape!==!1&&t.removeShape(u,{unsetLabel:!1});return}var m=js(d);typeof p>"u"&&(p=e.getExternalLabelBounds(u,m)),p&&t.resizeShape(u,p,P$)}}this.preExecute=i,this.execute=s,this.revert=a,this.postExecute=c}jE.$inject=["modeling","textRenderer","bpmnFactory"];function Tx(t){return!t||!t.trim()}function Zt(t,e,n,r){ot.call(this,t,e,n),this._bpmnRules=r}fe(Zt,ot);Zt.$inject=["eventBus","elementFactory","commandStack","bpmnRules"];Zt.prototype.getHandlers=function(){var t=ot.prototype.getHandlers.call(this);return t["element.updateModdleProperties"]=$c,t["element.updateProperties"]=Lc,t["canvas.updateRoot"]=vu,t["lane.add"]=eg,t["lane.resize"]=Bc,t["lane.split"]=tg,t["lane.updateRefs"]=Fc,t["id.updateClaim"]=yu,t["element.setColor"]=rg,t["element.updateLabel"]=jE,t};Zt.prototype.updateLabel=function(t,e,n,r){this._commandStack.execute("element.updateLabel",{element:t,newLabel:e,newBounds:n,hints:r||{}})};Zt.prototype.connect=function(t,e,n,r){var i=this._bpmnRules;if(n||(n=i.canConnect(t,e)),!!n)return this.createConnection(t,e,n,t.parent,r)};Zt.prototype.updateModdleProperties=function(t,e,n){this._commandStack.execute("element.updateModdleProperties",{element:t,moddleElement:e,properties:n})};Zt.prototype.updateProperties=function(t,e){this._commandStack.execute("element.updateProperties",{element:t,properties:e})};Zt.prototype.resizeLane=function(t,e,n){this._commandStack.execute("lane.resize",{shape:t,newBounds:e,balanced:n})};Zt.prototype.addLane=function(t,e){var n={shape:t,location:e};return this._commandStack.execute("lane.add",n),n.newLane};Zt.prototype.splitLane=function(t,e){this._commandStack.execute("lane.split",{shape:t,count:e})};Zt.prototype.makeCollaboration=function(){var t=this._create("root",{type:"bpmn:Collaboration"}),e={newRoot:t};return this._commandStack.execute("canvas.updateRoot",e),t};Zt.prototype.makeProcess=function(){var t=this._create("root",{type:"bpmn:Process"}),e={newRoot:t};return this._commandStack.execute("canvas.updateRoot",e),t};Zt.prototype.updateLaneRefs=function(t,e){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:t,laneShapes:e})};Zt.prototype.claimId=function(t,e){this._commandStack.execute("id.updateClaim",{id:t,element:e,claiming:!0})};Zt.prototype.unclaimId=function(t,e){this._commandStack.execute("id.updateClaim",{id:t,element:e})};Zt.prototype.setColor=function(t,e){t.length||(t=[t]),this._commandStack.execute("element.setColor",{elements:t,colors:e})};function NE(){}NE.prototype.layoutConnection=function(t,e){return e=e||{},[e.connectionStart||we(e.source||t.source),e.connectionEnd||we(e.target||t.target)]};var kl=20,T$=5,id=Math.round,Rx=20,R$={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function A$(t,e){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[e].test(t)}function I$(t,e){return{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[t].test(e)}function kE(t,e,n){var r=Yt(e,t,T$),i=n.split(":")[0],s=id((e.x-t.x)/2+t.x),a=id((e.y-t.y)/2+t.y),c,l,d=I$(i,r),u=/h|r|l/.test(i),h=!1,p=!1;return d?(c=u?{x:s,y:t.y}:{x:t.x,y:a},l=u?"h:h":"v:v"):(h=A$(r,i),l=u?"h:v":"v:h",h?u?(p=a===t.y,c={x:t.x+kl*(/l/.test(i)?-1:1),y:p?a+kl:a}):(p=s===t.x,c={x:p?s+kl:s,y:t.y+kl*(/t/.test(i)?-1:1)}):c={x:s,y:a}),{waypoints:ig(t,c,l).concat(c),directions:l,turnNextDirections:p}}function M$(t,e,n){return kE(t,e,n)}function D$(t,e,n){var r=kE(e,t,Ax(n));return{waypoints:r.waypoints.slice().reverse(),directions:Ax(r.directions),turnNextDirections:r.turnNextDirections}}function O$(t,e){var n=t.directions.split(":")[1],r=e.directions.split(":")[0];t.turnNextDirections&&(n=n=="h"?"v":"h"),e.turnNextDirections&&(r=r=="h"?"v":"h");var i=n+":"+r,s=ig(t.waypoints[t.waypoints.length-1],e.waypoints[0],i);return{waypoints:s,directions:i}}function Ax(t){return t.split(":").reverse().join(":")}function $$(t,e,n){var r=id((e.x-t.x)/2+t.x),i=id((e.y-t.y)/2+t.y);if(n==="h:v")return[{x:e.x,y:t.y}];if(n==="v:h")return[{x:t.x,y:e.y}];if(n==="h:h")return[{x:r,y:t.y},{x:r,y:e.y}];if(n==="v:v")return[{x:t.x,y:i},{x:e.x,y:i}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}function ig(t,e,n){if(n=n||"h:h",!W$(n))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(CE(n)){var r=M$(t,e,n),i=D$(t,e,n),s=O$(r,i);return[].concat(r.waypoints,s.waypoints,i.waypoints)}return $$(t,e,n)}function L$(t,e,n){var r=ig(t,e,n);return r.unshift(t),r.push(e),PE(r)}function B$(t,e,n,r,i){var s=i&&i.preferredLayouts||[],a=pC(s,"straight")[0]||"h:h",c=R$[a]||0,l=Yt(t,e,c),d=G$(l,a);n=n||we(t),r=r||we(e);var u=d.split(":"),h=Mx(n,t,u[0],q$(l)),p=Mx(r,e,u[1],l);return L$(h,p,d)}function F$(t,e,n,r,i,s){Ue(n)&&(i=n,s=r,n=we(t),r=we(e)),s=L({preferredLayouts:[]},s),i=i||[];var a=s.preferredLayouts,c=a.indexOf("straight")!==-1,l;return l=c&&U$(t,e,n,r,s),l||(l=s.connectionEnd&&V$(e,t,r,i),l)||(l=s.connectionStart&&H$(t,e,n,i),l)?l:!s.connectionStart&&!s.connectionEnd&&i&&i.length?i:B$(t,e,n,r,s)}function z$(t,e,n){return t>=e&&t<=n}function Ix(t,e,n){var r={x:"width",y:"height"};return z$(e[t],n[t],n[t]+n[r[t]])}function U$(t,e,n,r,i){var s={},a,c;return c=Yt(t,e),/^(top|bottom|left|right)$/.test(c)?(/top|bottom/.test(c)&&(a="x"),/left|right/.test(c)&&(a="y"),i.preserveDocking==="target"?Ix(a,r,t)?(s[a]=r[a],[{x:s.x!==void 0?s.x:n.x,y:s.y!==void 0?s.y:n.y,original:{x:s.x!==void 0?s.x:n.x,y:s.y!==void 0?s.y:n.y}},{x:r.x,y:r.y}]):null:Ix(a,n,e)?(s[a]=n[a],[{x:n.x,y:n.y},{x:s.x!==void 0?s.x:r.x,y:s.y!==void 0?s.y:r.y,original:{x:s.x!==void 0?s.x:r.x,y:s.y!==void 0?s.y:r.y}}]):null):null}function H$(t,e,n,r){return sg(t,e,n,r)}function V$(t,e,n,r){var i=r.slice().reverse();return i=sg(t,e,n,i),i?i.reverse():null}function sg(t,e,n,r){function i(u){return u.length<3?!0:u.length>4?!1:!!mt(u,function(h,p){var f=u[p-1];return f&&Cw(h,f)<3})}function s(u,h,p){var f=Ur(h,u);switch(f){case"v":return{x:p.x,y:u.y};case"h":return{x:u.x,y:p.y}}return{x:u.x,y:u.y}}function a(u,h,p){var f;for(f=u.length-2;f!==0;f--)if(Qg(u[f],h,Rx)||Qg(u[f],p,Rx))return u.slice(f);return u}if(i(r))return null;var c=r[0],l=r.slice(),d;return l[0]=n,l[1]=s(l[1],c,n),d=a(l,t,e),d!==l&&(l=sg(t,e,n,d)),l&&Ur(l)?null:l}function G$(t,e){if(CE(e))return e;switch(t){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return e}}function W$(t){return t&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(t)}function CE(t){return t&&/t|r|b|l/.test(t)}function q$(t){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[t]}function Mx(t,e,n,r){if(n==="h"&&(n=/left/.test(r)?"l":"r"),n==="v"&&(n=/top/.test(r)?"t":"b"),n==="t")return{original:t,x:t.x,y:e.y};if(n==="r")return{original:t,x:e.x+e.width,y:t.y};if(n==="b")return{original:t,x:t.x,y:e.y+e.height};if(n==="l")return{original:t,x:e.x,y:t.y};throw new Error("unexpected dockingDirection: <"+n+">")}function PE(t){return t.reduce(function(e,n,r){var i=e[e.length-1],s=t[r+1];return Pw(i,s,n,0)||e.push(n),e},[])}var K$=-10,Y$=40,Z$={default:["h:h"],fromGateway:["v:h"],toGateway:["h:v"],loop:{fromTop:["t:r"],fromRight:["r:b"],fromLeft:["l:t"],fromBottom:["b:l"]},boundaryLoop:{alternateHorizontalSide:"b",alternateVerticalSide:"l",default:"v"},messageFlow:["straight","v:v"],subProcess:["straight","h:h"],isHorizontal:!0},X$={default:["v:v"],fromGateway:["h:v"],toGateway:["v:h"],loop:{fromTop:["t:l"],fromRight:["r:t"],fromLeft:["l:b"],fromBottom:["b:r"]},boundaryLoop:{alternateHorizontalSide:"t",alternateVerticalSide:"r",default:"h"},messageFlow:["straight","h:h"],subProcess:["straight","v:v"],isHorizontal:!1},ag={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},ko={top:"t",right:"r",bottom:"b",left:"l"};function xu(t){this._elementRegistry=t}fe(xu,NE);xu.prototype.layoutConnection=function(t,e){e||(e={});var n=e.source||t.source,r=e.target||t.target,i=e.waypoints||t.waypoints,s=e.connectionStart,a=e.connectionEnd,c=this._elementRegistry,l,d;if(s||(s=Dx(i&&i[0],n)),a||(a=Dx(i&&i[i.length-1],r)),(_(t,"bpmn:Association")||_(t,"bpmn:DataAssociation"))&&i&&!Ox(n,r))return[].concat([s],i.slice(1,-1),[a]);var u=e1(n,c)?Z$:X$;return _(t,"bpmn:MessageFlow")?l=Q$(n,r,u):(_(t,"bpmn:SequenceFlow")||Ox(n,r))&&(n===r?l={preferredLayouts:sL(n,t,u)}:_(n,"bpmn:BoundaryEvent")?l={preferredLayouts:aL(n,r,a,u)}:rc(n)||rc(r)?l={preferredLayouts:u.subProcess,preserveDocking:tL(n)}:_(n,"bpmn:Gateway")?l={preferredLayouts:u.fromGateway}:_(r,"bpmn:Gateway")?l={preferredLayouts:u.toGateway}:l={preferredLayouts:u.default}),l&&(l=L(l,e),d=PE(F$(n,r,s,a,i,l))),d||[s,a]};function J$(t){var e=t.host;return Yt(we(t),e,K$)}function Q$(t,e,n){return{preferredLayouts:n.messageFlow,preserveDocking:eL(t,e)}}function eL(t,e){return _(e,"bpmn:Participant")?"source":_(t,"bpmn:Participant")?"target":rc(e)?"source":rc(t)||_(e,"bpmn:Event")?"target":_(t,"bpmn:Event")?"source":null}function tL(t){return rc(t)?"target":"source"}function Dx(t,e){return t?t.original||t:we(e)}function Ox(t,e){return _(e,"bpmn:Activity")&&_(t,"bpmn:BoundaryEvent")&&e.businessObject.isForCompensation}function rc(t){return _(t,"bpmn:SubProcess")&&Ze(t)}function gs(t,e){return t===e}function nL(t,e){return e.indexOf(t)!==-1}function Ta(t){var e=/right|left/.exec(t);return e&&e[0]}function Ra(t){var e=/top|bottom/.exec(t);return e&&e[0]}function $x(t,e){return ag[t]===e}function rL(t,e){var n=Ta(t),r=ag[n];return e.indexOf(r)!==-1}function iL(t,e){var n=Ra(t),r=ag[n];return e.indexOf(r)!==-1}function TE(t){return t==="right"||t==="left"}function sL(t,e,n){var r=e.waypoints,i=r&&r.length&&Yt(r[0],t);return i==="top"?n.loop.fromTop:i==="right"?n.loop.fromRight:i==="left"?n.loop.fromLeft:n.loop.fromBottom}function aL(t,e,n,r){var i=we(t),s=we(e),a=J$(t),c,l,d=gs(t.host,e),u=nL(a,["top","right","bottom","left"]),h=Yt(s,i,{x:t.width/2+e.width/2,y:t.height/2+e.height/2});return d?oL(a,u,t,e,n,r):(c=cL(a,h,u,r.isHorizontal),l=lL(a,h,u,r.isHorizontal),[c+":"+l])}function oL(t,e,n,r,i,s){var a=e?t:s.isHorizontal?Ra(t):Ta(t),c=ko[a],l;return e?TE(t)?l=Lx("y",n,r,i)?"h":s.boundaryLoop.alternateHorizontalSide:l=Lx("x",n,r,i)?"v":s.boundaryLoop.alternateVerticalSide:l=s.boundaryLoop.default,[c+":"+l]}function Lx(t,e,n,r){var i=Y$;return!(Ih(t,r,n,i)||Ih(t,r,{x:n.x+n.width,y:n.y+n.height},i)||Ih(t,r,we(e),i))}function Ih(t,e,n,r){return Math.abs(e[t]-n[t])<r}function cL(t,e,n,r){if(n)return ko[t];var i=Ra(t),s=Ta(t),a=Ra(e),c=Ta(e);if(r){if(gs(i,a)||$x(s,c))return ko[i]}else if(gs(s,c)||$x(i,a))return ko[s];return ko[r?s:i]}function lL(t,e,n,r){return n?TE(t)?rL(t,e)||gs(t,e)?"h":"v":iL(t,e)||gs(t,e)?"v":"h":r?gs(Ra(t),Ra(e))?"h":"v":gs(Ta(t),Ta(e))?"v":"h"}xu.$inject=["elementRegistry"];function Bx(t){return L({original:t.point.original||t.point},t.actual)}function Wi(t,e){this._elementRegistry=t,this._graphicsFactory=e}Wi.$inject=["elementRegistry","graphicsFactory"];Wi.prototype.getCroppedWaypoints=function(t,e,n){e=e||t.source,n=n||t.target;var r=this.getDockingPoint(t,e,!0),i=this.getDockingPoint(t,n),s=t.waypoints.slice(r.idx+1,i.idx);return s.unshift(Bx(r)),s.push(Bx(i)),s};Wi.prototype.getDockingPoint=function(t,e,n){var r=t.waypoints,i,s,a;return i=n?0:r.length-1,s=r[i],a=this._getIntersection(e,t,n),{point:s,actual:a||s,idx:i}};Wi.prototype._getIntersection=function(t,e,n){var r=this._getShapePath(t),i=this._getConnectionPath(e);return Wh(r,i,n)};Wi.prototype._getConnectionPath=function(t){return this._graphicsFactory.getConnectionPath(t)};Wi.prototype._getShapePath=function(t){return this._graphicsFactory.getShapePath(t)};Wi.prototype._getGfx=function(t){return this._elementRegistry.getGraphics(t)};const RE={__init__:["modeling","bpmnUpdater"],__depends__:[i5,_5,S5,j5,uE,Q5,t$,o$,Nr,Dw,fE],bpmnFactory:["type",qn],bpmnUpdater:["type",Nn],elementFactory:["type",Hi],modeling:["type",Zt],layouter:["type",xu],connectionDocking:["type",Wi]},Fx=Math.round;function bu(t,e,n,r,i,s){this._complexPreview=t,this._connectionDocking=e,this._elementFactory=n,this._eventBus=r,this._layouter=i,this._rules=s}bu.prototype.create=function(t,e,n){const r=this._complexPreview,i=this._connectionDocking,s=this._elementFactory,a=this._eventBus,c=this._layouter,l=this._rules,d=s.createShape(L({type:e},n)),u=a.fire("autoPlace",{source:t,shape:d});if(!u)return;L(d,{x:u.x-Fx(d.width/2),y:u.y-Fx(d.height/2)});const h=l.allowed("connection.create",{source:t,target:d,hints:{targetParent:t.parent}});let p=null;h&&(p=s.createConnection(h),p.waypoints=c.layoutConnection(p,{source:t,target:d}),p.waypoints=i.getCroppedWaypoints(p,t,d)),r.create({created:[d,p].filter(f=>!Gh(f))})};bu.prototype.cleanUp=function(){this._complexPreview.cleanUp()};bu.$inject=["complexPreview","connectionDocking","elementFactory","eventBus","layouter","rules"];const dL={__depends__:[Jf,ID,RE],__init__:["appendPreview"],appendPreview:["type",bu]};var zx=Math.min,Ux=Math.max;function Mh(t){t.preventDefault()}function Go(t){t.stopPropagation()}function uL(t){return t.nodeType===Node.TEXT_NODE}function hL(t){return[].slice.call(t)}function hr(t){this.container=t.container,this.parent=Ht('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=Ct("[contenteditable]",this.parent),this.keyHandler=t.keyHandler||function(){},this.resizeHandler=t.resizeHandler||function(){},this.autoResize=Ss(this.autoResize,this),this.handlePaste=Ss(this.handlePaste,this)}hr.prototype.create=function(t,e,n,r){var i=this,s=this.parent,a=this.content,c=this.container;r=this.options=r||{},e=this.style=e||{};var l=jr(e,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);L(s.style,{width:t.width+"px",height:t.height+"px",maxWidth:t.maxWidth+"px",maxHeight:t.maxHeight+"px",minWidth:t.minWidth+"px",minHeight:t.minHeight+"px",left:t.x+"px",top:t.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},l);var d=jr(e,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return L(a.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},d),r.centerVertically&&L(a.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},d),a.innerText=n,je.bind(a,"keydown",this.keyHandler),je.bind(a,"mousedown",Go),je.bind(a,"paste",i.handlePaste),r.autoResize&&je.bind(a,"input",this.autoResize),r.resizable&&this.resizable(e),c.appendChild(s),this.setSelection(a.lastChild,a.lastChild&&a.lastChild.length),s};hr.prototype.handlePaste=function(t){var e=this.options,n=this.style;t.preventDefault();var r;if(t.clipboardData?r=t.clipboardData.getData("text/plain"):r=window.clipboardData.getData("Text"),this.insertText(r),e.autoResize){var i=this.autoResize(n);i&&this.resizeHandler(i)}};hr.prototype.insertText=function(t){t=pL(t);var e=document.execCommand("insertText",!1,t);e||this._insertTextIE(t)};hr.prototype._insertTextIE=function(t){var e=this.getSelection(),n=e.startContainer,r=e.endContainer,i=e.startOffset,s=e.endOffset,a=e.commonAncestorContainer,c=hL(a.childNodes),l,d;if(uL(a)){var u=n.textContent;n.textContent=u.substring(0,i)+t+u.substring(s),l=n,d=i+t.length}else if(n===this.content&&r===this.content){var h=document.createTextNode(t);this.content.insertBefore(h,c[i]),l=h,d=h.textContent.length}else{var p=c.indexOf(n),f=c.indexOf(r);c.forEach(function(m,v){v===p?m.textContent=n.textContent.substring(0,i)+t+r.textContent.substring(s):v>p&&v<=f&&ya(m)}),l=n,d=i+t.length}l&&d!==void 0&&setTimeout(function(){self.setSelection(l,d)})};hr.prototype.autoResize=function(){var t=this.parent,e=this.content,n=parseInt(this.style.fontSize)||12;if(e.scrollHeight>t.offsetHeight||e.scrollHeight<t.offsetHeight-n){var r=t.getBoundingClientRect(),i=e.scrollHeight;t.style.height=i+"px",this.resizeHandler({width:r.width,height:r.height,dx:0,dy:i-r.height})}};hr.prototype.resizable=function(){var t=this,e=this.parent,n=this.resizeHandle,r=parseInt(this.style.minWidth)||0,i=parseInt(this.style.minHeight)||0,s=parseInt(this.style.maxWidth)||1/0,a=parseInt(this.style.maxHeight)||1/0;if(!n){n=this.resizeHandle=Ht('<div class="djs-direct-editing-resize-handle"></div>');var c,l,d,u,h=function(m){Mh(m),Go(m),c=m.clientX,l=m.clientY;var v=e.getBoundingClientRect();d=v.width,u=v.height,je.bind(document,"mousemove",p),je.bind(document,"mouseup",f)},p=function(m){Mh(m),Go(m);var v=zx(Ux(d+m.clientX-c,r),s),g=zx(Ux(u+m.clientY-l,i),a);e.style.width=v+"px",e.style.height=g+"px",t.resizeHandler({width:d,height:u,dx:m.clientX-c,dy:m.clientY-l})},f=function(m){Mh(m),Go(m),je.unbind(document,"mousemove",p,!1),je.unbind(document,"mouseup",f,!1)};je.bind(n,"mousedown",h)}L(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),e.appendChild(n)};hr.prototype.destroy=function(){var t=this.parent,e=this.content,n=this.resizeHandle;e.innerText="",t.removeAttribute("style"),e.removeAttribute("style"),je.unbind(e,"keydown",this.keyHandler),je.unbind(e,"mousedown",Go),je.unbind(e,"input",this.autoResize),je.unbind(e,"paste",this.handlePaste),n&&(n.removeAttribute("style"),ya(n)),ya(t)};hr.prototype.getValue=function(){return this.content.innerText.trim()};hr.prototype.getSelection=function(){var t=window.getSelection(),e=t.getRangeAt(0);return e};hr.prototype.setSelection=function(t,e){var n=document.createRange();t===null?n.selectNodeContents(this.content):(n.setStart(t,e),n.setEnd(t,e));var r=window.getSelection();r.removeAllRanges(),r.addRange(n)};function pL(t){return t.replace(/\r\n|\r|\n/g,`
`)}function Kn(t,e){this._eventBus=t,this._canvas=e,this._providers=[],this._textbox=new hr({container:e.getContainer(),keyHandler:Ss(this._handleKey,this),resizeHandler:Ss(this._handleResize,this)})}Kn.$inject=["eventBus","canvas"];Kn.prototype.registerProvider=function(t){this._providers.push(t)};Kn.prototype.isActive=function(t){return!!(this._active&&(!t||this._active.element===t))};Kn.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())};Kn.prototype._fire=function(t,e){this._eventBus.fire("directEditing."+t,e||{active:this._active})};Kn.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0,this._canvas.restoreFocus&&this._canvas.restoreFocus()};Kn.prototype.complete=function(){var t=this._active;if(t){var e,n=t.context.bounds,r=this.$textbox.getBoundingClientRect(),i=this.getValue(),s=t.context.text;(i!==s||r.height!==n.height||r.width!==n.width)&&(e=this._textbox.container.getBoundingClientRect(),t.provider.update(t.element,i,t.context.text,{x:r.left-e.left,y:r.top-e.top,width:r.width,height:r.height})),this._fire("complete"),this.close()}};Kn.prototype.getValue=function(){return this._textbox.getValue()};Kn.prototype._handleKey=function(t){t.stopPropagation();var e=t.keyCode||t.charCode;if(e===27)return t.preventDefault(),this.cancel();if(e===13&&!t.shiftKey)return t.preventDefault(),this.complete()};Kn.prototype._handleResize=function(t){this._fire("resize",t)};Kn.prototype.activate=function(t){this.isActive()&&this.cancel();var e,n=mt(this._providers,function(r){return(e=r.activate(t))?r:null});return e&&(this.$textbox=this._textbox.create(e.bounds,e.style,e.text,e.options),this._active={element:t,context:e,provider:n},e.options&&e.options.resizable&&(this.resizable=!0),this._fire("activate")),!!e};const AE={__depends__:[hf],__init__:["directEditing"],directEditing:["type",Kn]};function fL(t){return function(e){var n=e.target,r=ce(t),i=r.eventDefinitions&&r.eventDefinitions[0],s=r.$type===n.type,a=(i&&i.$type)===n.eventDefinitionType,c=!!n.triggeredByEvent==!!r.triggeredByEvent,l=n.isExpanded===void 0||n.isExpanded===Ze(t);return!s||!a||!c||!l}}var mL=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],gL=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],vL=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link intermediate catch event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link intermediate throw event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],yL=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel end event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate end event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],xL=[{label:"Exclusive gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event-based gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],bL=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],wL=[{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}}],IE=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],_L=IE,Hx=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"User task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Service task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Send task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"Manual task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business rule task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Script task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub-process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}},{label:"Ad-hoc sub-process (expanded)",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}}],EL=[{label:"Data store reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],SL=[{label:"Data object reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],jL=[{label:"Message boundary event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!0}},{label:"Timer boundary event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!0}},{label:"Escalation boundary event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!0}},{label:"Conditional boundary event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!0}},{label:"Error boundary event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",cancelActivity:!0}},{label:"Cancel boundary event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition",cancelActivity:!0}},{label:"Signal boundary event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!0}},{label:"Compensation boundary event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",cancelActivity:!0}},{label:"Message boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],NL=[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!0}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!0}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!0}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!0}},{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",isInterrupting:!0}},{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!0}},{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",isInterrupting:!0}},{label:"Message start event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer start event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional start event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal start event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation start event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],kL=[{label:"Sequence flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],CL=[{label:"Expanded pool/participant",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(t){var e="Empty pool/participant";return t.children&&t.children.length&&(e+=" (removes content)"),e},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}],PL={"bpmn:MessageEventDefinition":[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}}],"bpmn:TimerEventDefinition":[{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}}],"bpmn:ConditionalEventDefinition":[{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}}],"bpmn:SignalEventDefinition":[{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],"bpmn:ErrorEventDefinition":[{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}}],"bpmn:EscalationEventDefinition":[{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}}],"bpmn:CompensateEventDefinition":[{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}}]};const Vx={"start-event-non-interrupting":`
  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">
    <g transform="translate(0 995.64)">
      <path d="m1899 28.357c21.545 567.43-598.38 1023.5-1133.6 835.92-548.09-147.21-801.57-873.95-463.59-1330 302.62-480.3 1071.7-507.54 1407.6-49.847 122.14 153.12 190.07 348.07 189.59 543.91z" fill="none" stroke="currentColor" stroke-dasharray="418.310422, 361.2328165" stroke-linecap="round" stroke-width="100"/>
    </g>
  </svg>`,"intermediate-event-non-interrupting":`
  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">
     <g transform="translate(0 995.64)" fill="none" stroke="currentColor" stroke-linecap="round">
        <circle cx="1024" cy="28.357" r="875" stroke-dasharray="418.310422, 361.2328165" stroke-width="100"/>
        <circle cx="1024" cy="28.357" r="685" stroke-dasharray="348.31044857,261.23283643" stroke-dashoffset="500" stroke-width="100"/>
     </g>
  </svg>`};function Yn(t,e,n,r,i,s,a,c){this._bpmnFactory=t,this._popupMenu=e,this._modeling=n,this._moddle=r,this._bpmnReplace=i,this._rules=s,this._translate=a,this._moddleCopy=c,this._register()}Yn.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate","moddleCopy"];Yn.prototype._register=function(){this._popupMenu.registerProvider("bpmn-replace",this)};Yn.prototype.getPopupMenuEntries=function(t){var c;var e=t.businessObject,n=this._rules,r=[],i,s=[];if(Ue(t)||!n.allowed("shape.replace",{element:t}))return{};var a=fL(t);return _(e,"bpmn:DataObjectReference")?this._createEntries(t,EL):_(e,"bpmn:DataStoreReference")&&!_(t.parent,"bpmn:Collaboration")?this._createEntries(t,SL):(_(e,"bpmn:Event")&&!_(e,"bpmn:BoundaryEvent")&&(i=(c=e.get("eventDefinitions")[0])==null?void 0:c.$type,r=PL[i]||[],!cn(e.$parent)&&_(e.$parent,"bpmn:SubProcess")&&(r=Ve(r,function(l){return l.target.type!=="bpmn:StartEvent"}))),_(e,"bpmn:StartEvent")&&!_(e.$parent,"bpmn:SubProcess")?(s=Ve(mL.concat(r),a),this._createEntries(t,s)):_(e,"bpmn:Participant")?(s=Ve(CL,function(l){return Ze(t)!==l.target.isExpanded}),this._createEntries(t,s)):_(e,"bpmn:StartEvent")&&cn(e.$parent)?(s=Ve(NL.concat(r),function(l){var d=l.target,u=d.isInterrupting!==!1,h=e.isInterrupting===u;return a(l)||!a(l)&&!h}),this._createEntries(t,s)):_(e,"bpmn:StartEvent")&&!cn(e.$parent)&&_(e.$parent,"bpmn:SubProcess")?(s=Ve(gL.concat(r),a),this._createEntries(t,s)):_(e,"bpmn:EndEvent")?(s=Ve(yL.concat(r),function(l){var d=l.target;return d.eventDefinitionType=="bpmn:CancelEventDefinition"&&!_(e.$parent,"bpmn:Transaction")?!1:a(l)}),this._createEntries(t,s)):_(e,"bpmn:BoundaryEvent")?(s=Ve(jL,function(l){var d=l.target;if(d.eventDefinitionType=="bpmn:CancelEventDefinition"&&!_(e.attachedToRef,"bpmn:Transaction"))return!1;var u=d.cancelActivity!==!1,h=e.cancelActivity==u;return a(l)||!a(l)&&!h}),this._createEntries(t,s)):_(e,"bpmn:IntermediateCatchEvent")||_(e,"bpmn:IntermediateThrowEvent")?(s=Ve(vL.concat(r),a),this._createEntries(t,s)):_(e,"bpmn:Gateway")?(s=Ve(xL,a),this._createEntries(t,s)):_(e,"bpmn:Transaction")?(s=Ve(IE,a),this._createEntries(t,s)):cn(e)&&Ze(t)?(s=Ve(_L,a),this._createEntries(t,s)):_(e,"bpmn:AdHocSubProcess")&&Ze(t)?(s=Ve(wL,a),this._createEntries(t,s)):_(e,"bpmn:SubProcess")&&Ze(t)?(s=Ve(bL,a),this._createEntries(t,s)):_(e,"bpmn:SubProcess")&&!Ze(t)?(s=Ve(Hx,function(l){var d=l.target.type===t.type,u=l.target.isExpanded===!0;return d===u}),this._createEntries(t,s)):_(e,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(t,kL):_(e,"bpmn:FlowNode")?(s=Ve(Hx,a),this._createEntries(t,s)):{})};Yn.prototype.getPopupMenuHeaderEntries=function(t){var e={};return _(t,"bpmn:Activity")&&!cn(t)&&(e={...e,...this._getLoopCharacteristicsHeaderEntries(t)}),_(t,"bpmn:DataObjectReference")&&(e={...e,...this._getCollectionHeaderEntries(t)}),_(t,"bpmn:Participant")&&(e={...e,...this._getParticipantMultiplicityHeaderEntries(t)}),M1(t)&&(e={...e,...this._getNonInterruptingHeaderEntries(t)}),e};Yn.prototype._createEntries=function(t,e){var n={},r=this;return I(e,function(i){n[i.actionName]=r._createEntry(i,t)}),n};Yn.prototype._createSequenceFlowEntries=function(t,e){var n=ce(t),r={},i=this._modeling,s=this._moddle,a=this;return I(e,function(c){switch(c.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&(_(n.sourceRef,"bpmn:ExclusiveGateway")||_(n.sourceRef,"bpmn:InclusiveGateway")||_(n.sourceRef,"bpmn:ComplexGateway")||_(n.sourceRef,"bpmn:Activity"))&&(r={...r,[c.actionName]:a._createEntry(c,t,function(){i.updateProperties(t.source,{default:n})})});break;case"replace-with-conditional-flow":!n.conditionExpression&&_(n.sourceRef,"bpmn:Activity")&&(r={...r,[c.actionName]:a._createEntry(c,t,function(){var l=s.create("bpmn:FormalExpression",{body:""});i.updateProperties(t,{conditionExpression:l})})});break;default:_(n.sourceRef,"bpmn:Activity")&&n.conditionExpression&&(r={...r,[c.actionName]:a._createEntry(c,t,function(){i.updateProperties(t,{conditionExpression:void 0})})}),(_(n.sourceRef,"bpmn:ExclusiveGateway")||_(n.sourceRef,"bpmn:InclusiveGateway")||_(n.sourceRef,"bpmn:ComplexGateway")||_(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n&&(r={...r,[c.actionName]:a._createEntry(c,t,function(){i.updateProperties(t.source,{default:void 0})})})}}),r};Yn.prototype._createEntry=function(t,e,n){var r=this._translate,i=this._bpmnReplace.replaceElement,s=function(){return i(e,t.target)},a=t.label;return a&&typeof a=="function"&&(a=a(e)),n=n||s,{label:r(a),className:t.className,action:n}};Yn.prototype._getLoopCharacteristicsHeaderEntries=function(t){var e=this,n=this._translate;function r(d,u){if(u.active){e._modeling.updateProperties(t,{loopCharacteristics:void 0});return}var h=t.businessObject.get("loopCharacteristics");h&&_(h,u.options.loopCharacteristics)?e._modeling.updateModdleProperties(t,h,{isSequential:u.options.isSequential}):(h=e._moddle.create(u.options.loopCharacteristics,{isSequential:u.options.isSequential}),e._modeling.updateProperties(t,{loopCharacteristics:h}))}var i=ce(t),s=i.loopCharacteristics,a,c,l;return s&&(a=s.isSequential,c=s.isSequential===void 0,l=s.isSequential!==void 0&&!s.isSequential),{"toggle-parallel-mi":{className:"bpmn-icon-parallel-mi-marker",title:n("Parallel multi-instance"),active:l,action:r,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},"toggle-sequential-mi":{className:"bpmn-icon-sequential-mi-marker",title:n("Sequential multi-instance"),active:a,action:r,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},"toggle-loop":{className:"bpmn-icon-loop-marker",title:n("Loop"),active:c,action:r,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}}};Yn.prototype._getCollectionHeaderEntries=function(t){var e=this,n=this._translate,r=t.businessObject.dataObjectRef;if(!r)return{};function i(a,c){e._modeling.updateModdleProperties(t,r,{isCollection:!c.active})}var s=r.isCollection;return{"toggle-is-collection":{className:"bpmn-icon-parallel-mi-marker",title:n("Collection"),active:s,action:i}}};Yn.prototype._getParticipantMultiplicityHeaderEntries=function(t){var e=this,n=this._bpmnFactory,r=this._translate;function i(a,c){var l=c.active,d;l||(d=n.create("bpmn:ParticipantMultiplicity")),e._modeling.updateProperties(t,{participantMultiplicity:d})}var s=t.businessObject.participantMultiplicity;return{"toggle-participant-multiplicity":{className:"bpmn-icon-parallel-mi-marker",title:r("Participant multiplicity"),active:!!s,action:i}}};Yn.prototype._getNonInterruptingHeaderEntries=function(t){const e=this._translate,n=ce(t),r=this,i=D1(t),s=_(t,"bpmn:BoundaryEvent")?Vx["intermediate-event-non-interrupting"]:Vx["start-event-non-interrupting"],a=!n[i];return{"toggle-non-interrupting":{imageHtml:s,title:e("Toggle non-interrupting"),active:a,action:function(){r._modeling.updateProperties(t,{[i]:!!a})}}}};const TL={__depends__:[Yf,uE,Jf],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",Yn]};function zc(t,e,n,r,i,s,a,c,l,d,u,h,p){t=t||{},r.registerProvider(this),this._contextPad=r,this._modeling=i,this._elementFactory=s,this._connect=a,this._create=c,this._popupMenu=l,this._canvas=d,this._rules=u,this._translate=h,this._eventBus=n,this._appendPreview=p,t.autoPlace!==!1&&(this._autoPlace=e.get("autoPlace",!1)),n.on("create.end",250,function(f){var m=f.context,v=m.shape;if(!(!Ko(f)||!r.isOpen(v))){var g=r.getEntries(v);g.replace&&g.replace.action.click(f,v)}}),n.on("contextPad.close",function(){p.cleanUp()})}zc.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate","appendPreview"];zc.prototype.getMultiElementContextPadEntries=function(t){var e=this._modeling,n={};return this._isDeleteAllowed(t)&&L(n,{delete:{group:"edit",className:"bpmn-icon-trash",title:this._translate("Delete"),action:{click:function(r,i){e.removeElements(i.slice())}}}}),n};zc.prototype._isDeleteAllowed=function(t){var e=this._rules.allowed("elements.delete",{elements:t});return Ue(e)?_d(t,n=>e.includes(n)):e};zc.prototype.getContextPadEntries=function(t){var e=this._contextPad,n=this._modeling,r=this._elementFactory,i=this._connect,s=this._create,a=this._popupMenu,c=this._autoPlace,l=this._translate,d=this._appendPreview,u={};if(t.type==="label")return this._isDeleteAllowed([t])&&L(u,m()),u;var h=t.businessObject;function p(x,E){i.start(x,E)}function f(x,E){n.removeElements([E])}function m(){return{delete:{group:"edit",className:"bpmn-icon-trash",title:l("Delete"),action:{click:f}}}}function v(x){var E=5,N=e.getPad(x).html,j=N.getBoundingClientRect(),C={x:j.left,y:j.bottom+E};return C}function g(x,E,N,j){function C($,B){var D=r.createShape(L({type:x},j));s.start($,D,{source:B})}var R=c?function($,B){var D=r.createShape(L({type:x},j));c.append(B,D)}:C,T=c?function($,B){return d.create(B,x,j),()=>{d.cleanUp()}}:null;return{group:"model",className:E,title:N,action:{dragstart:C,click:R,hover:T}}}function w(x){return function(E,N){n.splitLane(N,x),e.open(N,!0)}}if(Me(h,["bpmn:Lane","bpmn:Participant"])&&Ze(t)){var b=zi(t);L(u,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:l("Add lane above"),action:{click:function(x,E){n.addLane(E,"top")}}}}),b.length<2&&((Vt(t)?t.height>=120:t.width>=120)&&L(u,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:l("Divide into two lanes"),action:{click:w(2)}}}),(Vt(t)?t.height>=180:t.width>=180)&&L(u,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:l("Divide into three lanes"),action:{click:w(3)}}})),L(u,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:l("Add lane below"),action:{click:function(x,E){n.addLane(E,"bottom")}}}})}return _(h,"bpmn:FlowNode")&&(_(h,"bpmn:EventBasedGateway")?L(u,{"append.receive-task":g("bpmn:ReceiveTask","bpmn-icon-receive-task",l("Append receive task")),"append.message-intermediate-event":g("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",l("Append message intermediate catch event"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":g("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",l("Append timer intermediate catch event"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":g("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",l("Append conditional intermediate catch event"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":g("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",l("Append signal intermediate catch event"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):Gx(h,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?L(u,{"append.compensation-activity":g("bpmn:Task","bpmn-icon-task",l("Append compensation activity"),{isForCompensation:!0})}):!_(h,"bpmn:EndEvent")&&!h.isForCompensation&&!Gx(h,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")&&!cn(h)&&L(u,{"append.end-event":g("bpmn:EndEvent","bpmn-icon-end-event-none",l("Append end event")),"append.gateway":g("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",l("Append gateway")),"append.append-task":g("bpmn:Task","bpmn-icon-task",l("Append task")),"append.intermediate-event":g("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",l("Append intermediate/boundary event"))})),a.isEmpty(t,"bpmn-replace")||L(u,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:l("Change element"),action:{click:function(x,E){var N=L(v(E),{cursor:{x:x.x,y:x.y}});a.open(E,"bpmn-replace",N,{title:l("Change element"),width:300,search:!0})}}}}),_(h,"bpmn:SequenceFlow")&&L(u,{"append.text-annotation":g("bpmn:TextAnnotation","bpmn-icon-text-annotation",l("Add text annotation"))}),_(h,"bpmn:MessageFlow")&&L(u,{"append.text-annotation":g("bpmn:TextAnnotation","bpmn-icon-text-annotation",l("Add text annotation"))}),Me(h,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&L(u,{"append.text-annotation":g("bpmn:TextAnnotation","bpmn-icon-text-annotation",l("Add text annotation")),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect to other element"),action:{click:p,dragstart:p}}}),_(h,"bpmn:TextAnnotation")&&L(u,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using association"),action:{click:p,dragstart:p}}}),Me(h,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&L(u,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using data input association"),action:{click:p,dragstart:p}}}),_(h,"bpmn:Group")&&L(u,{"append.text-annotation":g("bpmn:TextAnnotation","bpmn-icon-text-annotation",l("Add text annotation"))}),this._isDeleteAllowed([t])&&L(u,m()),u};function Gx(t,e,n){var r=t.$instanceOf(e),i=!1,s=t.eventDefinitions||[];return I(s,function(a){a.$type===n&&(i=!0)}),r&&i}const RL={__depends__:[dL,AE,P_,Nr,rm,au,TL],__init__:["contextPadProvider"],contextPadProvider:["type",zc]};var AL={horizontal:["x","width"],vertical:["y","height"]},Wx=5;function ni(t,e){this._modeling=t,this._filters=[],this.registerFilter(function(n){var r=e.allowed("elements.distribute",{elements:n});return Ue(r)?r:r?n:[]})}ni.$inject=["modeling","rules"];ni.prototype.registerFilter=function(t){if(typeof t!="function")throw new Error("the filter has to be a function");this._filters.push(t)};ni.prototype.trigger=function(t,e){var n=this._modeling,r,i;if(!(t.length<3)&&(this._setOrientation(e),i=this._filterElements(t),r=this._createGroups(i),!(r.length<=2)))return n.distributeElements(r,this._axis,this._dimension),r};ni.prototype._filterElements=function(t){var e=this._filters,n=this._axis,r=this._dimension,i=[].concat(t);return e.length?(I(e,function(s){i=s(i,n,r)}),i):t};ni.prototype._createGroups=function(t){var e=[],n=this,r=this._axis,i=this._dimension;if(!r)throw new Error('must have a defined "axis" and "dimension"');var s=Kr(t,r);return I(s,function(a,c){var l=n._findRange(a,r,i),d,u=e[e.length-1];u&&n._hasIntersection(u.range,l)?e[e.length-1].elements.push(a):(d={range:l,elements:[a]},e.push(d))}),e};ni.prototype._setOrientation=function(t){var e=AL[t];this._axis=e[0],this._dimension=e[1]};ni.prototype._hasIntersection=function(t,e){return Math.max(t.min,t.max)>=Math.min(e.min,e.max)&&Math.min(t.min,t.max)<=Math.max(e.min,e.max)};ni.prototype._findRange=function(t){var e=t[this._axis],n=t[this._dimension];return{min:e+Wx,max:e+n-Wx}};const IL={__init__:["distributeElements"],distributeElements:["type",ni]};function wu(t){Gn.call(this,t)}wu.$inject=["eventBus"];fe(wu,Gn);wu.prototype.init=function(){this.addRule("elements.distribute",function(t){var e=t.elements;return e=Ve(e,function(n){var r=Me(n,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(n.labelTarget||r)}),e=Ed(e),e.length<3?!1:e})};var qx={horizontal:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
                <polyline points="450 400 450 150 1350 150 1350 400" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>
                <rect x="150" y="450" width="600" height="1200" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
                <rect x="1050" y="450" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
              </svg>`,vertical:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
              <polyline points="400 1350 150 1350 150 450 400 450" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>
              <rect x="450" y="150" width="1200" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
              <rect x="450" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
            </svg>`},ML=900;function Uc(t,e,n,r){this._distributeElements=e,this._translate=n,this._popupMenu=t,this._rules=r,t.registerProvider("align-elements",ML,this)}Uc.$inject=["popupMenu","distributeElements","translate","rules"];Uc.prototype.getPopupMenuEntries=function(t){var e={};return this._isAllowed(t)&&L(e,this._getEntries(t)),e};Uc.prototype._isAllowed=function(t){return this._rules.allowed("elements.distribute",{elements:t})};Uc.prototype._getEntries=function(t){var e=this._distributeElements,n=this._translate,r=this._popupMenu,i={"distribute-elements-horizontal":{group:"distribute",title:n("Distribute elements horizontally"),className:"bjs-align-elements-menu-entry",imageHtml:qx.horizontal,action:function(s,a){e.trigger(t,"horizontal"),r.close()}},"distribute-elements-vertical":{group:"distribute",title:n("Distribute elements vertically"),imageHtml:qx.vertical,action:function(s,a){e.trigger(t,"vertical"),r.close()}}};return i};const DL={__depends__:[Yf,IL],__init__:["bpmnDistributeElements","distributeElementsMenuProvider"],bpmnDistributeElements:["type",wu],distributeElementsMenuProvider:["type",Uc]};var ME="is not a registered action",OL="is already registered";function Zn(t,e){this._actions={};var n=this;t.on("diagram.init",function(){n._registerDefaultActions(e),t.fire("editorActions.init",{editorActions:n})})}Zn.$inject=["eventBus","injector"];Zn.prototype._registerDefaultActions=function(t){var e=t.get("commandStack",!1),n=t.get("modeling",!1),r=t.get("selection",!1),i=t.get("zoomScroll",!1),s=t.get("copyPaste",!1),a=t.get("canvas",!1),c=t.get("rules",!1),l=t.get("keyboardMove",!1),d=t.get("keyboardMoveSelection",!1);e&&(this.register("undo",function(){e.undo()}),this.register("redo",function(){e.redo()})),s&&r&&this.register("copy",function(){var u=r.get();if(u.length)return s.copy(u)}),s&&this.register("paste",function(){s.paste()}),i&&this.register("stepZoom",function(u){i.stepZoom(u.value)}),a&&this.register("zoom",function(u){a.zoom(u.value)}),n&&r&&c&&this.register("removeSelection",function(){var u=r.get();if(u.length){var h=c.allowed("elements.delete",{elements:u}),p;h!==!1&&(Ue(h)?p=h:p=u,p.length&&n.removeElements(p.slice()))}}),l&&this.register("moveCanvas",function(u){l.moveCanvas(u)}),d&&this.register("moveSelection",function(u){d.moveSelection(u.direction,u.accelerated)})};Zn.prototype.trigger=function(t,e){if(!this._actions[t])throw og(t,ME);return this._actions[t](e)};Zn.prototype.register=function(t,e){var n=this;if(typeof t=="string")return this._registerAction(t,e);I(t,function(r,i){n._registerAction(i,r)})};Zn.prototype._registerAction=function(t,e){if(this.isRegistered(t))throw og(t,OL);this._actions[t]=e};Zn.prototype.unregister=function(t){if(!this.isRegistered(t))throw og(t,ME);this._actions[t]=void 0};Zn.prototype.getActions=function(){return Object.keys(this._actions)};Zn.prototype.isRegistered=function(t){return!!this._actions[t]};function og(t,e){return new Error(t+" "+e)}const $L={__init__:["editorActions"],editorActions:["type",Zn]};function _u(t){t.invoke(Zn,this)}fe(_u,Zn);_u.$inject=["injector"];_u.prototype._registerDefaultActions=function(t){Zn.prototype._registerDefaultActions.call(this,t);var e=t.get("canvas",!1),n=t.get("elementRegistry",!1),r=t.get("selection",!1),i=t.get("spaceTool",!1),s=t.get("lassoTool",!1),a=t.get("handTool",!1),c=t.get("globalConnect",!1),l=t.get("distributeElements",!1),d=t.get("alignElements",!1),u=t.get("directEditing",!1),h=t.get("searchPad",!1),p=t.get("modeling",!1),f=t.get("contextPad",!1);e&&n&&r&&this._registerAction("selectElements",function(){var m=e.getRootElement(),v=n.filter(function(g){return g!==m});return r.select(v),v}),i&&this._registerAction("spaceTool",function(){i.toggle()}),s&&this._registerAction("lassoTool",function(){s.toggle()}),a&&this._registerAction("handTool",function(){a.toggle()}),c&&this._registerAction("globalConnectTool",function(){c.toggle()}),r&&l&&this._registerAction("distributeElements",function(m){var v=r.get(),g=m.type;v.length&&l.trigger(v,g)}),r&&d&&this._registerAction("alignElements",function(m){var v=r.get(),g=[],w=m.type;v.length&&(g=Ve(v,function(b){return!_(b,"bpmn:Lane")}),d.trigger(g,w))}),r&&p&&this._registerAction("setColor",function(m){var v=r.get();v.length&&p.setColor(v,m)}),r&&u&&this._registerAction("directEditing",function(){var m=r.get();m.length&&u.activate(m[0])}),h&&this._registerAction("find",function(){h.toggle()}),e&&p&&this._registerAction("moveToOrigin",function(){var m=e.getRootElement(),v,g;_(m,"bpmn:Collaboration")?g=n.filter(function(w){return _(w.parent,"bpmn:Collaboration")}):g=n.filter(function(w){return w!==m&&!_(w.parent,"bpmn:SubProcess")}),v=gn(g),p.moveElements(g,{x:-v.x,y:-v.y},m)}),r&&f&&this._registerAction("replaceElement",function(m){f.triggerEntry("replace","click",m)})};const LL={__depends__:[$L],editorActions:["type",_u]};function DE(t){t.on(["create.init","shape.move.init"],function(e){var n=e.context,r=e.shape;Me(r,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(n.gridSnappingContext||(n.gridSnappingContext={}),n.gridSnappingContext.snapLocation="top-left")})}DE.$inject=["eventBus"];var zl=10;function Dh(t,e,n){return n||(n="round"),Math[n](t/e)*e}var BL=1200,FL=800;function qi(t,e,n){var r=!n||n.active!==!1;this._eventBus=e;var i=this;e.on("diagram.init",FL,function(){i.setActive(r)}),e.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],BL,function(s){var a=s.originalEvent;if(!(!i.active||a&&zn(a))){var c=s.context,l=c.gridSnappingContext;l||(l=c.gridSnappingContext={}),["x","y"].forEach(function(d){var u={},h=UL(s,d,t);h&&(u.offset=h);var p=zL(s,d);p&&L(u,p),Ca(s,d)||i.snapEvent(s,d,u)})}})}qi.prototype.snapEvent=function(t,e,n){var r=this.snapValue(t[e],n);kt(t,e,r)};qi.prototype.getGridSpacing=function(){return zl};qi.prototype.snapValue=function(t,e){var n=0;e&&e.offset&&(n=e.offset),t+=n,t=Dh(t,zl);var r,i;return e&&e.min&&(r=e.min,ze(r)&&(r=Dh(r+n,zl,"ceil"),t=Math.max(t,r))),e&&e.max&&(i=e.max,ze(i)&&(i=Dh(i+n,zl,"floor"),t=Math.min(t,i))),t-=n,t};qi.prototype.isActive=function(){return this.active};qi.prototype.setActive=function(t){this.active=t,this._eventBus.fire("gridSnapping.toggle",{active:t})};qi.prototype.toggleActive=function(){this.setActive(!this.active)};qi.$inject=["elementRegistry","eventBus","config.gridSnapping"];function zL(t,e){var n=t.context,r=n.createConstraints,i=n.resizeConstraints||{},s=n.gridSnappingContext,a=s.snapConstraints;if(a&&a[e])return a[e];a||(a=s.snapConstraints={}),a[e]||(a[e]={});var c=n.direction;r&&(Ul(e)?(a.x.min=r.left,a.x.max=r.right):(a.y.min=r.top,a.y.max=r.bottom));var l=i.min,d=i.max;return l&&(Ul(e)?Yx(c)?a.x.max=l.left:a.x.min=l.right:Kx(c)?a.y.max=l.top:a.y.min=l.bottom),d&&(Ul(e)?Yx(c)?a.x.min=d.left:a.x.max=d.right:Kx(c)?a.y.min=d.top:a.y.max=d.bottom),a[e]}function UL(t,e,n){var r=t.context,i=t.shape,s=r.gridSnappingContext,a=s.snapLocation,c=s.snapOffset;return c&&ze(c[e])||(c||(c=s.snapOffset={}),ze(c[e])||(c[e]=0),!i)||(n.get(i.id)||(Ul(e)?c[e]+=i[e]+i.width/2:c[e]+=i[e]+i.height/2),!a)||(e==="x"?/left/.test(a)?c[e]-=i.width/2:/right/.test(a)&&(c[e]+=i.width/2):/top/.test(a)?c[e]-=i.height/2:/bottom/.test(a)&&(c[e]+=i.height/2)),c[e]}function Ul(t){return t==="x"}function Kx(t){return t.indexOf("n")!==-1}function Yx(t){return t.indexOf("w")!==-1}function Is(t,e){Z.call(this,t),this._gridSnapping=e;var n=this;this.preExecute("shape.resize",function(r){var i=r.context,s=i.hints||{},a=s.autoResize;if(a){var c=i.shape,l=i.newBounds;Sd(a)?i.newBounds=n.snapComplex(l,a):i.newBounds=n.snapSimple(c,l)}})}Is.$inject=["eventBus","gridSnapping","modeling"];fe(Is,Z);Is.prototype.snapSimple=function(t,e){var n=this._gridSnapping;return e.width=n.snapValue(e.width,{min:e.width}),e.height=n.snapValue(e.height,{min:e.height}),e.x=t.x+t.width/2-e.width/2,e.y=t.y+t.height/2-e.height/2,e};Is.prototype.snapComplex=function(t,e){return/w|e/.test(e)&&(t=this.snapHorizontally(t,e)),/n|s/.test(e)&&(t=this.snapVertically(t,e)),t};Is.prototype.snapHorizontally=function(t,e){var n=this._gridSnapping,r=/w/.test(e),i=/e/.test(e),s={};return s.width=n.snapValue(t.width,{min:t.width}),i&&(r?(s.x=n.snapValue(t.x,{max:t.x}),s.width+=n.snapValue(t.x-s.x,{min:t.x-s.x})):t.x=t.x+t.width-s.width),L(t,s),t};Is.prototype.snapVertically=function(t,e){var n=this._gridSnapping,r=/n/.test(e),i=/s/.test(e),s={};return s.height=n.snapValue(t.height,{min:t.height}),r&&(i?(s.y=n.snapValue(t.y,{max:t.y}),s.height+=n.snapValue(t.y-s.y,{min:t.y-s.y})):t.y=t.y+t.height-s.height),L(t,s),t};var HL=2e3;function OE(t,e){t.on(["spaceTool.move","spaceTool.end"],HL,function(n){var r=n.context;if(r.initialized){var i=r.axis,s;i==="x"?(s=e.snapValue(n.dx),n.x=n.x+s-n.dx,n.dx=s):(s=e.snapValue(n.dy),n.y=n.y+s-n.dy,n.dy=s)}})}OE.$inject=["eventBus","gridSnapping"];const VL={__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",Is],gridSnappingSpaceToolBehavior:["type",OE]},GL={__depends__:[VL],__init__:["gridSnapping"],gridSnapping:["type",qi]};var WL=2e3;function $E(t,e,n){t.on("autoPlace",WL,function(r){var i=r.source,s=we(i),a=r.shape,c=t1(i,a,n);return["x","y"].forEach(function(l){var d={};c[l]!==s[l]&&(c[l]>s[l]?d.min=c[l]:d.max=c[l],_(a,"bpmn:TextAnnotation")&&(qL(l)?d.offset=-a.width/2:d.offset=-a.height/2),c[l]=e.snapValue(c[l],d))}),c})}$E.$inject=["eventBus","gridSnapping","elementRegistry"];function qL(t){return t==="x"}var KL=1750;function LE(t,e,n){e.on(["create.start","shape.move.start"],KL,function(r){var i=r.context,s=i.shape,a=t.getRootElement();if(!(!_(s,"bpmn:Participant")||!_(a,"bpmn:Process")||!a.children.length)){var c=i.createConstraints;c&&(s.width=n.snapValue(s.width,{min:s.width}),s.height=n.snapValue(s.height,{min:s.height}))}})}LE.$inject=["canvas","eventBus","gridSnapping"];var YL=3e3;function Eu(t,e,n){Z.call(this,t),this._gridSnapping=e;var r=this;this.postExecuted(["connection.create","connection.layout"],YL,function(i){var s=i.context,a=s.connection,c=s.hints||{},l=a.waypoints;c.connectionStart||c.connectionEnd||c.createElementsBehavior===!1||ZL(l)&&n.updateWaypoints(a,r.snapMiddleSegments(l))})}Eu.$inject=["eventBus","gridSnapping","modeling"];fe(Eu,Z);Eu.prototype.snapMiddleSegments=function(t){var e=this._gridSnapping,n;t=t.slice();for(var r=1;r<t.length-2;r++)n=QL(e,t[r],t[r+1]),t[r]=n[0],t[r+1]=n[1];return t};function ZL(t){return t.length>3}function XL(t){return t==="h"}function JL(t){return t==="v"}function QL(t,e,n){var r=Ur(e,n),i={};return XL(r)&&(i.y=t.snapValue(e.y)),JL(r)&&(i.x=t.snapValue(e.x)),("x"in i||"y"in i)&&(e=L({},e,i),n=L({},n,i)),[e,n]}const e4={__init__:["gridSnappingAutoPlaceBehavior","gridSnappingParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",$E],gridSnappingParticipantBehavior:["type",LE],gridSnappingLayoutConnectionBehavior:["type",Eu]},t4={__depends__:[GL,e4],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",DE]};var n4=30,BE=30;function Hc(t,e){this._interactionEvents=e;var n=this;t.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(r){var i=r.element,s=r.gfx;if(_(i,"bpmn:Lane"))return n._createParticipantHit(i,s);if(_(i,"bpmn:Participant"))return Ze(i)?n._createParticipantHit(i,s):n._createDefaultHit(i,s);if(_(i,"bpmn:SubProcess"))return Ze(i)?n._createSubProcessHit(i,s):n._createDefaultHit(i,s)})}Hc.$inject=["eventBus","interactionEvents"];Hc.prototype._createDefaultHit=function(t,e){return this._interactionEvents.removeHits(e),this._interactionEvents.createDefaultHit(t,e),!0};Hc.prototype._createParticipantHit=function(t,e){this._interactionEvents.removeHits(e),this._interactionEvents.createBoxHit(e,"no-move",{width:t.width,height:t.height}),this._interactionEvents.createBoxHit(e,"click-stroke",{width:t.width,height:t.height});var n=Vt(t)?{width:n4,height:t.height}:{width:t.width,height:BE};return this._interactionEvents.createBoxHit(e,"all",n),!0};Hc.prototype._createSubProcessHit=function(t,e){return this._interactionEvents.removeHits(e),this._interactionEvents.createBoxHit(e,"no-move",{width:t.width,height:t.height}),this._interactionEvents.createBoxHit(e,"click-stroke",{width:t.width,height:t.height}),this._interactionEvents.createBoxHit(e,"all",{width:t.width,height:BE}),!0};const r4={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",Hc]};function Su(t){t.invoke(Va,this)}fe(Su,Va);Su.$inject=["injector"];Su.prototype.registerBindings=function(t,e){Va.prototype.registerBindings.call(this,t,e);function n(r,i){e.isRegistered(r)&&t.addListener(i)}n("selectElements",function(r){var i=r.keyEvent;if(t.isKey(["a","A"],i)&&t.isCmd(i))return e.trigger("selectElements"),!0}),n("find",function(r){var i=r.keyEvent;if(t.isKey(["f","F"],i)&&t.isCmd(i))return e.trigger("find"),!0}),n("spaceTool",function(r){var i=r.keyEvent;if(!t.hasModifier(i)&&t.isKey(["s","S"],i))return e.trigger("spaceTool"),!0}),n("lassoTool",function(r){var i=r.keyEvent;if(!t.hasModifier(i)&&t.isKey(["l","L"],i))return e.trigger("lassoTool"),!0}),n("handTool",function(r){var i=r.keyEvent;if(!t.hasModifier(i)&&t.isKey(["h","H"],i))return e.trigger("handTool"),!0}),n("globalConnectTool",function(r){var i=r.keyEvent;if(!t.hasModifier(i)&&t.isKey(["c","C"],i))return e.trigger("globalConnectTool"),!0}),n("directEditing",function(r){var i=r.keyEvent;if(!t.hasModifier(i)&&t.isKey(["e","E"],i))return e.trigger("directEditing"),!0}),n("replaceElement",function(r){var i=r.keyEvent;if(!t.hasModifier(i)&&t.isKey(["r","R"],i))return e.trigger("replaceElement",i),!0})};const i4={__depends__:[Uf],__init__:["keyboardBindings"],keyboardBindings:["type",Su]};var s4={moveSpeed:1,moveSpeedAccelerated:10},a4=1500,Zx="left",Xx="up",Jx="right",Qx="down",o4={ArrowLeft:Zx,Left:Zx,ArrowUp:Xx,Up:Xx,ArrowRight:Jx,Right:Jx,ArrowDown:Qx,Down:Qx},c4={left:function(t){return{x:-t,y:0}},up:function(t){return{x:0,y:-t}},right:function(t){return{x:t,y:0}},down:function(t){return{x:0,y:t}}};function FE(t,e,n,r,i){var s=this;this._config=L({},s4,t||{}),e.addListener(a4,function(a){var c=a.keyEvent,l=o4[c.key];if(l&&!e.isCmd(c)){var d=e.isShift(c);return s.moveSelection(l,d),!0}}),this.moveSelection=function(a,c){var l=i.get();if(l.length){var d=this._config[c?"moveSpeedAccelerated":"moveSpeed"],u=c4[a](d),h=r.allowed("elements.move",{shapes:l});h&&n.moveElements(l,u)}}}FE.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];const l4={__depends__:[Uf,Nr],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",FE]};var eb=10;function Vc(t,e,n,r){this._dragging=r,this._rules=e;var i=this;function s(l,d){var u=l.shape,h=l.direction,p=l.resizeConstraints,f;l.delta=d,f=GD(u,h,d),l.newBounds=qD(f,p),l.canExecute=i.canResize(l)}function a(l){var d=l.resizeConstraints,u=l.minBounds;d===void 0&&(u===void 0&&(u=i.computeMinResizeBox(l)),l.resizeConstraints={min:ye(u)})}function c(l){var d=l.shape,u=l.canExecute,h=l.newBounds;if(u){if(h=Rw(h),!d4(d,h))return;n.resizeShape(d,h)}}t.on("resize.start",function(l){a(l.context)}),t.on("resize.move",function(l){var d={x:l.dx,y:l.dy};s(l.context,d)}),t.on("resize.end",function(l){c(l.context)})}Vc.prototype.canResize=function(t){var e=this._rules,n=jr(t,["newBounds","shape","delta","direction"]);return e.allowed("shape.resize",n)};Vc.prototype.activate=function(t,e,n){var r=this._dragging,i,s;if(typeof n=="string"&&(n={direction:n}),i=L({shape:e},n),s=i.direction,!s)throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");r.init(t,zE(e,s),"resize",{autoActivate:!0,cursor:u4(s),data:{shape:e,context:i}})};Vc.prototype.computeMinResizeBox=function(t){var e=t.shape,n=t.direction,r,i;return r=t.minDimensions||{width:eb,height:eb},i=j1(e,t.childrenBoxPadding),KD(n,e,r,i)};Vc.$inject=["eventBus","rules","modeling","dragging"];function d4(t,e){return t.x!==e.x||t.y!==e.y||t.width!==e.width||t.height!==e.height}function zE(t,e){var n=we(t),r=ye(t),i={x:n.x,y:n.y};return e.indexOf("n")!==-1?i.y=r.top:e.indexOf("s")!==-1&&(i.y=r.bottom),e.indexOf("e")!==-1?i.x=r.right:e.indexOf("w")!==-1&&(i.x=r.left),i}function u4(t){var e="resize-";return t==="n"||t==="s"?e+"ns":t==="e"||t==="w"?e+"ew":t==="nw"||t==="se"?e+"nwse":e+"nesw"}var tb="djs-resizing",nb="resize-not-ok",h4=500;function UE(t,e,n){function r(s){var a=s.shape,c=s.newBounds,l=s.frame;l||(l=s.frame=n.addFrame(a,e.getActiveLayer()),e.addMarker(a,tb)),c.width>5&&Y(l,{x:c.x,width:c.width}),c.height>5&&Y(l,{y:c.y,height:c.height}),s.canExecute?dt(l).remove(nb):dt(l).add(nb)}function i(s){var a=s.shape,c=s.frame;c&&on(s.frame),e.removeMarker(a,tb)}t.on("resize.move",h4,function(s){r(s.context)}),t.on("resize.cleanup",function(s){i(s.context)})}UE.$inject=["eventBus","canvas","previewSupport"];var Cl=-6,Pl=8,Tl=20,jo="djs-resizer",p4=["n","w","s","e","nw","ne","se","sw"];function Ki(t,e,n,r){this._resize=r,this._canvas=e;var i=this;t.on("selection.changed",function(s){var a=s.newSelection;i.removeResizers(),a.length===1&&I(a,Ss(i.addResizer,i))}),t.on("shape.changed",function(s){var a=s.element;n.isSelected(a)&&(i.removeResizers(),i.addResizer(a))})}Ki.prototype.makeDraggable=function(t,e,n){var r=this._resize;function i(s){mf(s)&&r.activate(s,t,n)}je.bind(e,"mousedown",i),je.bind(e,"touchstart",i)};Ki.prototype._createResizer=function(t,e,n,r){var i=this._getResizersParent(),s=f4(r),a=ie("g");dt(a).add(jo),dt(a).add(jo+"-"+t.id),dt(a).add(jo+"-"+r),ae(i,a);var c=ie("rect");Y(c,{x:-Pl/2+s.x,y:-Pl/2+s.y,width:Pl,height:Pl}),dt(c).add(jo+"-visual"),ae(a,c);var l=ie("rect");return Y(l,{x:-Tl/2+s.x,y:-Tl/2+s.y,width:Tl,height:Tl}),dt(l).add(jo+"-hit"),ae(a,l),fC(a,e,n),a};Ki.prototype.createResizer=function(t,e){var n=zE(t,e),r=this._createResizer(t,n.x,n.y,e);this.makeDraggable(t,r,e)};Ki.prototype.addResizer=function(t){var e=this;lt(t)||!this._resize.canResize({shape:t})||I(p4,function(n){e.createResizer(t,n)})};Ki.prototype.removeResizers=function(){var t=this._getResizersParent();kd(t)};Ki.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")};Ki.$inject=["eventBus","canvas","selection","resize"];function f4(t){var e={x:0,y:0};return t.indexOf("e")!==-1?e.x=-Cl:t.indexOf("w")!==-1&&(e.x=Cl),t.indexOf("s")!==-1?e.y=-Cl:t.indexOf("n")!==-1&&(e.y=Cl),e}const HE={__depends__:[Cr,Qr,Ya],__init__:["resize","resizePreview","resizeHandles"],resize:["type",Vc],resizePreview:["type",UE],resizeHandles:["type",Ki]};var m4=2e3;function Gc(t,e,n,r,i,s,a){this._bpmnFactory=e,this._canvas=n,this._modeling=i,this._textRenderer=a,r.registerProvider(this),t.on("element.dblclick",function(l){c(l.element,!0)}),t.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open","root.set","selection.changed"],function(){r.isActive()&&r.complete()}),t.on(["shape.remove","connection.remove"],m4,function(l){r.isActive(l.element)&&r.cancel()}),t.on(["commandStack.changed"],function(l){r.isActive()&&r.cancel()}),t.on("directEditing.activate",function(l){s.removeResizers()}),t.on("create.end",500,function(l){var d=l.context,u=d.shape,h=l.context.canExecute,p=l.isTouch;p||h&&(d.hints&&d.hints.createElementsBehavior===!1||c(u))}),t.on("autoPlace.end",500,function(l){c(l.shape)});function c(l,d){(d||Me(l,["bpmn:Task","bpmn:TextAnnotation","bpmn:Participant"])||cg(l))&&r.activate(l)}}Gc.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"];Gc.prototype.activate=function(t){var e=js(t);if(e!==void 0){var n={text:e},r=this.getEditingBBox(t);L(n,r);var i={},s=n.style||{};return L(s,{backgroundColor:null,border:null}),(Me(t,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||cg(t))&&L(i,{centerVertically:!0}),xa(t)&&(L(i,{autoResize:!0}),L(s,{backgroundColor:"#ffffff",border:"1px solid #ccc"})),_(t,"bpmn:TextAnnotation")&&(L(i,{resizable:!0,autoResize:!0}),L(s,{backgroundColor:"#ffffff",border:"1px solid #ccc"})),L(n,{options:i,style:s}),n}};Gc.prototype.getEditingBBox=function(t){var e=this._canvas,n=t.label||t,r=e.getAbsoluteBBox(n),i={x:r.x+r.width/2,y:r.y+r.height/2},s={x:r.x,y:r.y},a=e.zoom(),c=this._textRenderer.getDefaultStyle(),l=this._textRenderer.getExternalStyle(),d=l.fontSize*a,u=l.lineHeight,h=c.fontSize*a,p=c.lineHeight,f={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};if(_(t,"bpmn:Lane")||y4(t)){var m=Vt(t),v=m?{width:r.height,height:30*a,x:r.x-r.height/2+15*a,y:i.y-30*a/2}:{width:r.width,height:30*a};L(s,v),L(f,{fontSize:h+"px",lineHeight:p,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px",transform:m?"rotate(-90deg)":null})}if(v4(t)){var g=Vt(t),w=g?{width:r.width,height:r.height}:{width:r.height,height:r.width,x:i.x-r.height/2,y:i.y-r.width/2};L(s,w),L(f,{fontSize:h+"px",lineHeight:p,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px",transform:g?null:"rotate(-90deg)"})}(Me(t,["bpmn:Task","bpmn:CallActivity"])||cg(t))&&(L(s,{width:r.width,height:r.height}),L(f,{fontSize:h+"px",lineHeight:p,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px"})),g4(t)&&(L(s,{width:r.width,x:r.x}),L(f,{fontSize:h+"px",lineHeight:p,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px"}));var b=90*a,x=7*a,E=4*a;if(n.labelTarget&&(L(s,{width:b,height:r.height+x+E,x:i.x-b/2,y:r.y-x}),L(f,{fontSize:d+"px",lineHeight:u,paddingTop:x+"px",paddingBottom:E+"px"})),xa(n)&&!Cd(n)&&!We(n)){var N=Mw(t),j=e.getAbsoluteBBox({x:N.x,y:N.y,width:0,height:0}),C=d+x+E;L(s,{width:b,height:C,x:j.x-b/2,y:j.y-C/2}),L(f,{fontSize:d+"px",lineHeight:u,paddingTop:x+"px",paddingBottom:E+"px"})}return _(t,"bpmn:TextAnnotation")&&(L(s,{width:r.width,height:r.height,minWidth:30*a,minHeight:10*a}),L(f,{textAlign:"left",paddingTop:5*a+"px",paddingBottom:7*a+"px",paddingLeft:7*a+"px",paddingRight:5*a+"px",fontSize:h+"px",lineHeight:p})),{bounds:s,style:f}};Gc.prototype.update=function(t,e,n,r){var i,s;_(t,"bpmn:TextAnnotation")&&(s=this._canvas.getAbsoluteBBox(t),i={x:t.x,y:t.y,width:t.width/s.width*r.width,height:t.height/s.height*r.height}),x4(e)&&(e=null),this._modeling.updateLabel(t,e,i)};function cg(t){return _(t,"bpmn:SubProcess")&&!Ze(t)}function g4(t){return _(t,"bpmn:SubProcess")&&Ze(t)}function v4(t){return _(t,"bpmn:Participant")&&!Ze(t)}function y4(t){return _(t,"bpmn:Participant")&&Ze(t)}function x4(t){return!t||!t.trim()}var rb="djs-element-hidden",ib="djs-label-hidden";function VE(t,e,n){var r=this,i=e.getDefaultLayer(),s,a,c;t.on("directEditing.activate",function(l){var d=l.active;if(s=d.element.label||d.element,_(s,"bpmn:TextAnnotation")){a=e.getAbsoluteBBox(s),c=ie("g");var u=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:s.width,containerHeight:s.height,position:{mx:0,my:0}}),h=r.path=ie("path");Y(h,{d:u,strokeWidth:2,stroke:b4(s)}),ae(c,h),ae(i,c),an(c,s.x,s.y)}_(s,"bpmn:TextAnnotation")||s.labelTarget?e.addMarker(s,rb):(_(s,"bpmn:Task")||_(s,"bpmn:CallActivity")||_(s,"bpmn:SubProcess")||_(s,"bpmn:Participant")||_(s,"bpmn:Lane"))&&e.addMarker(s,ib)}),t.on("directEditing.resize",function(l){if(_(s,"bpmn:TextAnnotation")){var d=l.height,u=l.dy,h=Math.max(s.height/a.height*(d+u),0),p=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:s.width,containerHeight:h,position:{mx:0,my:0}});Y(r.path,{d:p})}}),t.on(["directEditing.complete","directEditing.cancel"],function(l){var d=l.active;d&&(e.removeMarker(d.element.label||d.element,rb),e.removeMarker(s,ib)),s=void 0,a=void 0,c&&(on(c),c=void 0)})}VE.$inject=["eventBus","canvas","pathMap"];function b4(t,e){var n=at(t);return n.get("stroke")||e||"black"}const w4={__depends__:[Dw,HE,AE],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",Gc],labelEditingPreview:["type",VE]};var _4=new uf("tt");function E4(t){var e=Ht('<div class="djs-tooltip-container" />');return xf(e,{position:"absolute",width:"0",height:"0"}),t.insertBefore(e,t.firstChild),e}function S4(t,e,n){xf(t,{left:e+"px",top:n+"px"})}function lg(t,e){t.style.display=e===!1?"none":""}var GE="djs-tooltip",Oh="."+GE;function vn(t,e){this._eventBus=t,this._canvas=e,this._ids=_4,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=E4(e.getContainer());var n=this;ar.bind(this._tooltipRoot,Oh,"mousedown",function(r){r.stopPropagation()}),ar.bind(this._tooltipRoot,Oh,"mouseover",function(r){n.trigger("mouseover",r)}),ar.bind(this._tooltipRoot,Oh,"mouseout",function(r){n.trigger("mouseout",r)}),this._init()}vn.$inject=["eventBus","canvas"];vn.prototype.add=function(t){if(!t.position)throw new Error("must specifiy tooltip position");if(!t.html)throw new Error("must specifiy tooltip html");var e=this._ids.next();return t=L({},this._tooltipDefaults,t,{id:e}),this._addTooltip(t),t.timeout&&this.setTimeout(t),e};vn.prototype.trigger=function(t,e){var n=e.delegateTarget||e.target,r=this.get(mn(n,"data-tooltip-id"));r&&(t==="mouseover"&&r.timeout&&this.clearTimeout(r),t==="mouseout"&&r.timeout&&(r.timeout=1e3,this.setTimeout(r)))};vn.prototype.get=function(t){return typeof t!="string"&&(t=t.id),this._tooltips[t]};vn.prototype.clearTimeout=function(t){if(t=this.get(t),!!t){var e=t.removeTimer;e&&(clearTimeout(e),t.removeTimer=null)}};vn.prototype.setTimeout=function(t){if(t=this.get(t),!!t){this.clearTimeout(t);var e=this;t.removeTimer=setTimeout(function(){e.remove(t)},t.timeout)}};vn.prototype.remove=function(t){var e=this.get(t);e&&(ya(e.html),ya(e.htmlContainer),delete e.htmlContainer,delete this._tooltips[e.id])};vn.prototype.show=function(){lg(this._tooltipRoot)};vn.prototype.hide=function(){lg(this._tooltipRoot,!1)};vn.prototype._updateRoot=function(t){var e=t.scale||1,n=t.scale||1,r="matrix("+e+",0,0,"+n+","+-1*t.x*e+","+-1*t.y*n+")";this._tooltipRoot.style.transform=r,this._tooltipRoot.style["-ms-transform"]=r};vn.prototype._addTooltip=function(t){var e=t.id,n=t.html,r,i=this._tooltipRoot;n.get&&n.constructor.prototype.jquery&&(n=n.get(0)),Sd(n)&&(n=Ht(n)),r=Ht('<div data-tooltip-id="'+e+'" class="'+GE+'">'),xf(r,{position:"absolute"}),r.appendChild(n),t.type&&Dt(r).add("djs-tooltip-"+t.type),t.className&&Dt(r).add(t.className),t.htmlContainer=r,i.appendChild(r),this._tooltips[e]=t,this._updateTooltip(t)};vn.prototype._updateTooltip=function(t){var e=t.position,n=t.htmlContainer;S4(n,e.x,e.y)};vn.prototype._updateTooltipVisibilty=function(t){I(this._tooltips,function(e){var n=e.show,r=e.htmlContainer,i=!0;n&&((n.minZoom>t.scale||n.maxZoom<t.scale)&&(i=!1),lg(r,i))})};vn.prototype._init=function(){var t=this;function e(n){t._updateRoot(n),t._updateTooltipVisibilty(n),t.show()}this._eventBus.on("canvas.viewbox.changing",function(n){t.hide()}),this._eventBus.on("canvas.viewbox.changed",function(n){e(n.viewbox)})};const j4={__init__:["tooltips"],tooltips:["type",vn]};var N4="flow elements must be children of pools/participants",k4="Data object must be placed within a pool/participant.";function WE(t,e,n){function r(i,s,a){e.add({position:{x:i.x+5,y:i.y+5},type:"error",timeout:2e3,html:"<div>"+s+"</div>"})}t.on(["shape.move.rejected","create.rejected"],function(i){var s=i.context,a=s.shape,c=s.target;_(c,"bpmn:Collaboration")&&(_(a,"bpmn:FlowNode")?r(i,n(N4)):_(a,"bpmn:DataObjectReference")&&r(i,n(k4)))})}WE.$inject=["eventBus","tooltips","translate"];const C4={__depends__:[j4],__init__:["modelingFeedback"],modelingFeedback:["type",WE]};var P4=500,T4=1e3;function Ms(t,e){this._eventBus=t,this.offset=5;var n=e.cls("djs-outline",["no-fill"]),r=this;function i(s){var a=ie("rect");return Y(a,L({x:0,y:0,rx:4,width:100,height:100},n)),a}t.on(["shape.added","shape.changed"],P4,function(s){var a=s.element,c=s.gfx,l=Ct(".djs-outline",c);l||(l=r.getOutline(a)||i(),ae(c,l)),r.updateShapeOutline(l,a)}),t.on(["connection.added","connection.changed"],function(s){var a=s.element,c=s.gfx,l=Ct(".djs-outline",c);l||(l=i(),ae(c,l)),r.updateConnectionOutline(l,a)})}Ms.prototype.updateShapeOutline=function(t,e){var n=!1,r=this._getProviders();r.length&&I(r,function(i){n=n||i.updateOutline(e,t)}),n||Y(t,{x:-this.offset,y:-this.offset,width:e.width+this.offset*2,height:e.height+this.offset*2})};Ms.prototype.updateConnectionOutline=function(t,e){var n=gn(e);Y(t,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+this.offset*2,height:n.height+this.offset*2})};Ms.prototype.registerProvider=function(t,e){e||(e=t,t=T4),this._eventBus.on("outline.getProviders",t,function(n){n.providers.push(e)})};Ms.prototype._getProviders=function(){var t=this._eventBus.createEvent({type:"outline.getProviders",providers:[]});return this._eventBus.fire(t),t.providers};Ms.prototype.getOutline=function(t){var e,n=this._getProviders();return I(n,function(r){Hn(r.getOutline)&&(e=e||r.getOutline(t))}),e};Ms.$inject=["eventBus","styles","elementRegistry"];var Rl=6;function dg(t,e,n){this._canvas=e;var r=this;t.on("element.changed",function(i){n.isSelected(i.element)&&r._updateMultiSelectionOutline(n.get())}),t.on("selection.changed",function(i){var s=i.newSelection;r._updateMultiSelectionOutline(s)})}dg.prototype._updateMultiSelectionOutline=function(t){var e=this._canvas.getLayer("selectionOutline");kd(e);var n=t.length>1,r=this._canvas.getContainer();if(dt(r)[n?"add":"remove"]("djs-multi-select"),!!n){var i=R4(gn(t)),s=ie("rect");Y(s,L({rx:3},i)),dt(s).add("djs-selection-outline"),ae(e,s)}};dg.$inject=["eventBus","canvas","selection"];function R4(t){return{x:t.x-Rl,y:t.y-Rl,width:t.width+Rl*2,height:t.height+Rl*2}}const qE={__depends__:[Nr],__init__:["outline","multiSelectionOutline"],outline:["type",Ms],multiSelectionOutline:["type",dg]};var A4=500,I4=1250,M4=1500,sd=Math.round;function D4(t){return{x:t.x+sd(t.width/2),y:t.y+sd(t.height/2)}}function KE(t,e,n,r,i){function s(c,l,d,u){return i.allowed("elements.move",{shapes:c,delta:l,position:d,target:u})}t.on("shape.move.start",M4,function(c){var l=c.context,d=c.shape,u=r.get().slice();u.indexOf(d)===-1&&(u=[d]),u=O4(u),L(l,{shapes:u,validatedShapes:u,shape:d})}),t.on("shape.move.start",I4,function(c){var l=c.context,d=l.validatedShapes,u;if(u=l.canExecute=s(d),!u)return!1}),t.on("shape.move.move",A4,function(c){var l=c.context,d=l.validatedShapes,u=c.hover,h={x:c.dx,y:c.dy},p={x:c.x,y:c.y},f;if(f=s(d,h,p,u),l.delta=h,l.canExecute=f,f===null){l.target=null;return}l.target=u}),t.on("shape.move.end",function(c){var l=c.context,d=l.delta,u=l.canExecute,h=u==="attach",p=l.shapes;if(u===!1)return!1;d.x=sd(d.x),d.y=sd(d.y),!(d.x===0&&d.y===0)&&n.moveElements(p,d,l.target,{primaryShape:l.shape,attach:h})}),t.on("element.mousedown",function(c){if(mf(c)){var l=kw(c);if(!l)throw new Error("must supply DOM mousedown event");return a(l,c.element)}});function a(c,l,d,u){if(Yr(d)&&(u=d,d=!1),!(l.waypoints||!l.parent)&&!dt(c.target).has("djs-hit-no-move")){var h=D4(l);return e.init(c,h,"shape.move",{cursor:"grabbing",autoActivate:d,data:{shape:l,context:u||{}}}),!0}}this.start=a}KE.$inject=["eventBus","dragging","modeling","selection","rules"];function O4(t){var e=Nd(t,"id");return Ve(t,function(n){for(;n=n.parent;)if(e[n.id])return!1;return!0})}var sb=499,$h="djs-dragging",ab="drop-ok",ob="drop-not-ok",cb="new-parent",lb="attach-ok";function YE(t,e,n,r){function i(l){var d=s(l),u=$4(d);return u}function s(l){var d=yc(l,!0),u=d.flatMap(f=>(f.incoming||[]).concat(f.outgoing||[])),h=d.concat(u),p=[...new Set(h)];return p}function a(l,d){[lb,ab,ob,cb].forEach(function(u){u===d?e.addMarker(l,u):e.removeMarker(l,u)})}function c(l,d,u){r.addDragger(d,l.dragGroup),u&&e.addMarker(d,$h),l.allDraggedElements?l.allDraggedElements.push(d):l.allDraggedElements=[d]}t.on("shape.move.start",sb,function(l){var d=l.context,u=d.shapes,h=d.allDraggedElements,p=i(u);if(!d.dragGroup){var f=ie("g");Y(f,n.cls("djs-drag-group",["no-events"]));var m=e.getActiveLayer();ae(m,f),d.dragGroup=f}p.forEach(function(v){r.addDragger(v,d.dragGroup)}),h?h=pf([h,s(u)]):h=s(u),I(h,function(v){e.addMarker(v,$h)}),d.allDraggedElements=h,d.differentParents=L4(u)}),t.on("shape.move.move",sb,function(l){var d=l.context,u=d.dragGroup,h=d.target,p=d.shape.parent,f=d.canExecute;h&&(f==="attach"?a(h,lb):d.canExecute&&p&&h.id!==p.id?a(h,cb):a(h,d.canExecute?ab:ob)),an(u,l.dx,l.dy)}),t.on(["shape.move.out","shape.move.cleanup"],function(l){var d=l.context,u=d.target;u&&a(u,null)}),t.on("shape.move.cleanup",function(l){var d=l.context,u=d.allDraggedElements,h=d.dragGroup;I(u,function(p){e.removeMarker(p,$h)}),h&&on(h)}),this.makeDraggable=c}YE.$inject=["eventBus","canvas","styles","previewSupport"];function $4(t){var e=Ve(t,function(n){return lt(n)?mt(t,Vr({id:n.source.id}))&&mt(t,Vr({id:n.target.id})):!0});return e}function L4(t){return mC(Nd(t,function(e){return e.parent&&e.parent.id}))!==1}const B4={__depends__:[hf,Nr,qE,Cr,Qr,Ya],__init__:["move","movePreview"],move:["type",KE],movePreview:["type",YE]};var ZE=".djs-palette-toggle",XE=".entry",F4=ZE+", "+XE,Bp="djs-palette-",z4="shown",Fp="open",db="two-column",U4=1e3;function Pt(t,e){this._eventBus=t,this._canvas=e;var n=this;t.on("tool-manager.update",function(r){var i=r.tool;n.updateToolHighlight(i)}),t.on("i18n.changed",function(){n._update()}),t.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}Pt.$inject=["eventBus","canvas"];Pt.prototype.registerProvider=function(t,e){e||(e=t,t=U4),this._eventBus.on("palette.getProviders",t,function(n){n.providers.push(e)}),this._rebuild()};Pt.prototype.getEntries=function(){var t=this._getProviders();return t.reduce(V4,{})};Pt.prototype._rebuild=function(){if(this._diagramInitialized){var t=this._getProviders();t.length&&(this._container||this._init(),this._update())}};Pt.prototype._init=function(){var t=this,e=this._eventBus,n=this._getParentContainer(),r=this._container=Ht(Pt.HTML_MARKUP);n.appendChild(r),Dt(n).add(Bp+z4),ar.bind(r,F4,"click",function(i){var s=i.delegateTarget;if(Nw(s,ZE))return t.toggle();t.trigger("click",i)}),je.bind(r,"mousedown",function(i){i.stopPropagation()}),ar.bind(r,XE,"dragstart",function(i){t.trigger("dragstart",i)}),e.on("canvas.resized",this._layoutChanged,this),e.fire("palette.create",{container:r})};Pt.prototype._getProviders=function(t){var e=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(e),e.providers};Pt.prototype._toggleState=function(t){t=t||{};var e=this._getParentContainer(),n=this._container,r=this._eventBus,i,s=Dt(n),a=Dt(e);"twoColumn"in t?i=t.twoColumn:i=this._needsCollapse(e.clientHeight,this._entries||{}),s.toggle(db,i),a.toggle(Bp+db,i),"open"in t&&(s.toggle(Fp,t.open),a.toggle(Bp+Fp,t.open)),r.fire("palette.changed",{twoColumn:i,open:this.isOpen()})};Pt.prototype._update=function(){var t=Ct(".djs-palette-entries",this._container),e=this._entries=this.getEntries();Ow(t),I(e,function(n,r){var i=n.group||"default",s=Ct("[data-group="+Wo(i)+"]",t);s||(s=Ht('<div class="group"></div>'),mn(s,"data-group",i),t.appendChild(s));var a=n.html||(n.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),c=Ht(a);if(s.appendChild(c),!n.separator&&(mn(c,"data-action",r),n.title&&mn(c,"title",n.title),n.className&&H4(c,n.className),n.imageUrl)){var l=Ht("<img>");mn(l,"src",n.imageUrl),c.appendChild(l)}}),this.open()};Pt.prototype.trigger=function(t,e,n){var r,i,s=e.delegateTarget||e.target;return s?(r=mn(s,"data-action"),i=e.originalEvent||e,this.triggerEntry(r,t,i,n)):e.preventDefault()};Pt.prototype.triggerEntry=function(t,e,n,r){var i=this._entries,s,a;if(s=i[t],!!s&&(a=s.action,this._eventBus.fire("palette.trigger",{entry:s,event:n})!==!1)){if(Hn(a)){if(e==="click")return a(n,r)}else if(a[e])return a[e](n,r);n.preventDefault()}};Pt.prototype._layoutChanged=function(){this._toggleState({})};Pt.prototype._needsCollapse=function(t,e){var n=50,r=Object.keys(e).length*46;return t<r+n};Pt.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})};Pt.prototype.open=function(){this._toggleState({open:!0})};Pt.prototype.toggle=function(){this.isOpen()?this.close():this.open()};Pt.prototype.isActiveTool=function(t){return t&&this._activeTool===t};Pt.prototype.updateToolHighlight=function(t){var e,n;this._toolsContainer||(e=Ct(".djs-palette-entries",this._container),this._toolsContainer=Ct("[data-group=tools]",e)),n=this._toolsContainer,I(n.children,function(r){var i=r.getAttribute("data-action");if(i){var s=Dt(r);i=i.replace("-tool",""),s.contains("entry")&&i===t?s.add("highlighted-entry"):s.remove("highlighted-entry")}})};Pt.prototype.isOpen=function(){return Dt(this._container).has(Fp)};Pt.prototype._getParentContainer=function(){return this._canvas.getContainer()};Pt.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';function H4(t,e){var n=Dt(t),r=Ue(e)?e:e.split(/\s+/g);r.forEach(function(i){n.add(i)})}function V4(t,e){var n=e.getPaletteEntries();return Hn(n)?n(t):(I(n,function(r,i){t[i]=r}),t)}const G4={__init__:["palette"],palette:["type",Pt]};var JE="crosshair";function Ds(t,e,n,r,i,s,a){this._selection=i,this._dragging=n,this._mouse=a;var c=this,l={create:function(d){var u=e.getActiveLayer(),h;h=d.frame=ie("rect"),Y(h,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),ae(u,h)},update:function(d){var u=d.frame,h=d.bbox;Y(u,{x:h.x,y:h.y,width:h.width,height:h.height})},remove:function(d){d.frame&&on(d.frame)}};s.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),t.on("lasso.selection.end",function(d){var u=d.originalEvent.target;!d.hover&&!(u instanceof SVGElement)||t.once("lasso.selection.ended",function(){c.activateLasso(d.originalEvent,!0)})}),t.on("lasso.end",0,function(d){var u=d.context,h=Lh(d),p=r.filter(function(m){return m}),f=qh(d);c.select(p,h,f?u.selection:[])}),t.on("lasso.start",function(d){var u=d.context;u.bbox=Lh(d),l.create(u),u.selection=i.get()}),t.on("lasso.move",function(d){var u=d.context;u.bbox=Lh(d),l.update(u)}),t.on("lasso.cleanup",function(d){var u=d.context;l.remove(u)}),t.on("element.mousedown",1500,function(d){if(qh(d))return c.activateLasso(d.originalEvent),!0})}Ds.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"];Ds.prototype.activateLasso=function(t,e){this._dragging.init(t,"lasso",{autoActivate:e,cursor:JE,data:{context:{}}})};Ds.prototype.activateSelection=function(t,e){this._dragging.init(t,"lasso.selection",{trapClick:!1,autoActivate:e,cursor:JE,data:{context:{}},keepSelection:!0})};Ds.prototype.select=function(t,e,n=[]){var r=Iw(t,e);this._selection.select([...n,...jd(r)])};Ds.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var t=this._mouse.getLastMoveEvent();this.activateSelection(t,!!t)};Ds.prototype.isActive=function(){var t=this._dragging.context();return t&&/^lasso/.test(t.prefix)};function Lh(t){var e={x:t.x-t.dx,y:t.y-t.dy},n={x:t.x,y:t.y},r;return e.x<=n.x&&e.y<n.y||e.x<n.x&&e.y<=n.y?r={x:e.x,y:e.y,width:n.x-e.x,height:n.y-e.y}:e.x>=n.x&&e.y<n.y||e.x>n.x&&e.y<=n.y?r={x:n.x,y:e.y,width:e.x-n.x,height:n.y-e.y}:e.x<=n.x&&e.y>n.y||e.x<n.x&&e.y>=n.y?r={x:e.x,y:n.y,width:n.x-e.x,height:e.y-n.y}:e.x>=n.x&&e.y>n.y||e.x>n.x&&e.y>=n.y?r={x:n.x,y:n.y,width:e.x-n.x,height:e.y-n.y}:r={x:n.x,y:n.y,width:0,height:0},r}const W4={__depends__:[ou,Pc],__init__:["lassoTool"],lassoTool:["type",Ds]};var Bh=1500,QE="grab";function Za(t,e,n,r,i,s){this._dragging=n,this._mouse=s;var a=this,c=r.get("keyboard",!1);i.registerTool("hand",{tool:"hand",dragging:"hand.move"}),t.on("element.mousedown",Bh,function(l){if(Ko(l))return a.activateMove(l.originalEvent,!0),!1}),c&&c.addListener(Bh,function(l){if(!(!ub(l.keyEvent)||a.isActive())){var d=a._mouse.getLastMoveEvent();a.activateMove(d,!!d)}},"keyboard.keydown"),c&&c.addListener(Bh,function(l){!ub(l.keyEvent)||!a.isActive()||a.toggle()},"keyboard.keyup"),t.on("hand.end",function(l){var d=l.originalEvent.target;if(!l.hover&&!(d instanceof SVGElement))return!1;t.once("hand.ended",function(){a.activateMove(l.originalEvent,{reactivate:!0})})}),t.on("hand.move.move",function(l){var d=e.viewbox().scale;e.scroll({dx:l.dx*d,dy:l.dy*d})}),t.on("hand.move.end",function(l){var d=l.context,u=d.reactivate;return!Ko(l)&&u&&t.once("hand.move.ended",function(h){a.activateHand(h.originalEvent,!0,!0)}),!1})}Za.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"];Za.prototype.activateMove=function(t,e,n){typeof e=="object"&&(n=e,e=!1),this._dragging.init(t,"hand.move",{autoActivate:e,cursor:QE,data:{context:n||{}}})};Za.prototype.activateHand=function(t,e,n){this._dragging.init(t,"hand",{trapClick:!1,autoActivate:e,cursor:QE,data:{context:{reactivate:n}}})};Za.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var t=this._mouse.getLastMoveEvent();this.activateHand(t,!!t)};Za.prototype.isActive=function(){var t=this._dragging.context();return t?/^(hand|hand\.move)$/.test(t.prefix):!1};function ub(t){return Ft("Space",t)}const q4={__depends__:[ou,Pc],__init__:["handTool"],handTool:["type",Za]};var hb="connect-ok",pb="connect-not-ok";function Xa(t,e,n,r,i,s,a){var c=this;this._dragging=e,this._rules=s,this._mouse=a,i.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),t.on("global-connect.hover",function(l){var d=l.context,u=l.hover,h=d.canStartConnect=c.canStartConnect(u);h!==null&&(d.startTarget=u,r.addMarker(u,h?hb:pb))}),t.on(["global-connect.out","global-connect.cleanup"],function(l){var d=l.context.startTarget,u=l.context.canStartConnect;d&&r.removeMarker(d,u?hb:pb)}),t.on(["global-connect.ended"],function(l){var d=l.context,u=d.startTarget,h={x:l.x,y:l.y},p=c.canStartConnect(u);if(p)return t.once("element.out",function(){t.once(["connect.ended","connect.canceled"],function(){t.fire("global-connect.drag.ended")}),n.start(null,u,h)}),!1})}Xa.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"];Xa.prototype.start=function(t,e){this._dragging.init(t,"global-connect",{autoActivate:e,trapClick:!1,data:{context:{}}})};Xa.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var t=this._mouse.getLastMoveEvent();return this.start(t,!!t)};Xa.prototype.isActive=function(){var t=this._dragging.context();return t&&/^global-connect/.test(t.prefix)};Xa.prototype.canStartConnect=function(t){return this._rules.allowed("connection.start",{source:t})};const K4={__depends__:[rm,Cr,Qr,ou,Pc],globalConnect:["type",Xa]};function ug(t,e,n,r,i,s,a,c){this._palette=t,this._create=e,this._elementFactory=n,this._spaceTool=r,this._lassoTool=i,this._handTool=s,this._globalConnect=a,this._translate=c,t.registerProvider(this)}ug.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"];ug.prototype.getPaletteEntries=function(){var t={},e=this._create,n=this._elementFactory,r=this._spaceTool,i=this._lassoTool,s=this._handTool,a=this._globalConnect,c=this._translate;function l(h,p,f,m,v){function g(w){var b=n.createShape(L({type:h},v));e.start(w,b)}return{group:p,className:f,title:m,action:{dragstart:g,click:g}}}function d(h){var p=n.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),f=n.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:p});e.start(h,[p,f],{hints:{autoSelect:[p]}})}function u(h){e.start(h,n.createParticipantShape())}return L(t,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:c("Activate hand tool"),action:{click:function(h){s.activateHand(h)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:c("Activate lasso tool"),action:{click:function(h){i.activateSelection(h)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:c("Activate create/remove space tool"),action:{click:function(h){r.activateSelection(h)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:c("Activate global connect tool"),action:{click:function(h){a.start(h)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":l("bpmn:StartEvent","event","bpmn-icon-start-event-none",c("Create start event")),"create.intermediate-event":l("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",c("Create intermediate/boundary event")),"create.end-event":l("bpmn:EndEvent","event","bpmn-icon-end-event-none",c("Create end event")),"create.exclusive-gateway":l("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",c("Create gateway")),"create.task":l("bpmn:Task","activity","bpmn-icon-task",c("Create task")),"create.data-object":l("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",c("Create data object reference")),"create.data-store":l("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",c("Create data store reference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:c("Create expanded sub-process"),action:{dragstart:d,click:d}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:c("Create pool/participant"),action:{dragstart:u,click:u}},"create.group":l("bpmn:Group","artifact","bpmn-icon-group",c("Create group"))}),t};const Y4={__depends__:[G4,au,fE,W4,q4,K4,$w],__init__:["paletteProvider"],paletteProvider:["type",ug]};var Z4=250;function hg(t,e,n,r,i){Z.call(this,t);function s(c){var l=c.canExecute.replacements;I(l,function(d){var u=d.oldElementId,h={type:d.newElementType};if(!c.visualReplacements[u]){var p=e.get(u);L(h,{x:p.x,y:p.y});var f=n.createShape(h);r.addShape(f,p.parent);var m=Ct('[data-element-id="'+Wo(p.id)+'"]',c.dragGroup);m&&Y(m,{display:"none"});var v=i.addDragger(f,c.dragGroup);c.visualReplacements[u]=v,r.removeShape(f)}})}function a(c){var l=c.visualReplacements;I(l,function(d,u){var h=Ct('[data-element-id="'+Wo(u)+'"]',c.dragGroup);h&&Y(h,{display:"inline"}),d.remove(),l[u]&&delete l[u]})}t.on("shape.move.move",Z4,function(c){var l=c.context,d=l.canExecute;l.visualReplacements||(l.visualReplacements={}),d&&d.replacements?s(l):a(l)})}hg.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"];fe(hg,Z);const X4={__depends__:[Ya],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",hg]};var J4=1250,Fh=40,Q4=20,e3=10,fb=20,eS=["x","y"],t3=Math.abs;function tS(t){t.on(["connect.hover","connect.move","connect.end"],J4,function(e){var n=e.context,r=n.canExecute,i=n.start,s=n.hover,a=n.source,c=n.target;e.originalEvent&&zn(e.originalEvent)||(n.initialConnectionStart||(n.initialConnectionStart=n.connectionStart),r&&s&&n3(e,s,a3(s)),s&&s3(r,["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"])?(n.connectionStart=Fn(i),Me(s,["bpmn:Event","bpmn:Gateway"])&&mb(e,Fn(s)),Me(s,["bpmn:Task","bpmn:SubProcess"])&&r3(e,s),_(a,"bpmn:BoundaryEvent")&&c===a.host&&i3(e)):nS(r,"bpmn:MessageFlow")?(_(i,"bpmn:Event")&&(n.connectionStart=Fn(i)),_(s,"bpmn:Event")&&mb(e,Fn(s))):n.connectionStart=n.initialConnectionStart)})}tS.$inject=["eventBus"];function n3(t,e,n){eS.forEach(function(r){var i=rS(r,e);t[r]<e[r]+n?kt(t,r,e[r]+n):t[r]>e[r]+i-n&&kt(t,r,e[r]+i-n)})}function r3(t,e){var n=Fn(e);eS.forEach(function(r){o3(t,e,r)&&kt(t,r,n[r])})}function i3(t){var e=t.context,n=e.source,r=e.target;if(!c3(e)){var i=Fn(n),s=Yt(i,r,-10),a=[];/top|bottom/.test(s)&&a.push("x"),/left|right/.test(s)&&a.push("y"),a.forEach(function(c){var l=t[c],d;t3(l-i[c])<Fh&&(l>i[c]?d=i[c]+Fh:d=i[c]-Fh,kt(t,c,d))})}}function mb(t,e){kt(t,"x",e.x),kt(t,"y",e.y)}function nS(t,e){return t&&t.type===e}function s3(t,e){return xc(e,function(n){return nS(t,n)})}function rS(t,e){return t==="x"?e.width:e.height}function a3(t){return _(t,"bpmn:Task")?e3:Q4}function o3(t,e,n){return t[n]>e[n]+fb&&t[n]<e[n]+rS(n,e)-fb}function c3(t){var e=t.hover,n=t.source;return e&&n&&e===n}function Yi(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}Yi.prototype.getSnapOrigin=function(t){return this._snapOrigins[t]};Yi.prototype.setSnapOrigin=function(t,e){this._snapOrigins[t]=e,this._snapLocations.indexOf(t)===-1&&this._snapLocations.push(t)};Yi.prototype.addDefaultSnap=function(t,e){var n=this._defaultSnaps[t];n||(n=this._defaultSnaps[t]=[]),n.push(e)};Yi.prototype.getSnapLocations=function(){return this._snapLocations};Yi.prototype.setSnapLocations=function(t){this._snapLocations=t};Yi.prototype.pointsForTarget=function(t){var e=t.id||t,n=this._targets[e];return n||(n=this._targets[e]=new ju,n.initDefaults(this._defaultSnaps)),n};function ju(){this._snapValues={}}ju.prototype.add=function(t,e){var n=this._snapValues[t];n||(n=this._snapValues[t]={x:[],y:[]}),n.x.indexOf(e.x)===-1&&n.x.push(e.x),n.y.indexOf(e.y)===-1&&n.y.push(e.y)};ju.prototype.snap=function(t,e,n,r){var i=this._snapValues[e];return i&&gD(t[n],i[n],r)};ju.prototype.initDefaults=function(t){var e=this;I(t||{},function(n,r){I(n,function(i){e.add(r,i)})})};var l3=1250;function Pr(t,e,n){var r=this;this._elementRegistry=t,e.on(["create.start","shape.move.start"],function(i){r.initSnap(i)}),e.on(["create.move","create.end","shape.move.move","shape.move.end"],l3,function(i){var s=i.context,a=s.shape,c=s.snapContext,l=s.target;if(!(i.originalEvent&&zn(i.originalEvent))&&!(Ca(i)||!l)){var d=c.pointsForTarget(l);d.initialized||(d=r.addSnapTargetPoints(d,a,l),d.initialized=!0),n.snap(i,d)}}),e.on(["create.cleanup","shape.move.cleanup"],function(){n.hide()})}Pr.$inject=["elementRegistry","eventBus","snapping"];Pr.prototype.initSnap=function(t){var e=this._elementRegistry,n=t.context,r=n.shape,i=n.snapContext;i||(i=n.snapContext=new Yi);var s;e.get(r.id)?s=Fn(r,t):s={x:t.x+Fn(r).x,y:t.y+Fn(r).y};var a={x:s.x-r.width/2,y:s.y-r.height/2},c={x:s.x+r.width/2,y:s.y+r.height/2};return i.setSnapOrigin("mid",{x:s.x-t.x,y:s.y-t.y}),We(r)||(i.setSnapOrigin("top-left",{x:a.x-t.x,y:a.y-t.y}),i.setSnapOrigin("bottom-right",{x:c.x-t.x,y:c.y-t.y})),i};Pr.prototype.addSnapTargetPoints=function(t,e,n){var r=this.getSnapTargets(e,n);return I(r,function(i){if(We(i)){We(e)&&t.add("mid",Fn(i));return}if(lt(i)){if(i.waypoints.length<3)return;var s=i.waypoints.slice(1,-1);I(s,function(a){t.add("mid",a)});return}t.add("mid",Fn(i))}),!ze(e.x)||!ze(e.y)||this._elementRegistry.get(e.id)&&t.add("mid",Fn(e)),t};Pr.prototype.getSnapTargets=function(t,e){return v1(e).filter(function(n){return!d3(n)})};function d3(t){return!!t.hidden}var gb=1500;function Ja(t,e){e.invoke(Pr,this),t.on(["create.move","create.end"],gb,f3),t.on(["create.move","create.end","shape.move.move","shape.move.end"],gb,function(n){var r=n.context,i=r.canExecute,s=r.target,a=i&&(i==="attach"||i.attach);a&&!Ca(n)&&u3(n,s)})}fe(Ja,Pr);Ja.$inject=["eventBus","injector"];Ja.prototype.initSnap=function(t){var e=Pr.prototype.initSnap.call(this,t),n=t.shape,r=!!this._elementRegistry.get(n.id);return I(n.outgoing,function(i){var s=i.waypoints[0];s=s.original||s,e.setSnapOrigin(i.id+"-docking",yb(s,r,t))}),I(n.incoming,function(i){var s=i.waypoints[i.waypoints.length-1];s=s.original||s,e.setSnapOrigin(i.id+"-docking",yb(s,r,t))}),_(n,"bpmn:Participant")&&e.setSnapLocations(["top-left","bottom-right","mid"]),e};Ja.prototype.addSnapTargetPoints=function(t,e,n){Pr.prototype.addSnapTargetPoints.call(this,t,e,n);var r=this.getSnapTargets(e,n);I(r,function(s){(p3(s)||h3([e,s],"bpmn:TextAnnotation"))&&(t.add("top-left",m1(s)),t.add("bottom-right",g1(s)))});var i=this._elementRegistry;return I(e.incoming,function(s){if(i.get(e.id)){vb(r,s.source)||t.add("mid",we(s.source));var a=s.waypoints[0];t.add(s.id+"-docking",a.original||a)}}),I(e.outgoing,function(s){if(i.get(e.id)){vb(r,s.target)||t.add("mid",we(s.target));var a=s.waypoints[s.waypoints.length-1];t.add(s.id+"-docking",a.original||a)}}),_(n,"bpmn:SequenceFlow")&&(t=this.addSnapTargetPoints(t,e,n.parent)),t};Ja.prototype.getSnapTargets=function(t,e){return Pr.prototype.getSnapTargets.call(this,t,e).filter(function(n){return!_(n,"bpmn:Lane")})};function u3(t,e){var n=ye(e),r=H1(t,e),i=t.context,s=i.shape,a;s.parent?a={x:0,y:0}:a=we(s),/top/.test(r)?kt(t,"y",n.top-a.y):/bottom/.test(r)&&kt(t,"y",n.bottom-a.y),/left/.test(r)?kt(t,"x",n.left-a.x):/right/.test(r)&&kt(t,"x",n.right-a.x)}function h3(t,e){return t.every(function(n){return _(n,e)})}function p3(t){return _(t,"bpmn:SubProcess")&&Ze(t)?!0:_(t,"bpmn:Participant")}function f3(t){var e=t.context,n=e.createConstraints;if(n){var r=n.top,i=n.right,s=n.bottom,a=n.left;(a&&a>=t.x||i&&i<=t.x)&&kt(t,"x",t.x),(r&&r>=t.y||s&&s<=t.y)&&kt(t,"y",t.y)}}function vb(t,e){return t.indexOf(e)!==-1}function yb(t,e,n){return e?{x:t.x-n.x,y:t.y-n.y}:{x:t.x,y:t.y}}var m3=1250;function Wc(t,e){var n=this;t.on(["resize.start"],function(r){n.initSnap(r)}),t.on(["resize.move","resize.end"],m3,function(r){var i=r.context,s=i.shape,a=s.parent,c=i.direction,l=i.snapContext;if(!(r.originalEvent&&zn(r.originalEvent))&&!Ca(r)){var d=l.pointsForTarget(a);d.initialized||(d=n.addSnapTargetPoints(d,s,a,c),d.initialized=!0),y3(c)&&kt(r,"x",r.x),x3(c)&&kt(r,"y",r.y),e.snap(r,d)}}),t.on(["resize.cleanup"],function(){e.hide()})}Wc.prototype.initSnap=function(t){var e=t.context,n=e.shape,r=e.direction,i=e.snapContext;i||(i=e.snapContext=new Yi);var s=iS(n,r);return i.setSnapOrigin("corner",{x:s.x-t.x,y:s.y-t.y}),i};Wc.prototype.addSnapTargetPoints=function(t,e,n,r){var i=this.getSnapTargets(e,n);return I(i,function(s){t.add("corner",g1(s)),t.add("corner",m1(s))}),t.add("corner",iS(e,r)),t};Wc.$inject=["eventBus","snapping"];Wc.prototype.getSnapTargets=function(t,e){return v1(e).filter(function(n){return!g3(n,t)&&!lt(n)&&!v3(n)&&!We(n)})};function iS(t,e){var n=we(t),r=ye(t),i={x:n.x,y:n.y};return e.indexOf("n")!==-1?i.y=r.top:e.indexOf("s")!==-1&&(i.y=r.bottom),e.indexOf("e")!==-1?i.x=r.right:e.indexOf("w")!==-1&&(i.x=r.left),i}function g3(t,e){return t.host===e}function v3(t){return!!t.hidden}function y3(t){return t==="n"||t==="s"}function x3(t){return t==="e"||t==="w"}var b3=7,w3=1e3;function Zi(t){this._canvas=t,this._asyncHide=gC(Ss(this.hide,this),w3)}Zi.$inject=["canvas"];Zi.prototype.snap=function(t,e){var n=t.context,r=n.snapContext,i=r.getSnapLocations(),s={x:Ca(t,"x"),y:Ca(t,"y")};I(i,function(a){var c=r.getSnapOrigin(a),l={x:t.x+c.x,y:t.y+c.y};if(I(["x","y"],function(d){var u;s[d]||(u=e.snap(l,a,d,b3),u!==void 0&&(s[d]={value:u,originValue:u-c[d]}))}),s.x&&s.y)return!1}),this.showSnapLine("vertical",s.x&&s.x.value),this.showSnapLine("horizontal",s.y&&s.y.value),I(["x","y"],function(a){var c=s[a];Yr(c)&&kt(t,a,c.originValue)})};Zi.prototype._createLine=function(t){var e=this._canvas.getLayer("snap"),n=ie("path");return Y(n,{d:"M0,0 L0,0"}),dt(n).add("djs-snap-line"),ae(e,n),{update:function(r){ze(r)?t==="horizontal"?Y(n,{d:"M-100000,"+r+" L+100000,"+r,display:""}):Y(n,{d:"M "+r+",-100000 L "+r+", +100000",display:""}):Y(n,{display:"none"})}}};Zi.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}};Zi.prototype.showSnapLine=function(t,e){var n=this.getSnapLine(t);n&&n.update(e),this._asyncHide()};Zi.prototype.getSnapLine=function(t){return this._snapLines||this._createSnapLines(),this._snapLines[t]};Zi.prototype.hide=function(){I(this._snapLines,function(t){t.update()})};const _3={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",Pr],resizeSnapping:["type",Wc],snapping:["type",Zi]},E3={__depends__:[_3],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",tS],createMoveSnapping:["type",Ja]};var sS=300;function be(t,e,n,r){this._open=!1,this._results={},this._eventMaps=[],this._cachedRootElement=null,this._cachedSelection=null,this._cachedViewbox=null,this._canvas=t,this._eventBus=e,this._selection=n,this._translate=r,this._container=this._getBoxHtml(),this._searchInput=Ct(be.INPUT_SELECTOR,this._container),this._resultsContainer=Ct(be.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),e.on(["canvas.destroy","diagram.destroy","drag.init","elements.changed"],this.close,this)}be.$inject=["canvas","eventBus","selection","translate"];be.prototype._bindEvents=function(){var t=this;function e(n,r,i,s){t._eventMaps.push({el:n,type:i,listener:ar.bind(n,r,i,s)})}e(document,"html","click",function(n){t.close(!1)}),e(this._container,be.INPUT_SELECTOR,"click",function(n){n.stopPropagation(),n.delegateTarget.focus()}),e(this._container,be.RESULT_SELECTOR,"mouseover",function(n){n.stopPropagation(),t._scrollToNode(n.delegateTarget),t._preselect(n.delegateTarget)}),e(this._container,be.RESULT_SELECTOR,"click",function(n){n.stopPropagation(),t._select(n.delegateTarget)}),e(this._container,be.INPUT_SELECTOR,"keydown",function(n){Ft("ArrowUp",n)&&n.preventDefault(),Ft("ArrowDown",n)&&n.preventDefault()}),e(this._container,be.INPUT_SELECTOR,"keyup",function(n){if(Ft("Escape",n))return t.close();if(Ft("Enter",n)){var r=t._getCurrentResult();return r?t._select(r):t.close(!1)}if(Ft("ArrowUp",n))return t._scrollToDirection(!0);if(Ft("ArrowDown",n))return t._scrollToDirection();Ft(["ArrowLeft","ArrowRight"],n)||t._search(n.delegateTarget.value)})};be.prototype._unbindEvents=function(){this._eventMaps.forEach(function(t){ar.unbind(t.el,t.type,t.listener)})};be.prototype._search=function(t){var e=this;if(this._clearResults(),!!t.trim()){var n=this._searchProvider.find(t);if(n=n.filter(function(i){return!e._canvas.getRootElements().includes(i.element)}),!n.length){this._selection.select(null);return}n.forEach(function(i){var s=i.element.id,a=e._createResultNode(i,s);e._results[s]={element:i.element,node:a}});var r=Ct(be.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(r),this._preselect(r)}};be.prototype._scrollToDirection=function(t){var e=this._getCurrentResult();if(e){var n=t?e.previousElementSibling:e.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}};be.prototype._scrollToNode=function(t){if(!(!t||t===this._getCurrentResult())){var e=t.offsetTop,n=this._resultsContainer.scrollTop,r=e-this._resultsContainer.clientHeight+t.clientHeight;e<n?this._resultsContainer.scrollTop=e:n<r&&(this._resultsContainer.scrollTop=r)}};be.prototype._clearResults=function(){Ow(this._resultsContainer),this._results={},this._eventBus.fire("searchPad.cleared")};be.prototype._getCurrentResult=function(){return Ct(be.RESULT_SELECTED_SELECTOR,this._resultsContainer)};be.prototype._createResultNode=function(t,e){var n=Ht(be.RESULT_HTML);return t.primaryTokens.length>0&&xb(n,t.primaryTokens,be.RESULT_PRIMARY_HTML),xb(n,t.secondaryTokens,be.RESULT_SECONDARY_HTML),mn(n,be.RESULT_ID_ATTRIBUTE,e),this._resultsContainer.appendChild(n),n};be.prototype.registerProvider=function(t){this._searchProvider=t};be.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._cachedRootElement=this._canvas.getRootElement(),this._cachedSelection=this._selection.get(),this._cachedViewbox=this._canvas.viewbox(),this._selection.select(null),this._bindEvents(),this._open=!0,Dt(this._canvas.getContainer()).add("djs-search-open"),Dt(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))};be.prototype.close=function(t=!0){this.isOpen()&&(t&&(this._cachedRootElement&&this._canvas.setRootElement(this._cachedRootElement),this._cachedSelection&&this._selection.select(this._cachedSelection),this._cachedViewbox&&this._canvas.viewbox(this._cachedViewbox),this._eventBus.fire("searchPad.restored")),this._cachedRootElement=null,this._cachedSelection=null,this._cachedViewbox=null,this._unbindEvents(),this._open=!1,Dt(this._canvas.getContainer()).remove("djs-search-open"),Dt(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._eventBus.fire("searchPad.closed"),this._canvas.restoreFocus())};be.prototype.toggle=function(){this.isOpen()?this.close():this.open()};be.prototype.isOpen=function(){return this._open};be.prototype._preselect=function(t){var e=this._getCurrentResult();if(t!==e){e&&Dt(e).remove(be.RESULT_SELECTED_CLASS);var n=mn(t,be.RESULT_ID_ATTRIBUTE),r=this._results[n].element;Dt(t).add(be.RESULT_SELECTED_CLASS),this._canvas.scrollToElement(r,{top:sS}),this._selection.select(r),this._eventBus.fire("searchPad.preselected",r)}};be.prototype._select=function(t){var e=mn(t,be.RESULT_ID_ATTRIBUTE),n=this._results[e].element;this._cachedSelection=null,this._cachedViewbox=null,this.close(!1),this._canvas.scrollToElement(n,{top:sS}),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)};be.prototype._getBoxHtml=function(){const t=Ht(be.BOX_HTML),e=Ct(be.INPUT_SELECTOR,t);return e&&e.setAttribute("aria-label",this._translate("Search in diagram")),t};function xb(t,e,n){var r=S3(e),i=Ht(n);i.innerHTML=r,t.appendChild(i)}function S3(t){var e="";return t.forEach(function(n){var r=vC(n.value||n.matched||n.normal),i=n.match||n.matched;i?e+='<b class="'+be.RESULT_HIGHLIGHT_CLASS+'">'+r+"</b>":e+=r}),e!==""?e:null}be.CONTAINER_SELECTOR=".djs-search-container";be.INPUT_SELECTOR=".djs-search-input input";be.RESULTS_CONTAINER_SELECTOR=".djs-search-results";be.RESULT_SELECTOR=".djs-search-result";be.RESULT_SELECTED_CLASS="djs-search-result-selected";be.RESULT_SELECTED_SELECTOR="."+be.RESULT_SELECTED_CLASS;be.RESULT_ID_ATTRIBUTE="data-result-id";be.RESULT_HIGHLIGHT_CLASS="djs-search-highlight";be.BOX_HTML=`<div class="djs-search-container djs-scrollable">
  <div class="djs-search-input">
    <svg class="djs-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M9.0325 8.5H9.625L13.3675 12.25L12.25 13.3675L8.5 9.625V9.0325L8.2975 8.8225C7.4425 9.5575 6.3325 10 5.125 10C2.4325 10 0.25 7.8175 0.25 5.125C0.25 2.4325 2.4325 0.25 5.125 0.25C7.8175 0.25 10 2.4325 10 5.125C10 6.3325 9.5575 7.4425 8.8225 8.2975L9.0325 8.5ZM1.75 5.125C1.75 6.9925 3.2575 8.5 5.125 8.5C6.9925 8.5 8.5 6.9925 8.5 5.125C8.5 3.2575 6.9925 1.75 5.125 1.75C3.2575 1.75 1.75 3.2575 1.75 5.125Z" fill="#22242A"/>
    </svg>
    <input type="text" spellcheck="false" />
  </div>
  <div class="djs-search-results" />
</div>`;be.RESULT_HTML='<div class="djs-search-result"></div>';be.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>';be.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';const j3={__depends__:[$w,jw,Nr],searchPad:["type",be]};function pg(t,e,n,r){this._elementRegistry=t,this._canvas=n,this._search=r,e.registerProvider(this)}pg.$inject=["elementRegistry","searchPad","canvas","search"];pg.prototype.find=function(t){var e=this._canvas.getRootElements(),n=this._elementRegistry.filter(function(r){return!We(r)&&!e.includes(r)});return this._search(n.map(r=>({element:r,label:js(r),id:r.id})),t,{keys:["label","id"]}).map(N3)};function N3(t){const{item:{element:e},tokens:n}=t;return{element:e,primaryTokens:n.label,secondaryTokens:n.id}}const k3={__depends__:[j3,Y_],__init__:["bpmnSearch"],bpmnSearch:["type",pg]},C3="M44.7648 11.3263L36.9892 2.64074C36.0451 1.58628 34.5651 0.988708 33.1904 0.988708H5.98667C3.22688 0.988708 0.989624 3.34892 0.989624 6.26039V55.0235C0.989624 57.9349 3.22688 60.2952 5.98667 60.2952H40.966C43.7257 60.2952 45.963 57.9349 45.963 55.0235V14.9459C45.963 13.5998 45.6407 12.3048 44.7648 11.3263Z",P3="M1.03845 48.1347C1.03845 49.3511 1.07295 50.758 1.38342 52.064C1.69949 53.3938 2.32428 54.7154 3.56383 55.6428C6.02533 57.4841 10.1161 58.7685 14.8212 59.6067C19.5772 60.4538 25.1388 60.8738 30.6831 60.8738C36.2276 60.8738 41.7891 60.4538 46.545 59.6067C51.2504 58.7687 55.3412 57.4842 57.8028 55.6429C59.0424 54.7156 59.6673 53.3938 59.9834 52.064C60.2938 50.7579 60.3285 49.351 60.3285 48.1344V13.8415C60.3285 12.6249 60.2938 11.218 59.9834 9.91171C59.6673 8.58194 59.0423 7.2602 57.8027 6.33294C55.341 4.49168 51.2503 3.20723 46.545 2.36914C41.7891 1.522 36.2276 1.10204 30.6831 1.10205C25.1388 1.10206 19.5772 1.52206 14.8213 2.36923C10.1162 3.20734 6.02543 4.49183 3.5639 6.33314C2.32433 7.26038 1.69951 8.58206 1.38343 9.91181C1.07295 11.2179 1.03845 12.6247 1.03845 13.8411V48.1347Z",T3={width:36,height:50},R3={width:50,height:50};function bb(t,e,n){return ie("path",{d:t,strokeWidth:2,transform:`translate(${e.x}, ${e.y})`,...n})}const wi=5;function Nu(t,e){this._styles=e,t.registerProvider(this)}Nu.$inject=["outline","styles"];Nu.prototype.getOutline=function(t){const e=this._styles.cls("djs-outline",["no-fill"]);var n;if(!We(t))return _(t,"bpmn:Gateway")?(n=ie("rect"),L(n.style,{"transform-box":"fill-box",transform:"rotate(45deg)","transform-origin":"center"}),Y(n,L({x:2,y:2,rx:4,width:t.width-4,height:t.height-4},e))):Me(t,["bpmn:Task","bpmn:SubProcess","bpmn:Group","bpmn:CallActivity"])?(n=ie("rect"),Y(n,L({x:-wi,y:-wi,rx:14,width:t.width+wi*2,height:t.height+wi*2},e))):_(t,"bpmn:EndEvent")?(n=ie("circle"),Y(n,L({cx:t.width/2,cy:t.height/2,r:t.width/2+wi+1},e))):_(t,"bpmn:Event")?(n=ie("circle"),Y(n,L({cx:t.width/2,cy:t.height/2,r:t.width/2+wi},e))):_(t,"bpmn:DataObjectReference")&&wb(t,"bpmn:DataObjectReference")?n=bb(C3,{x:-6,y:-6},e):_(t,"bpmn:DataStoreReference")&&wb(t,"bpmn:DataStoreReference")&&(n=bb(P3,{x:-6,y:-6},e)),n};Nu.prototype.updateOutline=function(t,e){if(!We(t))return Me(t,["bpmn:SubProcess","bpmn:Group"])?(Y(e,{width:t.width+wi*2,height:t.height+wi*2}),!0):!!Me(t,["bpmn:Event","bpmn:Gateway","bpmn:DataStoreReference","bpmn:DataObjectReference"])};function wb(t,e){var n;return e==="bpmn:DataObjectReference"?n=T3:e==="bpmn:DataStoreReference"&&(n=R3),t.width===n.width&&t.height===n.height}const A3={__depends__:[qE],__init__:["outlineProvider"],outlineProvider:["type",Nu]};var I3='<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>';function lr(t){Sc.call(this,t)}fe(lr,Sc);lr.Viewer=vc;lr.NavigatedViewer=Qo;lr.prototype.createDiagram=function(){return this.importXML(I3)};lr.prototype._interactionModules=[w_,j_,C_];lr.prototype._modelingModules=[PM,Jf,JM,WM,yD,rm,SD,RL,cE,au,DL,LL,t4,r4,i4,l4,w4,RE,C4,B4,Y4,X4,HE,E3,k3,A3];lr.prototype._modules=[].concat(vc.prototype._modules,lr.prototype._interactionModules,lr.prototype._modelingModules);const M3=100,D3=60;class O3 extends yC{constructor(n,r,i){super(n,5e3);uo(this,"bpmnRenderer");uo(this,"styles");uo(this,"_createDefs",!1);uo(this,"isPidMode",!1);this.bpmnRenderer=r,this.styles=i||{},this._createDefs=!1,this.isPidMode=!1,n.on("import.done",()=>{var a,c;const s=(a=r==null?void 0:r.get)==null?void 0:a.call(r,"canvas",!1);if(s){s.getRootElement();const l=(c=r==null?void 0:r.get)==null?void 0:c.call(r,"elementRegistry",!1);if(l){const u=l.getAll().some(h=>{const p=h.businessObject;if(!p)return!1;const f=p.$attrs||{};return!!(f["pid:symbol"]||f["pid:type"]||f["pid:category"])});this.isPidMode=u}}}),n.on("canvas.viewbox.changed",({element:s})=>{})}canRender(n){var u,h;const r=n.businessObject;if(!r||n.type==="label"||(u=n.id)!=null&&u.includes("_label")||(h=n.id)!=null&&h.includes("_di"))return!1;if(!this.isPidMode){const p=r.$attrs||{};return!!(p["pid:symbol"]||p["pid:type"]||p["pid:category"])}const i=r.name||"",s=(n.type||"").toLowerCase(),a=r.$attrs||{},c=!!(a["pid:symbol"]||a["pid:type"]||a["pid:category"]),l=s.includes("task")||s.includes("exclusivegateway")||s.includes("dataobjectreference")||s.includes("subprocess")||s.includes("startevent"),d=s.includes("sequenceflow")||s.includes("messageflow");return!!(c||l&&i||d)}drawShape(n,r){const i=r.businessObject,s=(i==null?void 0:i.$attrs)||{};let a=s["pid:symbol"]||"unknown";if(s["pid:category"],a==="unknown"&&this.isPidMode){const u=((i==null?void 0:i.name)||"").toLowerCase(),h=r.type||"";u.includes("tank")||u.includes("vessel")||u.includes("drum")?a="tank":u.includes("pump")?a="pump":u.includes("filter")?a="filter":u.includes("valve")?a=h.includes("Gateway")?"valve_control":"valve_gate":u.includes("transmitter")||u.includes("transducer")?u.includes("level")?a="transmitter_level":u.includes("flow")?a="transmitter_flow":u.includes("pressure")?a="transmitter_pressure":a="transmitter_level":u.includes("controller")?a="controller_pid":u.includes("analyzer")?a="analyzer":(u.includes("exchanger")||u.includes("heater")||u.includes("cooler"))&&(a="heat_exchanger"),a.includes("transmitter")||a.includes("analyzer")}this._ensureDefs(n);const c=ie("g");Y(c,{class:"pid-renderer-group"}),ae(n,c),setTimeout(()=>{Array.from(n.children).forEach(u=>{if(u!==c&&u.tagName==="g"){const h=u.querySelector(".djs-visual")||u;h&&!h.classList.contains("pid-renderer-group")&&h.setAttribute("style","display: none !important;")}})},0);const l=r.width&&r.width>0?r.width:M3,d=r.height&&r.height>0?r.height:D3;switch(a){case"tank":case"mixing_tank":case"storage_tank":this._drawTank(c,l,d);break;case"pump":case"pump_centrifugal":this._drawPump(c,l,d);break;case"filter":case"separator":this._drawFilter(c,l,d);break;case"heat_exchanger":case"condenser":this._drawHeatExchanger(c,l,d);break;case"reactor":this._drawRectWithDoubleLine(c,l,d);break;case"valve_control":case"valve_gate":case"valve_globe":case"valve_ball":case"valve_butterfly":case"valve_check":case"valve_pressure_relief":case"valve_solenoid":case"valve_diaphragm":case"valve_manual":this._drawValve(c,l,d,a);break;case"transmitter_temp":case"transmitter_pressure":case"transmitter_flow":case"transmitter_level":case"transmitter_analyzer":case"indicator_temp":case"indicator_pressure":case"indicator_flow":case"indicator_level":case"flow_meter":case"pressure_gauge":this._drawInstrument(c,l,d,a);break;case"controller_pid":case"controller_plc":case"controller_dcs":case"controller_local":case"controller_remote":case"controller_manual":this._drawController(c,l,d,a);break;case"actuator_electric":case"actuator_pneumatic":case"actuator_hydraulic":case"motor":case"fan":this._drawActuator(c,l,d,a);break;case"junction":case"tee_connection":case"analyzer_chamber":case"relay":case"control_panel":case"display":case"instrument_bubble":this._drawSmallSymbol(c,l,d,a);break;default:if(this.isPidMode)this._drawRoundedRect(c,l,d,{fill:"#e8f4f8",stroke:"#333",rx:8});else return this.bpmnRenderer.drawShape(n,r)}if(i&&i.name){const u=ie("text");Y(u,{x:l/2,y:d+14,"text-anchor":"middle","font-family":"Arial, Helvetica, sans-serif","font-size":"12px",fill:"#222","font-weight":"normal"}),u.textContent=i.name,ae(c,u)}return c}drawConnection(n,r){const i=r.businessObject,s=(i==null?void 0:i.$attrs)&&i.$attrs["pid:category"]||"process",a=(i==null?void 0:i.$attrs)&&i.$attrs["pid:style"]||"",c=s==="signal"?"#999":s==="electrical"?"#666":"#000",l=a==="dashed"||s==="signal"?"4 3":s==="electrical"?"2 2":null;this._ensureDefs(n);const d=ie("path");if(r.waypoints&&r.waypoints.length>0){const u=r.waypoints.map((h,p)=>p===0?`M ${h.x} ${h.y}`:`L ${h.x} ${h.y}`).join(" ");Y(d,{d:u})}else Y(d,{d:"M0 0 L10 10"});return Y(d,{stroke:c,"stroke-width":1.5,fill:"none"}),l&&Y(d,{"stroke-dasharray":l}),s==="process"?Y(d,{"marker-end":"url(#pid-arrow)"}):Y(d,{"marker-end":"url(#pid-arrow-small)"}),ae(n,d),d}_drawRoundedRect(n,r,i,s={}){const a=ie("rect");return Y(a,{x:0,y:0,width:r,height:i,rx:s.rx||10,ry:s.rx||10,fill:s.fill||"#b3d9ff",stroke:s.stroke||"#333","stroke-width":s.strokeWidth||2}),ae(n,a),a}_drawRectWithDoubleLine(n,r,i){this._drawRoundedRect(n,r,i,{fill:"#fff",stroke:"#333",rx:4,strokeWidth:2});const s=ie("rect");Y(s,{x:6,y:6,width:r-12,height:i-12,rx:3,stroke:"#333","stroke-width":1,fill:"none"}),ae(n,s)}_drawPump(n,r,i){const s=Math.min(r,i)*.35,a=s+8,c=i/2,l=ie("circle");Y(l,{cx:a,cy:c,r:s,stroke:"#333","stroke-width":2,fill:"#e6f2ff"}),ae(n,l);const d=ie("polygon"),u=a+s*.2,h=c-8,p=c+8;Y(d,{points:`${u},${c} ${u+22},${h} ${u+22},${p}`,fill:"#333"}),ae(n,d)}_drawTank(n,r,i){const s=r*.15,a=i*.15,c=ie("rect");Y(c,{x:s,y:a,width:r-2*s,height:i-2*a,fill:"#b3d9ff",stroke:"#333","stroke-width":2}),ae(n,c);const l=ie("ellipse");Y(l,{cx:r/2,cy:a,rx:s,ry:a,fill:"#b3d9ff",stroke:"#333","stroke-width":2}),ae(n,l);const d=ie("ellipse");Y(d,{cx:r/2,cy:i-a,rx:s,ry:a*.7,fill:"#b3d9ff",stroke:"#333","stroke-width":2}),ae(n,d);const u=ie("line");Y(u,{x1:s+5,y1:i*.6,x2:r-s-5,y2:i*.6,stroke:"#666","stroke-width":1,"stroke-dasharray":"3 3"}),ae(n,u)}_drawFilter(n,r,i){const s=ie("rect");Y(s,{x:0,y:0,width:r,height:i,rx:6,fill:"#eaf7ea",stroke:"#333","stroke-width":2}),ae(n,s);const a=5,c=r/(a+1);for(let l=1;l<=a;l++){const d=c*l,u=ie("line");Y(u,{x1:d-8,y1:8,x2:d+8,y2:i-8,stroke:"#333","stroke-width":1.5}),ae(n,u)}}_drawHeatExchanger(n,r,i){const s=Math.min(r,i)*.22,a=s+8,c=r-s-8,l=i/2,d=ie("circle");Y(d,{cx:a,cy:l,r:s,stroke:"#333","stroke-width":1.5,fill:"#fff"}),ae(n,d);const u=ie("circle");Y(u,{cx:c,cy:l,r:s,stroke:"#333","stroke-width":1.5,fill:"#fff"}),ae(n,u);const h=ie("line");Y(h,{x1:a+s,y1:l,x2:c-s,y2:l,stroke:"#333","stroke-width":1.2}),ae(n,h)}_drawValve(n,r,i,s){const a=Math.min(r,i)*.6,c=r/2,l=i/2,d=a/2,u=`${c},${l-d} ${c+d},${l} ${c},${l+d} ${c-d},${l}`,h=ie("polygon");if(Y(h,{points:u,stroke:"#000","stroke-width":2,fill:"none"}),ae(n,h),s==="valve_control"){const p=ie("line");Y(p,{x1:c-d*.6,y1:l-d*.6,x2:c+d*.6,y2:l+d*.6,stroke:"#000","stroke-width":2}),ae(n,p);const f=ie("line");Y(f,{x1:c+d*.6,y1:l-d*.6,x2:c-d*.6,y2:l+d*.6,stroke:"#000","stroke-width":2}),ae(n,f)}else if(s==="valve_check"){const p=ie("path");Y(p,{d:`M ${c-d*.4} ${l} q ${d*.4} ${-d*.4} ${d*.8} 0`,stroke:"#000","stroke-width":1.8,fill:"none"}),ae(n,p)}else if(s==="valve_gate"){const p=ie("line");Y(p,{x1:c,y1:l-d,x2:c,y2:l+d,stroke:"#000","stroke-width":1.6}),ae(n,p)}else{const p=ie("circle");Y(p,{cx:c,cy:l,r:Math.max(3,d*.25),fill:"#000"}),ae(n,p)}}_drawInstrument(n,r,i,s){const a=Math.min(20,Math.min(r,i)*.25),c=a+4,l=i/2,d=ie("circle");if(Y(d,{cx:c,cy:l,r:a,stroke:"#333","stroke-width":1.2,fill:"#fff"}),ae(n,d),s==="transmitter_analyzer"){const u=ie("rect");Y(u,{x:c-a/2,y:l-a/2,width:a,height:a,rx:2,stroke:"#333","stroke-width":1,fill:"#fff"}),ae(n,u)}else if(s==="flow_meter"){const u=ie("line");Y(u,{x1:c-a+2,y1:l,x2:c+a-2,y2:l,stroke:"#333","stroke-width":1.2}),ae(n,u)}else if(s==="pressure_gauge"){const u=ie("line");Y(u,{x1:c,y1:l,x2:c+a*.6,y2:l-a*.4,stroke:"#333","stroke-width":1.2}),ae(n,u)}}_drawController(n,r,i,s){const a=ie("rect");Y(a,{x:0,y:0,width:r,height:i,rx:8,stroke:"#333","stroke-width":1.6,fill:"#f9f9f9"}),ae(n,a);const c=r/2-18,l=i/2;for(let d=0;d<3;d++){const u=ie("line");Y(u,{x1:c+d*12,y1:l-8,x2:c+d*12,y2:l+8,stroke:"#333","stroke-width":1}),ae(n,u)}}_drawActuator(n,r,i,s){if(s==="motor"){const a=r/2,c=i/2,l=Math.min(r,i)*.28,d=ie("circle");Y(d,{cx:a,cy:c,r:l,stroke:"#333","stroke-width":1.6,fill:"#fff"}),ae(n,d);const u=ie("text");Y(u,{x:a,y:c+5,"text-anchor":"middle","font-size":"12px",fill:"#333"}),u.textContent="M",ae(n,u)}else s==="actuator_pneumatic"?this._drawRoundedRect(n,r*.8,i*.5,{fill:"#fff",stroke:"#333",rx:6}):this._drawSmallSymbol(n,r,i,s)}_drawSmallSymbol(n,r,i,s){const a=r/2,c=i/2;if(s==="junction"||s==="tee_connection"){const l=ie("circle");Y(l,{cx:a,cy:c,r:4,fill:"#333"}),ae(n,l)}else if(s==="analyzer_chamber"){const l=ie("rect");Y(l,{x:a-12,y:c-10,width:24,height:20,rx:4,stroke:"#333",fill:"#fff"}),ae(n,l)}else{const l=ie("circle");Y(l,{cx:a,cy:c,r:8,stroke:"#333",fill:"#fff"}),ae(n,l)}}_ensureDefs(n){let r=n;for(;r&&r.nodeName&&r.nodeName.toLowerCase()!=="svg";)r=r.parentNode;if(!r||this._createDefs)return;const i=ie("defs"),s=ie("marker");Y(s,{id:"pid-arrow",markerWidth:10,markerHeight:10,refX:8,refY:3.5,orient:"auto",markerUnits:"strokeWidth"});const a=ie("path");Y(a,{d:"M0,0 L8,3.5 L0,7 Z",fill:"#000"}),ae(s,a),ae(i,s);const c=ie("marker");Y(c,{id:"pid-arrow-small",markerWidth:8,markerHeight:8,refX:6,refY:3,orient:"auto",markerUnits:"strokeWidth"});const l=ie("path");Y(l,{d:"M0,0 L6,3 L0,6 Z",fill:"#666"}),ae(c,l),ae(i,c),ae(r,i),this._createDefs=!0}}const $3={__init__:["pidRenderer"],pidRenderer:["type",["eventBus","bpmnRenderer",O3]]},cs=Dk,ls=Ok,L3=y.forwardRef(({className:t,inset:e,children:n,...r},i)=>o.jsxs(hw,{ref:i,className:J("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",e&&"pl-8",t),...r,children:[n,o.jsx(Yo,{className:"ml-auto h-4 w-4"})]}));L3.displayName=hw.displayName;const B3=y.forwardRef(({className:t,...e},n)=>o.jsx(pw,{ref:n,className:J("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));B3.displayName=pw.displayName;const bi=y.forwardRef(({className:t,sideOffset:e=4,...n},r)=>o.jsx(Mk,{children:o.jsx(fw,{ref:r,sideOffset:e,className:J("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));bi.displayName=fw.displayName;const pt=y.forwardRef(({className:t,inset:e,...n},r)=>o.jsx(mw,{ref:r,className:J("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e&&"pl-8",t),...n}));pt.displayName=mw.displayName;const F3=y.forwardRef(({className:t,children:e,checked:n,...r},i)=>o.jsxs(gw,{ref:i,className:J("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:n,...r,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(vw,{children:o.jsx($n,{className:"h-4 w-4"})})}),e]}));F3.displayName=gw.displayName;const z3=y.forwardRef(({className:t,children:e,...n},r)=>o.jsxs(yw,{ref:r,className:J("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...n,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(vw,{children:o.jsx(QC,{className:"h-2 w-2 fill-current"})})}),e]}));z3.displayName=yw.displayName;const Hl=y.forwardRef(({className:t,inset:e,...n},r)=>o.jsx(xw,{ref:r,className:J("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));Hl.displayName=xw.displayName;const ra=y.forwardRef(({className:t,...e},n)=>o.jsx(bw,{ref:n,className:J("-mx-1 my-1 h-px bg-muted",t),...e}));ra.displayName=bw.displayName;const hn=lf,U3=cf,aS=y.forwardRef(({className:t,...e},n)=>o.jsx(uc,{ref:n,className:J("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));aS.displayName=uc.displayName;const en=y.forwardRef(({className:t,children:e,...n},r)=>o.jsxs(U3,{children:[o.jsx(aS,{}),o.jsxs(hc,{ref:r,className:J("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,o.jsxs(bd,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[o.jsx(wr,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));en.displayName=hc.displayName;const tn=({className:t,...e})=>o.jsx("div",{className:J("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});tn.displayName="DialogHeader";const nn=y.forwardRef(({className:t,...e},n)=>o.jsx(pc,{ref:n,className:J("text-lg font-semibold leading-none tracking-tight",t),...e}));nn.displayName=pc.displayName;const rn=y.forwardRef(({className:t,...e},n)=>o.jsx(fc,{ref:n,className:J("text-sm text-muted-foreground",t),...e}));rn.displayName=fc.displayName;const Kt=y.forwardRef(({className:t,type:e,...n},r)=>o.jsx("input",{type:e,className:J("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground transition-all duration-200 ease-in-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:border-ring focus-visible:shadow-[0_0_0_1px_hsl(var(--ring)),0_0_8px_hsl(var(--ring)/0.3)] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));Kt.displayName="Input";var H3="Label",oS=y.forwardRef((t,e)=>o.jsx(Pe.label,{...t,ref:e,onMouseDown:n=>{var i;n.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));oS.displayName=H3;var cS=oS;const V3=Ba("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),sn=y.forwardRef(({className:t,...e},n)=>o.jsx(cS,{ref:n,className:J(V3(),t),...e}));sn.displayName=cS.displayName;var ku="Collapsible",[G3,lS]=Vn(ku),[W3,fg]=G3(ku),dS=y.forwardRef((t,e)=>{const{__scopeCollapsible:n,open:r,defaultOpen:i,disabled:s,onOpenChange:a,...c}=t,[l,d]=dr({prop:r,defaultProp:i??!1,onChange:a,caller:ku});return o.jsx(W3,{scope:n,disabled:s,contentId:La(),open:l,onOpenToggle:y.useCallback(()=>d(u=>!u),[d]),children:o.jsx(Pe.div,{"data-state":gg(l),"data-disabled":s?"":void 0,...c,ref:e})})});dS.displayName=ku;var uS="CollapsibleTrigger",hS=y.forwardRef((t,e)=>{const{__scopeCollapsible:n,...r}=t,i=fg(uS,n);return o.jsx(Pe.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":gg(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...r,ref:e,onClick:Ee(t.onClick,i.onOpenToggle)})});hS.displayName=uS;var mg="CollapsibleContent",pS=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,i=fg(mg,t.__scopeCollapsible);return o.jsx(Oi,{present:n||i.open,children:({present:s})=>o.jsx(q3,{...r,ref:e,present:s})})});pS.displayName=mg;var q3=y.forwardRef((t,e)=>{const{__scopeCollapsible:n,present:r,children:i,...s}=t,a=fg(mg,n),[c,l]=y.useState(r),d=y.useRef(null),u=gt(e,d),h=y.useRef(0),p=h.current,f=y.useRef(0),m=f.current,v=a.open||c,g=y.useRef(v),w=y.useRef(void 0);return y.useEffect(()=>{const b=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(b)},[]),jn(()=>{const b=d.current;if(b){w.current=w.current||{transitionDuration:b.style.transitionDuration,animationName:b.style.animationName},b.style.transitionDuration="0s",b.style.animationName="none";const x=b.getBoundingClientRect();h.current=x.height,f.current=x.width,g.current||(b.style.transitionDuration=w.current.transitionDuration,b.style.animationName=w.current.animationName),l(r)}},[a.open,r]),o.jsx(Pe.div,{"data-state":gg(a.open),"data-disabled":a.disabled?"":void 0,id:a.contentId,hidden:!v,...s,ref:u,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":m?`${m}px`:void 0,...t.style},children:v&&i})});function gg(t){return t?"open":"closed"}var K3=dS,Y3=hS,Z3=pS,pr="Accordion",X3=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[vg,J3,Q3]=of(pr),[Cu,fz]=Vn(pr,[Q3,lS]),yg=lS(),fS=W.forwardRef((t,e)=>{const{type:n,...r}=t,i=r,s=r;return o.jsx(vg.Provider,{scope:t.__scopeAccordion,children:n==="multiple"?o.jsx(rB,{...s,ref:e}):o.jsx(nB,{...i,ref:e})})});fS.displayName=pr;var[mS,eB]=Cu(pr),[gS,tB]=Cu(pr,{collapsible:!1}),nB=W.forwardRef((t,e)=>{const{value:n,defaultValue:r,onValueChange:i=()=>{},collapsible:s=!1,...a}=t,[c,l]=dr({prop:n,defaultProp:r??"",onChange:i,caller:pr});return o.jsx(mS,{scope:t.__scopeAccordion,value:W.useMemo(()=>c?[c]:[],[c]),onItemOpen:l,onItemClose:W.useCallback(()=>s&&l(""),[s,l]),children:o.jsx(gS,{scope:t.__scopeAccordion,collapsible:s,children:o.jsx(vS,{...a,ref:e})})})}),rB=W.forwardRef((t,e)=>{const{value:n,defaultValue:r,onValueChange:i=()=>{},...s}=t,[a,c]=dr({prop:n,defaultProp:r??[],onChange:i,caller:pr}),l=W.useCallback(u=>c((h=[])=>[...h,u]),[c]),d=W.useCallback(u=>c((h=[])=>h.filter(p=>p!==u)),[c]);return o.jsx(mS,{scope:t.__scopeAccordion,value:a,onItemOpen:l,onItemClose:d,children:o.jsx(gS,{scope:t.__scopeAccordion,collapsible:!0,children:o.jsx(vS,{...s,ref:e})})})}),[iB,Pu]=Cu(pr),vS=W.forwardRef((t,e)=>{const{__scopeAccordion:n,disabled:r,dir:i,orientation:s="vertical",...a}=t,c=W.useRef(null),l=gt(c,e),d=J3(n),h=mc(i)==="ltr",p=Ee(t.onKeyDown,f=>{var R;if(!X3.includes(f.key))return;const m=f.target,v=d().filter(T=>{var $;return!(($=T.ref.current)!=null&&$.disabled)}),g=v.findIndex(T=>T.ref.current===m),w=v.length;if(g===-1)return;f.preventDefault();let b=g;const x=0,E=w-1,N=()=>{b=g+1,b>E&&(b=x)},j=()=>{b=g-1,b<x&&(b=E)};switch(f.key){case"Home":b=x;break;case"End":b=E;break;case"ArrowRight":s==="horizontal"&&(h?N():j());break;case"ArrowDown":s==="vertical"&&N();break;case"ArrowLeft":s==="horizontal"&&(h?j():N());break;case"ArrowUp":s==="vertical"&&j();break}const C=b%w;(R=v[C].ref.current)==null||R.focus()});return o.jsx(iB,{scope:n,disabled:r,direction:i,orientation:s,children:o.jsx(vg.Slot,{scope:n,children:o.jsx(Pe.div,{...a,"data-orientation":s,ref:l,onKeyDown:r?void 0:p})})})}),ad="AccordionItem",[sB,xg]=Cu(ad),yS=W.forwardRef((t,e)=>{const{__scopeAccordion:n,value:r,...i}=t,s=Pu(ad,n),a=eB(ad,n),c=yg(n),l=La(),d=r&&a.value.includes(r)||!1,u=s.disabled||t.disabled;return o.jsx(sB,{scope:n,open:d,disabled:u,triggerId:l,children:o.jsx(K3,{"data-orientation":s.orientation,"data-state":SS(d),...c,...i,ref:e,disabled:u,open:d,onOpenChange:h=>{h?a.onItemOpen(r):a.onItemClose(r)}})})});yS.displayName=ad;var xS="AccordionHeader",bS=W.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,i=Pu(pr,n),s=xg(xS,n);return o.jsx(Pe.h3,{"data-orientation":i.orientation,"data-state":SS(s.open),"data-disabled":s.disabled?"":void 0,...r,ref:e})});bS.displayName=xS;var zp="AccordionTrigger",wS=W.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,i=Pu(pr,n),s=xg(zp,n),a=tB(zp,n),c=yg(n);return o.jsx(vg.ItemSlot,{scope:n,children:o.jsx(Y3,{"aria-disabled":s.open&&!a.collapsible||void 0,"data-orientation":i.orientation,id:s.triggerId,...c,...r,ref:e})})});wS.displayName=zp;var _S="AccordionContent",ES=W.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,i=Pu(pr,n),s=xg(_S,n),a=yg(n);return o.jsx(Z3,{role:"region","aria-labelledby":s.triggerId,"data-orientation":i.orientation,...a,...r,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});ES.displayName=_S;function SS(t){return t?"open":"closed"}var aB=fS,oB=yS,cB=bS,jS=wS,NS=ES;const _b=aB,Co=y.forwardRef(({className:t,...e},n)=>o.jsx(oB,{ref:n,className:J("border-b",t),...e}));Co.displayName="AccordionItem";const Po=y.forwardRef(({className:t,children:e,...n},r)=>o.jsx(cB,{className:"flex",children:o.jsxs(jS,{ref:r,className:J("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...n,children:[e,o.jsx(Sf,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Po.displayName=jS.displayName;const To=y.forwardRef(({className:t,children:e,...n},r)=>o.jsx(NS,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:o.jsx("div",{className:J("pb-4 pt-0",t),children:e})}));To.displayName=NS.displayName;const kS=y.forwardRef(({...t},e)=>o.jsx("nav",{ref:e,"aria-label":"breadcrumb",...t}));kS.displayName="Breadcrumb";const CS=y.forwardRef(({className:t,...e},n)=>o.jsx("ol",{ref:n,className:J("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",t),...e}));CS.displayName="BreadcrumbList";const Vl=y.forwardRef(({className:t,...e},n)=>o.jsx("li",{ref:n,className:J("inline-flex items-center gap-1.5",t),...e}));Vl.displayName="BreadcrumbItem";const Up=y.forwardRef(({asChild:t,className:e,...n},r)=>{const i=t?dw:"a";return o.jsx(i,{ref:r,className:J("transition-colors hover:text-foreground",e),...n})});Up.displayName="BreadcrumbLink";const PS=y.forwardRef(({className:t,...e},n)=>o.jsx("span",{ref:n,role:"link","aria-disabled":"true","aria-current":"page",className:J("font-normal text-foreground",t),...e}));PS.displayName="BreadcrumbPage";const Hp=({children:t,className:e,...n})=>o.jsx("li",{role:"presentation","aria-hidden":"true",className:J("[&>svg]:size-3.5",e),...n,children:t??o.jsx(Yo,{})});Hp.displayName="BreadcrumbSeparator";function TS(t){const e=y.useRef({value:t,previous:t});return y.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var Tu="Switch",[lB,mz]=Vn(Tu),[dB,uB]=lB(Tu),RS=y.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:i,defaultChecked:s,required:a,disabled:c,value:l="on",onCheckedChange:d,form:u,...h}=t,[p,f]=y.useState(null),m=gt(e,x=>f(x)),v=y.useRef(!1),g=p?u||!!p.closest("form"):!0,[w,b]=dr({prop:i,defaultProp:s??!1,onChange:d,caller:Tu});return o.jsxs(dB,{scope:n,checked:w,disabled:c,children:[o.jsx(Pe.button,{type:"button",role:"switch","aria-checked":w,"aria-required":a,"data-state":DS(w),"data-disabled":c?"":void 0,disabled:c,value:l,...h,ref:m,onClick:Ee(t.onClick,x=>{b(E=>!E),g&&(v.current=x.isPropagationStopped(),v.current||x.stopPropagation())})}),g&&o.jsx(MS,{control:p,bubbles:!v.current,name:r,value:l,checked:w,required:a,disabled:c,form:u,style:{transform:"translateX(-100%)"}})]})});RS.displayName=Tu;var AS="SwitchThumb",IS=y.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,i=uB(AS,n);return o.jsx(Pe.span,{"data-state":DS(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:e})});IS.displayName=AS;var hB="SwitchBubbleInput",MS=y.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:r=!0,...i},s)=>{const a=y.useRef(null),c=gt(a,s),l=TS(n),d=$k(e);return y.useEffect(()=>{const u=a.current;if(!u)return;const h=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==n&&f){const m=new Event("click",{bubbles:r});f.call(u,n),u.dispatchEvent(m)}},[l,n,r]),o.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...i,tabIndex:-1,ref:c,style:{...i.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});MS.displayName=hB;function DS(t){return t?"checked":"unchecked"}var OS=RS,pB=IS;const Vp=y.forwardRef(({className:t,...e},n)=>o.jsx(OS,{className:J("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",t),...e,ref:n,children:o.jsx(pB,{className:J("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Vp.displayName=OS.displayName;const fB=Ba("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function gr({className:t,variant:e,...n}){return o.jsx("div",{className:J(fB({variant:e}),t),...n})}function Gp(t,[e,n]){return Math.min(n,Math.max(e,t))}function mB(t,e){return y.useReducer((n,r)=>e[n][r]??n,t)}var bg="ScrollArea",[$S,gz]=Vn(bg),[gB,Xn]=$S(bg),LS=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:i,scrollHideDelay:s=600,...a}=t,[c,l]=y.useState(null),[d,u]=y.useState(null),[h,p]=y.useState(null),[f,m]=y.useState(null),[v,g]=y.useState(null),[w,b]=y.useState(0),[x,E]=y.useState(0),[N,j]=y.useState(!1),[C,R]=y.useState(!1),T=gt(e,B=>l(B)),$=mc(i);return o.jsx(gB,{scope:n,type:r,dir:$,scrollHideDelay:s,scrollArea:c,viewport:d,onViewportChange:u,content:h,onContentChange:p,scrollbarX:f,onScrollbarXChange:m,scrollbarXEnabled:N,onScrollbarXEnabledChange:j,scrollbarY:v,onScrollbarYChange:g,scrollbarYEnabled:C,onScrollbarYEnabledChange:R,onCornerWidthChange:b,onCornerHeightChange:E,children:o.jsx(Pe.div,{dir:$,...a,ref:T,style:{position:"relative","--radix-scroll-area-corner-width":w+"px","--radix-scroll-area-corner-height":x+"px",...t.style}})})});LS.displayName=bg;var BS="ScrollAreaViewport",FS=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,nonce:i,...s}=t,a=Xn(BS,n),c=y.useRef(null),l=gt(e,c,a.onViewportChange);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),o.jsx(Pe.div,{"data-radix-scroll-area-viewport":"",...s,ref:l,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...t.style},children:o.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});FS.displayName=BS;var Tr="ScrollAreaScrollbar",wg=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,i=Xn(Tr,t.__scopeScrollArea),{onScrollbarXEnabledChange:s,onScrollbarYEnabledChange:a}=i,c=t.orientation==="horizontal";return y.useEffect(()=>(c?s(!0):a(!0),()=>{c?s(!1):a(!1)}),[c,s,a]),i.type==="hover"?o.jsx(vB,{...r,ref:e,forceMount:n}):i.type==="scroll"?o.jsx(yB,{...r,ref:e,forceMount:n}):i.type==="auto"?o.jsx(zS,{...r,ref:e,forceMount:n}):i.type==="always"?o.jsx(_g,{...r,ref:e}):null});wg.displayName=Tr;var vB=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,i=Xn(Tr,t.__scopeScrollArea),[s,a]=y.useState(!1);return y.useEffect(()=>{const c=i.scrollArea;let l=0;if(c){const d=()=>{window.clearTimeout(l),a(!0)},u=()=>{l=window.setTimeout(()=>a(!1),i.scrollHideDelay)};return c.addEventListener("pointerenter",d),c.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),c.removeEventListener("pointerenter",d),c.removeEventListener("pointerleave",u)}}},[i.scrollArea,i.scrollHideDelay]),o.jsx(Oi,{present:n||s,children:o.jsx(zS,{"data-state":s?"visible":"hidden",...r,ref:e})})}),yB=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,i=Xn(Tr,t.__scopeScrollArea),s=t.orientation==="horizontal",a=Au(()=>l("SCROLL_END"),100),[c,l]=mB("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return y.useEffect(()=>{if(c==="idle"){const d=window.setTimeout(()=>l("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(d)}},[c,i.scrollHideDelay,l]),y.useEffect(()=>{const d=i.viewport,u=s?"scrollLeft":"scrollTop";if(d){let h=d[u];const p=()=>{const f=d[u];h!==f&&(l("SCROLL"),a()),h=f};return d.addEventListener("scroll",p),()=>d.removeEventListener("scroll",p)}},[i.viewport,s,l,a]),o.jsx(Oi,{present:n||c!=="hidden",children:o.jsx(_g,{"data-state":c==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:Ee(t.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Ee(t.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),zS=y.forwardRef((t,e)=>{const n=Xn(Tr,t.__scopeScrollArea),{forceMount:r,...i}=t,[s,a]=y.useState(!1),c=t.orientation==="horizontal",l=Au(()=>{if(n.viewport){const d=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;a(c?d:u)}},10);return Aa(n.viewport,l),Aa(n.content,l),o.jsx(Oi,{present:r||s,children:o.jsx(_g,{"data-state":s?"visible":"hidden",...i,ref:e})})}),_g=y.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,i=Xn(Tr,t.__scopeScrollArea),s=y.useRef(null),a=y.useRef(0),[c,l]=y.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=WS(c.viewport,c.content),u={...r,sizes:c,onSizesChange:l,hasThumb:d>0&&d<1,onThumbChange:p=>s.current=p,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:p=>a.current=p};function h(p,f){return SB(p,a.current,c,f)}return n==="horizontal"?o.jsx(xB,{...u,ref:e,onThumbPositionChange:()=>{if(i.viewport&&s.current){const p=i.viewport.scrollLeft,f=Eb(p,c,i.dir);s.current.style.transform=`translate3d(${f}px, 0, 0)`}},onWheelScroll:p=>{i.viewport&&(i.viewport.scrollLeft=p)},onDragScroll:p=>{i.viewport&&(i.viewport.scrollLeft=h(p,i.dir))}}):n==="vertical"?o.jsx(bB,{...u,ref:e,onThumbPositionChange:()=>{if(i.viewport&&s.current){const p=i.viewport.scrollTop,f=Eb(p,c);s.current.style.transform=`translate3d(0, ${f}px, 0)`}},onWheelScroll:p=>{i.viewport&&(i.viewport.scrollTop=p)},onDragScroll:p=>{i.viewport&&(i.viewport.scrollTop=h(p))}}):null}),xB=y.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...i}=t,s=Xn(Tr,t.__scopeScrollArea),[a,c]=y.useState(),l=y.useRef(null),d=gt(e,l,s.onScrollbarXChange);return y.useEffect(()=>{l.current&&c(getComputedStyle(l.current))},[l]),o.jsx(HS,{"data-orientation":"horizontal",...i,ref:d,sizes:n,style:{bottom:0,left:s.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:s.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Ru(n)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.x),onDragScroll:u=>t.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(s.viewport){const p=s.viewport.scrollLeft+u.deltaX;t.onWheelScroll(p),KS(p,h)&&u.preventDefault()}},onResize:()=>{l.current&&s.viewport&&a&&r({content:s.viewport.scrollWidth,viewport:s.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:cd(a.paddingLeft),paddingEnd:cd(a.paddingRight)}})}})}),bB=y.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...i}=t,s=Xn(Tr,t.__scopeScrollArea),[a,c]=y.useState(),l=y.useRef(null),d=gt(e,l,s.onScrollbarYChange);return y.useEffect(()=>{l.current&&c(getComputedStyle(l.current))},[l]),o.jsx(HS,{"data-orientation":"vertical",...i,ref:d,sizes:n,style:{top:0,right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Ru(n)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.y),onDragScroll:u=>t.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(s.viewport){const p=s.viewport.scrollTop+u.deltaY;t.onWheelScroll(p),KS(p,h)&&u.preventDefault()}},onResize:()=>{l.current&&s.viewport&&a&&r({content:s.viewport.scrollHeight,viewport:s.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:cd(a.paddingTop),paddingEnd:cd(a.paddingBottom)}})}})}),[wB,US]=$S(Tr),HS=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:i,onThumbChange:s,onThumbPointerUp:a,onThumbPointerDown:c,onThumbPositionChange:l,onDragScroll:d,onWheelScroll:u,onResize:h,...p}=t,f=Xn(Tr,n),[m,v]=y.useState(null),g=gt(e,T=>v(T)),w=y.useRef(null),b=y.useRef(""),x=f.viewport,E=r.content-r.viewport,N=Tn(u),j=Tn(l),C=Au(h,10);function R(T){if(w.current){const $=T.clientX-w.current.left,B=T.clientY-w.current.top;d({x:$,y:B})}}return y.useEffect(()=>{const T=$=>{const B=$.target;(m==null?void 0:m.contains(B))&&N($,E)};return document.addEventListener("wheel",T,{passive:!1}),()=>document.removeEventListener("wheel",T,{passive:!1})},[x,m,E,N]),y.useEffect(j,[r,j]),Aa(m,C),Aa(f.content,C),o.jsx(wB,{scope:n,scrollbar:m,hasThumb:i,onThumbChange:Tn(s),onThumbPointerUp:Tn(a),onThumbPositionChange:j,onThumbPointerDown:Tn(c),children:o.jsx(Pe.div,{...p,ref:g,style:{position:"absolute",...p.style},onPointerDown:Ee(t.onPointerDown,T=>{T.button===0&&(T.target.setPointerCapture(T.pointerId),w.current=m.getBoundingClientRect(),b.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",f.viewport&&(f.viewport.style.scrollBehavior="auto"),R(T))}),onPointerMove:Ee(t.onPointerMove,R),onPointerUp:Ee(t.onPointerUp,T=>{const $=T.target;$.hasPointerCapture(T.pointerId)&&$.releasePointerCapture(T.pointerId),document.body.style.webkitUserSelect=b.current,f.viewport&&(f.viewport.style.scrollBehavior=""),w.current=null})})})}),od="ScrollAreaThumb",VS=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,i=US(od,t.__scopeScrollArea);return o.jsx(Oi,{present:n||i.hasThumb,children:o.jsx(_B,{ref:e,...r})})}),_B=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...i}=t,s=Xn(od,n),a=US(od,n),{onThumbPositionChange:c}=a,l=gt(e,h=>a.onThumbChange(h)),d=y.useRef(void 0),u=Au(()=>{d.current&&(d.current(),d.current=void 0)},100);return y.useEffect(()=>{const h=s.viewport;if(h){const p=()=>{if(u(),!d.current){const f=jB(h,c);d.current=f,c()}};return c(),h.addEventListener("scroll",p),()=>h.removeEventListener("scroll",p)}},[s.viewport,u,c]),o.jsx(Pe.div,{"data-state":a.hasThumb?"visible":"hidden",...i,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Ee(t.onPointerDownCapture,h=>{const f=h.target.getBoundingClientRect(),m=h.clientX-f.left,v=h.clientY-f.top;a.onThumbPointerDown({x:m,y:v})}),onPointerUp:Ee(t.onPointerUp,a.onThumbPointerUp)})});VS.displayName=od;var Eg="ScrollAreaCorner",GS=y.forwardRef((t,e)=>{const n=Xn(Eg,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?o.jsx(EB,{...t,ref:e}):null});GS.displayName=Eg;var EB=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,i=Xn(Eg,n),[s,a]=y.useState(0),[c,l]=y.useState(0),d=!!(s&&c);return Aa(i.scrollbarX,()=>{var h;const u=((h=i.scrollbarX)==null?void 0:h.offsetHeight)||0;i.onCornerHeightChange(u),l(u)}),Aa(i.scrollbarY,()=>{var h;const u=((h=i.scrollbarY)==null?void 0:h.offsetWidth)||0;i.onCornerWidthChange(u),a(u)}),d?o.jsx(Pe.div,{...r,ref:e,style:{width:s,height:c,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function cd(t){return t?parseInt(t,10):0}function WS(t,e){const n=t/e;return isNaN(n)?0:n}function Ru(t){const e=WS(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function SB(t,e,n,r="ltr"){const i=Ru(n),s=i/2,a=e||s,c=i-a,l=n.scrollbar.paddingStart+a,d=n.scrollbar.size-n.scrollbar.paddingEnd-c,u=n.content-n.viewport,h=r==="ltr"?[0,u]:[u*-1,0];return qS([l,d],h)(t)}function Eb(t,e,n="ltr"){const r=Ru(e),i=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=e.scrollbar.size-i,a=e.content-e.viewport,c=s-r,l=n==="ltr"?[0,a]:[a*-1,0],d=Gp(t,l);return qS([0,a],[0,c])(d)}function qS(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function KS(t,e){return t>0&&t<e}var jB=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function i(){const s={left:t.scrollLeft,top:t.scrollTop},a=n.left!==s.left,c=n.top!==s.top;(a||c)&&e(),n=s,r=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(r)};function Au(t,e){const n=Tn(t),r=y.useRef(0);return y.useEffect(()=>()=>window.clearTimeout(r.current),[]),y.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function Aa(t,e){const n=Tn(e);jn(()=>{let r=0;if(t){const i=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return i.observe(t),()=>{window.cancelAnimationFrame(r),i.unobserve(t)}}},[t,n])}var YS=LS,NB=FS,kB=GS;const Fr=y.forwardRef(({className:t,children:e,...n},r)=>o.jsxs(YS,{ref:r,className:J("relative overflow-hidden",t),...n,children:[o.jsx(NB,{className:"h-full w-full rounded-[inherit]",children:e}),o.jsx(ZS,{}),o.jsx(kB,{})]}));Fr.displayName=YS.displayName;const ZS=y.forwardRef(({className:t,orientation:e="vertical",...n},r)=>o.jsx(wg,{ref:r,orientation:e,className:J("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:o.jsx(VS,{className:"relative flex-1 rounded-full bg-border"})}));ZS.displayName=wg.displayName;var XS="AlertDialog",[CB,vz]=Vn(XS,[ww]),ri=ww(),JS=t=>{const{__scopeAlertDialog:e,...n}=t,r=ri(e);return o.jsx(lf,{...r,...n,modal:!0})};JS.displayName=XS;var PB="AlertDialogTrigger",TB=y.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,i=ri(n);return o.jsx(uw,{...i,...r,ref:e})});TB.displayName=PB;var RB="AlertDialogPortal",QS=t=>{const{__scopeAlertDialog:e,...n}=t,r=ri(e);return o.jsx(cf,{...r,...n})};QS.displayName=RB;var AB="AlertDialogOverlay",ej=y.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,i=ri(n);return o.jsx(uc,{...i,...r,ref:e})});ej.displayName=AB;var la="AlertDialogContent",[IB,MB]=CB(la),DB=lw("AlertDialogContent"),tj=y.forwardRef((t,e)=>{const{__scopeAlertDialog:n,children:r,...i}=t,s=ri(n),a=y.useRef(null),c=gt(e,a),l=y.useRef(null);return o.jsx(Lk,{contentName:la,titleName:nj,docsSlug:"alert-dialog",children:o.jsx(IB,{scope:n,cancelRef:l,children:o.jsxs(hc,{role:"alertdialog",...s,...i,ref:c,onOpenAutoFocus:Ee(i.onOpenAutoFocus,d=>{var u;d.preventDefault(),(u=l.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[o.jsx(DB,{children:r}),o.jsx($B,{contentRef:a})]})})})});tj.displayName=la;var nj="AlertDialogTitle",rj=y.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,i=ri(n);return o.jsx(pc,{...i,...r,ref:e})});rj.displayName=nj;var ij="AlertDialogDescription",sj=y.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,i=ri(n);return o.jsx(fc,{...i,...r,ref:e})});sj.displayName=ij;var OB="AlertDialogAction",aj=y.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,i=ri(n);return o.jsx(bd,{...i,...r,ref:e})});aj.displayName=OB;var oj="AlertDialogCancel",cj=y.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,{cancelRef:i}=MB(oj,n),s=ri(n),a=gt(e,i);return o.jsx(bd,{...s,...r,ref:a})});cj.displayName=oj;var $B=({contentRef:t})=>{const e=`\`${la}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${la}\` by passing a \`${ij}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${la}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return y.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(e)},[e,t]),null},LB=JS,BB=QS,lj=ej,dj=tj,uj=aj,hj=cj,pj=rj,fj=sj;const FB=LB,zB=BB,mj=y.forwardRef(({className:t,...e},n)=>o.jsx(lj,{className:J("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));mj.displayName=lj.displayName;const gj=y.forwardRef(({className:t,...e},n)=>o.jsxs(zB,{children:[o.jsx(mj,{}),o.jsx(dj,{ref:n,className:J("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e})]}));gj.displayName=dj.displayName;const vj=({className:t,...e})=>o.jsx("div",{className:J("flex flex-col space-y-2 text-center sm:text-left",t),...e});vj.displayName="AlertDialogHeader";const yj=({className:t,...e})=>o.jsx("div",{className:J("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});yj.displayName="AlertDialogFooter";const xj=y.forwardRef(({className:t,...e},n)=>o.jsx(pj,{ref:n,className:J("text-lg font-semibold",t),...e}));xj.displayName=pj.displayName;const bj=y.forwardRef(({className:t,...e},n)=>o.jsx(fj,{ref:n,className:J("text-sm text-muted-foreground",t),...e}));bj.displayName=fj.displayName;const wj=y.forwardRef(({className:t,...e},n)=>o.jsx(uj,{ref:n,className:J(Of(),t),...e}));wj.displayName=uj.displayName;const _j=y.forwardRef(({className:t,...e},n)=>o.jsx(hj,{ref:n,className:J(Of({variant:"outline"}),"mt-2 sm:mt-0",t),...e}));_j.displayName=hj.displayName;var Ej="Toggle",Sg=y.forwardRef((t,e)=>{const{pressed:n,defaultPressed:r,onPressedChange:i,...s}=t,[a,c]=dr({prop:n,onChange:i,defaultProp:r??!1,caller:Ej});return o.jsx(Pe.button,{type:"button","aria-pressed":a,"data-state":a?"on":"off","data-disabled":t.disabled?"":void 0,...s,ref:e,onClick:Ee(t.onClick,()=>{t.disabled||c(!a)})})});Sg.displayName=Ej;var Sj=Sg,Xi="ToggleGroup",[jj,yz]=Vn(Xi,[wd]),Nj=wd(),jg=W.forwardRef((t,e)=>{const{type:n,...r}=t;if(n==="single"){const i=r;return o.jsx(UB,{...i,ref:e})}if(n==="multiple"){const i=r;return o.jsx(HB,{...i,ref:e})}throw new Error(`Missing prop \`type\` expected on \`${Xi}\``)});jg.displayName=Xi;var[kj,Cj]=jj(Xi),UB=W.forwardRef((t,e)=>{const{value:n,defaultValue:r,onValueChange:i=()=>{},...s}=t,[a,c]=dr({prop:n,defaultProp:r??"",onChange:i,caller:Xi});return o.jsx(kj,{scope:t.__scopeToggleGroup,type:"single",value:W.useMemo(()=>a?[a]:[],[a]),onItemActivate:c,onItemDeactivate:W.useCallback(()=>c(""),[c]),children:o.jsx(Pj,{...s,ref:e})})}),HB=W.forwardRef((t,e)=>{const{value:n,defaultValue:r,onValueChange:i=()=>{},...s}=t,[a,c]=dr({prop:n,defaultProp:r??[],onChange:i,caller:Xi}),l=W.useCallback(u=>c((h=[])=>[...h,u]),[c]),d=W.useCallback(u=>c((h=[])=>h.filter(p=>p!==u)),[c]);return o.jsx(kj,{scope:t.__scopeToggleGroup,type:"multiple",value:a,onItemActivate:l,onItemDeactivate:d,children:o.jsx(Pj,{...s,ref:e})})});jg.displayName=Xi;var[VB,GB]=jj(Xi),Pj=W.forwardRef((t,e)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:i=!0,orientation:s,dir:a,loop:c=!0,...l}=t,d=Nj(n),u=mc(a),h={role:"group",dir:u,...l};return o.jsx(VB,{scope:n,rovingFocus:i,disabled:r,children:i?o.jsx(_w,{asChild:!0,...d,orientation:s,dir:u,loop:c,children:o.jsx(Pe.div,{...h,ref:e})}):o.jsx(Pe.div,{...h,ref:e})})}),ld="ToggleGroupItem",Tj=W.forwardRef((t,e)=>{const n=Cj(ld,t.__scopeToggleGroup),r=GB(ld,t.__scopeToggleGroup),i=Nj(t.__scopeToggleGroup),s=n.value.includes(t.value),a=r.disabled||t.disabled,c={...t,pressed:s,disabled:a},l=W.useRef(null);return r.rovingFocus?o.jsx(Ew,{asChild:!0,...i,focusable:!a,active:s,ref:l,children:o.jsx(Sb,{...c,ref:e})}):o.jsx(Sb,{...c,ref:e})});Tj.displayName=ld;var Sb=W.forwardRef((t,e)=>{const{__scopeToggleGroup:n,value:r,...i}=t,s=Cj(ld,n),a={role:"radio","aria-checked":t.pressed,"aria-pressed":void 0},c=s.type==="single"?a:void 0;return o.jsx(Sg,{...c,...i,ref:e,onPressedChange:l=>{l?s.onItemActivate(r):s.onItemDeactivate(r)}})}),Rj=jg,Aj=Tj;const Ij=Ba("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),WB=y.forwardRef(({className:t,variant:e,size:n,...r},i)=>o.jsx(Sj,{ref:i,className:J(Ij({variant:e,size:n,className:t})),...r}));WB.displayName=Sj.displayName;const Mj=y.createContext({size:"default",variant:"default"}),Dj=y.forwardRef(({className:t,variant:e,size:n,children:r,...i},s)=>o.jsx(Rj,{ref:s,className:J("flex items-center justify-center gap-1",t),...i,children:o.jsx(Mj.Provider,{value:{variant:e,size:n},children:r})}));Dj.displayName=Rj.displayName;const Oj=y.forwardRef(({className:t,children:e,variant:n,size:r,...i},s)=>{const a=y.useContext(Mj);return o.jsx(Aj,{ref:s,className:J(Ij({variant:a.variant||n,size:a.size||r}),t),...i,children:e})});Oj.displayName=Aj.displayName;const qB=t=>{if(!t)return"";const e=[];let n=t;for(;n&&n.nodeType===1;){const r=n.tagName.toLowerCase();let i=1,s=!1;if(n.parentNode){const a=n.parentNode.childNodes;let c=0;for(let l=0;l<a.length;l++){const d=a[l];d.nodeType===1&&d.tagName===n.tagName&&(c+=1,d===n?(i=c,c>1&&(s=!0)):s=!0)}}e.unshift(s?`${r}[${i}]`:r),n=n.parentElement}return`/${e.join("/")}`},jb=(t,e=280)=>{if(!t)return;const n=t.replace(/\s+/g," ").trim();if(n)return n.length>e?`${n.slice(0,e)}...`:n},zh=async t=>{const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(r)).map(s=>s.toString(16).padStart(2,"0")).join("")},KB=(t,e)=>{try{const r=new DOMParser().parseFromString(t,"application/xml");if(r.getElementsByTagName("parsererror").length>0)return e==="pid"?"Instrumentation and equipment interactions.":"Business process from start to finish.";const i=["bpmn:task","bpmn:userTask","bpmn:serviceTask","bpmn:manualTask","bpmn:sendTask","bpmn:receiveTask","bpmn:scriptTask","bpmn:businessRuleTask","bpmn:callActivity","task","userTask","serviceTask","manualTask","sendTask","receiveTask","scriptTask","businessRuleTask","callActivity"],s=[];if(i.forEach(u=>{const h=r.getElementsByTagName(u);for(let p=0;p<h.length;p++){const f=h[p].getAttribute("name");f&&!s.includes(f)&&s.push(f)}}),!s.length)return e==="pid"?"Instrumentation and equipment interactions.":"Business process from start to finish.";const a=20,c=s.length>a?s.slice(0,a):s,l=s.length>a?", and more.":".";return`${e==="pid"?"P&ID workflow covering: ":"Process steps include: "}${c.join(", ")}${l}`}catch(n){return console.error("Failed to extract process summary:",n),e==="pid"?"Instrumentation and equipment interactions.":"Business process from start to finish."}},Nb=[{id:"core-linear",title:"Core Linear Flow",description:"Straight-through execution with only essential activities.",complexity:"basic",instructions:{bpmn:"Generate the most streamlined BPMN possible for the process summary, keeping only critical tasks and a single happy path.",pid:"Focus on the principal equipment path and core instrumentation, omitting secondary loops or optional devices."}},{id:"human-centric",title:"Human-Centric Collaboration",description:"Highlights manual approvals and team handoffs.",complexity:"intermediate",instructions:{bpmn:"Emphasize manual approvals, include at least two swimlanes, and show review loops that require people to coordinate.",pid:"Highlight manual valves, operator checkpoints, and instrumentation that requires human acknowledgement before continuing."}},{id:"automation-lean",title:"Automation Lean",description:"Switches repetitive work to automated service steps.",complexity:"intermediate",instructions:{bpmn:"Transform repetitive or high-volume tasks into service tasks with system integrations and automated escalations.",pid:"Show controllers and transmitters automating monitoring tasks, including signal lines that close the loop automatically."}},{id:"parallel-efficiency",title:"Parallel Efficiency",description:"Optimizes throughput with parallel branches and event handling.",complexity:"advanced",instructions:{bpmn:"Introduce parallel gateways to split workload, use event-based gateways for exceptions, and add a compensation or rollback path.",pid:"Model redundant equipment paths in parallel with automated switchovers and interlock signals connecting the branches."}},{id:"compliance-audit",title:"Compliance & Audit Ready",description:"Adds control checkpoints, logging, and audit artefacts.",complexity:"advanced",instructions:{bpmn:"Layer in compliance checks, logging activities, and escalation paths. Attach data objects for evidence and audit trails.",pid:"Add monitoring instrumentation, safety valves, bypass lines, and annotations for regulatory checkpoints and alarms."}},{id:"experience-journey",title:"Customer Experience Journey",description:"Maps personas, SLAs, and service touchpoints end to end.",complexity:"intermediate",instructions:{bpmn:"Introduce swimlanes for customer-facing roles, note SLA timers, and highlight feedback or survey capture points along the path.",pid:"Call out operator interfaces, HMI panels, and alarm acknowledgements that connect process equipment to customer-impacting metrics."}},{id:"resilient-recovery",title:"Resilient Recovery Blueprint",description:"Builds failover branches, compensations, and escalation playbooks.",complexity:"advanced",instructions:{bpmn:"Layer event subprocesses for incidents, model compensation tasks, and show escalation to support teams with clear rollback steps.",pid:"Add redundancy loops, relief paths, and interlocks that trigger automated shutdown, including operator guidance annotations."}}],kb=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2),Js=async(t,e,n="#ffffff")=>{const r=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),i=URL.createObjectURL(r);try{const s=new Ri;s.crossOrigin="anonymous";const a=new Promise((h,p)=>{s.onload=()=>h(),s.onerror=f=>p(f)});s.src=i,await a;const c=document.createElement("canvas");c.width=s.naturalWidth||s.width||1200,c.height=s.naturalHeight||s.height||800;const l=c.getContext("2d");if(!l)throw new Error("Unable to create 2D canvas context");l.fillStyle=n,l.fillRect(0,0,c.width,c.height),l.drawImage(s,0,0);const d=c.toDataURL(e);return await(await fetch(d)).blob()}finally{URL.revokeObjectURL(i)}},Qs=(t,e)=>{const n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},Lr=async t=>{const e=document.createElement("div");e.style.position="fixed",e.style.left="-99999px",e.style.top="-99999px",e.style.width="1200px",e.style.height="800px",document.body.appendChild(e);try{const n=new lr({container:e});await n.importXML(t);const{svg:r}=await n.saveSVG();return n.destroy(),document.body.removeChild(e),r}catch(n){throw document.body.removeChild(e),n}};function YB(t,e,n){return new Promise(r=>{const i=setTimeout(()=>{r({data:null,error:new Error(`Function call timed out after ${n/1e3} seconds`)})},n);oe.functions.invoke(t,e).then(s=>{clearTimeout(i),r(s)}).catch(s=>{clearTimeout(i),r({data:null,error:s})})})}const Cb=({xml:t,title:e})=>{const[n,r]=y.useState(null),[i,s]=y.useState(!0),[a,c]=y.useState(null);return y.useEffect(()=>{let l=!0;return(async()=>{s(!0),c(null);try{const u=await Lr(t);l&&r(u)}catch(u){l&&c("Preview failed"),console.error(`Failed to render preview for ${e}:`,u)}finally{l&&s(!1)}})(),()=>{l=!1}},[t,e]),o.jsx("div",{className:"w-full h-full flex items-center justify-center overflow-hidden",style:{backgroundColor:"#ffffff"},children:i?o.jsx(On,{className:"h-8 w-8 animate-spin text-muted-foreground"}):a?o.jsx("div",{className:"text-xs text-destructive text-center p-2",children:a}):n?o.jsx("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(n)}`,alt:`${e} preview`,className:"h-full w-full object-contain"}):null})},Ng=({xml:t,onSave:e,diagramType:n="bpmn",onRefine:r})=>{var Wg,qg,Kg;Ps();const i=y.useRef(null),s=y.useRef(null),[a,c]=y.useState(!1),[l,d]=y.useState(!1),[u,h]=y.useState(null),[p,f]=y.useState(!1),[m,v]=y.useState(!0),[g,w]=y.useState(!1),[b,x]=y.useState(!1),[E,N]=y.useState([]),[j,C]=y.useState(!1),[R,T]=y.useState([]),[$,B]=y.useState(!1),[D,q]=y.useState(null),[F,xe]=y.useState({completed:0,total:0}),[de,Be]=y.useState(5),[$e,pe]=y.useState(null),[Ke,Ye]=y.useState([]),[Te,Se]=y.useState(!1),[_e,ut]=y.useState(null),[_t,re]=y.useState(null),Fe=y.useRef(!0),Qe=y.useRef(!1),[K,M]=y.useState([]),[G,ne]=y.useState(!1),[Q,ee]=y.useState(null),[ve,Ne]=y.useState(!1),et=y.useRef([]),zt=y.useRef(null),ns=y.useMemo(()=>KB(t,n),[t,n]),vt=y.useMemo(()=>{if(!R.length)return null;if($e){const S=R.find(A=>A.id===$e);if(S)return S}return R[0]},[R,$e]),ii=y.useCallback(async()=>{if(s.current)try{const S=await s.current.saveXML({format:!0});if(S.xml)return S.xml}catch(S){console.error("Failed to capture current XML snapshot:",S)}return t},[t]),yn=y.useCallback(async()=>{if(p){C(!0);try{const{data:S,error:A}=await oe.from("user_profiles").select("user_id,email,created_at,last_login");if(A)throw A;const{data:P,error:V}=await oe.from("user_roles").select("user_id, role");if(V)throw V;const H=new Map;(P??[]).forEach(({user_id:te,role:ue})=>{const ke=H.get(te)??[];H.set(te,[...ke,ue])});const O=(S??[]).map(({user_id:te,email:ue,created_at:ke,last_login:qt})=>({userId:te,email:ue,roles:H.get(te)??["user"],createdAt:ke,lastLogin:qt}));N(O)}catch(S){console.error("Failed to load collaborators:",S),k.error("Unable to load collaborators right now")}finally{C(!1)}}},[p]),to=y.useCallback(S=>{et.current=[...et.current,S],M(et.current.slice(-50))},[]),rs=y.useCallback(async S=>{if(!(!u||et.current.length===0))try{const A=await ii(),{error:P}=await oe.from("bpmn_generations").insert({user_id:u.id,input_type:"log",input_description:`system-use:${_e??"unknown"}:${Date.now()}`,generated_bpmn_xml:A,alternative_models:JSON.parse(JSON.stringify([{events:et.current,source:"system-tracking",capturedAt:new Date().toISOString()}]))});if(P)throw P;et.current=[],M([]),S!=null&&S.silent||k.success("System usage log saved")}catch(A){console.error("Failed to persist system activities:",A),S!=null&&S.silent||k.error("Could not save system activity log")}},[u,_e,ii]),xn=y.useCallback(()=>{var P;zt.current&&zt.current();const S=jb(((P=document.body)==null?void 0:P.innerText)??"");to({id:kb(),type:"visit",timestamp:new Date().toISOString(),details:{url:window.location.href,title:document.title,contentPreview:S,referrer:document.referrer||void 0}});const A=V=>{var O;const H=V.target;H&&to({id:kb(),type:"click",timestamp:new Date().toISOString(),details:{url:window.location.href,text:((O=H.innerText)==null?void 0:O.trim().slice(0,120))||void 0,tag:H.tagName.toLowerCase(),xpath:qB(H),contentPreview:jb(H.textContent)}})};document.addEventListener("click",A,!0),zt.current=()=>{document.removeEventListener("click",A,!0)}},[to]),si=y.useCallback(async S=>{zt.current&&(zt.current(),zt.current=null),await rs(S),ne(!1)},[rs]),Uu=y.useCallback(S=>{if(!p){k.error("Only Process Managers can change editing lock");return}w(S),_e&&localStorage.setItem(`bpmn-lock:${_e}`,S?"locked":"unlocked"),k.success(S?"Collaborators are now in view-only mode":"Collaborators can edit this diagram")},[_e,p]),Hu=y.useCallback(async S=>{if(p){if(S===(u==null?void 0:u.id)){k.info("You already have Process Manager rights.");return}try{const{error:A}=await oe.from("user_roles").insert({user_id:S,role:"admin"});if(A){if(A.code==="23505"){k.info("User already has Process Manager rights.");return}throw A}k.success("Process Manager access granted"),yn()}catch(A){console.error("Failed to grant access:",A),k.error("Unable to grant access")}}},[u==null?void 0:u.id,p,yn]),Ls=y.useCallback(async S=>{if(p){if(S===(u==null?void 0:u.id)){k.error("You cannot remove your own Process Manager rights.");return}try{const{error:A}=await oe.from("user_roles").delete().match({user_id:S,role:"admin"});if(A)throw A;k.success("Process Manager access revoked"),yn()}catch(A){console.error("Failed to revoke access:",A),k.error("Unable to revoke access")}}},[u==null?void 0:u.id,p,yn]),no=y.useCallback(async()=>{Se(!0);try{let S=oe.from("bpmn_generations").select("id, created_at, input_description, input_type, alternative_models, generated_bpmn_xml, user_id").order("created_at",{ascending:!1}).limit(p?25:10);!p&&u&&(S=S.eq("user_id",u.id));const{data:A,error:P}=await S;if(P)throw P;Ye(A??[])}catch(S){console.error("Failed to load log history:",S),k.error("Unable to load BPMN history right now")}finally{Se(!1)}},[u,p]),ai=y.useCallback(async(S=!1)=>{var A;if(!u){k.error("Please sign in to open Modelling Agent Mode");return}q(null),B(!0),T([]),pe(null),ee(null),Ne(!1);try{const P=await ii(),V=_e??await zh(P);if(_e||ut(V),!S&&!Qe.current){const{data:ue,error:ke}=await oe.from("bpmn_generations").select("id, alternative_models, created_at").eq("user_id",u.id).eq("input_description",`modelling-agent:${V}`).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(ke&&ke.code!=="PGRST116")throw ke;if(ue!=null&&ue.alternative_models){const qt=ue.alternative_models;if(Array.isArray(qt)&&qt.length){T(qt),Qe.current=!0,B(!1);return}}}const H=Nb.slice(0,Math.min(Nb.length,Math.max(1,de)));if(!H.length)throw new Error("No variant definitions available for generation.");const O=H.length;xe({completed:0,total:O,current:void 0});const te=[];for(const[ue,ke]of H.entries()){xe({completed:ue,total:O,current:ke.title});try{const qt=n==="pid"?ke.instructions.pid:ke.instructions.bpmn,Ut=`
              Original process summary: ${ns}
              Variant to generate: ${ke.title} - ${ke.description}
              Instructions: ${qt}
              Generate a valid BPMN 2.0 XML for this specific variant.
            `,{data:Xe,error:it}=await YB("generate-bpmn",{body:{prompt:Ut,diagramType:n}},3e4);if(it)throw new Error(`Function invocation failed: ${it.message}`);if(!(Xe!=null&&Xe.bpmnXml))throw new Error(`No BPMN XML returned for ${ke.title}`);const st={id:`${ke.id}-${Date.now()}-${ue}`,title:ke.title,description:ke.description,complexity:ke.complexity,xml:Xe.bpmnXml,generatedAt:new Date().toISOString()};te.push(st),T([...te]),$e||pe(st.id)}catch(qt){console.error(`Failed to generate alternative "${ke.title}":`,qt),k.error(`Could not generate: ${ke.title}`,{description:qt instanceof Error?qt.message:"An unknown error occurred. The AI model might be overloaded or the request may have timed out."})}}if(xe({completed:O,total:O}),!te.length){const ue=O-te.length;throw new Error(`No alternative diagrams were produced. ${ue} of ${O} generations failed.`)}T(te),pe(((A=te[0])==null?void 0:A.id)??null),Qe.current=!0,await oe.from("bpmn_generations").insert({user_id:u.id,input_type:"text",input_description:`modelling-agent:${V}`,generated_bpmn_xml:P,alternative_models:JSON.parse(JSON.stringify(te))})}catch(P){console.error("Failed to prepare alternative models:",P),q(P instanceof Error?P.message:"An unexpected error occurred while preparing alternatives.")}finally{B(!1),xe({completed:0,total:0})}},[u,_e,n,ns,ii,de]),ro=y.useCallback(async S=>{if(s.current)try{await s.current.importXML(S.xml),s.current.get("canvas").zoom("fit-viewport"),il(P=>[...P,S.xml]),co(P=>P+1),k.success(`${S.title} applied to the canvas`),ao(!1)}catch(A){console.error("Failed to apply alternative model:",A),k.error("Unable to apply this alternative diagram")}},[]),oi=y.useCallback(S=>{const A=new Blob([S.xml],{type:"application/xml"}),P=URL.createObjectURL(A),V=document.createElement("a");V.href=P,V.download=`${S.title.replace(/\s+/g,"_").toLowerCase()}_${S.complexity}.bpmn`,document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(P)},[]),qc=y.useCallback(async S=>{if(s.current)try{await s.current.importXML(S.generated_bpmn_xml),s.current.get("canvas").zoom("fit-viewport"),il(P=>[...P,S.generated_bpmn_xml]),co(P=>P+1),k.success("Historical diagram loaded"),li(!1)}catch(A){console.error("Failed to load historical diagram:",A),k.error("Unable to load this historical snapshot")}},[]),ci=y.useCallback((S,A)=>{const P=new Blob([S],{type:"application/xml"}),V=URL.createObjectURL(P),H=document.createElement("a");H.href=V,H.download=A.endsWith(".bpmn")?A:`${A}.bpmn`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(V)},[]),[Vu,Bs]=y.useState(!1),[Kc,io]=y.useState(!1),[so,li]=y.useState(!1),[bn,ao]=y.useState(!1),[Re,ct]=y.useState(!1),[ht,It]=y.useState(null),[Xt,$t]=y.useState(!1),[Rr,kn]=y.useState(!0),[Qn,Ig]=y.useState(!0),[Fs,Mg]=y.useState(!1),[Yc,nk]=y.useState(!1),[Dg,Gu]=y.useState(!1),[Zc,rk]=y.useState(!1),[Xc,Jc]=y.useState(!1),[Qc,Wu]=y.useState(!1),[el,oo]=y.useState(!1),[tl,nl]=y.useState(!1),[qu,Ku]=y.useState(!1),[Og,ik]=y.useState([]),[Wt,sk]=y.useState(null),[$g,ak]=y.useState({x:0,y:0}),[rl,fr]=y.useState(!1),[Lg,Bg]=y.useState(!1),[Fg,ok]=y.useState(!1),[Yu,co]=y.useState(1),[di,il]=y.useState([t]),[lo,Zu]=y.useState(null);y.useEffect(()=>{t&&di.length===1&&di[0]!==t&&(il([t]),co(1))},[t]),y.useEffect(()=>{let S=!0;return(async()=>{if(t)try{const P=await zh(t);if(!S)return;ut(P);const V=localStorage.getItem(`bpmn-lock:${P}`);V==="locked"?w(!0):V==="unlocked"&&w(!1)}catch(P){console.error("Failed to compute diagram fingerprint:",P)}})(),()=>{S=!1}},[t]),y.useEffect(()=>{let S=!0;return(async()=>{try{const{data:{user:P},error:V}=await oe.auth.getUser();if(!S)return;if(V)throw V;if(h(P??null),!P){f(!1);return}const{data:H,error:O}=await oe.from("user_roles").select("role").eq("user_id",P.id);if(O)throw O;const te=(H==null?void 0:H.some(ue=>ue.role==="admin"))??!1;f(te)}catch(P){console.error("Failed to load user/role info:",P),S&&(h(null),f(!1))}})(),()=>{S=!1}},[]),y.useEffect(()=>{v(p||!g)},[p,g]),y.useEffect(()=>{Fe.current=m},[m]),y.useEffect(()=>{Qe.current=!1,T([])},[_e]),y.useEffect(()=>{R.length?pe(S=>S&&R.some(A=>A.id===S)?S:R[0].id):pe(null)},[R]),y.useEffect(()=>{b&&yn()},[b,yn]),y.useEffect(()=>()=>{zt.current&&zt.current(),et.current.length>0&&rs({silent:!0})},[rs]),y.useEffect(()=>{bn&&ai()},[bn,ai]),y.useEffect(()=>{bn||(ee(null),Ne(!1))},[bn]),y.useEffect(()=>{so&&no()},[no,so]),y.useEffect(()=>{if(!_t)return;let S;const A=async()=>{const{data:H,error:O}=await oe.from("vision_bpmn_jobs").select("status, bpmn_xml, error_message").eq("id",_t).single();if(O){console.error("Error checking job status:",O);return}if(H.status==="completed"&&H.bpmn_xml){if(s.current)try{await s.current.importXML(H.bpmn_xml),s.current.get("canvas").zoom("fit-viewport"),k.success("BPMN diagram generated from your image!",{description:"Process extracted and visualized successfully"})}catch(ue){console.error("Failed to import BPMN:",ue),k.error("Failed to load generated diagram")}const te=document.getElementById("vision-upload");te&&(te.value=""),Bs(!1),It(null),$t(!1),re(null),S&&clearInterval(S)}else if(H.status==="failed"){const te=H.error_message||"Processing failed. Please try again.";k.error("Vision AI processing failed",{description:te});const ue=document.getElementById("vision-upload");ue&&(ue.value=""),$t(!1),It(null),re(null),S&&clearInterval(S)}},P=oe.channel(`vision-job-${_t}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"vision_bpmn_jobs",filter:`id=eq.${_t}`},H=>{const O=H.new;if(console.log(" Vision job status update:",O.status),O.status==="completed"&&O.bpmn_xml){s.current&&s.current.importXML(O.bpmn_xml).then(()=>{s.current.get("canvas").zoom("fit-viewport"),k.success("BPMN diagram generated from your image!",{description:"Process extracted and visualized successfully"})}).catch(ue=>{console.error("Failed to import BPMN:",ue),k.error("Failed to load generated diagram")});const te=document.getElementById("vision-upload");te&&(te.value=""),Bs(!1),It(null),$t(!1),re(null),S&&clearInterval(S)}else if(O.status==="failed"){const te=O.error_message||"Processing failed. Please try again.";k.error("Vision AI processing failed",{description:te});const ue=document.getElementById("vision-upload");ue&&(ue.value=""),$t(!1),It(null),re(null),S&&clearInterval(S)}}).subscribe();S=window.setInterval(A,3e3),A();const V=window.setTimeout(()=>{S&&clearInterval(S),k.error("Processing timed out",{description:"Please try again or contact support"});const H=document.getElementById("vision-upload");H&&(H.value=""),$t(!1),It(null),re(null)},3e5);return()=>{clearTimeout(V),oe.removeChannel(P),S&&clearInterval(S)}},[_t,n]),y.useEffect(()=>{if(!i.current||s.current)return;s.current=new lr({container:i.current,additionalModules:[{__init__:["paletteProvider"],paletteProvider:["value",{getPaletteEntries:()=>({})}]},$3]}),n==="pid"&&(s.current.get("eventBus").once("canvas.init",()=>{var P;try{const V=(P=s.current)==null?void 0:P.get("pidRenderer",!1);V&&(V.isPidMode=!0)}catch{}}),setTimeout(()=>{var P;try{const V=(P=s.current)==null?void 0:P.get("pidRenderer",!1);V&&(V.isPidMode=!0)}catch{}},50));const S=s.current.get("eventBus");return S.on("commandStack.changed",()=>{var P;const A=(P=s.current)==null?void 0:P.get("commandStack");A&&(c(A.canUndo()),d(A.canRedo()))}),S.on("element.click",A=>{var O;const{element:P,originalEvent:V}=A;if(!Fe.current){fr(!1);return}if(P.type==="bpmn:Process"||P.waypoints){fr(!1);return}const H=(O=i.current)==null?void 0:O.getBoundingClientRect();H&&(ak({x:V.clientX-H.left,y:V.clientY-H.top}),sk(P),fr(!0))}),()=>{s.current&&(s.current.destroy(),s.current=null)}},[]);const ck=S=>{if(n!=="pid")return S;let A=S;A.includes('xmlns:pid="http://pid.extensions/schema"')||(A=A.replace(/(<bpmn:definitions[^>]*>)/,`$1
  xmlns:pid="http://pid.extensions/schema"`));const P=(V,H)=>{const O=(V||"").toLowerCase();let te="",ue="",ke="";return H.includes("task")||H.includes("Task")?O.includes("tank")||O.includes("vessel")||O.includes("drum")?(te="equipment",ue="tank",ke="mechanical"):O.includes("pump")?(te="equipment",ue="pump",ke="mechanical"):O.includes("filter")?(te="equipment",ue="filter",ke="mechanical"):O.includes("exchanger")||O.includes("heater")||O.includes("cooler")?(te="equipment",ue="heat_exchanger",ke="mechanical"):(te="equipment",ue="tank",ke="mechanical"):H.includes("exclusiveGateway")||H.includes("Gateway")?O.includes("valve")?(te="valve",ue=O.includes("control")?"valve_control":"valve_gate",ke="mechanical"):(te="valve",ue="valve_control",ke="mechanical"):H.includes("dataObjectReference")||H.includes("DataObject")?O.includes("analyzer")?(te="instrument",ue="analyzer",ke="control"):O.includes("transmitter")||O.includes("transducer")?(te="instrument",O.includes("level")?ue="transmitter_level":O.includes("flow")?ue="transmitter_flow":O.includes("pressure")?ue="transmitter_pressure":ue="transmitter_level",ke="control"):(te="instrument",ue="transmitter_level",ke="control"):H.includes("subProcess")||H.includes("SubProcess")?(O.includes("controller"),te="controller",ue="controller_pid",ke="control"):H.includes("sequenceFlow")||H.includes("SequenceFlow")?(te="line",ke="process"):(H.includes("messageFlow")||H.includes("MessageFlow"))&&(te="line",ke="signal"),te&&ue&&ke?` pid:type="${te}" pid:symbol="${ue}" pid:category="${ke}"`:""};return A=A.replace(/(<bpmn:task[^>]*name="([^"]*)")([^>]*>)/g,(V,H,O,te)=>{if(V.includes("pid:type"))return V;const ue=P(O,"task");return H+ue+te}),A=A.replace(/(<bpmn:exclusiveGateway[^>]*name="([^"]*)")([^>]*>)/g,(V,H,O,te)=>{if(V.includes("pid:type"))return V;const ue=P(O,"exclusiveGateway");return H+ue+te}),A=A.replace(/(<bpmn:dataObjectReference[^>]*name="([^"]*)")([^>]*>)/g,(V,H,O,te)=>{if(V.includes("pid:type"))return V;const ue=P(O,"dataObjectReference");return H+ue+te}),A=A.replace(/(<bpmn:subProcess[^>]*name="([^"]*)")([^>]*>)/g,(V,H,O,te)=>{if(V.includes("pid:type"))return V;const ue=P(O,"subProcess");return H+ue+te}),A=A.replace(/(<bpmn:sequenceFlow[^>]*)([^/]*>)/g,(V,H,O)=>{if(V.includes("pid:type"))return V;const te=P("","sequenceFlow");return H+te+O}),A=A.replace(/(<bpmn:messageFlow[^>]*)([^/]*>)/g,(V,H,O)=>{if(V.includes("pid:type"))return V;const te=P("","messageFlow");return H+te+O}),A};y.useEffect(()=>{var P;if(!s.current||!t)return;if(n==="pid")try{const V=(P=s.current)==null?void 0:P.get("pidRenderer",!1);V&&(V.isPidMode=!0)}catch{}const A=ck(t);s.current.importXML(A).then(()=>{var H;if(s.current.get("canvas").zoom("fit-viewport"),Zu(null),n==="pid"){try{const Ut=(H=s.current)==null?void 0:H.get("pidRenderer",!1);Ut&&(Ut.isPidMode=!0,setTimeout(()=>{try{const Xe=s.current.get("elementRegistry"),it=s.current.get("draw",!1);Xe.getAll().forEach(Lt=>{if(it&&it.update)try{it.update(Lt)}catch{}})}catch{}},200))}catch{}const te=s.current.get("elementRegistry").getAll();let ue=0,ke=0;const qt=(Ut,Xe)=>{const it=(Ut||"").toLowerCase();let st="",Lt="",dn="";return Xe.includes("task")||Xe.includes("Task")?it.includes("tank")||it.includes("vessel")||it.includes("drum")?(st="equipment",Lt="tank",dn="mechanical"):it.includes("pump")?(st="equipment",Lt="pump",dn="mechanical"):it.includes("filter")?(st="equipment",Lt="filter",dn="mechanical"):it.includes("exchanger")||it.includes("heater")||it.includes("cooler")?(st="equipment",Lt="heat_exchanger",dn="mechanical"):(st="equipment",Lt="tank",dn="mechanical"):Xe.includes("exclusiveGateway")||Xe.includes("Gateway")?(st="valve",Lt=it.includes("control")?"valve_control":"valve_gate",dn="mechanical"):Xe.includes("dataObjectReference")||Xe.includes("DataObject")?(st="instrument",it.includes("analyzer")?Lt="analyzer":it.includes("transmitter")||it.includes("transducer")?it.includes("level")?Lt="transmitter_level":it.includes("flow")?Lt="transmitter_flow":it.includes("pressure")?Lt="transmitter_pressure":Lt="transmitter_level":Lt="transmitter_level",dn="control"):Xe.includes("subProcess")||Xe.includes("SubProcess")?(st="controller",Lt="controller_pid",dn="control"):Xe.includes("sequenceFlow")||Xe.includes("SequenceFlow")?(st="line",dn="process"):(Xe.includes("messageFlow")||Xe.includes("MessageFlow"))&&(st="line",dn="signal"),{type:st,symbol:Lt,category:dn}};te.forEach(Ut=>{const Xe=Ut.businessObject;if(!Xe)return;if(Xe.$attrs||(Xe.$attrs={}),Object.keys(Xe.$attrs).filter(st=>st.startsWith("pid:")).length>0)ue++;else{const st=qt(Xe.name||"",Ut.type||"");st.type&&st.symbol&&st.category&&(Xe.$attrs["pid:type"]=st.type,Xe.$attrs["pid:symbol"]=st.symbol,Xe.$attrs["pid:category"]=st.category,ke++)}}),(ke>0||ue>0)&&setTimeout(()=>{try{const Ut=s.current.get("canvas"),Xe=A;s.current.importXML(Xe).then(()=>{Ut.zoom("fit-viewport"),setTimeout(()=>{var dn;const it=s.current.get("elementRegistry"),st=s.current.get("graphicsFactory"),Lt=(dn=s.current)==null?void 0:dn.get("pidRenderer",!1);Lt&&(Lt.isPidMode=!0),st&&it&&it.getAll().forEach(Yg=>{try{const eh=it.getGraphics(Yg.id);eh&&st.update&&st.update(Yg,eh)}catch{}})},200)}).catch(it=>{})}catch{}},500)}}).catch(V=>{console.error("Error rendering diagram:",V);const H=V.message||"Failed to load diagram";Zu(`Generation failed (Reason: ${H}). Try simplified prompt.`),n==="pid"?k.error("Generation failed (Reason: token limit). Try simplified prompt."):k.error("Failed to load BPMN diagram")})},[t,n]);const lk=async()=>{if(!m){k.error("Editing is locked by the Process Manager");return}if(s.current)try{const S=await s.current.saveXML({format:!0});if(S.xml){const A=Yu+1;co(A);const P=[...di,S.xml];if(il(P),e&&e(S.xml),u)try{const H=_e??await zh(S.xml);await oe.from("bpmn_generations").insert({user_id:u.id,input_type:"text",input_description:`manual-save:${H}`,generated_bpmn_xml:S.xml})}catch(H){console.error("Failed to log manual save:",H)}const V=n==="bpmn"?"BPMN":"P&ID";k.success("Diagram saved to workspace",{description:`Saved as version v${A}`})}}catch(S){console.error("Error saving diagram:",S),k.error("Failed to save diagram")}},Xu=async S=>{if(s.current)try{if((await s.current.saveXML({format:!0})).xml){const P=`PID_v${Yu}.${S}`;k.success(`Exported to ${P}`,{description:"Export functionality ready"})}}catch(A){console.error("Error exporting P&ID:",A),k.error("Failed to export diagram")}},dk=S=>{if(!m){k.error("Editing is locked by the Process Manager");return}S>=0&&S<di.length&&(co(S+1),e&&s.current&&s.current.importXML(di[S]).then(()=>{s.current.get("canvas").zoom("fit-viewport")}))},zg=()=>{if(!m){k.error("Editing is locked by the Process Manager");return}if(!s.current)return;const S=s.current.get("commandStack");S.canUndo()&&S.undo()},Ug=()=>{if(!m){k.error("Editing is locked by the Process Manager");return}if(!s.current)return;const S=s.current.get("commandStack");S.canRedo()&&S.redo()},uk=()=>{if(!m){k.error("Editing is locked by the Process Manager");return}if(!s.current)return;const S=s.current.get("modeling"),A=s.current.get("elementRegistry"),V=s.current.get("canvas").getRootElement(),H=A.filter(O=>O.id!==V.id&&O.parent===V);S.removeElements(H),k.success("Canvas cleared!")},hk=y.useCallback(()=>{if(!m){k.error("Editing is locked by the Process Manager");return}const S=document.createElement("input");S.type="file",S.accept=".bpmn,.xml",S.onchange=async A=>{var V;const P=(V=A.target.files)==null?void 0:V[0];if(!(!P||!s.current))try{const H=await P.text();if(new DOMParser().parseFromString(H,"text/xml").querySelector("parsererror")){k.error("Invalid XML file");return}if(!H.includes("bpmn:")&&!H.includes("bpmn2:")&&!H.includes("bpmndi:")){k.error("File does not appear to be a valid BPMN diagram");return}await s.current.importXML(H),s.current.get("canvas").zoom("fit-viewport"),k.success("Diagram imported successfully")}catch(H){console.error("Import error:",H),k.error("Failed to import diagram")}},S.click()},[m]),Ju=y.useCallback(async(S="bpmn")=>{if(s.current)try{if(S==="svg"){const P=s.current.get("canvas").svg(),V=new Blob([P],{type:"image/svg+xml"}),H=URL.createObjectURL(V),O=document.createElement("a");O.href=H,O.download=`diagram.${S}`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(H),k.success("SVG exported successfully")}else{const{xml:A}=await s.current.saveXML({format:!0}),P=new Blob([A],{type:"application/xml"}),V=URL.createObjectURL(P),H=document.createElement("a");H.href=V,H.download=`diagram.${S}`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(V),k.success(`${S.toUpperCase()} exported successfully`)}}catch(A){console.error("Export error:",A),k.error("Failed to export diagram")}},[]),Hg=y.useCallback(()=>{if(s.current)try{const S=s.current.get("canvas"),A=S.getViewbox();if(A){const P=Math.min(A.scale*1.2,3);S.zoom(P)}}catch(S){console.error("Error zooming in:",S)}},[]),Vg=y.useCallback(()=>{if(s.current)try{const S=s.current.get("canvas"),A=S.getViewbox();if(A){const P=Math.max(A.scale/1.2,.2);S.zoom(P)}}catch(S){console.error("Error zooming out:",S)}},[]),Qu=y.useCallback(()=>{if(s.current)try{s.current.get("canvas").zoom("fit-viewport")}catch(S){console.error("Error fitting to screen:",S)}},[]),pk=y.useCallback(()=>{var S;document.fullscreenElement?document.exitFullscreen().then(()=>{Gu(!1)}).catch(()=>{k.error("Failed to exit fullscreen mode")}):(S=i.current)==null||S.requestFullscreen().then(()=>{Gu(!0)}).catch(()=>{k.error("Failed to enter fullscreen mode")})},[]),fk=y.useCallback(()=>{if(s.current)try{const S=s.current.get("grid",!1);if(S)Mg(!Fs),S.setVisible(!Fs);else{Mg(!Fs);const A=i.current;if(A){const P=A.querySelector(".djs-container");P&&(Fs?P.style.backgroundImage="none":(P.style.backgroundImage="linear-gradient(rgba(0, 0, 0, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(0, 0, 0, 0.1) 1px, transparent 1px)",P.style.backgroundSize="20px 20px"))}}}catch(S){console.error("Error toggling grid:",S)}},[Fs]),mk=y.useCallback(()=>{nk(!Yc),k.info(`Ruler ${Yc?"disabled":"enabled"}`)},[Yc]),Gg=y.useCallback(()=>{if(!s.current)return;const S=[];try{const P=s.current.get("elementRegistry").getAll(),V=P.filter(O=>{var te;return(te=O.type)==null?void 0:te.includes("StartEvent")}),H=P.filter(O=>{var te;return(te=O.type)==null?void 0:te.includes("EndEvent")});V.length===0&&S.push({message:"No start event found. A BPMN diagram must have at least one start event."}),H.length===0&&S.push({message:"No end event found. A BPMN diagram should have at least one end event."}),P.forEach(O=>{var te,ue;(te=O.type)!=null&&te.includes("Task")&&!((ue=O.businessObject)!=null&&ue.name)&&S.push({message:`Task "${O.id}" has no name`,elementId:O.id})}),P.forEach(O=>{O.type&&!O.type.includes("Event")&&O.type.includes("Gateway")}),ik(S),Ku(!0),S.length===0?k.success("Validation passed! No issues found."):k.warning(`Found ${S.length} validation issue(s)`)}catch(A){console.error("Validation error:",A),k.error("Failed to validate diagram")}},[]),gk=y.useCallback(()=>{if(s.current){rk(!Zc);try{const S=s.current.get("canvas");Zc?(S.isActive("hand-tool")&&S.toggle("hand-tool"),k.info("Pan mode deactivated.")):(S.toggle("hand-tool"),k.info("Pan mode activated. Click and drag to move the canvas."))}catch(S){console.error("Error toggling pan mode:",S)}}},[Zc]),vk=y.useCallback(S=>{if(!(!s.current||!S.trim()))try{const A=s.current.get("elementRegistry"),P=s.current.get("canvas"),V=A.getAll(),H=S.toLowerCase(),O=V.filter(te=>{var Ut,Xe,it,st;const ue=((Xe=(Ut=te.businessObject)==null?void 0:Ut.name)==null?void 0:Xe.toLowerCase())||"",ke=((it=te.id)==null?void 0:it.toLowerCase())||"",qt=((st=te.type)==null?void 0:st.toLowerCase())||"";return ue.includes(H)||ke.includes(H)||qt.includes(H)});if(O.length>0){const te=O[0];P.zoom(te),k.success(`Found ${O.length} element(s) matching "${S}"`)}else k.info(`No elements found matching "${S}"`)}catch(A){console.error("Search error:",A)}},[]),yk=async S=>{var P;if(!m){k.error("Editing is locked by the Process Manager"),S.target.value="";return}const A=(P=S.target.files)==null?void 0:P[0];if(!A){S.target.value="";return}if(!A.type.startsWith("image/")){k.error("Please upload an image file"),S.target.value="";return}It(A),$t(!0);try{const{data:{user:V},error:H}=await oe.auth.getUser();if(H||!V){k.error("Please log in to use Vision Modelling AI"),$t(!1),It(null),S.target.value="";return}const O=new FileReader;O.readAsDataURL(A),await new Promise((qt,Ut)=>{O.onload=qt,O.onerror=Ut});const te=O.result;k.info("Uploading image for analysis...");const{data:ue,error:ke}=await oe.functions.invoke("vision-to-bpmn",{body:{imageBase64:te,diagramType:n}});if(ke)throw ke;if(ue!=null&&ue.jobId)re(ue.jobId),k.info("Processing started",{description:"Your image is being analyzed. This may take a moment..."});else throw new Error("No job ID received from server")}catch(V){console.error("Vision processing error:",V);const H=V instanceof Error?V.message:"Failed to process image. Please try again.";k.error("Failed to process image",{description:H}),$t(!1),It(null),S.target.value=""}},xk=async S=>{var P;const A=(P=S.target.files)==null?void 0:P[0];if(A){if(!u){k.error("Please sign in to archive logs");return}$t(!0);try{const V=await A.text(),H=await ii(),{error:O}=await oe.from("bpmn_generations").insert({user_id:u.id,input_type:"log",input_description:`log-import:${A.name}`,generated_bpmn_xml:H,alternative_models:[{event:"log_import",fileName:A.name,size:A.size,preview:V.slice(0,1e3),importedAt:new Date().toISOString()}]});if(O)throw O;k.success("Log file imported successfully"),await no(),li(!1)}catch(V){console.error("Log import error:",V),k.error("Failed to import log file")}finally{$t(!1),S.target.value=""}}},bk=()=>{k.success("QR code generated! Share with collaborators.")},Cn=y.useCallback(S=>{if(!m){k.error("Editing is locked by the Process Manager"),fr(!1);return}if(!s.current||!Wt)return;s.current.get("modeling");const A=s.current.get("bpmnReplace");try{let P=S,V;switch(S){case"start-event":P="bpmn:StartEvent";break;case"start-timer-event":P="bpmn:StartEvent",V="bpmn:TimerEventDefinition";break;case"start-message-event":P="bpmn:StartEvent",V="bpmn:MessageEventDefinition";break;case"intermediate-event":P="bpmn:IntermediateThrowEvent";break;case"intermediate-timer-event":P="bpmn:IntermediateCatchEvent",V="bpmn:TimerEventDefinition";break;case"end-event":P="bpmn:EndEvent";break;case"end-message-event":P="bpmn:EndEvent",V="bpmn:MessageEventDefinition";break;case"task":P="bpmn:Task";break;case"user-task":P="bpmn:UserTask";break;case"service-task":P="bpmn:ServiceTask";break;case"manual-task":P="bpmn:ManualTask";break;case"xor-gateway":P="bpmn:ExclusiveGateway";break;case"and-gateway":P="bpmn:ParallelGateway";break;case"or-gateway":P="bpmn:InclusiveGateway";break;default:S.startsWith("bpmn:")&&(P=S)}A.replaceElement(Wt,{type:P,eventDefinitionType:V}),k.success("Element changed successfully!"),fr(!1)}catch(P){console.error("Error changing element:",P),k.error("Failed to change element type")}},[m,Wt]),wk=y.useCallback((S,A)=>{if(!m){k.error("Editing is locked by the Process Manager"),fr(!1);return}if(!(!s.current||!Wt))try{s.current.get("modeling").setColor([Wt],{fill:S,stroke:S}),k.success(`Applied ${A} color`),fr(!1)}catch(P){console.error("Error applying color:",P),k.error("Failed to apply color")}},[m,Wt]),_k=[{name:"Bottleneck",color:"#FF5252",label:"Bottleneck (Red)"},{name:"Optimization",color:"#4CAF50",label:"Optimization (Green)"},{name:"Warning",color:"#FFC107",label:"Warning (Yellow)"},{name:"Standard",color:"#2196F3",label:"Standard (Blue)"},{name:"Inactive",color:"#9E9E9E",label:"Inactive (Gray)"},{name:"Special",color:"#9C27B0",label:"Special (Purple)"},{name:"Remove",color:"none",label:"Remove Color"}],qe=y.useCallback(S=>{if(!m){k.error("Editing is locked by the Process Manager");return}if(!s.current)return;const A=s.current.get("modeling"),P=s.current.get("elementFactory"),H=s.current.get("canvas").getRootElement();let O;const te={x:300,y:200};switch(S){case"start-event":O=P.createShape({type:"bpmn:StartEvent"});break;case"start-timer-event":O=P.createShape({type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"});break;case"start-message-event":O=P.createShape({type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"});break;case"start-signal-event":O=P.createShape({type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"});break;case"start-conditional-event":O=P.createShape({type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"});break;case"intermediate-event":O=P.createShape({type:"bpmn:IntermediateThrowEvent"});break;case"intermediate-timer-event":O=P.createShape({type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"});break;case"intermediate-message-event":O=P.createShape({type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"});break;case"intermediate-signal-event":O=P.createShape({type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"});break;case"end-event":O=P.createShape({type:"bpmn:EndEvent"});break;case"end-message-event":O=P.createShape({type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"});break;case"end-error-event":O=P.createShape({type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"});break;case"end-terminate-event":O=P.createShape({type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"});break;case"task":O=P.createShape({type:"bpmn:Task"});break;case"user-task":O=P.createShape({type:"bpmn:UserTask"});break;case"service-task":O=P.createShape({type:"bpmn:ServiceTask"});break;case"manual-task":O=P.createShape({type:"bpmn:ManualTask"});break;case"script-task":O=P.createShape({type:"bpmn:ScriptTask"});break;case"send-task":O=P.createShape({type:"bpmn:SendTask"});break;case"receive-task":O=P.createShape({type:"bpmn:ReceiveTask"});break;case"business-rule-task":O=P.createShape({type:"bpmn:BusinessRuleTask"});break;case"call-activity":O=P.createShape({type:"bpmn:CallActivity"});break;case"xor-gateway":O=P.createShape({type:"bpmn:ExclusiveGateway"});break;case"and-gateway":O=P.createShape({type:"bpmn:ParallelGateway"});break;case"or-gateway":O=P.createShape({type:"bpmn:InclusiveGateway"});break;case"event-gateway":O=P.createShape({type:"bpmn:EventBasedGateway"});break;case"complex-gateway":O=P.createShape({type:"bpmn:ComplexGateway"});break;case"subprocess":O=P.createShape({type:"bpmn:SubProcess",isExpanded:!0});break;case"collapsed-subprocess":O=P.createShape({type:"bpmn:SubProcess",isExpanded:!1});break;case"event-subprocess":O=P.createShape({type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0});break;case"transaction":O=P.createShape({type:"bpmn:Transaction",isExpanded:!0});break;case"participant":O=P.createShape({type:"bpmn:Participant"});break;case"data-object":O=P.createShape({type:"bpmn:DataObjectReference"});break;case"data-store":O=P.createShape({type:"bpmn:DataStoreReference"});break;case"data-input":O=P.createShape({type:"bpmn:DataInput"});break;case"data-output":O=P.createShape({type:"bpmn:DataOutput"});break;case"text-annotation":O=P.createShape({type:"bpmn:TextAnnotation"});break;case"group":O=P.createShape({type:"bpmn:Group"});break;default:return}O&&(A.createShape(O,te,H),k.success("Element added to canvas!"))},[m]);y.useEffect(()=>{const S=A=>{const P=A.target;rl&&!P.closest(".context-menu")&&fr(!1)};return rl&&document.addEventListener("click",S),()=>{document.removeEventListener("click",S)}},[rl]),y.useEffect(()=>{const S=()=>{Gu(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",S),()=>document.removeEventListener("fullscreenchange",S)},[]);const Ar=n==="pid";return o.jsxs("div",{className:"flex flex-col h-[calc(100vh-8rem)] bg-background",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b bg-background",children:[o.jsx("div",{className:"flex items-center gap-3",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(sv,{className:"h-5 w-5 text-primary"}),o.jsx("span",{className:"font-bold text-lg",children:"PROSSMIND"}),o.jsx("span",{className:"text-sm text-muted-foreground font-normal",children:"DESIGN"})]})}),o.jsx("div",{className:"flex-1 flex justify-center",children:o.jsx(kS,{children:o.jsxs(CS,{children:[o.jsx(Vl,{children:o.jsx(Up,{asChild:!0,children:o.jsx("a",{href:"/",className:"text-sm hover:text-primary",children:"Workspaces"})})}),o.jsx(Hp,{}),o.jsx(Vl,{children:o.jsx(Up,{className:"text-sm hover:text-primary",children:"Generated default"})}),o.jsx(Hp,{}),o.jsx(Vl,{children:o.jsx(PS,{className:`text-sm font-medium ${Ar?"text-engineering-green":"text-primary"}`,children:Ar?"* P&ID":"* BPMN"})})]})})}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("a",{href:"/",className:"text-sm hover:text-primary",children:"Overview"}),o.jsx("a",{href:"/",className:"text-sm hover:text-primary",children:"Models"}),o.jsx("a",{href:"/",className:"text-sm hover:text-primary font-medium",children:"Editing"}),o.jsx(U,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full",children:o.jsx(d0,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:`flex items-center gap-0.5 px-1 py-1 border-b bg-muted/30 overflow-x-auto ${Ar?"border-engineering-green/20":"border-border"}`,children:[o.jsxs("div",{className:"flex items-center gap-0.5 shrink-0",children:[o.jsx(U,{variant:"ghost",size:"sm",onClick:lk,className:"h-7 w-7 p-0 shrink-0",title:"Save",disabled:!m,children:o.jsx(v2,{className:"h-3.5 w-3.5"})}),o.jsx(U,{variant:"ghost",size:"sm",onClick:hk,className:"h-7 w-7 p-0 shrink-0",title:"Upload/Import",disabled:!m,children:o.jsx(ch,{className:"h-3.5 w-3.5"})}),o.jsxs(cs,{children:[o.jsx(ls,{asChild:!0,children:o.jsx(U,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 shrink-0",title:"Download/Export",children:o.jsx(o0,{className:"h-3.5 w-3.5"})})}),o.jsxs(bi,{align:"start",children:[o.jsxs(pt,{onClick:()=>Ju("bpmn"),children:[o.jsx(lv,{className:"h-4 w-4 mr-2"}),"Export as .bpmn"]}),o.jsxs(pt,{onClick:()=>Ju("xml"),children:[o.jsx(or,{className:"h-4 w-4 mr-2"}),"Export as .xml"]}),o.jsxs(pt,{onClick:()=>Ju("svg"),children:[o.jsx(Ri,{className:"h-4 w-4 mr-2"}),"Export as .svg"]})]})]}),o.jsx("div",{className:"h-5 w-px bg-border mx-0.5 shrink-0"}),o.jsx(U,{variant:"ghost",size:"sm",onClick:zg,className:"h-7 w-7 p-0 shrink-0",title:"Undo",disabled:!a||!m,children:o.jsx(vv,{className:"h-3.5 w-3.5"})}),o.jsx(U,{variant:"ghost",size:"sm",onClick:Ug,className:"h-7 w-7 p-0 shrink-0",title:"Redo",disabled:!l||!m,children:o.jsx(pv,{className:"h-3.5 w-3.5"})}),o.jsx("div",{className:"h-5 w-px bg-border mx-0.5 shrink-0"}),o.jsxs(cs,{children:[o.jsx(ls,{asChild:!0,children:o.jsx(U,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 shrink-0",title:"Zoom Controls",children:o.jsx(lh,{className:"h-3.5 w-3.5"})})}),o.jsxs(bi,{align:"start",children:[o.jsxs(pt,{onClick:Hg,children:[o.jsx(lh,{className:"h-4 w-4 mr-2"}),"Zoom In"]}),o.jsxs(pt,{onClick:Vg,children:[o.jsx(bv,{className:"h-4 w-4 mr-2"}),"Zoom Out"]}),o.jsxs(pt,{onClick:Qu,children:[o.jsx(oh,{className:"h-4 w-4 mr-2"}),"Fit to Screen"]})]})]}),o.jsx(U,{variant:Dg?"default":"ghost",size:"sm",onClick:pk,className:"h-7 w-7 p-0 shrink-0",title:"Fullscreen Mode",children:Dg?o.jsx(d2,{className:"h-3.5 w-3.5"}):o.jsx(o2,{className:"h-3.5 w-3.5"})}),o.jsx("div",{className:"h-5 w-px bg-border mx-0.5 shrink-0"}),o.jsx(U,{variant:Fs?"default":"ghost",size:"sm",onClick:fk,className:"h-7 w-7 p-0 shrink-0",title:"Toggle Grid",children:o.jsx(r2,{className:"h-3.5 w-3.5"})}),o.jsx(U,{variant:Yc?"default":"ghost",size:"sm",onClick:mk,className:"h-7 w-7 p-0 shrink-0",title:"Toggle Ruler",children:o.jsx(g2,{className:"h-3.5 w-3.5"})}),o.jsx(U,{variant:"ghost",size:"sm",onClick:Qu,className:"h-7 w-7 p-0 shrink-0",title:"Fit Diagram to Screen",children:o.jsx(oh,{className:"h-3.5 w-3.5"})}),o.jsx(U,{variant:"ghost",size:"sm",onClick:Gg,className:"h-7 w-7 p-0 shrink-0",title:"Validate Model",children:o.jsx(gv,{className:"h-3.5 w-3.5"})}),o.jsx("div",{className:"h-5 w-px bg-border mx-0.5 shrink-0"}),o.jsx(U,{variant:"ghost",size:"sm",onClick:uk,className:"h-7 w-7 p-0 shrink-0",title:"Clear canvas",disabled:!m,children:o.jsx(l0,{className:"h-3.5 w-3.5"})}),o.jsx("div",{className:"h-5 w-px bg-border mx-0.5 shrink-0"}),o.jsxs(cs,{children:[o.jsx(ls,{asChild:!0,children:o.jsxs(U,{variant:"outline",size:"sm",className:"gap-1.5 h-7 px-2 shrink-0",children:[o.jsx(E2,{className:"h-3.5 w-3.5"}),o.jsx("span",{className:"text-xs",children:"Tools"})]})}),o.jsxs(bi,{align:"start",className:"w-64",children:[o.jsx(Hl,{children:Ar?"Advanced P&ID Tools":"Advanced BPMN Tools"}),o.jsx(ra,{}),r&&o.jsxs(o.Fragment,{children:[o.jsx(pt,{onClick:()=>{if(!m){k.error("Editing is locked by the Process Manager");return}r()},children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(_a,{className:"h-4 w-4"}),o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:"font-medium",children:"Refine Diagram"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"AI-powered diagram refinement"})]})]})}),o.jsx(ra,{})]}),o.jsx(pt,{onClick:()=>ao(!0),children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(aa,{className:"h-4 w-4"}),o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:"font-medium",children:"Modelling Agent Mode"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"Review 5-7 AI-generated alternatives"})]})]})}),o.jsx(pt,{onClick:()=>li(!0),children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ah,{className:"h-4 w-4"}),o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:"font-medium",children:"Log Agent"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"Review BPMN audit history"})]})]})}),o.jsx(pt,{onClick:()=>Bs(!0),children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ch,{className:"h-4 w-4"}),o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:"font-medium",children:"Vision Modelling AI"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"Sketch to diagram"})]})]})}),o.jsx(ra,{}),o.jsx(pt,{onClick:()=>io(!0),children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(hv,{className:"h-4 w-4"}),o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:"font-medium",children:"Share via QR Code"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"Invite collaborators"})]})]})})]})]}),r&&o.jsxs(U,{variant:"outline",size:"sm",className:"gap-1.5 h-7 px-2 shrink-0",onClick:()=>{if(!m){k.error("Editing is locked by the Process Manager");return}r()},title:"Refine diagram with AI",disabled:!m,children:[o.jsx(_a,{className:"h-3.5 w-3.5"}),o.jsx("span",{className:"text-xs",children:"Refine"})]}),o.jsx(gr,{variant:m?p?"default":"secondary":"outline",className:"ml-1 shrink-0 text-xs",children:p?"Process Manager":m?"Editor mode":"View only"})]}),o.jsx("div",{className:"flex-1 flex justify-center min-w-0 shrink",children:o.jsxs("div",{className:"flex items-center gap-1 bg-background rounded-md border border-border p-0.5",children:[o.jsxs("div",{className:"px-2 py-0.5 bg-primary text-primary-foreground rounded text-xs font-medium flex items-center gap-1.5",children:[Ar?"P&ID":"BPMN",o.jsx(U,{variant:"ghost",size:"sm",className:"h-3.5 w-3.5 p-0 hover:bg-primary-foreground/20",onClick:()=>{},children:o.jsx(wr,{className:"h-2.5 w-2.5"})})]}),o.jsx(U,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",title:"New Tab",children:o.jsx(m2,{className:"h-3 w-3"})})]})}),o.jsx("div",{className:"flex items-center gap-1 shrink-0",children:o.jsxs("div",{className:"relative",children:[o.jsx(x2,{className:"absolute left-1.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"}),o.jsx(Kt,{placeholder:"Q Quick Search...",className:"pl-7 pr-7 h-7 w-40 text-xs",onKeyDown:S=>{S.key==="Enter"&&vk(S.currentTarget.value)}}),o.jsx("kbd",{className:"absolute right-1.5 top-1/2 transform -translate-y-1/2 pointer-events-none inline-flex h-3.5 select-none items-center gap-0.5 rounded border bg-muted px-1 font-mono text-[9px] font-medium text-muted-foreground opacity-100",children:"K"})]})})]}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[Rr&&o.jsxs("div",{className:"w-64 border-r border-border bg-muted/30 flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-border bg-background",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(p2,{className:"h-4 w-4"}),o.jsx("span",{className:"font-semibold text-sm",children:"Elements"})]}),o.jsx(U,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>kn(!1),children:o.jsx(wr,{className:"h-4 w-4"})})]}),o.jsx(Fr,{className:"flex-1 p-3",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-bold text-foreground",children:"START EVENTS"}),o.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[o.jsxs("div",{onClick:()=>qe("start-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Start Event",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-2 border-green-600"}),o.jsx("span",{className:"text-[9px] text-center",children:"Start"})]}),o.jsxs("div",{onClick:()=>qe("start-timer-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Timer Start",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-2 border-green-600 flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Timer"})]}),o.jsxs("div",{onClick:()=>qe("start-message-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Message Start",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-2 border-green-600 flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Msg"})]}),o.jsxs("div",{onClick:()=>qe("start-signal-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Signal Start",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-2 border-green-600 flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Signal"})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-bold text-foreground",children:"INTERMEDIATE EVENTS"}),o.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[o.jsxs("div",{onClick:()=>qe("intermediate-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Intermediate",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-2 border-blue-600"}),o.jsx("span",{className:"text-[9px] text-center",children:"Inter."})]}),o.jsxs("div",{onClick:()=>qe("intermediate-timer-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Timer",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-2 border-blue-600 flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Timer"})]}),o.jsxs("div",{onClick:()=>qe("intermediate-message-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Message",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-2 border-blue-600 flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Msg"})]}),o.jsxs("div",{onClick:()=>qe("intermediate-signal-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Signal",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-2 border-blue-600 flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Signal"})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-bold text-foreground",children:"END EVENTS"}),o.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[o.jsxs("div",{onClick:()=>qe("end-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"End Event",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-4 border-red-600"}),o.jsx("span",{className:"text-[9px] text-center",children:"End"})]}),o.jsxs("div",{onClick:()=>qe("end-message-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Message End",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-4 border-red-600 flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Msg"})]}),o.jsxs("div",{onClick:()=>qe("end-error-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Error End",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-4 border-red-600 flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Error"})]}),o.jsxs("div",{onClick:()=>qe("end-terminate-event"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Terminate",children:[o.jsx("div",{className:"w-7 h-7 rounded-full border-4 border-red-600 flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Term"})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-bold text-foreground",children:"TASKS & ACTIVITIES"}),o.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[o.jsxs("div",{onClick:()=>qe("task"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Task",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-foreground rounded"}),o.jsx("span",{className:"text-[9px] text-center",children:"Task"})]}),o.jsxs("div",{onClick:()=>qe("user-task"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"User Task",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-foreground rounded flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"User"})]}),o.jsxs("div",{onClick:()=>qe("service-task"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Service Task",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-foreground rounded flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Service"})]}),o.jsxs("div",{onClick:()=>qe("manual-task"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Manual Task",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-foreground rounded flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Manual"})]}),o.jsxs("div",{onClick:()=>qe("script-task"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Script Task",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-foreground rounded flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Script"})]}),o.jsxs("div",{onClick:()=>qe("send-task"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Send Task",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-foreground rounded flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Send"})]}),o.jsxs("div",{onClick:()=>qe("receive-task"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Receive Task",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-foreground rounded flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Receive"})]}),o.jsxs("div",{onClick:()=>qe("business-rule-task"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Business Rule Task",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-foreground rounded flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[9px] text-center",children:"Rule"})]}),o.jsxs("div",{onClick:()=>qe("call-activity"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Call Activity",children:[o.jsx("div",{className:"w-7 h-7 border-4 border-foreground rounded"}),o.jsx("span",{className:"text-[9px] text-center",children:"Call"})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-bold text-foreground",children:"GATEWAYS"}),o.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[o.jsxs("div",{onClick:()=>qe("xor-gateway"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Exclusive Gateway (XOR)",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-amber-600 transform rotate-45 flex items-center justify-center",children:o.jsx("span",{className:"transform -rotate-45 text-[10px] font-bold",children:"X"})}),o.jsx("span",{className:"text-[9px] text-center",children:"XOR"})]}),o.jsxs("div",{onClick:()=>qe("and-gateway"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Parallel Gateway (AND)",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-purple-600 transform rotate-45 flex items-center justify-center",children:o.jsx("span",{className:"transform -rotate-45 text-[10px] font-bold",children:"+"})}),o.jsx("span",{className:"text-[9px] text-center",children:"AND"})]}),o.jsxs("div",{onClick:()=>qe("or-gateway"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Inclusive Gateway (OR)",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-indigo-600 transform rotate-45 flex items-center justify-center",children:o.jsx("span",{className:"transform -rotate-45 text-[10px] font-bold",children:"O"})}),o.jsx("span",{className:"text-[9px] text-center",children:"OR"})]}),o.jsxs("div",{onClick:()=>qe("event-gateway"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Event-based Gateway",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-cyan-600 transform rotate-45 flex items-center justify-center",children:o.jsx("span",{className:"transform -rotate-45 text-[10px]",children:""})}),o.jsx("span",{className:"text-[9px] text-center",children:"Event"})]}),o.jsxs("div",{onClick:()=>qe("complex-gateway"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Complex Gateway",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-pink-600 transform rotate-45 flex items-center justify-center",children:o.jsx("span",{className:"transform -rotate-45 text-[10px] font-bold",children:"*"})}),o.jsx("span",{className:"text-[9px] text-center",children:"Complex"})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-bold text-foreground",children:"SUBPROCESSES"}),o.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[o.jsxs("div",{onClick:()=>qe("subprocess"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Expanded Subprocess",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-foreground rounded flex items-center justify-center text-[10px]",children:"+"}),o.jsx("span",{className:"text-[9px] text-center",children:"Sub"})]}),o.jsxs("div",{onClick:()=>qe("collapsed-subprocess"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Collapsed Subprocess",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-foreground rounded flex items-center justify-center",children:o.jsx("div",{className:"w-3 h-0.5 bg-foreground"})}),o.jsx("span",{className:"text-[9px] text-center",children:"Coll."})]}),o.jsxs("div",{onClick:()=>qe("event-subprocess"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Event Subprocess",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-dashed border-foreground rounded flex items-center justify-center text-[10px",children:"+"}),o.jsx("span",{className:"text-[9px] text-center",children:"Event"})]}),o.jsxs("div",{onClick:()=>qe("transaction"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Transaction",children:[o.jsx("div",{className:"w-7 h-7 border-4 border-double border-foreground rounded"}),o.jsx("span",{className:"text-[9px] text-center",children:"Trans."})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-bold text-foreground",children:"POOLS & LANES"}),o.jsx("div",{className:"grid grid-cols-4 gap-2",children:o.jsxs("div",{onClick:()=>qe("participant"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Pool/Participant",children:[o.jsx("div",{className:"w-8 h-6 border-2 border-foreground rounded",children:o.jsx("div",{className:"w-1 h-full bg-foreground"})}),o.jsx("span",{className:"text-[9px] text-center",children:"Pool"})]})})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-bold text-foreground",children:"DATA OBJECTS"}),o.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[o.jsxs("div",{onClick:()=>qe("data-object"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Data Object",children:[o.jsx("div",{className:"w-6 h-7 border-2 border-foreground",style:{clipPath:"polygon(0 10%, 70% 10%, 100% 0, 100% 100%, 0 100%)"}}),o.jsx("span",{className:"text-[9px] text-center",children:"Object"})]}),o.jsxs("div",{onClick:()=>qe("data-store"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Data Store",children:[o.jsx("div",{className:"w-7 h-6 border-2 border-foreground rounded-sm"}),o.jsx("span",{className:"text-[9px] text-center",children:"Store"})]}),o.jsxs("div",{onClick:()=>qe("data-input"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Data Input",children:[o.jsx("div",{className:"w-6 h-7 border-2 border-foreground",style:{clipPath:"polygon(0 10%, 70% 10%, 100% 0, 100% 100%, 0 100%)"},children:o.jsx("div",{className:"text-[8px] mt-2 ml-1",children:""})}),o.jsx("span",{className:"text-[9px] text-center",children:"Input"})]}),o.jsxs("div",{onClick:()=>qe("data-output"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Data Output",children:[o.jsx("div",{className:"w-6 h-7 border-2 border-foreground",style:{clipPath:"polygon(0 10%, 70% 10%, 100% 0, 100% 100%, 0 100%)"},children:o.jsx("div",{className:"text-[8px] mt-2 ml-1",children:""})}),o.jsx("span",{className:"text-[9px] text-center",children:"Output"})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-bold text-foreground",children:"ARTIFACTS"}),o.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[o.jsxs("div",{onClick:()=>qe("text-annotation"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Text Annotation",children:[o.jsx("div",{className:"w-7 h-6 border-l-2 border-t-2 border-b-2 border-foreground"}),o.jsx("span",{className:"text-[9px] text-center",children:"Note"})]}),o.jsxs("div",{onClick:()=>qe("group"),className:"flex flex-col items-center gap-1 p-2 hover:bg-accent rounded cursor-pointer transition-colors",title:"Group",children:[o.jsx("div",{className:"w-7 h-7 border-2 border-dashed border-foreground rounded"}),o.jsx("span",{className:"text-[9px] text-center",children:"Group"})]})]})]}),o.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[o.jsx("p",{className:"text-xs font-bold text-foreground",children:"CONNECTIONS"}),o.jsxs("div",{className:"space-y-1 text-[10px] text-muted-foreground",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 h-0.5 bg-foreground"}),o.jsx("span",{children:"Sequence Flow"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 h-0.5 border-t-2 border-dashed border-foreground"}),o.jsx("span",{children:"Message Flow"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 h-0.5 border-t-2 border-dotted border-foreground"}),o.jsx("span",{children:"Association"})]}),o.jsx("p",{className:"pt-1 text-muted-foreground",children:"Drag from any element's anchor points to create connections"})]})]}),o.jsx("p",{className:"text-xs text-muted-foreground pt-2 border-t",children:" Click elements to add them. Double-click shapes to edit labels. Use context menu (right-click) for more options."})]})}),o.jsxs("div",{className:"border-t border-border p-2 flex items-center justify-center gap-1 bg-background",children:[o.jsx(U,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:Hg,title:"Zoom In",children:o.jsx(lh,{className:"h-3.5 w-3.5"})}),o.jsx(U,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:Vg,title:"Zoom Out",children:o.jsx(bv,{className:"h-3.5 w-3.5"})}),o.jsx(U,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:Qu,title:"Fit to Screen",children:o.jsx(oh,{className:"h-3.5 w-3.5"})}),o.jsx(U,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:()=>oo(!0),title:"Settings",children:o.jsx(fv,{className:"h-3.5 w-3.5"})})]})]}),o.jsxs("div",{className:"flex-1 relative flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"absolute top-4 right-4 z-40 flex items-center gap-2 bg-background/95 backdrop-blur-sm border border-border rounded-lg shadow-lg p-2",children:[o.jsx(U,{variant:"ghost",size:"sm",onClick:zg,disabled:!m||!a,title:"Undo (Ctrl+Z)",className:"h-8 w-8 p-0",children:o.jsx(vv,{className:"h-4 w-4"})}),o.jsx(U,{variant:"ghost",size:"sm",onClick:Ug,disabled:!m||!l,title:"Redo (Ctrl+Y)",className:"h-8 w-8 p-0",children:o.jsx(pv,{className:"h-4 w-4"})}),o.jsx("div",{className:"h-6 w-px bg-border mx-1"}),o.jsxs("span",{className:"text-xs text-muted-foreground px-2",children:["v",Yu,di.length>1&&o.jsxs(cs,{children:[o.jsx(ls,{asChild:!0,children:o.jsxs("button",{className:"ml-1 text-primary hover:underline",children:[" v",di.length]})}),o.jsx(bi,{children:di.map((S,A)=>o.jsxs(pt,{onClick:()=>dk(A),children:["Version ",A+1]},A))})]})]})]}),lo&&o.jsx("div",{className:"w-full h-full bg-muted/50 border border-destructive/20 rounded-lg flex flex-col items-center justify-center p-8",children:o.jsxs("div",{className:"text-center space-y-4 max-w-md",children:[o.jsx("div",{className:"w-16 h-16 rounded-full bg-destructive/10 flex items-center justify-center mx-auto",children:o.jsx(wr,{className:"h-8 w-8 text-destructive"})}),o.jsx("h3",{className:"text-lg font-semibold",children:"Generation Failed"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:lo}),o.jsx(U,{onClick:()=>Zu(null),variant:"outline",children:"Retry with Simplified Prompt"})]})}),o.jsx("div",{ref:i,style:{backgroundColor:"#ffffff"},className:`w-full h-full border rounded-lg shadow-sm ${lo?"hidden":""} ${Ar?"border-engineering-green/30":"border-border"}`}),Ar&&Lg&&o.jsxs("div",{className:"absolute top-16 right-4 w-80 bg-background border border-engineering-green/20 rounded-lg shadow-lg z-40 max-h-[600px] overflow-y-auto",children:[o.jsxs("div",{className:"p-4 border-b border-border flex items-center justify-between",children:[o.jsxs("h4",{className:"font-semibold text-sm flex items-center gap-2",children:[o.jsx(dv,{className:"h-4 w-4 text-engineering-green"}),"ISA S5.1 Symbols"]}),o.jsx(U,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>Bg(!1),children:o.jsx(wr,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs(_b,{type:"single",collapsible:!0,children:[o.jsxs(Co,{value:"equipment",children:[o.jsx(Po,{className:"text-sm",children:"Equipment"}),o.jsxs(To,{className:"text-xs space-y-2",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"TK-xxx:"})," Storage Tank"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"P-xxx:"})," Pump"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"V-xxx:"})," Pressure Vessel"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"E-xxx:"})," Heat Exchanger"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"R-xxx:"})," Reactor"]})]})]}),o.jsxs(Co,{value:"valves",children:[o.jsx(Po,{className:"text-sm",children:"Valves"}),o.jsxs(To,{className:"text-xs space-y-2",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"FCV-xxx:"})," Flow Control Valve"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"TCV-xxx:"})," Temperature Control Valve"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"PCV-xxx:"})," Pressure Control Valve"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"PSV-xxx:"})," Pressure Safety Valve"]})]})]}),o.jsxs(Co,{value:"instruments",children:[o.jsx(Po,{className:"text-sm",children:"Instruments"}),o.jsxs(To,{className:"text-xs space-y-2",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"FI:"})," Flow Indicator"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"TI:"})," Temperature Indicator"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"PI:"})," Pressure Indicator"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"LI:"})," Level Indicator"]})]})]})]}),o.jsx(_b,{type:"single",collapsible:!0,children:o.jsxs(Co,{value:"advanced",children:[o.jsx(Po,{className:"text-sm",onClick:()=>ok(!Fg),children:"Show Advanced Symbols"}),Fg&&o.jsxs(To,{className:"text-xs space-y-2",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"FIC:"})," Flow Indicating Controller"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"TIC:"})," Temperature Indicating Controller"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"PIC:"})," Pressure Indicating Controller"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"LIC:"})," Level Indicating Controller"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Line Ratings:"})," 150# = ASME B16.5 Class 150"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Line Ratings:"})," 300# = ASME B16.5 Class 300"]})]})]})})]})]}),Ar&&!lo&&o.jsx("div",{className:"absolute bottom-8 right-8 z-30",children:o.jsxs(cs,{children:[o.jsx(ls,{asChild:!0,children:o.jsxs(U,{className:"shadow-lg hover:shadow-xl bg-engineering-green hover:bg-engineering-green/90",children:["Export ",o.jsx(lv,{className:"ml-2 h-4 w-4"})]})}),o.jsxs(bi,{align:"end",children:[o.jsx(pt,{onClick:()=>Xu("svg"),children:"Export as SVG"}),o.jsx(pt,{onClick:()=>Xu("pdf"),children:"Export as PDF"}),o.jsx(pt,{onClick:()=>Xu("dwg"),children:"Export as DWG"})]})]})}),Ar&&!Lg&&!lo&&o.jsxs(U,{variant:"outline",size:"sm",className:"absolute top-16 right-4 z-30 bg-background/95 backdrop-blur-sm border-engineering-green/20 hover:bg-engineering-green/10",onClick:()=>Bg(!0),children:[o.jsx(dv,{className:"h-4 w-4 mr-2 text-engineering-green"}),"Show Legend"]})]}),Qn&&o.jsxs("div",{className:"w-12 border-l border-border bg-muted/30 flex flex-col items-center py-2 gap-2",children:[o.jsx(U,{variant:Xc?"default":"ghost",size:"sm",className:"h-9 w-9 p-0",title:"Diagram Overview",onClick:()=>Jc(!Xc),children:o.jsx(or,{className:"h-4 w-4"})}),o.jsx(U,{variant:Qc?"default":"ghost",size:"sm",className:"h-9 w-9 p-0",title:"Participants / Pools & Lanes",onClick:()=>Wu(!Qc),children:o.jsx(yv,{className:"h-4 w-4"})}),o.jsx(U,{variant:el?"default":"ghost",size:"sm",className:"h-9 w-9 p-0",title:"Execution Settings",onClick:()=>oo(!el),children:o.jsx(fv,{className:"h-4 w-4"})}),o.jsx(U,{variant:qu?"default":"ghost",size:"sm",className:"h-9 w-9 p-0",title:"Check Model / Validate",onClick:Gg,children:o.jsx($n,{className:"h-4 w-4"})}),o.jsx(U,{variant:"ghost",size:"sm",className:"h-9 w-9 p-0",title:"User / Role Panel",onClick:()=>k.info("User/Role panel - coming soon"),children:o.jsx(yv,{className:"h-4 w-4"})}),o.jsx(U,{variant:tl?"default":"ghost",size:"sm",className:"h-9 w-9 p-0",title:"Element Documentation",onClick:()=>nl(!tl),children:o.jsx(or,{className:"h-4 w-4"})}),o.jsx(U,{variant:Zc?"default":"ghost",size:"sm",className:"h-9 w-9 p-0",title:"Pan / Navigate Tool",onClick:gk,children:o.jsx(i2,{className:"h-4 w-4"})}),o.jsx(U,{variant:"ghost",size:"sm",className:"h-9 w-9 p-0",title:"Search",onClick:()=>{const S=document.querySelector('input[placeholder*="Quick Search"]');S&&S.focus()},children:o.jsx(t2,{className:"h-4 w-4"})}),o.jsx("div",{className:"flex-1"}),o.jsx(U,{variant:"ghost",size:"sm",className:"h-9 w-9 p-0",onClick:()=>Ig(!1),title:"Collapse Sidebar",children:o.jsx(ov,{className:"h-4 w-4"})})]}),!Qn&&o.jsx("div",{className:"w-8 border-l border-border bg-muted/30 flex items-center justify-center",children:o.jsx(U,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>Ig(!0),title:"Expand Sidebar",children:o.jsx(ov,{className:"h-4 w-4 rotate-180"})})})]}),rl&&Wt&&o.jsxs("div",{className:"context-menu absolute bg-background border border-border rounded-lg shadow-lg z-50 p-3",style:{left:`${$g.x}px`,top:`${$g.y}px`,maxWidth:"280px"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2 pb-2 border-b",children:[o.jsx("span",{className:"text-xs font-semibold",children:"Change to:"}),o.jsx(U,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0",onClick:()=>fr(!1),children:o.jsx(wr,{className:"h-3 w-3"})})]}),o.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:[(((Wg=Wt.type)==null?void 0:Wg.includes("Event"))||Wt.type==="bpmn:StartEvent"||Wt.type==="bpmn:EndEvent")&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-[10px] font-bold text-muted-foreground",children:"EVENTS"}),o.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[o.jsxs("button",{onClick:()=>Cn("start-event"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded text-xs",title:"Start Event",children:[o.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-green-600"}),o.jsx("span",{className:"text-[8px]",children:"Start"})]}),o.jsxs("button",{onClick:()=>Cn("intermediate-event"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded text-xs",title:"Intermediate",children:[o.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-blue-600"}),o.jsx("span",{className:"text-[8px]",children:"Inter."})]}),o.jsxs("button",{onClick:()=>Cn("end-event"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded text-xs",title:"End Event",children:[o.jsx("div",{className:"w-6 h-6 rounded-full border-4 border-red-600"}),o.jsx("span",{className:"text-[8px]",children:"End"})]})]})]}),((qg=Wt.type)==null?void 0:qg.includes("Task"))&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-[10px] font-bold text-muted-foreground",children:"TASKS"}),o.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[o.jsxs("button",{onClick:()=>Cn("task"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded",title:"Task",children:[o.jsx("div",{className:"w-6 h-6 border-2 border-foreground rounded"}),o.jsx("span",{className:"text-[8px]",children:"Task"})]}),o.jsxs("button",{onClick:()=>Cn("user-task"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded",title:"User Task",children:[o.jsx("div",{className:"w-6 h-6 border-2 border-foreground rounded flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[8px]",children:"User"})]}),o.jsxs("button",{onClick:()=>Cn("service-task"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded",title:"Service",children:[o.jsx("div",{className:"w-6 h-6 border-2 border-foreground rounded flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[8px]",children:"Service"})]}),o.jsxs("button",{onClick:()=>Cn("manual-task"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded",title:"Manual",children:[o.jsx("div",{className:"w-6 h-6 border-2 border-foreground rounded flex items-center justify-center text-[10px]",children:""}),o.jsx("span",{className:"text-[8px]",children:"Manual"})]})]})]}),((Kg=Wt.type)==null?void 0:Kg.includes("Gateway"))&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-[10px] font-bold text-muted-foreground",children:"GATEWAYS"}),o.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[o.jsxs("button",{onClick:()=>Cn("xor-gateway"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded",title:"XOR",children:[o.jsx("div",{className:"w-6 h-6 border-2 border-amber-600 transform rotate-45 flex items-center justify-center",children:o.jsx("span",{className:"transform -rotate-45 text-[10px] font-bold",children:"X"})}),o.jsx("span",{className:"text-[8px]",children:"XOR"})]}),o.jsxs("button",{onClick:()=>Cn("and-gateway"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded",title:"AND",children:[o.jsx("div",{className:"w-6 h-6 border-2 border-purple-600 transform rotate-45 flex items-center justify-center",children:o.jsx("span",{className:"transform -rotate-45 text-[10px] font-bold",children:"+"})}),o.jsx("span",{className:"text-[8px]",children:"AND"})]}),o.jsxs("button",{onClick:()=>Cn("or-gateway"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded",title:"OR",children:[o.jsx("div",{className:"w-6 h-6 border-2 border-indigo-600 transform rotate-45 flex items-center justify-center",children:o.jsx("span",{className:"transform -rotate-45 text-[10px] font-bold",children:"O"})}),o.jsx("span",{className:"text-[8px]",children:"OR"})]})]})]}),o.jsxs("div",{className:"pt-2 border-t space-y-1",children:[o.jsx("p",{className:"text-[10px] font-bold text-muted-foreground",children:"CAMUNDA COLORS"}),o.jsx("div",{className:"grid grid-cols-3 gap-1",children:_k.map(S=>o.jsxs("button",{onClick:()=>{var A;if(S.color==="none")try{const P=(A=s.current)==null?void 0:A.get("modeling");P&&Wt&&(P.setColor([Wt],{fill:void 0,stroke:void 0}),k.success("Color removed"),fr(!1))}catch(P){console.error("Error removing color:",P),k.error("Failed to remove color")}else wk(S.color,S.label)},className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded transition-colors",title:S.label,children:[S.color==="none"?o.jsx("div",{className:"w-6 h-6 border-2 border-dashed border-foreground rounded flex items-center justify-center",children:o.jsx(wr,{className:"h-3 w-3"})}):o.jsx("div",{className:"w-6 h-6 rounded border-2 border-border",style:{backgroundColor:S.color}}),o.jsx("span",{className:"text-[8px] text-center leading-tight",children:S.name})]},S.name))})]}),o.jsxs("div",{className:"pt-2 border-t space-y-1",children:[o.jsx("p",{className:"text-[10px] font-bold text-muted-foreground",children:"CHANGE TO"}),o.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[o.jsxs("button",{onClick:()=>Cn("task"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded",title:"Task",children:[o.jsx("div",{className:"w-6 h-6 border-2 border-foreground rounded"}),o.jsx("span",{className:"text-[8px]",children:"Task"})]}),o.jsxs("button",{onClick:()=>Cn("start-event"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded",title:"Event",children:[o.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-green-600"}),o.jsx("span",{className:"text-[8px]",children:"Event"})]}),o.jsxs("button",{onClick:()=>Cn("xor-gateway"),className:"flex flex-col items-center gap-1 p-1.5 hover:bg-accent rounded",title:"Gateway",children:[o.jsx("div",{className:"w-6 h-6 border-2 border-amber-600 transform rotate-45"}),o.jsx("span",{className:"text-[8px]",children:"Gateway"})]})]})]})]})]}),o.jsx(hn,{open:Vu,onOpenChange:Bs,children:o.jsxs(en,{children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"Vision Modelling AI - Process from Images"}),o.jsxs(rn,{children:["Upload images containing process information:",o.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[o.jsxs("li",{children:[o.jsx("strong",{children:"Handwritten notes"})," - sketches and text"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Whiteboard diagrams"})," - flow drawings and ideas"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Process sketches"})," - rough workflow designs"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Meeting notes"})," - captured process discussions"]})]}),o.jsx("p",{className:"mt-2 text-sm",children:"AI will extract text, analyze the content, and generate a professional BPMN diagram."})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-8 text-center",children:[o.jsx(ch,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),o.jsxs(sn,{htmlFor:"vision-upload",className:"cursor-pointer",children:[o.jsx("span",{className:"text-sm font-medium",children:"Click to upload image"}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG - handwritten or printed content"})]}),o.jsx(Kt,{id:"vision-upload",type:"file",accept:"image/*",className:"hidden",onChange:yk,disabled:Xt})]}),ht&&o.jsx("div",{className:"text-center text-sm",children:o.jsxs("p",{className:"text-foreground",children:["Selected: ",o.jsx("strong",{children:ht.name})]})}),Xt&&o.jsx("div",{className:"text-center space-y-2",children:o.jsxs("div",{className:"text-sm text-muted-foreground",children:[o.jsx("p",{className:"font-medium",children:"Processing your image with AI..."}),o.jsx("p",{className:"text-xs mt-1",children:" Extracting text and analyzing content"}),o.jsx("p",{className:"text-xs",children:" Understanding process flow"}),o.jsx("p",{className:"text-xs",children:" Generating BPMN diagram"})]})})]})]})}),o.jsx(FB,{open:ve,onOpenChange:S=>{Ne(S),S||ee(null)},children:o.jsxs(gj,{children:[o.jsxs(vj,{children:[o.jsx(xj,{children:"Apply this alternative diagram?"}),o.jsx(bj,{children:"The current canvas will be replaced with the selected alternative. You can always undo or regenerate additional options."})]}),Q?o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium",children:Q.title}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:Q.description})]}),o.jsx(gr,{variant:Q.complexity==="advanced"?"default":"secondary",children:Q.complexity.toUpperCase()})]}),o.jsx(Fr,{className:"h-40 border rounded-md bg-muted/30",children:o.jsxs("pre",{className:"text-[11px] leading-4 p-3 whitespace-pre-wrap",children:[Q.xml.slice(0,1600),Q.xml.length>1600?`...

(Preview truncated)`:""]})})]}):o.jsx("p",{className:"text-sm text-muted-foreground",children:"Select an alternative to preview and apply it."}),o.jsxs(yj,{children:[o.jsx(_j,{children:"Not now"}),o.jsx(wj,{disabled:!Q,onClick:async()=>{Q&&(await ro(Q),ee(null),Ne(!1))},children:"Apply diagram"})]})]})}),o.jsx(hn,{open:Kc,onOpenChange:io,children:o.jsxs(en,{children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"Share via QR Code"}),o.jsx(rn,{children:"Generate a QR code to invite collaborators with view or edit permissions"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"border rounded-lg p-8 text-center bg-muted/30",children:[o.jsx(hv,{className:"h-32 w-32 mx-auto mb-4"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"QR Code will appear here"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(U,{onClick:bk,className:"flex-1",children:"Generate QR Code"}),o.jsx(U,{variant:"outline",className:"flex-1",children:"Set Permissions"})]})]})]})}),o.jsx(hn,{open:so,onOpenChange:S=>{li(S)},children:o.jsxs(en,{className:"max-w-xl",children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"Log Agent"}),o.jsx(rn,{children:"Store and audit BPMN diagram history for compliance, recovery, and review"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-8 text-center bg-muted/30",children:[o.jsx(ah,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),o.jsxs(sn,{htmlFor:"log-upload",className:"cursor-pointer flex flex-col gap-1",children:[o.jsx("span",{className:"text-sm font-medium",children:"Click to upload log file"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"CSV, JSON, TXT, or LOG format"})]}),o.jsx(Kt,{id:"log-upload",type:"file",accept:".csv,.json,.txt,.log",className:"hidden",onChange:xk,disabled:Xt})]}),Xt&&o.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Analyzing log file..."}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ah,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("p",{className:"text-sm font-medium",children:"Audit trail"})]}),o.jsxs(gr,{variant:"outline",children:[Ke.length," snapshots"]})]}),o.jsx(Fr,{className:"max-h-64 border rounded-md",children:o.jsx("div",{className:"divide-y",children:Te?o.jsx("div",{className:"p-4 text-sm text-muted-foreground",children:"Loading audit trail..."}):Ke.length?Ke.map(S=>{const A=Array.isArray(S.alternative_models)?S.alternative_models[0]:void 0,P=A&&typeof A=="object"&&typeof A.preview=="string"?A.preview:void 0;return o.jsxs("div",{className:"p-4 flex flex-col gap-3",children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium",children:S.input_description??"Manual save"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:S.created_at?new Date(S.created_at).toLocaleString():"Timestamp unavailable"}),S.input_type&&o.jsx(gr,{variant:"secondary",className:"mt-1 uppercase tracking-wide",children:S.input_type.replace(/[_-]/g," ")})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(cs,{children:[o.jsx(ls,{asChild:!0,children:o.jsx(U,{size:"sm",variant:"outline",children:"Download as"})}),o.jsxs(bi,{align:"end",className:"w-44",children:[o.jsx(Hl,{children:"Choose format"}),o.jsx(ra,{}),o.jsx(pt,{onClick:()=>ci(S.generated_bpmn_xml,S.input_description??"diagram-log"),children:"BPMN (.bpmn)"}),o.jsx(pt,{onClick:async()=>{try{const V=await Lr(S.generated_bpmn_xml),H=new Blob([V],{type:"image/svg+xml"});Qs(H,`${S.input_description??"diagram-log"}.svg`)}catch{k.error("Failed to export SVG")}},children:"SVG (.svg)"}),o.jsx(pt,{onClick:async()=>{try{const V=await Lr(S.generated_bpmn_xml),H=await Js(V,"image/png");Qs(H,`${S.input_description??"diagram-log"}.png`)}catch{k.error("Failed to export PNG")}},children:"PNG (.png)"}),o.jsx(pt,{onClick:async()=>{try{const V=await Lr(S.generated_bpmn_xml),H=await Js(V,"image/jpeg","#ffffff");Qs(H,`${S.input_description??"diagram-log"}.jpg`)}catch{k.error("Failed to export JPG")}},children:"JPG (.jpg)"}),o.jsx(pt,{onClick:async()=>{try{const V=await Lr(S.generated_bpmn_xml),H=await Js(V,"image/png","#ffffff"),O=URL.createObjectURL(H),te=window.open("","_blank");te?(te.document.write(`<html><head><title>${S.input_description??"diagram-log"}</title></head><body style="margin:0"><img src="${O}" style="width:100%;height:auto"/></body></html>`),te.document.close(),setTimeout(()=>{try{te.focus(),te.print()}catch{}},300)):k.info("Popup blocked. Enable popups to save as PDF.")}catch{k.error("Failed to prepare PDF. Use 'Print to PDF' from the opened image.")}},children:"PDF (via Print)"})]})]}),o.jsx(U,{size:"sm",onClick:()=>qc(S),children:"Load"})]})]}),P&&o.jsx("pre",{className:"text-xs bg-muted/60 border rounded-md p-3 whitespace-pre-wrap max-h-32 overflow-auto",children:P})]},S.id)}):o.jsx("div",{className:"p-4 text-sm text-muted-foreground",children:"No historical logs archived yet."})})})]})]})]})}),o.jsx(hn,{open:bn,onOpenChange:S=>{ao(S),S||q(null)},children:o.jsxs(en,{className:"max-w-2xl",children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"Modelling Agent Mode"}),o.jsx(rn,{children:"Compare 5-7 AI-generated BPMN variations, from streamlined to advanced, and apply the best fit"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"How many alternative diagrams would you like to generate?"}),o.jsx(Dj,{type:"single",value:String(de),onValueChange:S=>{!S||$||Be(Number(S))},className:"justify-start",children:[3,5,7].map(S=>o.jsx(Oj,{value:String(S),disabled:$,className:"px-4",children:S},S))}),o.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Adjust the batch size before generating or regenerating alternatives."})]}),$?o.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[o.jsx(On,{className:"h-8 w-8 animate-spin text-primary"}),o.jsxs("div",{className:"space-y-2 text-center",children:[o.jsxs("p",{className:"text-sm font-medium",children:["Generating ",F.total||de," alternative ",n==="pid"?"P&ID":"BPMN"," models in parallel..."]}),F.total>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[o.jsxs("span",{children:["Progress: ",F.completed," / ",F.total]}),o.jsxs("span",{children:[F.total?Math.round(F.completed/F.total*100):0,"%"]})]}),o.jsx("div",{className:"w-64 h-2 bg-muted rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-primary transition-all duration-300",style:{width:`${F.total?Math.min(100,F.completed/F.total*100):0}%`}})}),F.current&&o.jsxs("p",{className:"text-xs text-muted-foreground italic",children:["Processing: ",F.current]})]}),R.length>0&&o.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400",children:[" ",R.length," model",R.length!==1?"s":""," ready"]})]})]}):D?o.jsxs("div",{className:"border border-destructive/30 bg-destructive/10 rounded-lg p-4 space-y-3",children:[o.jsx("p",{className:"text-sm text-destructive font-medium",children:"Unable to prepare alternatives"}),o.jsx("p",{className:"text-xs text-destructive/80",children:D}),o.jsx(U,{size:"sm",variant:"outline",onClick:()=>ai(!0),children:"Retry"})]}):R.length?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid gap-6 md:grid-cols-[minmax(0,2fr)_minmax(0,1fr)]",children:[o.jsx("div",{className:"space-y-4",children:vt?o.jsxs("div",{className:"border rounded-lg p-5 space-y-4 bg-muted/40",children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(aa,{className:"h-4 w-4 text-primary"}),o.jsx("h4",{className:"text-base font-semibold",children:vt.title})]}),o.jsx("p",{className:"text-xs text-muted-foreground",children:vt.description})]}),o.jsx(gr,{variant:vt.complexity==="advanced"?"default":"secondary",children:vt.complexity.toUpperCase()})]}),vt.generatedAt&&o.jsxs("p",{className:"text-[11px] text-muted-foreground",children:["Generated ",new Date(vt.generatedAt).toLocaleString()]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase",children:"Diagram Preview"}),o.jsx("div",{className:"h-64 border rounded-md",style:{backgroundColor:"#ffffff"},children:o.jsx(Cb,{xml:vt.xml,title:vt.title})})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsxs(cs,{children:[o.jsx(ls,{asChild:!0,children:o.jsx(U,{size:"sm",variant:"outline",children:"Download as"})}),o.jsxs(bi,{align:"end",className:"w-44",children:[o.jsx(Hl,{children:"Choose format"}),o.jsx(ra,{}),o.jsx(pt,{onClick:()=>oi(vt),children:"BPMN (.bpmn)"}),o.jsx(pt,{onClick:async()=>{try{const S=await Lr(vt.xml),A=new Blob([S],{type:"image/svg+xml"});Qs(A,`${vt.title}.svg`)}catch{k.error("Failed to export SVG")}},children:"SVG (.svg)"}),o.jsx(pt,{onClick:async()=>{try{const S=await Lr(vt.xml),A=await Js(S,"image/png");Qs(A,`${vt.title}.png`)}catch{k.error("Failed to export PNG")}},children:"PNG (.png)"}),o.jsx(pt,{onClick:async()=>{try{const S=await Lr(vt.xml),A=await Js(S,"image/jpeg","#ffffff");Qs(A,`${vt.title}.jpg`)}catch{k.error("Failed to export JPG")}},children:"JPG (.jpg)"}),o.jsx(pt,{onClick:async()=>{try{const S=await Lr(vt.xml),A=await Js(S,"image/png","#ffffff"),P=URL.createObjectURL(A),V=window.open("","_blank");V?(V.document.write(`<html><head><title>${vt.title}</title></head><body style="margin:0"><img src="${P}" style="width:100%;height:auto"/></body></html>`),V.document.close(),setTimeout(()=>{try{V.focus(),V.print()}catch{}},300)):k.info("Popup blocked. Enable popups to save as PDF.")}catch{k.error("Failed to prepare PDF. Use 'Print to PDF' from the opened image.")}},children:"PDF (via Print)"})]})]}),o.jsx(U,{size:"sm",onClick:()=>{ee(vt),Ne(!0)},children:"Apply to canvas"})]})]}):o.jsx("div",{className:"border rounded-lg p-6 text-center text-sm text-muted-foreground bg-muted/30",children:"Select an alternative from the list to preview and apply it."})}),o.jsxs("div",{className:"border rounded-lg p-3 bg-background/70",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:["Alternatives (",R.length,")"]}),o.jsx("span",{className:"text-[11px] text-muted-foreground",children:"Click to preview & confirm"})]}),o.jsx(Fr,{className:"h-[30rem] pr-2",children:o.jsx("div",{className:"space-y-3",children:R.map(S=>{const A=S.id===$e;return o.jsxs("button",{type:"button",onClick:()=>pe(S.id),className:`w-full text-left border rounded-lg p-3 transition-all focus:outline-none ${A?"border-primary bg-primary/10 shadow-lg":"border-border hover:shadow-md"}`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"space-y-1 flex-1",children:[o.jsx("p",{className:"text-sm font-medium",children:S.title}),o.jsx("p",{className:"text-xs capitalize text-muted-foreground",children:S.complexity})]}),A&&o.jsx($n,{className:"h-5 w-5 text-primary flex-shrink-0"})]}),o.jsx("div",{className:"h-32 mt-2 rounded-md border",style:{backgroundColor:"#ffffff"},children:o.jsx(Cb,{xml:S.xml,title:S.title})})]},S.id)})})})]})]}),o.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[o.jsx("span",{className:"text-xs text-muted-foreground",children:"Compare variants side by side, then apply the one that fits your requirements."}),o.jsxs(U,{size:"sm",variant:"outline",onClick:()=>ai(!0),disabled:$,children:["Regenerate ",de]})]})]}):o.jsxs("div",{className:"border rounded-lg p-6 text-center bg-muted/40",children:[o.jsx(aa,{className:"h-16 w-16 mx-auto mb-4 text-primary"}),o.jsx("p",{className:"text-sm font-medium mb-2",children:"Preparing alternatives"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"We will analyze the current diagram and assemble 5-7 tailored variations, from core flow to advanced designs."}),o.jsx(U,{className:"mt-4",onClick:()=>ai(!0),disabled:$,children:"Generate alternatives"})]})]})]})}),o.jsx(hn,{open:Re,onOpenChange:S=>{ct(S)},children:o.jsxs(en,{className:"max-w-xl",children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"System Use Modelling"}),o.jsx(rn,{children:"Capture visits, clicks, and on-page context to generate BPMN models from real usage"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"border rounded-lg p-4 bg-muted/40 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(sv,{className:"h-10 w-10 text-primary"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold",children:"Detailed Behavior Tracking"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Log page visits, clicked elements, and page copy for downstream mining."})]})]}),o.jsx(gr,{variant:G?"default":"outline",children:G?"Active":"Paused"})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:G?o.jsxs(o.Fragment,{children:[o.jsx(U,{variant:"destructive",className:"flex-1",onClick:()=>void si(),children:"Stop Tracking"}),o.jsx(U,{variant:"outline",className:"flex-1",onClick:()=>void rs(),disabled:K.length===0,children:"Save Snapshot"})]}):o.jsx(U,{className:"flex-1",onClick:()=>{if(!u){k.error("Please sign in to enable tracking");return}ne(!0),xn(),k.success("System tracking enabled  capturing visits, clicks, and page context.")},children:"Enable Tracking"})}),o.jsxs("div",{children:[o.jsxs("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:["Tracked activity (",K.length,")"]}),o.jsx(Fr,{className:"max-h-60 border rounded-md",children:o.jsx("div",{className:"divide-y",children:K.length?K.map(S=>o.jsxs("div",{className:"flex items-start gap-3 p-3",children:[S.type==="visit"?o.jsx(c0,{className:"h-4 w-4 mt-1 text-primary"}):o.jsx(h2,{className:"h-4 w-4 mt-1 text-primary"}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-sm font-medium",children:S.type==="visit"?"Visited page":"User click"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(S.timestamp).toLocaleString()}),S.details.url&&o.jsx("p",{className:"text-xs break-all",children:S.details.url}),S.details.title&&o.jsxs("p",{className:"text-xs text-muted-foreground",children:["Title: ",S.details.title]}),S.details.text&&o.jsxs("p",{className:"text-xs text-muted-foreground",children:['"',S.details.text,'"']}),S.details.contentPreview&&o.jsxs("p",{className:"text-xs text-muted-foreground",children:["Preview: ",S.details.contentPreview]}),S.details.tag&&o.jsxs("p",{className:"text-[11px] text-muted-foreground",children:["Element: ",S.details.tag,S.details.xpath?`  ${S.details.xpath}`:""]}),S.details.referrer&&o.jsxs("p",{className:"text-[11px] text-muted-foreground",children:["Referrer: ",S.details.referrer]})]})]},S.id)):o.jsx("div",{className:"p-4 text-sm text-muted-foreground",children:"No activity captured yet. Enable tracking to begin logging interactions."})})})]})]})]})}),o.jsx(hn,{open:b,onOpenChange:S=>{if(S&&!p){k.error("Process Manager rights required");return}x(S)},children:o.jsxs(en,{className:"max-w-2xl",children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"Process Manager Console"}),o.jsx(rn,{children:"Exercise full editing control, lock or unlock the canvas, and grant or revoke collaborator rights."})]}),p?o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"border rounded-lg p-4 flex items-center justify-between bg-muted/40",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium",children:"Editing lock"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"When locked, collaborators can only view the diagram."})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(gr,{variant:g?"default":"outline",children:g?"Locked":"Unlocked"}),o.jsx(Vp,{id:"editing-lock",checked:g,onCheckedChange:S=>Uu(S)})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(w2,{className:"h-4 w-4 text-primary"}),o.jsx("p",{className:"text-sm font-medium",children:"Collaborators"})]}),o.jsx(gr,{variant:"outline",children:E.length})]}),o.jsx(Fr,{className:"max-h-72 border rounded-md",children:o.jsx("div",{className:"divide-y",children:j?o.jsx("div",{className:"p-4 text-sm text-muted-foreground",children:"Loading collaborators..."}):E.length?E.map(S=>{const A=S.roles.includes("admin");return o.jsxs("div",{className:"p-4 flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs("p",{className:"text-sm font-medium flex items-center gap-2",children:[S.email,S.userId===(u==null?void 0:u.id)&&o.jsx(gr,{variant:"outline",children:"You"})]}),o.jsx("p",{className:"text-xs text-muted-foreground",children:A?"Process Manager":"Collaborator"}),o.jsxs("p",{className:"text-[11px] text-muted-foreground",children:["Last active:"," ",S.lastLogin?new Date(S.lastLogin).toLocaleString():"No activity recorded"]})]}),S.userId!==(u==null?void 0:u.id)&&(A?o.jsx(U,{variant:"outline",size:"sm",onClick:()=>Ls(S.userId),children:"Remove access"}):o.jsx(U,{size:"sm",onClick:()=>Hu(S.userId),children:"Grant access"}))]},S.userId)}):o.jsx("div",{className:"p-4 text-sm text-muted-foreground",children:"No collaborators found."})})})]})]}):o.jsxs("div",{className:"border rounded-lg p-6 text-center bg-muted/40 space-y-2",children:[o.jsx("p",{className:"text-sm font-medium",children:"View-only access"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"You do not have Process Manager permissions. Please contact an administrator to update access rights."})]})]})}),Xc&&o.jsx(hn,{open:Xc,onOpenChange:Jc,children:o.jsxs(en,{className:"max-w-2xl",children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"Diagram Overview"}),o.jsx(rn,{children:"Edit process properties and metadata"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(sn,{children:"Process Name"}),o.jsx(Kt,{placeholder:"Enter process name"})]}),o.jsxs("div",{children:[o.jsx(sn,{children:"Process ID"}),o.jsx(Kt,{placeholder:"process-id"})]}),o.jsxs("div",{children:[o.jsx(sn,{children:"Description"}),o.jsx(Er,{placeholder:"Enter process description",rows:4})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx(U,{variant:"outline",onClick:()=>Jc(!1),children:"Cancel"}),o.jsx(U,{onClick:()=>{k.success("Properties saved"),Jc(!1)},children:"Save"})]})]})]})}),Qc&&o.jsx(hn,{open:Qc,onOpenChange:Wu,children:o.jsxs(en,{className:"max-w-2xl",children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"Participants / Pools & Lanes"}),o.jsx(rn,{children:"Manage collaboration elements"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"text-sm text-muted-foreground",children:"Manage pools, lanes, and participant assignments for your BPMN diagram."}),o.jsx(U,{onClick:()=>k.info("Add participant functionality - coming soon"),children:"Add Participant"}),o.jsx("div",{className:"flex justify-end gap-2",children:o.jsx(U,{variant:"outline",onClick:()=>Wu(!1),children:"Close"})})]})]})}),el&&o.jsx(hn,{open:el,onOpenChange:oo,children:o.jsxs(en,{className:"max-w-2xl",children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"Execution Settings"}),o.jsx(rn,{children:"Configure process engine options and metadata"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(sn,{children:"Process Version"}),o.jsx(Kt,{type:"number",defaultValue:"1"})]}),o.jsxs("div",{children:[o.jsx(sn,{children:"Process Namespace"}),o.jsx(Kt,{placeholder:"http://example.org/bpmn"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Vp,{id:"executable"}),o.jsx(sn,{htmlFor:"executable",children:"Executable Process"})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx(U,{variant:"outline",onClick:()=>oo(!1),children:"Cancel"}),o.jsx(U,{onClick:()=>{k.success("Settings saved"),oo(!1)},children:"Save"})]})]})]})}),tl&&o.jsx(hn,{open:tl,onOpenChange:nl,children:o.jsxs(en,{className:"max-w-2xl",children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"Element Documentation"}),o.jsx(rn,{children:"Add documentation for the selected element"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs(sn,{children:["Element: ",(Wt==null?void 0:Wt.id)||"None selected"]}),o.jsx(Er,{placeholder:"Enter element documentation",rows:6})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx(U,{variant:"outline",onClick:()=>nl(!1),children:"Cancel"}),o.jsx(U,{onClick:()=>{k.success("Documentation saved"),nl(!1)},children:"Save"})]})]})]})}),qu&&o.jsx(hn,{open:qu,onOpenChange:Ku,children:o.jsxs(en,{className:"max-w-2xl",children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"Validation Results"}),o.jsx(rn,{children:"BPMN structural validation issues"})]}),o.jsxs("div",{className:"space-y-4",children:[Og.length===0?o.jsxs("div",{className:"text-center py-8 text-green-600",children:[o.jsx($n,{className:"h-12 w-12 mx-auto mb-2"}),o.jsx("p",{className:"font-semibold",children:"No validation issues found!"})]}):o.jsx(Fr,{className:"h-[400px]",children:o.jsx("div",{className:"space-y-2",children:Og.map((S,A)=>o.jsx("div",{className:"p-3 border border-destructive/20 rounded-lg bg-destructive/5",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(gv,{className:"h-4 w-4 text-destructive mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium",children:S.message}),S.elementId&&o.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Element ID: ",S.elementId]})]})]})},A))})}),o.jsx("div",{className:"flex justify-end gap-2",children:o.jsx(U,{variant:"outline",onClick:()=>Ku(!1),children:"Close"})})]})]})})]})};var Iu="Tabs",[ZB,xz]=Vn(Iu,[wd]),$j=wd(),[XB,kg]=ZB(Iu),Lj=y.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:i,defaultValue:s,orientation:a="horizontal",dir:c,activationMode:l="automatic",...d}=t,u=mc(c),[h,p]=dr({prop:r,onChange:i,defaultProp:s??"",caller:Iu});return o.jsx(XB,{scope:n,baseId:La(),value:h,onValueChange:p,orientation:a,dir:u,activationMode:l,children:o.jsx(Pe.div,{dir:u,"data-orientation":a,...d,ref:e})})});Lj.displayName=Iu;var Bj="TabsList",Fj=y.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...i}=t,s=kg(Bj,n),a=$j(n);return o.jsx(_w,{asChild:!0,...a,orientation:s.orientation,dir:s.dir,loop:r,children:o.jsx(Pe.div,{role:"tablist","aria-orientation":s.orientation,...i,ref:e})})});Fj.displayName=Bj;var zj="TabsTrigger",Uj=y.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:i=!1,...s}=t,a=kg(zj,n),c=$j(n),l=Gj(a.baseId,r),d=Wj(a.baseId,r),u=r===a.value;return o.jsx(Ew,{asChild:!0,...c,focusable:!i,active:u,children:o.jsx(Pe.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:l,...s,ref:e,onMouseDown:Ee(t.onMouseDown,h=>{!i&&h.button===0&&h.ctrlKey===!1?a.onValueChange(r):h.preventDefault()}),onKeyDown:Ee(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&a.onValueChange(r)}),onFocus:Ee(t.onFocus,()=>{const h=a.activationMode!=="manual";!u&&!i&&h&&a.onValueChange(r)})})})});Uj.displayName=zj;var Hj="TabsContent",Vj=y.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:i,children:s,...a}=t,c=kg(Hj,n),l=Gj(c.baseId,r),d=Wj(c.baseId,r),u=r===c.value,h=y.useRef(u);return y.useEffect(()=>{const p=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(p)},[]),o.jsx(Oi,{present:i||u,children:({present:p})=>o.jsx(Pe.div,{"data-state":u?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":l,hidden:!p,id:d,tabIndex:0,...a,ref:e,style:{...t.style,animationDuration:h.current?"0s":void 0},children:p&&s})})});Vj.displayName=Hj;function Gj(t,e){return`${t}-trigger-${e}`}function Wj(t,e){return`${t}-content-${e}`}var qj=Lj,Mu=Fj,Du=Uj,Ou=Vj;const Cg=qj,$u=y.forwardRef(({className:t,...e},n)=>o.jsx(Mu,{ref:n,className:J("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));$u.displayName=Mu.displayName;const Wr=y.forwardRef(({className:t,...e},n)=>o.jsx(Du,{ref:n,className:J("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",t),...e}));Wr.displayName=Du.displayName;const qr=y.forwardRef(({className:t,...e},n)=>o.jsx(Ou,{ref:n,className:J("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));qr.displayName=Ou.displayName;const Kj=qj,Pg=y.forwardRef(({className:t,...e},n)=>o.jsx(Mu,{ref:n,className:J("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground relative gap-1",t),...e}));Pg.displayName=Mu.displayName;const ic=y.forwardRef(({className:t,children:e,...n},r)=>{const i=y.useRef(null),[s,a]=y.useState(!1);return y.useImperativeHandle(r,()=>i.current),y.useEffect(()=>{const c=()=>{i.current&&a(i.current.getAttribute("data-state")==="active")};c();const l=new MutationObserver(c);return i.current&&l.observe(i.current,{attributes:!0,attributeFilter:["data-state"]}),()=>l.disconnect()},[]),o.jsxs(Du,{ref:i,className:J("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 relative z-10 flex-1","data-[state=active]:text-foreground","hover:text-foreground/90",t),...n,children:[o.jsx("span",{className:"relative z-10 flex items-center justify-center w-full",children:e}),s&&o.jsx(he.div,{layoutId:"activeTabIndicator",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary",initial:!1,transition:{type:"spring",stiffness:380,damping:30,duration:.4}})]})});ic.displayName=Du.displayName;const sc=y.forwardRef(({className:t,...e},n)=>{const[r,i]=y.useState(1),s=y.useRef();return y.useEffect(()=>{if(s.current&&e.value){const a=parseInt(s.current)||0,c=parseInt(e.value)||0;i(c>a?1:-1)}s.current=e.value},[e.value]),o.jsx(nw,{mode:"wait",custom:r,children:o.jsx(Ou,{ref:n,className:J("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e,asChild:!0,children:o.jsx(he.div,{custom:r,initial:{opacity:0,x:r*20},animate:{opacity:1,x:0},exit:{opacity:0,x:r*-20},transition:{opacity:{duration:.3},x:{duration:.2},ease:"easeInOut"},children:e.children})},e.value)})});sc.displayName=Ou.displayName;var JB=[" ","Enter","ArrowUp","ArrowDown"],QB=[" ","Enter"],Ns="Select",[Lu,Bu,e6]=of(Ns),[Qa,bz]=Vn(Ns,[e6,xd]),Fu=xd(),[t6,Ji]=Qa(Ns),[n6,r6]=Qa(Ns),Yj=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:i,onOpenChange:s,value:a,defaultValue:c,onValueChange:l,dir:d,name:u,autoComplete:h,disabled:p,required:f,form:m}=t,v=Fu(e),[g,w]=y.useState(null),[b,x]=y.useState(null),[E,N]=y.useState(!1),j=mc(d),[C,R]=dr({prop:r,defaultProp:i??!1,onChange:s,caller:Ns}),[T,$]=dr({prop:a,defaultProp:c,onChange:l,caller:Ns}),B=y.useRef(null),D=g?m||!!g.closest("form"):!0,[q,F]=y.useState(new Set),xe=Array.from(q).map(de=>de.props.value).join(";");return o.jsx(Vk,{...v,children:o.jsxs(t6,{required:f,scope:e,trigger:g,onTriggerChange:w,valueNode:b,onValueNodeChange:x,valueNodeHasChildren:E,onValueNodeHasChildrenChange:N,contentId:La(),value:T,onValueChange:$,open:C,onOpenChange:R,dir:j,triggerPointerDownPosRef:B,disabled:p,children:[o.jsx(Lu.Provider,{scope:e,children:o.jsx(n6,{scope:t.__scopeSelect,onNativeOptionAdd:y.useCallback(de=>{F(Be=>new Set(Be).add(de))},[]),onNativeOptionRemove:y.useCallback(de=>{F(Be=>{const $e=new Set(Be);return $e.delete(de),$e})},[]),children:n})}),D?o.jsxs(xN,{"aria-hidden":!0,required:f,tabIndex:-1,name:u,autoComplete:h,value:T,onChange:de=>$(de.target.value),disabled:p,form:m,children:[T===void 0?o.jsx("option",{value:""}):null,Array.from(q)]},xe):null]})})};Yj.displayName=Ns;var Zj="SelectTrigger",Xj=y.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...i}=t,s=Fu(n),a=Ji(Zj,n),c=a.disabled||r,l=gt(e,a.onTriggerChange),d=Bu(n),u=y.useRef("touch"),[h,p,f]=wN(v=>{const g=d().filter(x=>!x.disabled),w=g.find(x=>x.value===a.value),b=_N(g,v,w);b!==void 0&&a.onValueChange(b.value)}),m=v=>{c||(a.onOpenChange(!0),f()),v&&(a.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return o.jsx(sw,{asChild:!0,...s,children:o.jsx(Pe.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":bN(a.value)?"":void 0,...i,ref:l,onClick:Ee(i.onClick,v=>{v.currentTarget.focus(),u.current!=="mouse"&&m(v)}),onPointerDown:Ee(i.onPointerDown,v=>{u.current=v.pointerType;const g=v.target;g.hasPointerCapture(v.pointerId)&&g.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(m(v),v.preventDefault())}),onKeyDown:Ee(i.onKeyDown,v=>{const g=h.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&p(v.key),!(g&&v.key===" ")&&JB.includes(v.key)&&(m(),v.preventDefault())})})})});Xj.displayName=Zj;var Jj="SelectValue",Qj=y.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,children:s,placeholder:a="",...c}=t,l=Ji(Jj,n),{onValueNodeHasChildrenChange:d}=l,u=s!==void 0,h=gt(e,l.onValueNodeChange);return jn(()=>{d(u)},[d,u]),o.jsx(Pe.span,{...c,ref:h,style:{pointerEvents:"none"},children:bN(l.value)?o.jsx(o.Fragment,{children:a}):s})});Qj.displayName=Jj;var i6="SelectIcon",eN=y.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...i}=t;return o.jsx(Pe.span,{"aria-hidden":!0,...i,ref:e,children:r||""})});eN.displayName=i6;var s6="SelectPortal",tN=t=>o.jsx(iw,{asChild:!0,...t});tN.displayName=s6;var ks="SelectContent",nN=y.forwardRef((t,e)=>{const n=Ji(ks,t.__scopeSelect),[r,i]=y.useState();if(jn(()=>{i(new DocumentFragment)},[]),!n.open){const s=r;return s?yd.createPortal(o.jsx(rN,{scope:t.__scopeSelect,children:o.jsx(Lu.Slot,{scope:t.__scopeSelect,children:o.jsx("div",{children:t.children})})}),s):null}return o.jsx(iN,{...t,ref:e})});nN.displayName=ks;var tr=10,[rN,Qi]=Qa(ks),a6="SelectContentImpl",o6=Hk("SelectContent.RemoveScroll"),iN=y.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:s,onPointerDownOutside:a,side:c,sideOffset:l,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:p,collisionPadding:f,sticky:m,hideWhenDetached:v,avoidCollisions:g,...w}=t,b=Ji(ks,n),[x,E]=y.useState(null),[N,j]=y.useState(null),C=gt(e,re=>E(re)),[R,T]=y.useState(null),[$,B]=y.useState(null),D=Bu(n),[q,F]=y.useState(!1),xe=y.useRef(!1);y.useEffect(()=>{if(x)return Bk(x)},[x]),Fk();const de=y.useCallback(re=>{const[Fe,...Qe]=D().map(G=>G.ref.current),[K]=Qe.slice(-1),M=document.activeElement;for(const G of re)if(G===M||(G==null||G.scrollIntoView({block:"nearest"}),G===Fe&&N&&(N.scrollTop=0),G===K&&N&&(N.scrollTop=N.scrollHeight),G==null||G.focus(),document.activeElement!==M))return},[D,N]),Be=y.useCallback(()=>de([R,x]),[de,R,x]);y.useEffect(()=>{q&&Be()},[q,Be]);const{onOpenChange:$e,triggerPointerDownPosRef:pe}=b;y.useEffect(()=>{if(x){let re={x:0,y:0};const Fe=K=>{var M,G;re={x:Math.abs(Math.round(K.pageX)-(((M=pe.current)==null?void 0:M.x)??0)),y:Math.abs(Math.round(K.pageY)-(((G=pe.current)==null?void 0:G.y)??0))}},Qe=K=>{re.x<=10&&re.y<=10?K.preventDefault():x.contains(K.target)||$e(!1),document.removeEventListener("pointermove",Fe),pe.current=null};return pe.current!==null&&(document.addEventListener("pointermove",Fe),document.addEventListener("pointerup",Qe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Fe),document.removeEventListener("pointerup",Qe,{capture:!0})}}},[x,$e,pe]),y.useEffect(()=>{const re=()=>$e(!1);return window.addEventListener("blur",re),window.addEventListener("resize",re),()=>{window.removeEventListener("blur",re),window.removeEventListener("resize",re)}},[$e]);const[Ke,Ye]=wN(re=>{const Fe=D().filter(M=>!M.disabled),Qe=Fe.find(M=>M.ref.current===document.activeElement),K=_N(Fe,re,Qe);K&&setTimeout(()=>K.ref.current.focus())}),Te=y.useCallback((re,Fe,Qe)=>{const K=!xe.current&&!Qe;(b.value!==void 0&&b.value===Fe||K)&&(T(re),K&&(xe.current=!0))},[b.value]),Se=y.useCallback(()=>x==null?void 0:x.focus(),[x]),_e=y.useCallback((re,Fe,Qe)=>{const K=!xe.current&&!Qe;(b.value!==void 0&&b.value===Fe||K)&&B(re)},[b.value]),ut=r==="popper"?Wp:sN,_t=ut===Wp?{side:c,sideOffset:l,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:p,collisionPadding:f,sticky:m,hideWhenDetached:v,avoidCollisions:g}:{};return o.jsx(rN,{scope:n,content:x,viewport:N,onViewportChange:j,itemRefCallback:Te,selectedItem:R,onItemLeave:Se,itemTextRefCallback:_e,focusSelectedItem:Be,selectedItemText:$,position:r,isPositioned:q,searchRef:Ke,children:o.jsx(zk,{as:o6,allowPinchZoom:!0,children:o.jsx(Uk,{asChild:!0,trapped:b.open,onMountAutoFocus:re=>{re.preventDefault()},onUnmountAutoFocus:Ee(i,re=>{var Fe;(Fe=b.trigger)==null||Fe.focus({preventScroll:!0}),re.preventDefault()}),children:o.jsx(aw,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:re=>re.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:o.jsx(ut,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:re=>re.preventDefault(),...w,..._t,onPlaced:()=>F(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:Ee(w.onKeyDown,re=>{const Fe=re.ctrlKey||re.altKey||re.metaKey;if(re.key==="Tab"&&re.preventDefault(),!Fe&&re.key.length===1&&Ye(re.key),["ArrowUp","ArrowDown","Home","End"].includes(re.key)){let K=D().filter(M=>!M.disabled).map(M=>M.ref.current);if(["ArrowUp","End"].includes(re.key)&&(K=K.slice().reverse()),["ArrowUp","ArrowDown"].includes(re.key)){const M=re.target,G=K.indexOf(M);K=K.slice(G+1)}setTimeout(()=>de(K)),re.preventDefault()}})})})})})})});iN.displayName=a6;var c6="SelectItemAlignedPosition",sN=y.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...i}=t,s=Ji(ks,n),a=Qi(ks,n),[c,l]=y.useState(null),[d,u]=y.useState(null),h=gt(e,C=>u(C)),p=Bu(n),f=y.useRef(!1),m=y.useRef(!0),{viewport:v,selectedItem:g,selectedItemText:w,focusSelectedItem:b}=a,x=y.useCallback(()=>{if(s.trigger&&s.valueNode&&c&&d&&v&&g&&w){const C=s.trigger.getBoundingClientRect(),R=d.getBoundingClientRect(),T=s.valueNode.getBoundingClientRect(),$=w.getBoundingClientRect();if(s.dir!=="rtl"){const M=$.left-R.left,G=T.left-M,ne=C.left-G,Q=C.width+ne,ee=Math.max(Q,R.width),ve=window.innerWidth-tr,Ne=Gp(G,[tr,Math.max(tr,ve-ee)]);c.style.minWidth=Q+"px",c.style.left=Ne+"px"}else{const M=R.right-$.right,G=window.innerWidth-T.right-M,ne=window.innerWidth-C.right-G,Q=C.width+ne,ee=Math.max(Q,R.width),ve=window.innerWidth-tr,Ne=Gp(G,[tr,Math.max(tr,ve-ee)]);c.style.minWidth=Q+"px",c.style.right=Ne+"px"}const B=p(),D=window.innerHeight-tr*2,q=v.scrollHeight,F=window.getComputedStyle(d),xe=parseInt(F.borderTopWidth,10),de=parseInt(F.paddingTop,10),Be=parseInt(F.borderBottomWidth,10),$e=parseInt(F.paddingBottom,10),pe=xe+de+q+$e+Be,Ke=Math.min(g.offsetHeight*5,pe),Ye=window.getComputedStyle(v),Te=parseInt(Ye.paddingTop,10),Se=parseInt(Ye.paddingBottom,10),_e=C.top+C.height/2-tr,ut=D-_e,_t=g.offsetHeight/2,re=g.offsetTop+_t,Fe=xe+de+re,Qe=pe-Fe;if(Fe<=_e){const M=B.length>0&&g===B[B.length-1].ref.current;c.style.bottom="0px";const G=d.clientHeight-v.offsetTop-v.offsetHeight,ne=Math.max(ut,_t+(M?Se:0)+G+Be),Q=Fe+ne;c.style.height=Q+"px"}else{const M=B.length>0&&g===B[0].ref.current;c.style.top="0px";const ne=Math.max(_e,xe+v.offsetTop+(M?Te:0)+_t)+Qe;c.style.height=ne+"px",v.scrollTop=Fe-_e+v.offsetTop}c.style.margin=`${tr}px 0`,c.style.minHeight=Ke+"px",c.style.maxHeight=D+"px",r==null||r(),requestAnimationFrame(()=>f.current=!0)}},[p,s.trigger,s.valueNode,c,d,v,g,w,s.dir,r]);jn(()=>x(),[x]);const[E,N]=y.useState();jn(()=>{d&&N(window.getComputedStyle(d).zIndex)},[d]);const j=y.useCallback(C=>{C&&m.current===!0&&(x(),b==null||b(),m.current=!1)},[x,b]);return o.jsx(d6,{scope:n,contentWrapper:c,shouldExpandOnScrollRef:f,onScrollButtonChange:j,children:o.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:E},children:o.jsx(Pe.div,{...i,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});sN.displayName=c6;var l6="SelectPopperPosition",Wp=y.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:i=tr,...s}=t,a=Fu(n);return o.jsx(ow,{...a,...s,ref:e,align:r,collisionPadding:i,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Wp.displayName=l6;var[d6,Tg]=Qa(ks,{}),qp="SelectViewport",aN=y.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:r,...i}=t,s=Qi(qp,n),a=Tg(qp,n),c=gt(e,s.onViewportChange),l=y.useRef(0);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),o.jsx(Lu.Slot,{scope:n,children:o.jsx(Pe.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Ee(i.onScroll,d=>{const u=d.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:p}=a;if(p!=null&&p.current&&h){const f=Math.abs(l.current-u.scrollTop);if(f>0){const m=window.innerHeight-tr*2,v=parseFloat(h.style.minHeight),g=parseFloat(h.style.height),w=Math.max(v,g);if(w<m){const b=w+f,x=Math.min(m,b),E=b-x;h.style.height=x+"px",h.style.bottom==="0px"&&(u.scrollTop=E>0?E:0,h.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});aN.displayName=qp;var oN="SelectGroup",[u6,h6]=Qa(oN),p6=y.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=La();return o.jsx(u6,{scope:n,id:i,children:o.jsx(Pe.div,{role:"group","aria-labelledby":i,...r,ref:e})})});p6.displayName=oN;var cN="SelectLabel",lN=y.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=h6(cN,n);return o.jsx(Pe.div,{id:i.id,...r,ref:e})});lN.displayName=cN;var dd="SelectItem",[f6,dN]=Qa(dd),uN=y.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:i=!1,textValue:s,...a}=t,c=Ji(dd,n),l=Qi(dd,n),d=c.value===r,[u,h]=y.useState(s??""),[p,f]=y.useState(!1),m=gt(e,b=>{var x;return(x=l.itemRefCallback)==null?void 0:x.call(l,b,r,i)}),v=La(),g=y.useRef("touch"),w=()=>{i||(c.onValueChange(r),c.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return o.jsx(f6,{scope:n,value:r,disabled:i,textId:v,isSelected:d,onItemTextChange:y.useCallback(b=>{h(x=>x||((b==null?void 0:b.textContent)??"").trim())},[]),children:o.jsx(Lu.ItemSlot,{scope:n,value:r,disabled:i,textValue:u,children:o.jsx(Pe.div,{role:"option","aria-labelledby":v,"data-highlighted":p?"":void 0,"aria-selected":d&&p,"data-state":d?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...a,ref:m,onFocus:Ee(a.onFocus,()=>f(!0)),onBlur:Ee(a.onBlur,()=>f(!1)),onClick:Ee(a.onClick,()=>{g.current!=="mouse"&&w()}),onPointerUp:Ee(a.onPointerUp,()=>{g.current==="mouse"&&w()}),onPointerDown:Ee(a.onPointerDown,b=>{g.current=b.pointerType}),onPointerMove:Ee(a.onPointerMove,b=>{var x;g.current=b.pointerType,i?(x=l.onItemLeave)==null||x.call(l):g.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ee(a.onPointerLeave,b=>{var x;b.currentTarget===document.activeElement&&((x=l.onItemLeave)==null||x.call(l))}),onKeyDown:Ee(a.onKeyDown,b=>{var E;((E=l.searchRef)==null?void 0:E.current)!==""&&b.key===" "||(QB.includes(b.key)&&w(),b.key===" "&&b.preventDefault())})})})})});uN.displayName=dd;var Ro="SelectItemText",hN=y.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,...s}=t,a=Ji(Ro,n),c=Qi(Ro,n),l=dN(Ro,n),d=r6(Ro,n),[u,h]=y.useState(null),p=gt(e,w=>h(w),l.onItemTextChange,w=>{var b;return(b=c.itemTextRefCallback)==null?void 0:b.call(c,w,l.value,l.disabled)}),f=u==null?void 0:u.textContent,m=y.useMemo(()=>o.jsx("option",{value:l.value,disabled:l.disabled,children:f},l.value),[l.disabled,l.value,f]),{onNativeOptionAdd:v,onNativeOptionRemove:g}=d;return jn(()=>(v(m),()=>g(m)),[v,g,m]),o.jsxs(o.Fragment,{children:[o.jsx(Pe.span,{id:l.textId,...s,ref:p}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?yd.createPortal(s.children,a.valueNode):null]})});hN.displayName=Ro;var pN="SelectItemIndicator",fN=y.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return dN(pN,n).isSelected?o.jsx(Pe.span,{"aria-hidden":!0,...r,ref:e}):null});fN.displayName=pN;var Kp="SelectScrollUpButton",mN=y.forwardRef((t,e)=>{const n=Qi(Kp,t.__scopeSelect),r=Tg(Kp,t.__scopeSelect),[i,s]=y.useState(!1),a=gt(e,r.onScrollButtonChange);return jn(()=>{if(n.viewport&&n.isPositioned){let c=function(){const d=l.scrollTop>0;s(d)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),i?o.jsx(vN,{...t,ref:a,onAutoScroll:()=>{const{viewport:c,selectedItem:l}=n;c&&l&&(c.scrollTop=c.scrollTop-l.offsetHeight)}}):null});mN.displayName=Kp;var Yp="SelectScrollDownButton",gN=y.forwardRef((t,e)=>{const n=Qi(Yp,t.__scopeSelect),r=Tg(Yp,t.__scopeSelect),[i,s]=y.useState(!1),a=gt(e,r.onScrollButtonChange);return jn(()=>{if(n.viewport&&n.isPositioned){let c=function(){const d=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<d;s(u)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),i?o.jsx(vN,{...t,ref:a,onAutoScroll:()=>{const{viewport:c,selectedItem:l}=n;c&&l&&(c.scrollTop=c.scrollTop+l.offsetHeight)}}):null});gN.displayName=Yp;var vN=y.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...i}=t,s=Qi("SelectScrollButton",n),a=y.useRef(null),c=Bu(n),l=y.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return y.useEffect(()=>()=>l(),[l]),jn(()=>{var u;const d=c().find(h=>h.ref.current===document.activeElement);(u=d==null?void 0:d.ref.current)==null||u.scrollIntoView({block:"nearest"})},[c]),o.jsx(Pe.div,{"aria-hidden":!0,...i,ref:e,style:{flexShrink:0,...i.style},onPointerDown:Ee(i.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:Ee(i.onPointerMove,()=>{var d;(d=s.onItemLeave)==null||d.call(s),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:Ee(i.onPointerLeave,()=>{l()})})}),m6="SelectSeparator",yN=y.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return o.jsx(Pe.div,{"aria-hidden":!0,...r,ref:e})});yN.displayName=m6;var Zp="SelectArrow",g6=y.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=Fu(n),s=Ji(Zp,n),a=Qi(Zp,n);return s.open&&a.position==="popper"?o.jsx(cw,{...i,...r,ref:e}):null});g6.displayName=Zp;var v6="SelectBubbleInput",xN=y.forwardRef(({__scopeSelect:t,value:e,...n},r)=>{const i=y.useRef(null),s=gt(r,i),a=TS(e);return y.useEffect(()=>{const c=i.current;if(!c)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==e&&u){const h=new Event("change",{bubbles:!0});u.call(c,e),c.dispatchEvent(h)}},[a,e]),o.jsx(Pe.select,{...n,style:{...Bw,...n.style},ref:s,defaultValue:e})});xN.displayName=v6;function bN(t){return t===""||t===void 0}function wN(t){const e=Tn(t),n=y.useRef(""),r=y.useRef(0),i=y.useCallback(a=>{const c=n.current+a;e(c),function l(d){n.current=d,window.clearTimeout(r.current),d!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(c)},[e]),s=y.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return y.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,i,s]}function _N(t,e,n){const i=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let a=y6(t,Math.max(s,0));i.length===1&&(a=a.filter(d=>d!==n));const l=a.find(d=>d.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function y6(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var x6=Yj,EN=Xj,b6=Qj,w6=eN,_6=tN,SN=nN,E6=aN,jN=lN,NN=uN,S6=hN,j6=fN,kN=mN,CN=gN,PN=yN;const Xp=x6,Jp=b6,ud=y.forwardRef(({className:t,children:e,...n},r)=>o.jsxs(EN,{ref:r,className:J("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,o.jsx(w6,{asChild:!0,children:o.jsx(Sf,{className:"h-4 w-4 opacity-50"})})]}));ud.displayName=EN.displayName;const TN=y.forwardRef(({className:t,...e},n)=>o.jsx(kN,{ref:n,className:J("flex cursor-default items-center justify-center py-1",t),...e,children:o.jsx(ZC,{className:"h-4 w-4"})}));TN.displayName=kN.displayName;const RN=y.forwardRef(({className:t,...e},n)=>o.jsx(CN,{ref:n,className:J("flex cursor-default items-center justify-center py-1",t),...e,children:o.jsx(Sf,{className:"h-4 w-4"})}));RN.displayName=CN.displayName;const hd=y.forwardRef(({className:t,children:e,position:n="popper",...r},i)=>o.jsx(_6,{children:o.jsxs(SN,{ref:i,className:J("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[o.jsx(TN,{}),o.jsx(E6,{className:J("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),o.jsx(RN,{})]})}));hd.displayName=SN.displayName;const N6=y.forwardRef(({className:t,...e},n)=>o.jsx(jN,{ref:n,className:J("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));N6.displayName=jN.displayName;const Ce=y.forwardRef(({className:t,children:e,...n},r)=>o.jsxs(NN,{ref:r,className:J("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...n,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(j6,{children:o.jsx($n,{className:"h-4 w-4"})})}),o.jsx(S6,{children:e})]}));Ce.displayName=NN.displayName;const k6=y.forwardRef(({className:t,...e},n)=>o.jsx(PN,{ref:n,className:J("-mx-1 my-1 h-px bg-muted",t),...e}));k6.displayName=PN.displayName;const C6=["Create a customer onboarding process","Design an order fulfillment workflow","Build a support ticket resolution process","Generate an employee hiring workflow","Create an invoice approval process"],P6=({user:t})=>{const e=Ps(),n=Bi(),{remainingPrompts:r,hasUsedAllPrompts:i,usePrompt:s,isUnlimited:a}=h_(!!t),[c,l]=y.useState(""),[d,u]=y.useState(!1),[h,p]=y.useState(null),[f,m]=y.useState("bpmn"),[v,g]=y.useState(!1),[w,b]=y.useState("en-US"),[x,E]=y.useState(null),[N,j]=y.useState(!1),[C,R]=y.useState(""),[T,$]=y.useState(!1),[B,D]=y.useState("idle"),[q,F]=y.useState("idle"),[xe,de]=y.useState(!1),[Be,$e]=y.useState(null),[pe,Ke]=y.useState(!1),Ye=y.useRef(null),Te=y.useRef(null),Se=y.useRef(null);y.useEffect(()=>{const M=localStorage.getItem("diagramType")||"bpmn",G=M==="bpmn"?"generatedBpmn":"generatedPid",ne=localStorage.getItem(G);if(ne){p(ne),localStorage.removeItem(G),localStorage.removeItem("diagramType");const Q=M==="bpmn"?"BPMN":"P&ID";k.success(`Your generated ${Q} diagram is ready!`,{description:"You can now view and edit your process diagram"}),setTimeout(()=>{var ee;(ee=document.getElementById("bpmn-viewer"))==null||ee.scrollIntoView({behavior:"smooth",block:"start"})},500)}},[]),y.useEffect(()=>{if(!Be)return;let M;const G=async()=>{const{data:ee,error:ve}=await oe.from("vision_bpmn_jobs").select("status, bpmn_xml, error_message").eq("id",Be).single();if(ve){console.error("Error checking job status:",ve);return}if(console.log("Job status:",ee.status),ee.status==="completed"&&ee.bpmn_xml){const Ne=f==="bpmn"?"BPMN":"P&ID";p(ee.bpmn_xml),F("idle"),u(!1),$e(null),j(!1),E(null),k.success(`${Ne} diagram generated successfully!`),setTimeout(()=>{var et;(et=document.getElementById("bpmn-viewer"))==null||et.scrollIntoView({behavior:"smooth",block:"start"})},500),M&&clearInterval(M)}else if(ee.status==="failed"){const Ne=ee.error_message||"Processing failed. Please try again.";F("idle"),u(!1),$e(null),k.error("Upload failed",{description:Ne,action:{label:"Retry",onClick:()=>{}},duration:1e4}),M&&clearInterval(M)}},ne=oe.channel(`job-${Be}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"vision_bpmn_jobs",filter:`id=eq.${Be}`},ee=>{const ve=ee.new;if(console.log("Realtime job status update:",ve.status),ve.status==="completed"&&ve.bpmn_xml){const Ne=f==="bpmn"?"BPMN":"P&ID";p(ve.bpmn_xml),F("idle"),u(!1),$e(null),j(!1),E(null),k.success(`${Ne} diagram generated successfully!`),setTimeout(()=>{var et;(et=document.getElementById("bpmn-viewer"))==null||et.scrollIntoView({behavior:"smooth",block:"start"})},500),M&&clearInterval(M)}else if(ve.status==="failed"){const Ne=ve.error_message||"Processing failed. Please try again.";F("idle"),u(!1),$e(null),k.error("Upload failed",{description:Ne,action:{label:"Retry",onClick:()=>{x&&Qe()}},duration:1e4}),M&&clearInterval(M)}}).subscribe();M=window.setInterval(G,3e3),G();const Q=window.setTimeout(()=>{M&&clearInterval(M);const ee="Processing timed out - Please try refreshing the page or contact support";F("idle"),u(!1),$e(null),k.error("Upload failed",{description:ee,action:{label:"Retry",onClick:()=>{x&&Qe()}},duration:1e4})},3e5);return()=>{clearTimeout(Q),oe.removeChannel(ne),M&&clearInterval(M)}},[Be,f,x]);const _e=async M=>{var ne,Q;if(!M.trim()){k.error("Please enter a process description");return}if(!t&&i){k.error("You've used all 5 free prompts. Please sign up to continue!"),e("/auth");return}if(!t&&!s()){k.error("You've used all 5 free prompts. Please sign up to continue!"),e("/auth");return}u(!0);const G=f==="bpmn"?"BPMN":"P&ID";F("reading"),await new Promise(ee=>setTimeout(ee,500)),F("generating");try{const{data:ee,error:ve}=await oe.functions.invoke("generate-bpmn",{body:{prompt:M,diagramType:f},headers:t?void 0:{Authorization:""}});if(ve){console.error("Function error:",ve),F("idle"),(ne=ve.message)!=null&&ne.includes("429")?k.error("Rate limit exceeded. Please try again in a moment."):(Q=ve.message)!=null&&Q.includes("402")?k.error("AI credits depleted. Please add more credits to continue."):k.error(`Failed to generate ${G} model`);return}F("drawing"),await new Promise(Ne=>setTimeout(Ne,500)),ee!=null&&ee.bpmnXml?(p(ee.bpmnXml),F("idle"),k.success(`${G} model generated successfully!`)):(F("idle"),k.error("No diagram data received"))}catch(ee){console.error("Error generating BPMN:",ee),F("idle"),k.error("An error occurred while generating the model")}finally{u(!1)}},ut=()=>{_e(c),l("")},_t=M=>{l(M)},re=async M=>{var et,zt;const G="dataTransfer"in M?(et=M.dataTransfer.files)==null?void 0:et[0]:(zt=M.target.files)==null?void 0:zt[0];if(!G)return;const{data:{user:ne},error:Q}=await oe.auth.getUser();if(Q||!ne){k.error("Please log in to upload and analyze documents"),e("/auth");return}if(!["image/png","image/jpeg","image/jpg","image/webp","application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","text/plain"].includes(G.type)){k.error("Please upload an image, PDF, Word document, or text file");return}u(!0);const ve=f==="bpmn"?"BPMN":"P&ID";k.info(`Analyzing document and generating ${ve}...`);const Ne=new FileReader;Ne.onloadend=async()=>{const ns=Ne.result;E({name:G.name,type:G.type,base64:ns}),j(!0),u(!1),k.success(`File uploaded! Review the preview before generating ${ve}.`)},Ne.readAsDataURL(G)},Fe=async()=>{if(v)Te.current&&Te.current.state==="recording"&&Te.current.stop(),Se.current&&(Se.current.getTracks().forEach(M=>M.stop()),Se.current=null),g(!1),Te.current=null;else try{const M=await navigator.mediaDevices.getUserMedia({audio:!0});Se.current=M;const G=new MediaRecorder(M),ne=[];G.ondataavailable=Q=>{ne.push(Q.data)},G.onstop=async()=>{const Q=new Blob(ne,{type:"audio/webm"}),ee=new FileReader;ee.readAsDataURL(Q),ee.onloadend=async()=>{var Ne;const ve=(Ne=ee.result)==null?void 0:Ne.toString().split(",")[1];try{const{data:et,error:zt}=await oe.functions.invoke("speech-to-text",{body:{audio:ve,language:w},headers:t?void 0:{Authorization:""}});if(zt)throw zt;et!=null&&et.text&&(l(et.text),k.success("Voice recorded successfully!"))}catch(et){console.error("Speech-to-text error:",et),k.error("Failed to convert speech to text.")}},Se.current&&(Se.current.getTracks().forEach(ve=>ve.stop()),Se.current=null)},G.start(),Te.current=G,g(!0),k.info("Recording... Click again to stop")}catch(M){console.error("Error accessing microphone:",M),k.error("Could not access microphone. Please check permissions.")}},Qe=async()=>{if(x){u(!0),j(!1),F("reading"),await new Promise(M=>setTimeout(M,500)),F("generating");try{const{data:{user:M}}=await oe.auth.getUser();if(!M){F("idle"),k.error("Please log in to continue"),e("/auth");return}const G=x.base64.length*.75,ne=200*1024*1024;if(G>ne){F("idle"),u(!1),k.error("File too large",{description:"Maximum file size is 200 MB. Please select a smaller file."});return}const Q=k.loading("Processing your file...",{description:"This may take 30-60 seconds for complex diagrams"}),{data:ee,error:ve}=await oe.functions.invoke("vision-to-bpmn",{body:{imageBase64:x.base64,diagramType:f},headers:t?void 0:{Authorization:""}});if(k.dismiss(Q),ve){console.error("Vision AI error:",ve),F("idle"),u(!1);const Ne=ve.message||"Failed to start diagram generation";k.error("Upload failed",{description:Ne,action:{label:"Retry",onClick:()=>{Qe()}},duration:1e4});return}if(!ee||!ee.jobId){F("idle"),u(!1),k.error("Upload failed",{description:"Failed to start processing",action:{label:"Retry",onClick:()=>{Qe()}},duration:1e4});return}$e(ee.jobId),F("generating"),k.info("Processing started",{description:"We'll notify you when your diagram is ready (this may take 1-2 minutes)"})}catch(M){console.error("Vision AI processing error:",M),F("idle"),u(!1);const G=M instanceof Error?M.message:"Network error - Please check your connection and try again";k.error("Upload failed",{description:G,action:{label:"Retry",onClick:()=>{Qe()}},duration:1e4})}}},K=async()=>{if(!h||!C.trim()){const ne=f==="bpmn"?"BPMN":"P&ID";k.error(`Please enter instructions to refine the ${ne}`);return}const{data:{user:M}}=await oe.auth.getUser();if(!M){const ne=f==="bpmn"?"BPMN":"P&ID";k.error(`Please log in to refine ${ne}`),e("/auth");return}$(!0);const G=f==="bpmn"?"BPMN":"P&ID";k.info(`Refining ${G} based on your instructions...`),D("analyzing"),await new Promise(ne=>setTimeout(ne,500)),D("refining");try{const{data:ne,error:Q}=await oe.functions.invoke("refine-bpmn",{body:{currentBpmnXml:h,instructions:C,userId:M.id,diagramType:f},headers:t?void 0:{Authorization:""}});if(Q){console.error("Refinement error:",Q),D("idle");const ee=Q.message||JSON.stringify(Q);ee.includes("429")?k.error("Rate limit exceeded. Please try again in a moment."):ee.includes("402")?k.error("AI credits depleted. Please add more credits to continue."):ee.includes("401")||ee.includes("Authentication")?(k.error("Authentication required. Please log in again."),e("/auth")):k.error(`Failed to refine ${G}: ${ee}`);return}if(ne!=null&&ne.error){console.error("Refinement error in response:",ne.error),D("idle");const ee=typeof ne.error=="string"?ne.error:JSON.stringify(ne.error);ee.includes("402")?k.error("AI credits depleted. Please add more credits to continue."):ee.includes("401")||ee.includes("Authentication")?(k.error("Authentication required. Please log in again."),e("/auth")):k.error(`Failed to refine ${G}: ${ee}`);return}if(ne!=null&&ne.bpmnXml){D("applying"),await new Promise(ve=>setTimeout(ve,300));const ee=ne.bpmnXml.includes("</bpmn:definitions>")||ne.bpmnXml.includes("</definitions>");ne.bpmnXml.includes("<?xml")&&ee?(p(ne.bpmnXml),D("idle"),k.success(`${G} refined successfully!`),R("")):(console.error("Received invalid diagram XML:",ne.bpmnXml.substring(0,200)),D("idle"),k.error("Received invalid diagram structure. Please try again."))}else console.error("No refined diagram received. Response:",ne),D("idle"),k.error("No refined diagram received. The function may not be deployed or there was an error.")}catch(ne){console.error("BPMN refinement error:",ne),D("idle");const Q=ne instanceof Error?ne.message:String(ne);Q.includes("Failed to fetch")||Q.includes("load the resource")?k.error("Network error: Unable to reach refine-bpmn function. Please check if the function is deployed."):k.error(`Failed to refine ${f==="bpmn"?"BPMN":"P&ID"}: ${Q}`)}finally{$(!1)}};return o.jsx("section",{className:"py-24 bg-muted/20 relative","data-section":"try-prossmind",children:o.jsxs("div",{className:"container mx-auto px-6",children:[o.jsxs(he.div,{className:"text-center mb-12",initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.3},variants:u_,children:[o.jsxs("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:["Try ",o.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"ProssMind!"})]}),o.jsx("p",{className:"text-lg text-muted-foreground max-w-3xl mx-auto",children:"Describe your business process, upload an image, PDF, Word doc, or text file - AI will generate a BPMN or P&ID diagram for you"})]}),o.jsxs("div",{className:"max-w-5xl mx-auto mt-12 space-y-8",children:[o.jsxs(Kj,{value:f,onValueChange:M=>m(M),className:"w-full",children:[o.jsxs(Pg,{className:`grid w-full max-w-md mx-auto grid-cols-2 mb-8 ${f==="pid"?"bg-engineering-green/10":""}`,children:[o.jsx(ic,{value:"bpmn",className:`${f==="bpmn"?"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground":""}`,children:"BPMN Diagram"}),o.jsxs(ic,{value:"pid",className:`${f==="pid"?"data-[state=active]:bg-engineering-green data-[state=active]:text-white":""}`,children:[o.jsx(e2,{className:"h-4 w-4 mr-2 flex-shrink-0"}),"P&ID Diagram"]})]}),o.jsxs(sc,{value:"bpmn",className:"space-y-8",children:[o.jsxs("div",{className:"bg-gradient-to-br from-muted/50 to-muted/30 rounded-2xl p-8 border border-border/50 slide-up stagger-1",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx("div",{className:"rounded-full bg-primary/10 p-2",children:o.jsx(_a,{className:"h-5 w-5 text-primary"})}),o.jsx("h3",{className:"font-semibold text-lg",children:"Try these BPMN examples:"})]}),o.jsx("div",{className:"flex flex-wrap gap-3",children:C6.map((M,G)=>o.jsx(U,{variant:"outline",size:"sm",onClick:()=>_t(M),className:"text-sm hover:bg-primary/10 hover:border-primary/50 transition-all whitespace-nowrap",disabled:d,style:{minWidth:"max-content",paddingLeft:"1.2em",paddingRight:"1.2em"},"aria-label":`Use suggestion: ${M}`,children:M},G))})]}),o.jsx("div",{className:"bg-card border border-border rounded-2xl p-8 shadow-xl slide-up stagger-2",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs(Cg,{defaultValue:"prompt",className:"w-full",children:[o.jsxs($u,{className:"grid w-full grid-cols-3 bg-muted/50",children:[o.jsxs(Wr,{value:"prompt",className:"gap-2 data-[state=active]:bg-background data-[state=active]:shadow-sm",children:[o.jsx(jf,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Prompt"})]}),o.jsxs(Wr,{value:"voice",className:"gap-2 data-[state=active]:bg-background data-[state=active]:shadow-sm",children:[o.jsx($o,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Voice"})]}),o.jsxs(Wr,{value:"attachment",className:"gap-2 data-[state=active]:bg-background data-[state=active]:shadow-sm",children:[o.jsx(Lo,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Attachment"})]})]}),o.jsx(qr,{value:"prompt",className:"mt-4",children:o.jsxs("div",{className:"relative",children:[o.jsx(Er,{placeholder:"Describe your process step by step...",value:c,onChange:M=>l(M.target.value),className:"min-h-[120px] resize-none border-muted",style:{paddingLeft:"1.2em",paddingRight:"1.2em"},disabled:d}),d&&o.jsxs("div",{className:"absolute bottom-3 right-3 flex items-center gap-1",children:[o.jsx(he.span,{className:"w-2 h-2 bg-primary rounded-full",animate:n?{}:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:Je(n)||{duration:1,repeat:1/0,delay:0}}),o.jsx(he.span,{className:"w-2 h-2 bg-primary rounded-full",animate:n?{}:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:Je(n)||{duration:1,repeat:1/0,delay:.2}}),o.jsx(he.span,{className:"w-2 h-2 bg-primary rounded-full",animate:n?{}:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:Je(n)||{duration:1,repeat:1/0,delay:.4}})]})]})}),o.jsx(qr,{value:"voice",className:"mt-4",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Qh,{className:"h-4 w-4 text-muted-foreground"}),o.jsxs(Xp,{value:w,onValueChange:b,children:[o.jsx(ud,{className:"w-[200px] h-8",children:o.jsx(Jp,{placeholder:"Select language"})}),o.jsxs(hd,{children:[o.jsx(Ce,{value:"en-US",children:"English (US)"}),o.jsx(Ce,{value:"en-GB",children:"English (UK)"}),o.jsx(Ce,{value:"es-ES",children:"Spanish"}),o.jsx(Ce,{value:"fr-FR",children:"French"}),o.jsx(Ce,{value:"de-DE",children:"German"}),o.jsx(Ce,{value:"it-IT",children:"Italian"}),o.jsx(Ce,{value:"pt-BR",children:"Portuguese (Brazil)"}),o.jsx(Ce,{value:"pt-PT",children:"Portuguese (Portugal)"}),o.jsx(Ce,{value:"ru-RU",children:"Russian"}),o.jsx(Ce,{value:"ja-JP",children:"Japanese"}),o.jsx(Ce,{value:"ko-KR",children:"Korean"}),o.jsx(Ce,{value:"zh-CN",children:"Chinese (Simplified)"}),o.jsx(Ce,{value:"zh-TW",children:"Chinese (Traditional)"}),o.jsx(Ce,{value:"ar-SA",children:"Arabic"}),o.jsx(Ce,{value:"hi-IN",children:"Hindi"})]})]}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"Voice recognition language"})]}),o.jsx(U,{variant:"outline",onClick:Fe,disabled:d,className:v?"text-red-500 border-red-500":"w-full",children:v?o.jsxs(o.Fragment,{children:[o.jsx(ep,{className:"h-4 w-4 mr-2 animate-pulse"}),"Click to Stop Recording"]}):o.jsxs(o.Fragment,{children:[o.jsx($o,{className:"h-4 w-4 mr-2"}),"Start Voice Recording"]})})]})}),o.jsx(qr,{value:"attachment",className:"mt-4",children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("input",{ref:Ye,type:"file",accept:"image/*,.pdf,.doc,.docx,.txt",onChange:re,className:"hidden"}),o.jsxs("div",{onDragOver:M=>{M.preventDefault(),Ke(!0)},onDragLeave:()=>Ke(!1),onDrop:M=>{M.preventDefault(),Ke(!1),re(M)},className:`border-2 border-dashed rounded-2xl p-8 text-center transition-all ${pe?"border-primary bg-primary/5 scale-[1.02]":"border-border hover:border-primary/50"}`,children:[o.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[o.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[o.jsx(Ri,{className:"h-5 w-5","aria-hidden":"true"}),o.jsx("span",{className:"text-xs",children:"PNG/JPG"})]}),o.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[o.jsx(or,{className:"h-5 w-5","aria-hidden":"true"}),o.jsx("span",{className:"text-xs",children:"PDF"})]}),o.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[o.jsx(Jh,{className:"h-5 w-5","aria-hidden":"true"}),o.jsx("span",{className:"text-xs",children:"DOCX"})]})]}),o.jsxs(U,{variant:"outline",onClick:()=>{var M;return(M=Ye.current)==null?void 0:M.click()},disabled:d,className:"w-full","aria-label":"Upload file",children:[o.jsx(Lo,{className:"h-4 w-4 mr-2","aria-hidden":"true"}),"Upload File"]}),o.jsx("p",{className:"text-xs text-muted-foreground mt-3",children:"Drag and drop a file here or click to browse"})]})]})})]}),d&&q!=="idle"&&o.jsxs("div",{className:"space-y-3 p-4 bg-muted/50 rounded-lg border border-border",children:[o.jsx("p",{className:"text-sm font-medium text-foreground mb-2",children:"Processing your document..."}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("span",{className:q==="reading"?"font-semibold":"text-muted-foreground",children:[q==="reading"&&o.jsx(On,{className:"h-4 w-4 inline mr-2 animate-spin","aria-hidden":"true"}),q!=="reading"&&" ","Step 1: Reading prompt..."]}),q==="reading"&&o.jsx(Ln,{value:33,className:"w-24","aria-label":"Progress: 33%"})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("span",{className:q==="generating"?"font-semibold":q==="drawing"?"text-muted-foreground":"",children:[q==="generating"&&o.jsx(On,{className:"h-4 w-4 inline mr-2 animate-spin","aria-hidden":"true"}),q!=="generating"&&q!=="reading"&&" ","Step 2: Generating..."]}),q==="generating"&&o.jsx(Ln,{value:66,className:"w-24","aria-label":"Progress: 66%"})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("span",{className:q==="drawing"?"font-semibold":"text-muted-foreground",children:[q==="drawing"&&o.jsx(On,{className:"h-4 w-4 inline mr-2 animate-spin","aria-hidden":"true"}),q!=="drawing"&&q!=="generating"&&q!=="reading"&&" ","Step 3: Drawing Diagram..."]}),q==="drawing"&&o.jsx(Ln,{value:100,className:"w-24","aria-label":"Progress: 100%"})]})]}),o.jsxs(U,{onClick:ut,className:"gap-2 shadow-lg hover:shadow-xl hover:scale-[1.03] transition-all w-full",size:"lg",disabled:d||!c.trim(),"aria-label":"Generate BPMN diagram",children:[d?"Generating...":"Generate BPMN",o.jsx(Wl,{className:"h-4 w-4","aria-hidden":"true"})]})]})})]}),o.jsxs(sc,{value:"pid",className:"space-y-8",children:[o.jsxs("div",{className:"bg-gradient-to-br from-muted/50 to-muted/30 rounded-2xl p-8 border border-border/50 slide-up stagger-1",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx("div",{className:"rounded-full bg-primary/10 p-2",children:o.jsx(_a,{className:"h-5 w-5 text-primary"})}),o.jsx("h3",{className:"font-semibold text-lg",children:"Try these P&ID examples:"})]}),o.jsx("div",{className:"flex flex-wrap gap-3",children:["Create a chemical reactor cooling system","Design a water treatment process flow","Build a distillation column control loop","Generate a pump and valve configuration","Create a heat exchanger system"].map((M,G)=>o.jsx(U,{variant:"outline",size:"sm",onClick:()=>_t(M),className:"text-sm hover:bg-primary/10 hover:border-primary/50 transition-all",disabled:d,children:M},G))})]}),o.jsx("div",{className:"bg-card border border-border rounded-2xl p-8 shadow-xl slide-up stagger-2",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Qh,{className:"h-4 w-4 text-muted-foreground","aria-hidden":"true"}),o.jsxs(Xp,{value:w,onValueChange:b,children:[o.jsx(ud,{className:"w-[200px] h-8","aria-label":"Select voice recognition language",children:o.jsx(Jp,{placeholder:"Select language"})}),o.jsxs(hd,{children:[o.jsx(Ce,{value:"en-US",children:"English (US)"}),o.jsx(Ce,{value:"en-GB",children:"English (UK)"}),o.jsx(Ce,{value:"es-ES",children:"Spanish"}),o.jsx(Ce,{value:"fr-FR",children:"French"}),o.jsx(Ce,{value:"de-DE",children:"German"}),o.jsx(Ce,{value:"it-IT",children:"Italian"}),o.jsx(Ce,{value:"pt-BR",children:"Portuguese (Brazil)"}),o.jsx(Ce,{value:"pt-PT",children:"Portuguese (Portugal)"}),o.jsx(Ce,{value:"ru-RU",children:"Russian"}),o.jsx(Ce,{value:"ja-JP",children:"Japanese"}),o.jsx(Ce,{value:"ko-KR",children:"Korean"}),o.jsx(Ce,{value:"zh-CN",children:"Chinese (Simplified)"}),o.jsx(Ce,{value:"zh-TW",children:"Chinese (Traditional)"}),o.jsx(Ce,{value:"ar-SA",children:"Arabic"}),o.jsx(Ce,{value:"hi-IN",children:"Hindi"})]})]}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"Voice recognition language"})]}),o.jsx(Er,{placeholder:"Describe your P&ID process, or upload files (images, PDFs, Word docs, text files) - I'll extract content and generate a P&ID diagram. You can preview before generation and refine using natural language after creation...",value:c,onChange:M=>l(M.target.value),className:"min-h-[120px] resize-none border-muted",disabled:d,"aria-label":"P&ID process description input"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{ref:Ye,type:"file",accept:"image/*,.pdf,.doc,.docx,.txt",onChange:re,className:"hidden","aria-label":"Upload file input"}),o.jsx(U,{variant:"ghost",size:"icon",onClick:()=>{var M;return(M=Ye.current)==null?void 0:M.click()},disabled:d,title:"Upload image, PDF, Word, or text file to generate P&ID","aria-label":"Upload file",children:o.jsx(Lo,{className:"h-5 w-5","aria-hidden":"true"})}),o.jsx(U,{variant:"ghost",size:"icon",onClick:Fe,disabled:d,className:v?"text-red-500":"",title:"Voice to text","aria-label":v?"Stop voice recording":"Start voice recording",children:v?o.jsx(ep,{className:"h-5 w-5 animate-pulse","aria-hidden":"true"}):o.jsx($o,{className:"h-5 w-5","aria-hidden":"true"})})]}),o.jsxs(U,{onClick:ut,className:"gap-2 shadow-lg hover:shadow-xl hover:scale-[1.03] transition-all",size:"lg",disabled:d||!c.trim(),"aria-label":"Generate P&ID diagram",children:[d?"Generating...":"Generate P&ID",o.jsx(Wl,{className:"h-4 w-4","aria-hidden":"true"})]})]}),o.jsxs("div",{className:"border border-border rounded-lg p-4 bg-muted/30",children:[o.jsxs("div",{className:"flex justify-center gap-4 mb-2",children:[o.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[o.jsx(Ri,{className:"h-4 w-4","aria-hidden":"true"}),o.jsx("span",{className:"text-xs",children:"PNG/JPG"})]}),o.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[o.jsx(or,{className:"h-4 w-4","aria-hidden":"true"}),o.jsx("span",{className:"text-xs",children:"PDF"})]}),o.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[o.jsx(Jh,{className:"h-4 w-4","aria-hidden":"true"}),o.jsx("span",{className:"text-xs",children:"DOCX"})]})]}),o.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Supported file types for upload"})]})]})})]})]}),N&&x&&o.jsxs("div",{className:"bg-card border border-border rounded-2xl p-6 shadow-lg",children:[o.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Preview Uploaded File"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-muted/30 rounded-lg p-4",children:[o.jsxs("p",{className:"text-sm font-medium mb-2",children:["File: ",x.name]}),x.type.startsWith("image/")&&o.jsx("div",{className:"mt-4 max-h-96 overflow-auto",children:o.jsx("img",{src:x.base64,alt:"Preview",className:"max-w-full rounded border"})}),x.extractedText&&o.jsxs("div",{className:"mt-4",children:[o.jsx("p",{className:"text-sm font-medium mb-2",children:"Extracted Content Preview:"}),o.jsx("div",{className:"bg-background rounded p-3 max-h-48 overflow-auto text-xs",children:x.extractedText})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(U,{onClick:Qe,className:"flex-1",disabled:d,children:d?"Generating...":`Generate ${f==="bpmn"?"BPMN":"P&ID"} from this file`}),o.jsx(U,{variant:"outline",onClick:()=>{j(!1),E(null)},children:"Cancel"})]})]})]}),h?o.jsxs("div",{id:"bpmn-viewer",className:"space-y-6 relative",children:[o.jsxs("div",{className:"bg-card border border-border rounded-2xl p-6 shadow-lg",children:[o.jsxs("h3",{className:"text-xl font-semibold mb-4",children:["Your ",f==="bpmn"?"BPMN":"P&ID"," Model"]}),o.jsx(Ng,{xml:h,diagramType:f,onSave:M=>{p(M),k.success("Diagram saved to workspace")},onRefine:()=>de(!0)}),o.jsx("p",{className:"text-xs text-muted-foreground mt-4 text-right",children:"Generated via Gemini 2.5 Pro  v1"})]}),T&&B!=="idle"&&o.jsxs("div",{className:"space-y-3 p-4 bg-muted/50 rounded-lg border border-border",children:[o.jsxs("p",{className:"text-sm font-medium text-foreground mb-2",children:["Refining your ",f==="bpmn"?"BPMN":"P&ID"," diagram..."]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("span",{className:B==="analyzing"?"font-semibold":"text-muted-foreground",children:[B==="analyzing"&&o.jsx(On,{className:"h-4 w-4 inline mr-2 animate-spin","aria-hidden":"true"}),B!=="analyzing"&&" ","Step 1: Analyzing instructions..."]}),B==="analyzing"&&o.jsx(Ln,{value:33,className:"w-24","aria-label":"Progress: 33%"})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("span",{className:B==="refining"?"font-semibold":B==="applying"?"text-muted-foreground":"",children:[B==="refining"&&o.jsx(On,{className:"h-4 w-4 inline mr-2 animate-spin","aria-hidden":"true"}),B!=="refining"&&B!=="analyzing"&&" ","Step 2: Refining diagram..."]}),B==="refining"&&o.jsx(Ln,{value:66,className:"w-24","aria-label":"Progress: 66%"})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("span",{className:B==="applying"?"font-semibold":"text-muted-foreground",children:[B==="applying"&&o.jsx(On,{className:"h-4 w-4 inline mr-2 animate-spin","aria-hidden":"true"}),B!=="applying"&&B!=="refining"&&B!=="analyzing"&&" ","Step 3: Applying changes..."]}),B==="applying"&&o.jsx(Ln,{value:100,className:"w-24","aria-label":"Progress: 100%"})]})]}),o.jsx(hn,{open:xe,onOpenChange:de,children:o.jsxs(en,{children:[o.jsxs(tn,{children:[o.jsxs(nn,{children:["Refine Your ",f==="bpmn"?"BPMN":"P&ID"]}),o.jsx(rn,{children:"Use natural language to modify the current diagram. The AI will update the latest version based on your instructions."})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx(Er,{placeholder:"E.g., 'add a review step after approval', 'replace manual task with automated service', 'add parallel gateway for concurrent processing'...",value:C,onChange:M=>R(M.target.value),className:"min-h-[100px] resize-none",disabled:T}),o.jsx(U,{onClick:()=>{K(),de(!1)},disabled:T||!C.trim(),className:"w-full",children:T?"Refining...":`Apply Changes to Current ${f==="bpmn"?"BPMN":"P&ID"}`})]})]})})]}):d&&q==="drawing"?o.jsxs(he.div,{className:"bg-card border border-border rounded-2xl p-6 shadow-lg",initial:n?{opacity:1}:{opacity:0},animate:{opacity:1},transition:Je(n)||{duration:.3},children:[o.jsxs("h3",{className:"text-xl font-semibold mb-4",children:["Generating ",f==="bpmn"?"BPMN":"P&ID"," Model"]}),o.jsx("div",{className:"space-y-4",children:o.jsx("div",{className:"w-full h-[400px] bg-muted/50 rounded-lg animate-pulse border border-border/50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center space-y-3",children:[o.jsx(On,{className:"h-8 w-8 animate-spin mx-auto text-primary"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Rendering diagram..."})]})})})]}):null]})]})})},es=y.forwardRef(({className:t,...e},n)=>o.jsx("div",{ref:n,className:J("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));es.displayName="Card";const Os=y.forwardRef(({className:t,...e},n)=>o.jsx("div",{ref:n,className:J("flex flex-col space-y-1.5 p-6",t),...e}));Os.displayName="CardHeader";const $s=y.forwardRef(({className:t,...e},n)=>o.jsx("h3",{ref:n,className:J("text-2xl font-semibold leading-none tracking-tight",t),...e}));$s.displayName="CardTitle";const eo=y.forwardRef(({className:t,...e},n)=>o.jsx("p",{ref:n,className:J("text-sm text-muted-foreground",t),...e}));eo.displayName="CardDescription";const ts=y.forwardRef(({className:t,...e},n)=>o.jsx("div",{ref:n,className:J("p-6 pt-0",t),...e}));ts.displayName="CardContent";const T6=y.forwardRef(({className:t,...e},n)=>o.jsx("div",{ref:n,className:J("flex items-center p-6 pt-0",t),...e}));T6.displayName="CardFooter";const R6=[{icon:Nf,title:"Process Generator",description:"Design and build automated business processes with powerful AI capabilities."},{icon:Gl,title:"Vision Automation",description:"Automate visual tasks with advanced computer vision and image processing."},{icon:o0,title:"BPMN Integration",description:"Download BPMN diagrams and integrate with SAP Signavio, Camunda, Flowable, and more."}],A6=()=>{const t=Bi(),{ref:e,isInView:n}=$f({threshold:.1});return o.jsx("section",{className:"py-24 bg-muted/30 relative",children:o.jsxs("div",{className:"container mx-auto px-6",children:[o.jsxs(he.div,{className:"text-center mb-16",initial:t?{opacity:1,y:0}:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:Je(t)||{duration:.6},children:[o.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Powerful Features"}),o.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Everything you need to automate and optimize your business processes"})]}),o.jsx(he.div,{ref:e,className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",variants:Lf,initial:"hidden",animate:n?"visible":"hidden",children:R6.map((r,i)=>o.jsx(he.div,{variants:t?void 0:Uo,whileHover:t?{}:{y:-12,rotateY:2,rotateX:2,scale:1.03},transition:Je(t)||{duration:.3},style:{perspective:1e3},children:o.jsxs(es,{className:"card-hover cursor-pointer border-border/50 hover:border-primary bg-card/50 backdrop-blur-sm flex flex-col h-full rounded-2xl shadow-md transition-all p-6 relative overflow-hidden group",style:{boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},role:"article","aria-label":`Feature: ${r.title}`,children:[o.jsx(he.div,{className:"absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity",style:{background:"linear-gradient(45deg, hsl(var(--primary)), hsl(var(--accent)))",padding:"1px"},initial:!1,children:o.jsx("div",{className:"w-full h-full bg-card/50 backdrop-blur-sm rounded-2xl"})}),o.jsxs(Os,{className:"flex-shrink-0 relative z-10",children:[o.jsxs(he.div,{className:"w-14 h-14 rounded-xl bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center mb-6 tech-glow relative",animate:t?{rotate:0}:{rotate:[-2,2,-2]},transition:Je(t)||{duration:4,repeat:1/0,ease:"easeInOut"},whileHover:t?{}:{scale:1.15,rotate:15,filter:"brightness(1.3)"},children:[o.jsx(he.div,{whileHover:t?{}:{scale:1.2},transition:Je(t)||{duration:.2},style:{filter:"drop-shadow(0 0 20px hsl(var(--primary)))"},children:o.jsx(r.icon,{className:"h-7 w-7 text-primary"})}),o.jsx(he.div,{className:"absolute inset-0 rounded-xl bg-primary/20 blur-xl",animate:t?{scale:1,opacity:0}:{scale:[1,1.3,1],opacity:[0,.8,0]},transition:Je(t)||{duration:1.5,repeat:1/0,ease:"easeInOut"}})]}),o.jsx($s,{className:"text-2xl mb-2",children:r.title})]}),o.jsx(ts,{className:"flex-grow flex flex-col relative z-10",children:o.jsx(eo,{className:"text-base leading-relaxed break-words overflow-visible min-h-0",children:r.description})})]})},i))})]})})},I6=[{name:"ProssMind Light",description:"Perfect for individuals and small teams",features:["Basic automation features","Up to 5 processes","Community support","Basic analytics"]},{name:"ProssMind Vision",description:"Advanced features for growing businesses",features:["All Light features","Unlimited processes","Vision automation","Priority support","Advanced analytics","Custom integrations"],popular:!0},{name:"Custom Models",description:"Enterprise-grade solution",features:["All Vision features","Custom AI models","Dedicated support","On-premise deployment","SLA guarantee","Training & consulting"]}],AN=()=>{const{ref:t,isInView:e}=$f({threshold:.1});return o.jsx("section",{className:"py-24 bg-background relative",children:o.jsxs("div",{className:"container mx-auto px-6",children:[o.jsxs(he.div,{className:"text-center mb-16",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.6},children:[o.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Choose Your Plan"}),o.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Select the perfect plan for your business needs"})]}),o.jsx(he.div,{ref:t,className:"grid md:grid-cols-3 gap-8 max-w-6xl mx-auto",variants:Lf,initial:"hidden",animate:e?"visible":"hidden",children:I6.map((n,r)=>o.jsx(he.div,{variants:Uo,whileHover:{y:-8,rotateY:n.popular?0:2,rotateX:n.popular?0:2,scale:n.popular?1.05:1.02},style:{perspective:1e3},children:o.jsxs(es,{className:`relative card-hover flex flex-col h-full transition-all ${n.popular?"border-primary shadow-2xl bg-gradient-to-b from-card to-primary/5 hover:border-primary/80":"border-border bg-card/50 backdrop-blur-sm hover:border-primary/50"}`,role:"article","aria-label":`Pricing tier: ${n.name}${n.popular?" - Most Popular":""}`,children:[n.popular&&o.jsxs(he.div,{className:"absolute -top-4 left-1/2 -translate-x-1/2 z-10",animate:{scale:[1,1.08,1],opacity:[.8,1,.8]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},whileHover:{scale:1.1},children:[o.jsx(he.span,{className:"bg-gradient-to-r from-primary to-accent text-primary-foreground text-sm font-semibold px-6 py-2 rounded-full shadow-lg block",animate:{boxShadow:["0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 0 20px rgba(37, 99, 235, 0.5)","0 10px 15px -3px rgba(37, 99, 235, 0.3), 0 0 30px rgba(37, 99, 235, 0.8)","0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 0 20px rgba(37, 99, 235, 0.5)"]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:"Most Popular"}),o.jsx(he.div,{animate:{scale:[1,1.15,1]},transition:{duration:.3,repeat:1/0,repeatDelay:5,ease:"easeOut"},className:"absolute inset-0",style:{pointerEvents:"none"}})]}),o.jsxs(Os,{className:"text-center pb-8 pt-8 flex-shrink-0",children:[o.jsx($s,{className:"text-2xl mb-3 font-bold",children:n.name}),o.jsx(eo,{className:"text-base",children:n.description})]}),o.jsxs(ts,{className:"flex flex-col flex-grow space-y-8",children:[o.jsx("ul",{className:"space-y-4 flex-grow",children:n.features.map((i,s)=>o.jsxs("li",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"rounded-full bg-primary/10 p-1 flex-shrink-0",children:o.jsx($n,{className:"h-4 w-4 text-primary"})}),o.jsx("span",{className:"text-sm leading-relaxed",children:i})]},s))}),o.jsx(U,{className:`w-full text-base py-6 mt-auto hover:scale-[1.03] transition-all ${n.popular?"shadow-lg hover:shadow-xl":""}`,variant:n.popular?"default":"outline",size:"lg","aria-label":`Get started with ${n.name}`,children:"Get Started"})]})]})},r))})]})})},M6=()=>{const[t,e]=y.useState(!1),[n,r]=y.useState([{role:"assistant",content:"Hi! I'm ProssMind AI Assistant. I can help you with creating BPMN diagrams, using the interface, or answering any questions. How can I help you today?"}]),[i,s]=y.useState(""),[a,c]=y.useState(!1),l=y.useRef(null),d=y.useRef(null);y.useEffect(()=>{var f;(f=d.current)==null||f.scrollIntoView({behavior:"smooth"})},[n]);const u=async f=>{var v,g,w;const m=[...n,{role:"user",content:f}];r(m),s(""),c(!0);try{const x=await fetch("https://lnxbvkcggoyfmpfthhhk.supabase.co/functions/v1/chatbot",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer undefined"},body:JSON.stringify({messages:m})});if(!x.ok){x.status===429?k.error("Rate limit exceeded. Please try again in a moment."):x.status===402?k.error("AI credits depleted. Please contact support."):k.error("Failed to get response from AI."),c(!1);return}if(!x.body)throw new Error("No response body");const E=x.body.getReader(),N=new TextDecoder;let j="",C="",R=!1;const T=$=>{r(B=>{const D=B[B.length-1];return(D==null?void 0:D.role)==="assistant"?B.map((q,F)=>F===B.length-1?{...q,content:$}:q):[...B,{role:"assistant",content:$}]})};for(;!R;){const{done:$,value:B}=await E.read();if($)break;j+=N.decode(B,{stream:!0});let D;for(;(D=j.indexOf(`
`))!==-1;){let q=j.slice(0,D);if(j=j.slice(D+1),q.endsWith("\r")&&(q=q.slice(0,-1)),q.startsWith(":")||q.trim()===""||!q.startsWith("data: "))continue;const F=q.slice(6).trim();if(F==="[DONE]"){R=!0;break}try{const de=(w=(g=(v=JSON.parse(F).choices)==null?void 0:v[0])==null?void 0:g.delta)==null?void 0:w.content;de&&(C+=de,T(C))}catch{j=q+`
`+j;break}}}c(!1)}catch(b){console.error("Chat error:",b),k.error("An error occurred. Please try again."),c(!1)}},h=()=>{!i.trim()||a||u(i)},p=f=>{f.key==="Enter"&&!f.shiftKey&&(f.preventDefault(),h())};return o.jsxs(o.Fragment,{children:[!t&&o.jsx(U,{onClick:()=>e(!0),className:"fixed bottom-6 right-6 h-14 w-14 rounded-full shadow-2xl hover:shadow-xl transition-all z-50 animate-fade-in",size:"icon",children:o.jsx(l2,{className:"h-6 w-6"})}),t&&o.jsxs(es,{className:"fixed bottom-6 right-6 w-96 h-[600px] shadow-2xl flex flex-col z-50 animate-scale-in",children:[o.jsx(Os,{className:"border-b bg-gradient-to-r from-primary to-accent text-primary-foreground",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(aa,{className:"h-5 w-5"}),o.jsx($s,{className:"text-lg",children:"ProssMind Assistant"})]}),o.jsx(U,{variant:"ghost",size:"icon",onClick:()=>e(!1),className:"text-primary-foreground hover:bg-primary-foreground/20",children:o.jsx(wr,{className:"h-4 w-4"})})]})}),o.jsxs(ts,{className:"flex-1 flex flex-col p-0",children:[o.jsx(Fr,{className:"flex-1 p-4",ref:l,children:o.jsxs("div",{className:"space-y-4",children:[n.map((f,m)=>o.jsxs("div",{className:`flex gap-3 ${f.role==="user"?"justify-end":"justify-start"}`,children:[f.role==="assistant"&&o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:o.jsx(aa,{className:"h-4 w-4 text-primary"})}),o.jsx("div",{className:`max-w-[75%] rounded-2xl px-4 py-2 ${f.role==="user"?"bg-primary text-primary-foreground":"bg-muted"}`,children:o.jsx("p",{className:"text-sm whitespace-pre-wrap",children:f.content})}),f.role==="user"&&o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary flex items-center justify-center",children:o.jsx(d0,{className:"h-4 w-4 text-primary-foreground"})})]},m)),o.jsx("div",{ref:d})]})}),o.jsx("div",{className:"border-t p-4",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsx(Er,{value:i,onChange:f=>s(f.target.value),onKeyDown:p,placeholder:"Ask me anything about ProssMind...",className:"resize-none min-h-[60px]",disabled:a}),o.jsx(U,{onClick:h,disabled:!i.trim()||a,size:"icon",className:"h-[60px] w-[60px] flex-shrink-0",children:o.jsx(Wl,{className:"h-5 w-5"})})]})})]})]})]})},D6=()=>{const{ref:t,isInView:e}=$f({threshold:.1});return o.jsx("footer",{className:"border-t border-border bg-background",children:o.jsxs("div",{className:"container mx-auto px-6 py-12",children:[o.jsxs(he.div,{ref:t,className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-8",variants:Lf,initial:"hidden",animate:e?"visible":"hidden",children:[o.jsxs(he.div,{variants:Uo,children:[o.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Product"}),o.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[o.jsx("li",{children:o.jsxs(pn,{to:"/features",className:"hover:text-foreground transition-colors relative group",children:["Features",o.jsx(he.span,{className:"absolute bottom-0 left-0 w-0 h-0.5 bg-primary group-hover:w-full transition-all duration-300",whileHover:{width:"100%"}})]})}),o.jsx("li",{children:o.jsxs(pn,{to:"/pricing",className:"hover:text-foreground transition-colors relative group",children:["Pricing",o.jsx(he.span,{className:"absolute bottom-0 left-0 w-0 h-0.5 bg-primary group-hover:w-full transition-all duration-300",whileHover:{width:"100%"}})]})}),o.jsx("li",{children:o.jsxs(pn,{to:"/vision-ai",className:"hover:text-foreground transition-colors relative group",children:["Vision AI",o.jsx(he.span,{className:"absolute bottom-0 left-0 w-0 h-0.5 bg-primary group-hover:w-full transition-all duration-300",whileHover:{width:"100%"}})]})})]})]}),o.jsxs(he.div,{variants:Uo,children:[o.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Legal"}),o.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[o.jsx("li",{children:o.jsxs(pn,{to:"/privacy",className:"hover:text-foreground transition-colors relative group",children:["Privacy Policy",o.jsx(he.span,{className:"absolute bottom-0 left-0 w-0 h-0.5 bg-primary group-hover:w-full transition-all duration-300",whileHover:{width:"100%"}})]})}),o.jsx("li",{children:o.jsxs(pn,{to:"/terms",className:"hover:text-foreground transition-colors relative group",children:["Terms of Service",o.jsx(he.span,{className:"absolute bottom-0 left-0 w-0 h-0.5 bg-primary group-hover:w-full transition-all duration-300",whileHover:{width:"100%"}})]})}),o.jsx("li",{children:o.jsxs(pn,{to:"/contact",className:"hover:text-foreground transition-colors relative group",children:["Contact",o.jsx(he.span,{className:"absolute bottom-0 left-0 w-0 h-0.5 bg-primary group-hover:w-full transition-all duration-300",whileHover:{width:"100%"}})]})})]})]}),o.jsxs(he.div,{variants:Uo,children:[o.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Company"}),o.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[o.jsx("li",{children:o.jsxs(pn,{to:"/about",className:"hover:text-foreground transition-colors relative group",children:["About Us",o.jsx(he.span,{className:"absolute bottom-0 left-0 w-0 h-0.5 bg-primary group-hover:w-full transition-all duration-300",whileHover:{width:"100%"}})]})}),o.jsx("li",{children:o.jsxs(pn,{to:"/contact",className:"hover:text-foreground transition-colors relative group",children:["Contact Us",o.jsx(he.span,{className:"absolute bottom-0 left-0 w-0 h-0.5 bg-primary group-hover:w-full transition-all duration-300",whileHover:{width:"100%"}})]})})]})]})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-4 justify-center md:justify-start mb-8 pb-8 border-b border-border",children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-primary/10 border border-primary/20",children:[o.jsx(wa,{className:"h-4 w-4 text-primary","aria-hidden":"true"}),o.jsx("span",{className:"text-sm font-medium text-foreground",children:"GDPR"})]}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-primary/10 border border-primary/20",children:[o.jsx(a2,{className:"h-4 w-4 text-primary","aria-hidden":"true"}),o.jsx("span",{className:"text-sm font-medium text-foreground",children:"Swiss Hosted"})]}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-muted border border-border",children:[o.jsx(JC,{className:"h-4 w-4 text-muted-foreground","aria-hidden":"true"}),o.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"SOC 2 pending"})]})]}),o.jsx("div",{className:"text-sm text-muted-foreground text-center",children:o.jsxs("p",{children:[" ",new Date().getFullYear()," ProssMind. All rights reserved."]})})]})})},O6=Wk,$6=qk,IN=y.forwardRef(({className:t,align:e="center",sideOffset:n=4,...r},i)=>o.jsx(Gk,{children:o.jsx(Sw,{ref:i,align:e,sideOffset:n,className:J("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));IN.displayName=Sw.displayName;const L6=()=>{const t=Bi(),e=[{icon:b2,label:"Swiss Hosted",title:"Swiss Hosted Infrastructure",description:"All data is hosted in Switzerland, ensuring maximum privacy and data sovereignty. Our infrastructure complies with Swiss data protection laws.",link:"#"},{icon:wa,label:"GDPR Compliant",title:"GDPR Compliance",description:"We are fully compliant with the General Data Protection Regulation (GDPR). Your data is processed with the highest standards of privacy and security.",link:"#"},{icon:c0,label:"SOC 2 Pending",title:"SOC 2 Certification",description:"We are currently undergoing SOC 2 Type II certification to demonstrate our commitment to security, availability, and confidentiality.",link:"#"}];return o.jsx("div",{className:"bg-muted/50 dark:bg-muted/30 py-2 text-sm text-muted-foreground text-center border-b border-border/50",children:o.jsx("div",{className:"container mx-auto px-6",children:o.jsx("div",{className:"flex items-center justify-center gap-6 flex-wrap",children:e.map((n,r)=>o.jsxs(O6,{children:[o.jsx($6,{asChild:!0,children:o.jsxs(he.button,{className:"flex items-center gap-2 hover:text-foreground transition-colors cursor-pointer focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 rounded px-2 py-1",whileHover:t?{}:{scale:1.05},whileTap:t?{}:{scale:.95},"aria-label":`Learn more about ${n.label}`,children:[o.jsx(n.icon,{className:"h-4 w-4","aria-hidden":"true"}),o.jsx("span",{children:n.label})]})}),o.jsx(IN,{className:"w-80",side:"bottom",align:"center",children:o.jsxs("div",{className:"space-y-2",children:[o.jsx("h4",{className:"font-semibold text-sm",children:n.title}),o.jsx("p",{className:"text-xs text-muted-foreground",children:n.description})]})})]},r))})})})},B6=()=>{Ps();const[t,e]=y.useState(null),[n,r]=y.useState(!0);return y.useEffect(()=>{const{data:{subscription:i}}=oe.auth.onAuthStateChange((s,a)=>{e((a==null?void 0:a.user)??null),r(!1)});return oe.auth.getSession().then(({data:{session:s}})=>{e((s==null?void 0:s.user)??null),r(!1)}),()=>i.unsubscribe()},[]),n?o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),o.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading..."})]})}):o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(Ha,{user:t}),o.jsx(L6,{}),o.jsx(fI,{}),o.jsx(mI,{}),o.jsx(P6,{user:t}),o.jsx(A6,{}),o.jsx(AN,{}),o.jsx(M6,{}),o.jsx(D6,{})]})},zu=({children:t,className:e})=>o.jsx("div",{className:J("max-w-[1200px] mx-auto p-4 md:p-8",e),children:t}),F6=[{icon:aa,title:"AI Agent Generator",description:"Create intelligent agents that can automate complex workflows and tasks with advanced machine learning capabilities.",benefits:["Natural language processing","Self-learning algorithms","Multi-task handling"]},{icon:Nf,title:"Process Generator",description:"Design and build automated business processes with powerful AI capabilities and intuitive visual tools. Download BPMN diagrams and integrate seamlessly with SAP Signavio, Camunda, Flowable, and more.",benefits:["Visual process builder","Real-time monitoring","Automatic optimization","Export BPMN diagrams","Integration with SAP Signavio, Camunda, Flowable"]},{icon:Gl,title:"Vision Automation",description:"Automate visual tasks with advanced computer vision and image processing powered by state-of-the-art AI.",benefits:["Image recognition","OCR capabilities","Video analysis"]},{icon:S2,title:"Lightning Fast",description:"Process automation that runs at incredible speeds with minimal latency and maximum efficiency.",benefits:["Sub-second response","Real-time processing","Edge computing"]},{icon:wa,title:"Enterprise Security",description:"Bank-level security with end-to-end encryption, ensuring your data and processes are always protected.",benefits:["256-bit encryption","SOC 2 compliant","GDPR ready"]},{icon:n2,title:"Performance Analytics",description:"Deep insights into your automation performance with comprehensive analytics and reporting tools.",benefits:["Real-time dashboards","Custom reports","Predictive insights"]}],z6=()=>{const t=Bi();return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(Ha,{}),o.jsx("main",{className:"pt-24 pb-20",children:o.jsxs(zu,{children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsxs("h1",{className:"text-5xl font-bold mb-4",children:["Powerful ",o.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Features"})]}),o.jsx("p",{className:"text-xl text-muted-foreground max-w-3xl mx-auto",children:"Everything you need to automate your business processes with cutting-edge AI technology"})]}),o.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:F6.map((e,n)=>o.jsx(he.div,{whileHover:t?{}:{y:-12,rotateY:2,rotateX:2,scale:1.03},transition:Je(t)||{duration:.3},style:{perspective:1e3},children:o.jsxs(es,{className:"card-hover cursor-pointer border-border/50 hover:border-primary bg-card/50 backdrop-blur-sm flex flex-col h-full rounded-2xl shadow-md transition-all relative overflow-hidden group",style:{boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},role:"article","aria-label":`Feature: ${e.title}`,children:[o.jsx(he.div,{className:"absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity",style:{background:"linear-gradient(45deg, hsl(var(--primary)), hsl(var(--accent)))",padding:"1px"},initial:!1,children:o.jsx("div",{className:"w-full h-full bg-card/50 backdrop-blur-sm rounded-2xl"})}),o.jsxs(Os,{className:"flex-shrink-0 relative z-10",children:[o.jsxs(he.div,{className:"w-14 h-14 rounded-xl bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center mb-4 relative",animate:t?{rotate:0}:{rotate:[-2,2,-2]},transition:Je(t)||{duration:4,repeat:1/0,ease:"easeInOut"},whileHover:t?{}:{scale:1.15,rotate:15,filter:"brightness(1.3)"},children:[o.jsx(he.div,{whileHover:t?{}:{scale:1.2},transition:Je(t)||{duration:.2},style:{filter:"drop-shadow(0 0 20px hsl(var(--primary)))"},children:o.jsx(e.icon,{className:"h-7 w-7 text-primary"})}),o.jsx(he.div,{className:"absolute inset-0 rounded-xl bg-primary/20 blur-xl",animate:t?{scale:1,opacity:0}:{scale:[1,1.3,1],opacity:[0,.8,0]},transition:Je(t)||{duration:1.5,repeat:1/0,ease:"easeInOut"}})]}),o.jsx($s,{className:"text-2xl mb-2",children:e.title}),o.jsx(eo,{className:"text-base mt-2",children:e.description})]}),o.jsx(ts,{className:"flex-grow flex flex-col relative z-10",children:o.jsx("ul",{className:"space-y-2",children:e.benefits.map((r,i)=>o.jsxs("li",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-primary"}),r]},i))})})]})},n))})]})})]})},U6=()=>{const[t,e]=y.useState(!1),[n,r]=y.useState(!1),[i,s]=y.useState(null),[a,c]=y.useState(!1),[l,d]=y.useState(null),[u,h]=y.useState("bpmn"),[p,f]=y.useState(0),[m,v]=y.useState(""),[g,w]=y.useState(null);y.useEffect(()=>{if(!l)return;let j;const C=async()=>{const{data:$,error:B}=await oe.from("vision_bpmn_jobs").select("status, bpmn_xml, error_message").eq("id",l).single();if(B){console.error("Error checking job status:",B);return}if(console.log("Job status:",$.status),$.status==="completed"&&$.bpmn_xml){const D=u==="bpmn"?"generatedBpmn":"generatedPid";localStorage.setItem(D,$.bpmn_xml),localStorage.setItem("diagramType",u);const q=u==="bpmn"?"BPMN":"P&ID";f(100),v("Complete!");let F=2;const xe=setInterval(()=>{F--,F>0?k.success(`${q} diagram generated successfully!`,{description:`Redirecting in ${F}s...`,duration:1e3}):(clearInterval(xe),window.location.href="/")},1e3);r(!1),s(null),c(!1),d(null),w(null),j&&clearInterval(j)}else if($.status==="failed"){const D=$.error_message||"Please try again";w(D),k.error("Upload failed  retry or contact support",{description:D,action:{label:"Retry",onClick:()=>{w(null),i&&N()}},duration:1e4}),c(!1),d(null),f(0),v(""),j&&clearInterval(j)}},R=oe.channel(`job-${l}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"vision_bpmn_jobs",filter:`id=eq.${l}`},$=>{const B=$.new;if(console.log("Realtime job status update:",B.status),B.status==="completed"&&B.bpmn_xml){const D=u==="bpmn"?"generatedBpmn":"generatedPid";localStorage.setItem(D,B.bpmn_xml),localStorage.setItem("diagramType",u);const q=u==="bpmn"?"BPMN":"P&ID";f(100),v("Complete!");let F=2;const xe=setInterval(()=>{F--,F>0?k.success(`${q} diagram generated successfully!`,{description:`Redirecting in ${F}s...`,duration:1e3}):(clearInterval(xe),window.location.href="/")},1e3);r(!1),s(null),c(!1),d(null),w(null),j&&clearInterval(j)}else if(B.status==="failed"){const D=B.error_message||"Please try again";w(D),k.error("Upload failed  retry or contact support",{description:D,action:{label:"Retry",onClick:()=>{w(null),i&&N()}},duration:1e4}),c(!1),d(null),f(0),v(""),j&&clearInterval(j)}}).subscribe();j=window.setInterval(C,3e3),C();const T=window.setTimeout(()=>{j&&clearInterval(j);const $="Processing timed out - Please try refreshing the page or contact support";w($),f(0),v(""),k.error("Upload failed  retry or contact support",{description:$,action:{label:"Retry",onClick:()=>{w(null),i&&N()}},duration:1e4}),c(!1),d(null)},3e5);return()=>{clearTimeout(T),oe.removeChannel(R),j&&clearInterval(j)}},[l,u,i]);const b=()=>{e(!0)},x=()=>{e(!1),r(!0)},E=j=>{var R;const C=(R=j.target.files)==null?void 0:R[0];if(C){if(C.size>209715200){k.error("File too large",{description:"Maximum file size is 200 MB. Please select a smaller file."}),j.target.value="";return}s(C),w(null),f(10),v("File selected, ready to upload...")}},N=async()=>{if(!i){k.error("Please select a file");return}c(!0),w(null),f(10),v("Analyzing frame 1 of 20...");const j=k.loading("Processing your file...",{description:"This may take 30-60 seconds for complex diagrams"});try{const{data:{user:C},error:R}=await oe.auth.getUser();if(!C||R){k.dismiss(j);const $=(R==null?void 0:R.message)||"Please log in to use this feature";w($),k.error("Upload failed  retry or contact support",{description:$,action:{label:"Retry",onClick:()=>{w(null),N()}},duration:1e4}),c(!1),f(0),v(""),window.location.href="/auth";return}const T=new FileReader;T.onloadend=async()=>{const $=T.result;k.dismiss(j),f(20),v("Uploading file...");const B=k.loading("Starting diagram generation...",{description:"This will continue in the background"});try{const{data:D,error:q}=await oe.functions.invoke("vision-to-bpmn",{body:{imageBase64:$}});if(k.dismiss(B),q){const F=q.message||"Failed to start diagram generation";w(F),f(0),v(""),k.error("Upload failed  retry or contact support",{description:F,action:{label:"Retry",onClick:()=>{w(null),N()}},duration:1e4}),c(!1);return}if(!D||!D.jobId){const F="Failed to start processing";w(F),f(0),v(""),k.error("Upload failed  retry or contact support",{description:F,action:{label:"Retry",onClick:()=>{w(null),N()}},duration:1e4}),c(!1);return}d(D.jobId),f(30),v("Processing started, analyzing frames..."),k.info("Processing started",{description:"We'll notify you when your diagram is ready (this may take 1-2 minutes)"})}catch{const q="Network error - Please check your connection and try again";w(q),f(0),v(""),k.dismiss(B),k.error("Upload failed  retry or contact support",{description:q,action:{label:"Retry",onClick:()=>{w(null),N()}},duration:1e4}),c(!1)}},T.onerror=()=>{const $="Failed to read file";w($),f(0),v(""),k.dismiss(j),k.error("Upload failed  retry or contact support",{description:$,action:{label:"Retry",onClick:()=>{w(null),N()}},duration:1e4}),c(!1)},T.readAsDataURL(i)}catch(C){const R=C instanceof Error?C.message:"Failed to generate diagram";w(R),f(0),v(""),k.dismiss(j),k.error("Upload failed  retry or contact support",{description:R,action:{label:"Retry",onClick:()=>{w(null),N()}},duration:1e4}),c(!1)}};return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(Ha,{}),o.jsx("main",{className:"pt-24 pb-20",children:o.jsxs("div",{className:"container mx-auto px-6",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-primary/10 mb-6",children:o.jsx(Gl,{className:"h-10 w-10 text-primary"})}),o.jsxs("h1",{className:"text-5xl font-bold mb-4",children:["Vision ",o.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"AI"})]}),o.jsx("p",{className:"text-xl text-muted-foreground max-w-3xl mx-auto",children:"See what computers see. Our advanced vision AI technology enables your automation to understand and process visual information just like humans do."})]}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center mb-20",children:[o.jsxs("div",{className:"space-y-6",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Self-Learning Vision System"}),o.jsx("p",{className:"text-lg text-muted-foreground",children:"Our Vision AI continuously learns and adapts to your specific use cases, improving accuracy and performance over time without manual intervention."}),o.jsxs("ul",{className:"space-y-4",children:[o.jsxs("li",{className:"flex items-start gap-3",children:[o.jsx(YC,{className:"h-6 w-6 text-primary flex-shrink-0 mt-1"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold mb-1",children:"Real-time Processing"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Process images and video streams in real-time with minimal latency"})]})]}),o.jsxs("li",{className:"flex items-start gap-3",children:[o.jsx(y2,{className:"h-6 w-6 text-primary flex-shrink-0 mt-1"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold mb-1",children:"Object Detection"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Identify and track multiple objects across frames"})]})]}),o.jsxs("li",{className:"flex items-start gap-3",children:[o.jsx(Ri,{className:"h-6 w-6 text-primary flex-shrink-0 mt-1"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold mb-1",children:"Image Classification"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically categorize and tag visual content"})]})]})]}),o.jsx(U,{size:"lg",className:"mt-6",onClick:b,children:"Start Free Trial"})]}),o.jsxs("div",{className:"bg-gradient-to-br from-primary/10 to-accent/10 rounded-2xl p-12 text-center",children:[o.jsx(Gl,{className:"h-32 w-32 mx-auto text-primary mb-6"}),o.jsx("h3",{className:"text-xl font-bold mb-4",children:"100% Client-Side Processing"}),o.jsx("p",{className:"text-muted-foreground",children:"All vision processing happens on your device. Your data never leaves your control, ensuring maximum privacy and security."})]})]}),o.jsxs("div",{className:"bg-hero-bg text-hero-foreground rounded-2xl p-12 text-center",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Ready to See the Future?"}),o.jsx("p",{className:"text-xl text-hero-foreground/80 mb-8 max-w-2xl mx-auto",children:"Join thousands of companies already using ProssMind Vision AI to transform their automation workflows"}),o.jsx(U,{size:"lg",variant:"secondary",className:"text-lg px-8",onClick:b,children:"Get Started Now"})]})]})}),o.jsx(hn,{open:t,onOpenChange:e,children:o.jsxs(en,{className:"max-w-4xl",children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"See Vision AI in Action"}),o.jsx(rn,{children:"Watch how Vision AI transforms handwritten notes, whiteboard diagrams, and process sketches into professional BPMN diagrams"})]}),o.jsx("div",{className:"aspect-video bg-muted rounded-lg flex items-center justify-center",children:o.jsx("iframe",{width:"100%",height:"100%",src:"https://www.youtube.com/embed/gvwvmUy_wrw",title:"BPMN Process Modeling Demo",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"rounded-lg"})}),o.jsxs("div",{className:"flex justify-end gap-4",children:[o.jsx(U,{variant:"outline",onClick:x,children:"Skip Demo"}),o.jsx(U,{onClick:x,children:"Try It Now"})]})]})}),o.jsx(hn,{open:n,onOpenChange:r,children:o.jsxs(en,{className:"max-w-2xl",children:[o.jsxs(tn,{children:[o.jsx(nn,{children:"Upload Your Process"}),o.jsx(rn,{children:"Upload handwritten notes, whiteboard images, process documents, or text files to generate a diagram"})]}),o.jsx("div",{className:"space-y-6",children:o.jsxs(Kj,{value:u,onValueChange:j=>h(j),className:"w-full",children:[o.jsxs(Pg,{className:"grid w-full grid-cols-2",children:[o.jsx(ic,{value:"bpmn",children:"BPMN Diagram"}),o.jsx(ic,{value:"pid",children:"P&ID Diagram"})]}),o.jsxs(sc,{value:"bpmn",className:"mt-6 space-y-6",children:[o.jsxs("div",{className:"bg-card border-2 border-dashed border-border rounded-lg p-8 text-center hover:border-primary/50 transition-colors",children:[o.jsx("input",{type:"file",accept:"image/*,.pdf,.doc,.docx,.txt,video/*",onChange:E,className:"hidden",id:"file-upload",disabled:a}),o.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center gap-4",children:[o.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:o.jsx(xv,{className:"w-8 h-8 text-primary"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-lg font-semibold mb-1",children:i?i.name:"Drop or record your process video"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Images, PDF, Word documents, text files, or videos"}),o.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"MP4/MOV  200 MB"})]})]}),a&&p>0&&o.jsxs("div",{className:"mt-6 space-y-2",children:[o.jsx(Ln,{value:p,className:"w-full"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:m})]}),g&&o.jsx("div",{className:"mt-4 p-3 bg-destructive/10 border border-destructive/20 rounded-lg",children:o.jsx("p",{className:"text-sm text-destructive",children:g})})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{className:"flex flex-col items-center gap-2 p-4 bg-muted rounded-lg",children:[o.jsx(Ri,{className:"w-8 h-8 text-primary"}),o.jsx("span",{className:"text-sm font-medium",children:"Images"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"JPG, PNG, WEBP"})]}),o.jsxs("div",{className:"flex flex-col items-center gap-2 p-4 bg-muted rounded-lg",children:[o.jsx(or,{className:"w-8 h-8 text-primary"}),o.jsx("span",{className:"text-sm font-medium",children:"Documents"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"PDF, DOC, DOCX"})]}),o.jsxs("div",{className:"flex flex-col items-center gap-2 p-4 bg-muted rounded-lg",children:[o.jsx(or,{className:"w-8 h-8 text-primary"}),o.jsx("span",{className:"text-sm font-medium",children:"Text"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"TXT files"})]})]}),o.jsxs("div",{className:"flex justify-end gap-4",children:[o.jsx(U,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),o.jsx(U,{onClick:N,disabled:!i||a,children:a?"Generating...":"Generate BPMN"})]})]}),o.jsxs(sc,{value:"pid",className:"mt-6 space-y-6",children:[o.jsxs("div",{className:"bg-card border-2 border-dashed border-border rounded-lg p-8 text-center hover:border-primary/50 transition-colors",children:[o.jsx("input",{type:"file",accept:"image/*,.pdf,.doc,.docx,.txt,video/*",onChange:E,className:"hidden",id:"file-upload-pid",disabled:a}),o.jsxs("label",{htmlFor:"file-upload-pid",className:"cursor-pointer flex flex-col items-center gap-4",children:[o.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:o.jsx(xv,{className:"w-8 h-8 text-primary"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-lg font-semibold mb-1",children:i?i.name:"Drop or record your process video"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Images, PDF, Word documents, text files, or videos"}),o.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"MP4/MOV  200 MB"})]})]}),a&&p>0&&o.jsxs("div",{className:"mt-6 space-y-2",children:[o.jsx(Ln,{value:p,className:"w-full"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:m})]}),g&&o.jsx("div",{className:"mt-4 p-3 bg-destructive/10 border border-destructive/20 rounded-lg",children:o.jsx("p",{className:"text-sm text-destructive",children:g})})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{className:"flex flex-col items-center gap-2 p-4 bg-muted rounded-lg",children:[o.jsx(Ri,{className:"w-8 h-8 text-primary"}),o.jsx("span",{className:"text-sm font-medium",children:"Images"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"JPG, PNG, WEBP"})]}),o.jsxs("div",{className:"flex flex-col items-center gap-2 p-4 bg-muted rounded-lg",children:[o.jsx(or,{className:"w-8 h-8 text-primary"}),o.jsx("span",{className:"text-sm font-medium",children:"Documents"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"PDF, DOC, DOCX"})]}),o.jsxs("div",{className:"flex flex-col items-center gap-2 p-4 bg-muted rounded-lg",children:[o.jsx(or,{className:"w-8 h-8 text-primary"}),o.jsx("span",{className:"text-sm font-medium",children:"Text"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"TXT files"})]})]}),o.jsxs("div",{className:"flex justify-end gap-4",children:[o.jsx(U,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),o.jsx(U,{onClick:N,disabled:!i||a,children:a?"Generating...":"Generate P&ID"})]})]})]})})]})})]})},H6=()=>o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(Ha,{}),o.jsx("main",{className:"pt-24 pb-20",children:o.jsxs(zu,{children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsxs("h1",{className:"text-5xl font-bold mb-4",children:["Simple, ",o.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Transparent"})," Pricing"]}),o.jsx("p",{className:"text-xl text-muted-foreground max-w-3xl mx-auto",children:"Choose the plan that fits your needs. All plans include our core automation features."})]}),o.jsx(AN,{}),o.jsxs("div",{className:"mt-20 bg-muted/30 rounded-2xl p-12",children:[o.jsx("h2",{className:"text-3xl font-bold text-center mb-12",children:"All Plans Include"}),o.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx($n,{className:"h-6 w-6 text-primary flex-shrink-0 mt-1"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold mb-2",children:"99.9% Uptime SLA"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Reliable service you can count on"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx($n,{className:"h-6 w-6 text-primary flex-shrink-0 mt-1"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold mb-2",children:"24/7 Support"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Help whenever you need it"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx($n,{className:"h-6 w-6 text-primary flex-shrink-0 mt-1"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold mb-2",children:"Free Updates"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Always get the latest features"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx($n,{className:"h-6 w-6 text-primary flex-shrink-0 mt-1"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold mb-2",children:"Data Encryption"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Bank-level security for your data"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx($n,{className:"h-6 w-6 text-primary flex-shrink-0 mt-1"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold mb-2",children:"API Access"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Integrate with your tools"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx($n,{className:"h-6 w-6 text-primary flex-shrink-0 mt-1"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold mb-2",children:"No Hidden Fees"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"What you see is what you pay"})]})]})]})]})]})})]});var MN={exports:{}},DN={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ia=y;function V6(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var G6=typeof Object.is=="function"?Object.is:V6,W6=Ia.useState,q6=Ia.useEffect,K6=Ia.useLayoutEffect,Y6=Ia.useDebugValue;function Z6(t,e){var n=e(),r=W6({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return K6(function(){i.value=n,i.getSnapshot=e,Uh(i)&&s({inst:i})},[t,n,e]),q6(function(){return Uh(i)&&s({inst:i}),t(function(){Uh(i)&&s({inst:i})})},[t]),Y6(n),n}function Uh(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!G6(t,n)}catch{return!0}}function X6(t,e){return e()}var J6=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?X6:Z6;DN.useSyncExternalStore=Ia.useSyncExternalStore!==void 0?Ia.useSyncExternalStore:J6;MN.exports=DN;var Q6=MN.exports;function eF(){return Q6.useSyncExternalStore(tF,()=>!0,()=>!1)}function tF(){return()=>{}}var Rg="Avatar",[nF,wz]=Vn(Rg),[rF,ON]=nF(Rg),$N=y.forwardRef((t,e)=>{const{__scopeAvatar:n,...r}=t,[i,s]=y.useState("idle");return o.jsx(rF,{scope:n,imageLoadingStatus:i,onImageLoadingStatusChange:s,children:o.jsx(Pe.span,{...r,ref:e})})});$N.displayName=Rg;var LN="AvatarImage",BN=y.forwardRef((t,e)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:i=()=>{},...s}=t,a=ON(LN,n),c=iF(r,s),l=Tn(d=>{i(d),a.onImageLoadingStatusChange(d)});return jn(()=>{c!=="idle"&&l(c)},[c,l]),c==="loaded"?o.jsx(Pe.img,{...s,ref:e,src:r}):null});BN.displayName=LN;var FN="AvatarFallback",zN=y.forwardRef((t,e)=>{const{__scopeAvatar:n,delayMs:r,...i}=t,s=ON(FN,n),[a,c]=y.useState(r===void 0);return y.useEffect(()=>{if(r!==void 0){const l=window.setTimeout(()=>c(!0),r);return()=>window.clearTimeout(l)}},[r]),a&&s.imageLoadingStatus!=="loaded"?o.jsx(Pe.span,{...i,ref:e}):null});zN.displayName=FN;function Pb(t,e){return t?e?(t.src!==e&&(t.src=e),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function iF(t,{referrerPolicy:e,crossOrigin:n}){const r=eF(),i=y.useRef(null),s=r?(i.current||(i.current=new window.Image),i.current):null,[a,c]=y.useState(()=>Pb(s,t));return jn(()=>{c(Pb(s,t))},[s,t]),jn(()=>{const l=h=>()=>{c(h)};if(!s)return;const d=l("loaded"),u=l("error");return s.addEventListener("load",d),s.addEventListener("error",u),e&&(s.referrerPolicy=e),typeof n=="string"&&(s.crossOrigin=n),()=>{s.removeEventListener("load",d),s.removeEventListener("error",u)}},[s,n,e]),a}var UN=$N,HN=BN,VN=zN;const GN=y.forwardRef(({className:t,...e},n)=>o.jsx(UN,{ref:n,className:J("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));GN.displayName=UN.displayName;const WN=y.forwardRef(({className:t,...e},n)=>o.jsx(HN,{ref:n,className:J("aspect-square h-full w-full object-cover",t),...e}));WN.displayName=HN.displayName;const qN=y.forwardRef(({className:t,...e},n)=>o.jsx(VN,{ref:n,className:J("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));qN.displayName=VN.displayName;const sF=[{name:"Mayank Sharma",role:"CEO & Founder",description:"Finance and digital transformation leader driving data-powered, innovative tech solutions.",image:"/mayank.png",initials:"MS"},{name:"Satyam Pant",role:"Cofounder & AI Solutions",description:"Tech innovator specializing in AI-driven business process solutions.",image:"/satyam.jpeg",initials:"SP"},{name:"Divyam Pant",role:"CTO & Head of Product",description:"Product strategist focused on creating intuitive workflow automation tools.",image:"/divyam.jpeg",initials:"DP"},{name:"Sahil Pandey",role:"DevOps Engineer",description:"Full-stack engineer passionate about building scalable BPMN solutions.",image:"/sahil.jpeg",initials:"SP"}],aF=()=>{const[t,e]=y.useState({name:"",email:"",subject:"",message:""}),n=r=>{r.preventDefault(),k.success("Message sent! We'll get back to you soon."),e({name:"",email:"",subject:"",message:""})};return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(Ha,{}),o.jsx("main",{className:"pt-24 pb-20",children:o.jsxs(zu,{children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsxs("h1",{className:"text-5xl font-bold mb-4",children:["Get in"," ",o.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Touch"})]}),o.jsx("p",{className:"text-xl text-muted-foreground max-w-3xl mx-auto",children:"Have questions? We'd love to hear from you. Send us a message and we'll respond as soon as possible."})]}),o.jsxs("div",{className:"grid md:grid-cols-3 gap-8 mb-16",children:[o.jsxs("div",{className:"bg-card border border-border rounded-xl p-6 text-center transition-all duration-300 cursor-pointer hover:shadow-[0_0_20px_rgba(59,130,246,0.5)] hover:shadow-blue-500/50 hover:scale-[1.02] hover:-translate-y-1",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4 transition-all duration-300",children:o.jsx(s2,{className:"h-6 w-6 text-primary"})}),o.jsx("h3",{className:"font-semibold mb-2",children:"Email Us"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"info@prossmind.com"})]}),o.jsxs("div",{className:"bg-card border border-border rounded-xl p-6 text-center transition-all duration-300 cursor-pointer hover:shadow-[0_0_20px_rgba(59,130,246,0.5)] hover:shadow-blue-500/50 hover:scale-[1.02] hover:-translate-y-1",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4 transition-all duration-300",children:o.jsx(f2,{className:"h-6 w-6 text-primary"})}),o.jsx("h3",{className:"font-semibold mb-2",children:"Call Us"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"+41 78 330 79 67"})]}),o.jsxs("div",{className:"bg-card border border-border rounded-xl p-6 text-center transition-all duration-300 cursor-pointer hover:shadow-[0_0_20px_rgba(59,130,246,0.5)] hover:shadow-blue-500/50 hover:scale-[1.02] hover:-translate-y-1",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4 transition-all duration-300",children:o.jsx(jf,{className:"h-6 w-6 text-primary"})}),o.jsx("h3",{className:"font-semibold mb-2",children:"Live Chat"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Available 24/7"})]})]}),o.jsxs("div",{className:"mb-16",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Meet Our"," ",o.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Team"})]}),o.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"The passionate people behind ProssMind"})]}),o.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8",children:sF.map(r=>o.jsx(es,{className:"text-center transition-all duration-300 cursor-pointer hover:shadow-[0_0_20px_rgba(59,130,246,0.5)] hover:shadow-blue-500/50 hover:scale-[1.03] hover:-translate-y-2",children:o.jsxs(ts,{className:"pt-6 pb-6",children:[o.jsxs(GN,{className:"w-24 h-24 mx-auto mb-4 transition-all duration-300",children:[o.jsx(WN,{src:r.image,alt:r.name}),o.jsx(qN,{className:"bg-primary/10 text-primary text-xl",children:r.initials})]}),o.jsx("h3",{className:"font-semibold text-lg mb-1",children:r.name}),o.jsx("p",{className:"text-sm text-primary mb-3",children:r.role}),o.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:r.description})]})},r.name))})]}),o.jsx("div",{className:"max-w-2xl mx-auto",children:o.jsxs("form",{onSubmit:n,className:"bg-card border border-border rounded-2xl p-8 space-y-6 transition-all duration-300 hover:shadow-[0_0_20px_rgba(59,130,246,0.3)] hover:shadow-blue-500/30",children:[o.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{htmlFor:"name",className:"text-sm font-medium",children:"Name"}),o.jsx(Kt,{id:"name",value:t.name,onChange:r=>e({...t,name:r.target.value}),placeholder:"Your name",className:"transition-all duration-300 focus:shadow-[0_0_15px_rgba(59,130,246,0.4)] focus:shadow-blue-500/40",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),o.jsx(Kt,{id:"email",type:"email",value:t.email,onChange:r=>e({...t,email:r.target.value}),placeholder:"your@email.com",className:"transition-all duration-300 focus:shadow-[0_0_15px_rgba(59,130,246,0.4)] focus:shadow-blue-500/40",required:!0})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{htmlFor:"subject",className:"text-sm font-medium",children:"Subject"}),o.jsx(Kt,{id:"subject",value:t.subject,onChange:r=>e({...t,subject:r.target.value}),placeholder:"How can we help?",className:"transition-all duration-300 focus:shadow-[0_0_15px_rgba(59,130,246,0.4)] focus:shadow-blue-500/40",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{htmlFor:"message",className:"text-sm font-medium",children:"Message"}),o.jsx(Er,{id:"message",value:t.message,onChange:r=>e({...t,message:r.target.value}),placeholder:"Tell us more about your inquiry...",className:"min-h-[150px] transition-all duration-300 focus:shadow-[0_0_15px_rgba(59,130,246,0.4)] focus:shadow-blue-500/40",required:!0})]}),o.jsx(U,{type:"submit",size:"lg",className:"w-full transition-all duration-300 hover:shadow-[0_0_20px_rgba(59,130,246,0.6)] hover:shadow-blue-500/60 hover:scale-[1.02]",children:"Send Message"})]})})]})})]})};var rt;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function n(i){throw new Error}t.assertNever=n,t.arrayToEnum=i=>{const s={};for(const a of i)s[a]=a;return s},t.getValidEnumValues=i=>{const s=t.objectKeys(i).filter(c=>typeof i[i[c]]!="number"),a={};for(const c of s)a[c]=i[c];return t.objectValues(a)},t.objectValues=i=>t.objectKeys(i).map(function(s){return i[s]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&s.push(a);return s},t.find=(i,s)=>{for(const a of i)if(s(a))return a},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}t.joinValues=r,t.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(rt||(rt={}));var Tb;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(Tb||(Tb={}));const me=rt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),_i=t=>{switch(typeof t){case"undefined":return me.undefined;case"string":return me.string;case"number":return Number.isNaN(t)?me.nan:me.number;case"boolean":return me.boolean;case"function":return me.function;case"bigint":return me.bigint;case"symbol":return me.symbol;case"object":return Array.isArray(t)?me.array:t===null?me.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?me.promise:typeof Map<"u"&&t instanceof Map?me.map:typeof Set<"u"&&t instanceof Set?me.set:typeof Date<"u"&&t instanceof Date?me.date:me.object;default:return me.unknown}},X=rt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Zr extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(s){return s.message},r={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let c=r,l=0;for(;l<a.path.length;){const d=a.path[l];l===a.path.length-1?(c[d]=c[d]||{_errors:[]},c[d]._errors.push(n(a))):c[d]=c[d]||{_errors:[]},c=c[d],l++}}};return i(this),r}static assert(e){if(!(e instanceof Zr))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,rt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const i of this.issues)if(i.path.length>0){const s=i.path[0];n[s]=n[s]||[],n[s].push(e(i))}else r.push(e(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Zr.create=t=>new Zr(t);const Qp=(t,e)=>{let n;switch(t.code){case X.invalid_type:t.received===me.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case X.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,rt.jsonStringifyReplacer)}`;break;case X.unrecognized_keys:n=`Unrecognized key(s) in object: ${rt.joinValues(t.keys,", ")}`;break;case X.invalid_union:n="Invalid input";break;case X.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${rt.joinValues(t.options)}`;break;case X.invalid_enum_value:n=`Invalid enum value. Expected ${rt.joinValues(t.options)}, received '${t.received}'`;break;case X.invalid_arguments:n="Invalid function arguments";break;case X.invalid_return_type:n="Invalid function return type";break;case X.invalid_date:n="Invalid date";break;case X.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:rt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case X.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case X.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case X.custom:n="Invalid input";break;case X.invalid_intersection_types:n="Intersection results could not be merged";break;case X.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case X.not_finite:n="Number must be finite";break;default:n=e.defaultError,rt.assertNever(t)}return{message:n}};let oF=Qp;function cF(){return oF}const lF=t=>{const{data:e,path:n,errorMaps:r,issueData:i}=t,s=[...n,...i.path||[]],a={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let c="";const l=r.filter(d=>!!d).slice().reverse();for(const d of l)c=d(a,{data:e,defaultError:c}).message;return{...i,path:s,message:c}};function le(t,e){const n=cF(),r=lF({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Qp?void 0:Qp].filter(i=>!!i)});t.common.issues.push(r)}class An{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const i of n){if(i.status==="aborted")return Ae;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const i of n){const s=await i.key,a=await i.value;r.push({key:s,value:a})}return An.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const i of n){const{key:s,value:a}=i;if(s.status==="aborted"||a.status==="aborted")return Ae;s.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(r[s.value]=a.value)}return{status:e.value,value:r}}}const Ae=Object.freeze({status:"aborted"}),Ao=t=>({status:"dirty",value:t}),Jn=t=>({status:"valid",value:t}),Rb=t=>t.status==="aborted",Ab=t=>t.status==="dirty",Ma=t=>t.status==="valid",pd=t=>typeof Promise<"u"&&t instanceof Promise;var ge;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ge||(ge={}));class Mi{constructor(e,n,r,i){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ib=(t,e)=>{if(Ma(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Zr(t.common.issues);return this._error=n,this._error}}};function Ge(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:i}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,c)=>{const{message:l}=t;return a.code==="invalid_enum_value"?{message:l??c.defaultError}:typeof c.data>"u"?{message:l??r??c.defaultError}:a.code!=="invalid_type"?{message:c.defaultError}:{message:l??n??c.defaultError}},description:i}}class tt{get description(){return this._def.description}_getType(e){return _i(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:_i(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new An,ctx:{common:e.parent.common,data:e.data,parsedType:_i(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(pd(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:_i(e)},i=this._parseSync({data:e,path:r.path,parent:r});return Ib(r,i)}"~validate"(e){var r,i;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:_i(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:n});return Ma(s)?{value:s.value}:{issues:n.common.issues}}catch(s){(i=(r=s==null?void 0:s.message)==null?void 0:r.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(s=>Ma(s)?{value:s.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:_i(e)},i=this._parse({data:e,path:r.path,parent:r}),s=await(pd(i)?i:Promise.resolve(i));return Ib(r,s)}refine(e,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,s)=>{const a=e(i),c=()=>s.addIssue({code:X.custom,...r(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(c(),!1)):a?!0:(c(),!1)})}refinement(e,n){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(e){return new Oa({schema:this,typeName:Ie.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Ii.create(this,this._def)}nullable(){return $a.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Sr.create(this)}promise(){return vd.create(this,this._def)}or(e){return md.create([this,e],this._def)}and(e){return gd.create(this,e,this._def)}transform(e){return new Oa({...Ge(this._def),schema:this,typeName:Ie.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new tf({...Ge(this._def),innerType:this,defaultValue:n,typeName:Ie.ZodDefault})}brand(){return new AF({typeName:Ie.ZodBranded,type:this,...Ge(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new nf({...Ge(this._def),innerType:this,catchValue:n,typeName:Ie.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Ag.create(this,e)}readonly(){return rf.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const dF=/^c[^\s-]{8,}$/i,uF=/^[0-9a-z]+$/,hF=/^[0-9A-HJKMNP-TV-Z]{26}$/i,pF=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,fF=/^[a-z0-9_-]{21}$/i,mF=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,gF=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,vF=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,yF="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Hh;const xF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,bF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,wF=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,_F=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,EF=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,SF=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,KN="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",jF=new RegExp(`^${KN}$`);function YN(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function NF(t){return new RegExp(`^${YN(t)}$`)}function kF(t){let e=`${KN}T${YN(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function CF(t,e){return!!((e==="v4"||!e)&&xF.test(t)||(e==="v6"||!e)&&wF.test(t))}function PF(t,e){if(!mF.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function TF(t,e){return!!((e==="v4"||!e)&&bF.test(t)||(e==="v6"||!e)&&_F.test(t))}class Ti extends tt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==me.string){const s=this._getOrReturnCtx(e);return le(s,{code:X.invalid_type,expected:me.string,received:s.parsedType}),Ae}const r=new An;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),le(i,{code:X.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),le(i,{code:X.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const a=e.data.length>s.value,c=e.data.length<s.value;(a||c)&&(i=this._getOrReturnCtx(e,i),a?le(i,{code:X.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):c&&le(i,{code:X.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")vF.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"email",code:X.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")Hh||(Hh=new RegExp(yF,"u")),Hh.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"emoji",code:X.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")pF.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"uuid",code:X.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")fF.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"nanoid",code:X.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")dF.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"cuid",code:X.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")uF.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"cuid2",code:X.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")hF.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"ulid",code:X.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),le(i,{validation:"url",code:X.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"regex",code:X.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),le(i,{code:X.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),le(i,{code:X.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),le(i,{code:X.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?kF(s).test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{code:X.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?jF.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{code:X.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?NF(s).test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{code:X.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?gF.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"duration",code:X.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?CF(e.data,s.version)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"ip",code:X.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?PF(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"jwt",code:X.invalid_string,message:s.message}),r.dirty()):s.kind==="cidr"?TF(e.data,s.version)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"cidr",code:X.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?EF.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"base64",code:X.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?SF.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"base64url",code:X.invalid_string,message:s.message}),r.dirty()):rt.assertNever(s);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(i=>e.test(i),{validation:n,code:X.invalid_string,...ge.errToObj(r)})}_addCheck(e){return new Ti({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ge.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ge.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ge.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ge.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ge.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ge.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ge.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ge.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ge.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ge.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ge.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ge.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ge.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...ge.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ge.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ge.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...ge.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...ge.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...ge.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...ge.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...ge.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...ge.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...ge.errToObj(n)})}nonempty(e){return this.min(1,ge.errToObj(e))}trim(){return new Ti({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ti({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ti({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ti.create=t=>new Ti({checks:[],typeName:Ie.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...Ge(t)});function RF(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=n>r?n:r,s=Number.parseInt(t.toFixed(i).replace(".","")),a=Number.parseInt(e.toFixed(i).replace(".",""));return s%a/10**i}class ac extends tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==me.number){const s=this._getOrReturnCtx(e);return le(s,{code:X.invalid_type,expected:me.number,received:s.parsedType}),Ae}let r;const i=new An;for(const s of this._def.checks)s.kind==="int"?rt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),le(r,{code:X.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),le(r,{code:X.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),le(r,{code:X.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?RF(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),le(r,{code:X.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),le(r,{code:X.not_finite,message:s.message}),i.dirty()):rt.assertNever(s);return{status:i.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ge.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ge.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ge.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ge.toString(n))}setLimit(e,n,r,i){return new ac({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ge.toString(i)}]})}_addCheck(e){return new ac({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ge.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ge.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ge.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ge.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ge.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ge.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:ge.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ge.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ge.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&rt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}ac.create=t=>new ac({checks:[],typeName:Ie.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ge(t)});class oc extends tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==me.bigint)return this._getInvalidInput(e);let r;const i=new An;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),le(r,{code:X.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),le(r,{code:X.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),le(r,{code:X.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):rt.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return le(n,{code:X.invalid_type,expected:me.bigint,received:n.parsedType}),Ae}gte(e,n){return this.setLimit("min",e,!0,ge.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ge.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ge.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ge.toString(n))}setLimit(e,n,r,i){return new oc({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ge.toString(i)}]})}_addCheck(e){return new oc({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ge.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ge.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ge.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ge.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ge.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}oc.create=t=>new oc({checks:[],typeName:Ie.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...Ge(t)});class Mb extends tt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==me.boolean){const r=this._getOrReturnCtx(e);return le(r,{code:X.invalid_type,expected:me.boolean,received:r.parsedType}),Ae}return Jn(e.data)}}Mb.create=t=>new Mb({typeName:Ie.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ge(t)});class fd extends tt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==me.date){const s=this._getOrReturnCtx(e);return le(s,{code:X.invalid_type,expected:me.date,received:s.parsedType}),Ae}if(Number.isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return le(s,{code:X.invalid_date}),Ae}const r=new An;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),le(i,{code:X.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),le(i,{code:X.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):rt.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new fd({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:ge.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:ge.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}fd.create=t=>new fd({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Ie.ZodDate,...Ge(t)});class Db extends tt{_parse(e){if(this._getType(e)!==me.symbol){const r=this._getOrReturnCtx(e);return le(r,{code:X.invalid_type,expected:me.symbol,received:r.parsedType}),Ae}return Jn(e.data)}}Db.create=t=>new Db({typeName:Ie.ZodSymbol,...Ge(t)});class Ob extends tt{_parse(e){if(this._getType(e)!==me.undefined){const r=this._getOrReturnCtx(e);return le(r,{code:X.invalid_type,expected:me.undefined,received:r.parsedType}),Ae}return Jn(e.data)}}Ob.create=t=>new Ob({typeName:Ie.ZodUndefined,...Ge(t)});class $b extends tt{_parse(e){if(this._getType(e)!==me.null){const r=this._getOrReturnCtx(e);return le(r,{code:X.invalid_type,expected:me.null,received:r.parsedType}),Ae}return Jn(e.data)}}$b.create=t=>new $b({typeName:Ie.ZodNull,...Ge(t)});class Lb extends tt{constructor(){super(...arguments),this._any=!0}_parse(e){return Jn(e.data)}}Lb.create=t=>new Lb({typeName:Ie.ZodAny,...Ge(t)});class Bb extends tt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Jn(e.data)}}Bb.create=t=>new Bb({typeName:Ie.ZodUnknown,...Ge(t)});class Di extends tt{_parse(e){const n=this._getOrReturnCtx(e);return le(n,{code:X.invalid_type,expected:me.never,received:n.parsedType}),Ae}}Di.create=t=>new Di({typeName:Ie.ZodNever,...Ge(t)});class Fb extends tt{_parse(e){if(this._getType(e)!==me.undefined){const r=this._getOrReturnCtx(e);return le(r,{code:X.invalid_type,expected:me.void,received:r.parsedType}),Ae}return Jn(e.data)}}Fb.create=t=>new Fb({typeName:Ie.ZodVoid,...Ge(t)});class Sr extends tt{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),i=this._def;if(n.parsedType!==me.array)return le(n,{code:X.invalid_type,expected:me.array,received:n.parsedType}),Ae;if(i.exactLength!==null){const a=n.data.length>i.exactLength.value,c=n.data.length<i.exactLength.value;(a||c)&&(le(n,{code:a?X.too_big:X.too_small,minimum:c?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(le(n,{code:X.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(le(n,{code:X.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,c)=>i.type._parseAsync(new Mi(n,a,n.path,c)))).then(a=>An.mergeArray(r,a));const s=[...n.data].map((a,c)=>i.type._parseSync(new Mi(n,a,n.path,c)));return An.mergeArray(r,s)}get element(){return this._def.type}min(e,n){return new Sr({...this._def,minLength:{value:e,message:ge.toString(n)}})}max(e,n){return new Sr({...this._def,maxLength:{value:e,message:ge.toString(n)}})}length(e,n){return new Sr({...this._def,exactLength:{value:e,message:ge.toString(n)}})}nonempty(e){return this.min(1,e)}}Sr.create=(t,e)=>new Sr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Ie.ZodArray,...Ge(e)});function ia(t){if(t instanceof jt){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Ii.create(ia(r))}return new jt({...t._def,shape:()=>e})}else return t instanceof Sr?new Sr({...t._def,type:ia(t.element)}):t instanceof Ii?Ii.create(ia(t.unwrap())):t instanceof $a?$a.create(ia(t.unwrap())):t instanceof Cs?Cs.create(t.items.map(e=>ia(e))):t}class jt extends tt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=rt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==me.object){const d=this._getOrReturnCtx(e);return le(d,{code:X.invalid_type,expected:me.object,received:d.parsedType}),Ae}const{status:r,ctx:i}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),c=[];if(!(this._def.catchall instanceof Di&&this._def.unknownKeys==="strip"))for(const d in i.data)a.includes(d)||c.push(d);const l=[];for(const d of a){const u=s[d],h=i.data[d];l.push({key:{status:"valid",value:d},value:u._parse(new Mi(i,h,i.path,d)),alwaysSet:d in i.data})}if(this._def.catchall instanceof Di){const d=this._def.unknownKeys;if(d==="passthrough")for(const u of c)l.push({key:{status:"valid",value:u},value:{status:"valid",value:i.data[u]}});else if(d==="strict")c.length>0&&(le(i,{code:X.unrecognized_keys,keys:c}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const u of c){const h=i.data[u];l.push({key:{status:"valid",value:u},value:d._parse(new Mi(i,h,i.path,u)),alwaysSet:u in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const d=[];for(const u of l){const h=await u.key,p=await u.value;d.push({key:h,value:p,alwaysSet:u.alwaysSet})}return d}).then(d=>An.mergeObjectSync(r,d)):An.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return ge.errToObj,new jt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,a;const i=((a=(s=this._def).errorMap)==null?void 0:a.call(s,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:ge.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new jt({...this._def,unknownKeys:"strip"})}passthrough(){return new jt({...this._def,unknownKeys:"passthrough"})}extend(e){return new jt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new jt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ie.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new jt({...this._def,catchall:e})}pick(e){const n={};for(const r of rt.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new jt({...this._def,shape:()=>n})}omit(e){const n={};for(const r of rt.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new jt({...this._def,shape:()=>n})}deepPartial(){return ia(this)}partial(e){const n={};for(const r of rt.objectKeys(this.shape)){const i=this.shape[r];e&&!e[r]?n[r]=i:n[r]=i.optional()}return new jt({...this._def,shape:()=>n})}required(e){const n={};for(const r of rt.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof Ii;)s=s._def.innerType;n[r]=s}return new jt({...this._def,shape:()=>n})}keyof(){return ZN(rt.objectKeys(this.shape))}}jt.create=(t,e)=>new jt({shape:()=>t,unknownKeys:"strip",catchall:Di.create(),typeName:Ie.ZodObject,...Ge(e)});jt.strictCreate=(t,e)=>new jt({shape:()=>t,unknownKeys:"strict",catchall:Di.create(),typeName:Ie.ZodObject,...Ge(e)});jt.lazycreate=(t,e)=>new jt({shape:t,unknownKeys:"strip",catchall:Di.create(),typeName:Ie.ZodObject,...Ge(e)});class md extends tt{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function i(s){for(const c of s)if(c.result.status==="valid")return c.result;for(const c of s)if(c.result.status==="dirty")return n.common.issues.push(...c.ctx.common.issues),c.result;const a=s.map(c=>new Zr(c.ctx.common.issues));return le(n,{code:X.invalid_union,unionErrors:a}),Ae}if(n.common.async)return Promise.all(r.map(async s=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(i);{let s;const a=[];for(const l of r){const d={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:d});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:d}),d.common.issues.length&&a.push(d.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const c=a.map(l=>new Zr(l));return le(n,{code:X.invalid_union,unionErrors:c}),Ae}}get options(){return this._def.options}}md.create=(t,e)=>new md({options:t,typeName:Ie.ZodUnion,...Ge(e)});function ef(t,e){const n=_i(t),r=_i(e);if(t===e)return{valid:!0,data:t};if(n===me.object&&r===me.object){const i=rt.objectKeys(e),s=rt.objectKeys(t).filter(c=>i.indexOf(c)!==-1),a={...t,...e};for(const c of s){const l=ef(t[c],e[c]);if(!l.valid)return{valid:!1};a[c]=l.data}return{valid:!0,data:a}}else if(n===me.array&&r===me.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<t.length;s++){const a=t[s],c=e[s],l=ef(a,c);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return n===me.date&&r===me.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class gd extends tt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=(s,a)=>{if(Rb(s)||Rb(a))return Ae;const c=ef(s.value,a.value);return c.valid?((Ab(s)||Ab(a))&&n.dirty(),{status:n.value,value:c.data}):(le(r,{code:X.invalid_intersection_types}),Ae)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,a])=>i(s,a)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}gd.create=(t,e,n)=>new gd({left:t,right:e,typeName:Ie.ZodIntersection,...Ge(n)});class Cs extends tt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==me.array)return le(r,{code:X.invalid_type,expected:me.array,received:r.parsedType}),Ae;if(r.data.length<this._def.items.length)return le(r,{code:X.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ae;!this._def.rest&&r.data.length>this._def.items.length&&(le(r,{code:X.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...r.data].map((a,c)=>{const l=this._def.items[c]||this._def.rest;return l?l._parse(new Mi(r,a,r.path,c)):null}).filter(a=>!!a);return r.common.async?Promise.all(s).then(a=>An.mergeArray(n,a)):An.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new Cs({...this._def,rest:e})}}Cs.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Cs({items:t,typeName:Ie.ZodTuple,rest:null,...Ge(e)})};class zb extends tt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==me.map)return le(r,{code:X.invalid_type,expected:me.map,received:r.parsedType}),Ae;const i=this._def.keyType,s=this._def.valueType,a=[...r.data.entries()].map(([c,l],d)=>({key:i._parse(new Mi(r,c,r.path,[d,"key"])),value:s._parse(new Mi(r,l,r.path,[d,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const l of a){const d=await l.key,u=await l.value;if(d.status==="aborted"||u.status==="aborted")return Ae;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),c.set(d.value,u.value)}return{status:n.value,value:c}})}else{const c=new Map;for(const l of a){const d=l.key,u=l.value;if(d.status==="aborted"||u.status==="aborted")return Ae;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),c.set(d.value,u.value)}return{status:n.value,value:c}}}}zb.create=(t,e,n)=>new zb({valueType:e,keyType:t,typeName:Ie.ZodMap,...Ge(n)});class cc extends tt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==me.set)return le(r,{code:X.invalid_type,expected:me.set,received:r.parsedType}),Ae;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(le(r,{code:X.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(le(r,{code:X.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const s=this._def.valueType;function a(l){const d=new Set;for(const u of l){if(u.status==="aborted")return Ae;u.status==="dirty"&&n.dirty(),d.add(u.value)}return{status:n.value,value:d}}const c=[...r.data.values()].map((l,d)=>s._parse(new Mi(r,l,r.path,d)));return r.common.async?Promise.all(c).then(l=>a(l)):a(c)}min(e,n){return new cc({...this._def,minSize:{value:e,message:ge.toString(n)}})}max(e,n){return new cc({...this._def,maxSize:{value:e,message:ge.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}cc.create=(t,e)=>new cc({valueType:t,minSize:null,maxSize:null,typeName:Ie.ZodSet,...Ge(e)});class Ub extends tt{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Ub.create=(t,e)=>new Ub({getter:t,typeName:Ie.ZodLazy,...Ge(e)});class Hb extends tt{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return le(n,{received:n.data,code:X.invalid_literal,expected:this._def.value}),Ae}return{status:"valid",value:e.data}}get value(){return this._def.value}}Hb.create=(t,e)=>new Hb({value:t,typeName:Ie.ZodLiteral,...Ge(e)});function ZN(t,e){return new Da({values:t,typeName:Ie.ZodEnum,...Ge(e)})}class Da extends tt{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return le(n,{expected:rt.joinValues(r),received:n.parsedType,code:X.invalid_type}),Ae}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return le(n,{received:n.data,code:X.invalid_enum_value,options:r}),Ae}return Jn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Da.create(e,{...this._def,...n})}exclude(e,n=this._def){return Da.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}Da.create=ZN;class Vb extends tt{_parse(e){const n=rt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==me.string&&r.parsedType!==me.number){const i=rt.objectValues(n);return le(r,{expected:rt.joinValues(i),received:r.parsedType,code:X.invalid_type}),Ae}if(this._cache||(this._cache=new Set(rt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const i=rt.objectValues(n);return le(r,{received:r.data,code:X.invalid_enum_value,options:i}),Ae}return Jn(e.data)}get enum(){return this._def.values}}Vb.create=(t,e)=>new Vb({values:t,typeName:Ie.ZodNativeEnum,...Ge(e)});class vd extends tt{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==me.promise&&n.common.async===!1)return le(n,{code:X.invalid_type,expected:me.promise,received:n.parsedType}),Ae;const r=n.parsedType===me.promise?n.data:Promise.resolve(n.data);return Jn(r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}vd.create=(t,e)=>new vd({type:t,typeName:Ie.ZodPromise,...Ge(e)});class Oa extends tt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ie.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:a=>{le(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const a=i.transform(r.data,s);if(r.common.async)return Promise.resolve(a).then(async c=>{if(n.value==="aborted")return Ae;const l=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return l.status==="aborted"?Ae:l.status==="dirty"||n.value==="dirty"?Ao(l.value):l});{if(n.value==="aborted")return Ae;const c=this._def.schema._parseSync({data:a,path:r.path,parent:r});return c.status==="aborted"?Ae:c.status==="dirty"||n.value==="dirty"?Ao(c.value):c}}if(i.type==="refinement"){const a=c=>{const l=i.refinement(c,s);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?Ae:(c.status==="dirty"&&n.dirty(),a(c.value),{status:n.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?Ae:(c.status==="dirty"&&n.dirty(),a(c.value).then(()=>({status:n.value,value:c.value}))))}if(i.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Ma(a))return Ae;const c=i.transform(a.value,s);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Ma(a)?Promise.resolve(i.transform(a.value,s)).then(c=>({status:n.value,value:c})):Ae);rt.assertNever(i)}}Oa.create=(t,e,n)=>new Oa({schema:t,typeName:Ie.ZodEffects,effect:e,...Ge(n)});Oa.createWithPreprocess=(t,e,n)=>new Oa({schema:e,effect:{type:"preprocess",transform:t},typeName:Ie.ZodEffects,...Ge(n)});class Ii extends tt{_parse(e){return this._getType(e)===me.undefined?Jn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ii.create=(t,e)=>new Ii({innerType:t,typeName:Ie.ZodOptional,...Ge(e)});class $a extends tt{_parse(e){return this._getType(e)===me.null?Jn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}$a.create=(t,e)=>new $a({innerType:t,typeName:Ie.ZodNullable,...Ge(e)});class tf extends tt{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===me.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}tf.create=(t,e)=>new tf({innerType:t,typeName:Ie.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ge(e)});class nf extends tt{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return pd(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Zr(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Zr(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}nf.create=(t,e)=>new nf({innerType:t,typeName:Ie.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ge(e)});class Gb extends tt{_parse(e){if(this._getType(e)!==me.nan){const r=this._getOrReturnCtx(e);return le(r,{code:X.invalid_type,expected:me.nan,received:r.parsedType}),Ae}return{status:"valid",value:e.data}}}Gb.create=t=>new Gb({typeName:Ie.ZodNaN,...Ge(t)});class AF extends tt{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Ag extends tt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Ae:s.status==="dirty"?(n.dirty(),Ao(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Ae:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,n){return new Ag({in:e,out:n,typeName:Ie.ZodPipeline})}}class rf extends tt{_parse(e){const n=this._def.innerType._parse(e),r=i=>(Ma(i)&&(i.value=Object.freeze(i.value)),i);return pd(n)?n.then(i=>r(i)):r(n)}unwrap(){return this._def.innerType}}rf.create=(t,e)=>new rf({innerType:t,typeName:Ie.ZodReadonly,...Ge(e)});jt.lazycreate;var Ie;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Ie||(Ie={}));const Wb=Ti.create;Di.create;Sr.create;const IF=jt.create;jt.strictCreate;md.create;gd.create;Cs.create;Da.create;vd.create;Ii.create;$a.create;const qb=IF({email:Wb().email("Invalid email address").max(255,"Email too long"),password:Wb().min(6,"Password must be at least 6 characters").max(100,"Password too long")}),MF=()=>{const t=Ps(),{toast:e}=bf(),[n,r]=y.useState(!1),[i,s]=y.useState(""),[a,c]=y.useState(""),[l,d]=y.useState(!1),[u,h]=y.useState(""),[p,f]=y.useState(!1),[m,v]=y.useState(""),[g,w]=y.useState("");y.useEffect(()=>{oe.auth.getSession().then(({data:{session:R}})=>{R&&t("/")});const{data:{subscription:C}}=oe.auth.onAuthStateChange((R,T)=>{T&&t("/")});return()=>C.unsubscribe()},[t]);const b=async C=>{C.preventDefault();const R=qb.safeParse({email:i,password:a});if(!R.success){e({variant:"destructive",title:"Validation Error",description:R.error.errors[0].message});return}r(!0);const{error:T}=await oe.auth.signUp({email:R.data.email,password:R.data.password});r(!1),T?T.message.includes("already registered")?e({variant:"destructive",title:"Account exists",description:"This email is already registered. Please sign in instead."}):e({variant:"destructive",title:"Sign up failed",description:T.message}):(w(R.data.email),f(!0),e({title:"Check your email!",description:"We've sent you a 6-digit verification code. Please enter it below."}))},x=async C=>{if(C.preventDefault(),m.length!==6){e({variant:"destructive",title:"Invalid OTP",description:"Please enter a 6-digit code"});return}r(!0);const{error:R}=await oe.auth.verifyOtp({email:g,token:m,type:"email"});r(!1),R?e({variant:"destructive",title:"Verification failed",description:R.message}):(e({title:"Success!",description:"Your email has been verified. You can now sign in."}),f(!1),v(""),w(""),s(""),c(""))},E=async()=>{r(!0);const{error:C}=await oe.auth.resend({type:"signup",email:g});r(!1),e(C?{variant:"destructive",title:"Resend failed",description:C.message}:{title:"OTP Resent",description:"Check your email for a new verification code."})},N=async C=>{C.preventDefault();const R=qb.safeParse({email:i,password:a});if(!R.success){e({variant:"destructive",title:"Validation Error",description:R.error.errors[0].message});return}r(!0);const{error:T}=await oe.auth.signInWithPassword({email:R.data.email,password:R.data.password});r(!1),T&&e({variant:"destructive",title:"Sign in failed",description:T.message})},j=async C=>{if(C.preventDefault(),!u.trim()){e({variant:"destructive",title:"Email required",description:"Please enter your email address"});return}r(!0);const{error:R}=await oe.auth.resetPasswordForEmail(u,{redirectTo:`${window.location.origin}/`});r(!1),R?e({variant:"destructive",title:"Password reset failed",description:R.message}):(e({title:"Check your email",description:"We've sent you a password reset link"}),d(!1),h(""))};return o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:o.jsxs(es,{className:"w-full max-w-md",children:[o.jsxs(Os,{children:[o.jsx($s,{className:"text-2xl text-center",children:"Welcome to ProssMind"}),o.jsx(eo,{className:"text-center",children:l?"Reset your password":p?"Verify your email":"Sign in or create an account to start generating BPMN diagrams"})]}),o.jsx(ts,{children:p?o.jsxs("form",{onSubmit:x,className:"space-y-4",children:[o.jsxs(U,{type:"button",variant:"ghost",onClick:()=>{f(!1),v(""),w("")},className:"mb-4 p-0 h-auto",children:[o.jsx(av,{className:"h-4 w-4 mr-2"}),"Back to sign up"]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(sn,{htmlFor:"otp",children:"Verification Code"}),o.jsx(Kt,{id:"otp",type:"text",placeholder:"Enter 6-digit code",value:m,onChange:C=>v(C.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,required:!0,disabled:n,className:"text-center text-2xl tracking-widest"}),o.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Enter the 6-digit code sent to ",g]})]}),o.jsx(U,{type:"submit",className:"w-full",disabled:n||m.length!==6,children:n?"Verifying...":"Verify Email"}),o.jsx(U,{type:"button",variant:"link",className:"w-full text-sm",onClick:E,disabled:n,children:"Didn't receive the code? Resend"})]}):l?o.jsxs("form",{onSubmit:j,className:"space-y-4",children:[o.jsxs(U,{type:"button",variant:"ghost",onClick:()=>d(!1),className:"mb-4 p-0 h-auto",children:[o.jsx(av,{className:"h-4 w-4 mr-2"}),"Back to sign in"]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(sn,{htmlFor:"reset-email",children:"Email"}),o.jsx(Kt,{id:"reset-email",type:"email",placeholder:"you@example.com",value:u,onChange:C=>h(C.target.value),required:!0,disabled:n})]}),o.jsx(U,{type:"submit",className:"w-full",disabled:n,children:n?"Sending...":"Send Reset Link"})]}):o.jsxs(Cg,{defaultValue:"signin",className:"w-full",children:[o.jsxs($u,{className:"grid w-full grid-cols-2",children:[o.jsx(Wr,{value:"signin",children:"Sign In"}),o.jsx(Wr,{value:"signup",children:"Sign Up"})]}),o.jsx(qr,{value:"signin",children:o.jsxs("form",{onSubmit:N,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(sn,{htmlFor:"signin-email",children:"Email"}),o.jsx(Kt,{id:"signin-email",type:"email",placeholder:"you@example.com",value:i,onChange:C=>s(C.target.value),required:!0,disabled:n})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(sn,{htmlFor:"signin-password",children:"Password"}),o.jsx(Kt,{id:"signin-password",type:"password",placeholder:"",value:a,onChange:C=>c(C.target.value),required:!0,disabled:n})]}),o.jsx(U,{type:"submit",className:"w-full",disabled:n,children:n?"Signing in...":"Sign In"}),o.jsx(U,{type:"button",variant:"link",className:"w-full text-sm",onClick:()=>d(!0),children:"Forgot password?"})]})}),o.jsx(qr,{value:"signup",children:o.jsxs("form",{onSubmit:b,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(sn,{htmlFor:"signup-email",children:"Email"}),o.jsx(Kt,{id:"signup-email",type:"email",placeholder:"you@example.com",value:i,onChange:C=>s(C.target.value),required:!0,disabled:n})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(sn,{htmlFor:"signup-password",children:"Password"}),o.jsx(Kt,{id:"signup-password",type:"password",placeholder:"",value:a,onChange:C=>c(C.target.value),required:!0,disabled:n}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Password must be at least 6 characters"})]}),o.jsx(U,{type:"submit",className:"w-full",disabled:n,children:n?"Creating account...":"Sign Up"})]})})]})})]})})},XN=y.forwardRef(({className:t,...e},n)=>o.jsx("div",{className:"relative w-full overflow-auto",children:o.jsx("table",{ref:n,className:J("w-full caption-bottom text-sm",t),...e})}));XN.displayName="Table";const JN=y.forwardRef(({className:t,...e},n)=>o.jsx("thead",{ref:n,className:J("[&_tr]:border-b",t),...e}));JN.displayName="TableHeader";const QN=y.forwardRef(({className:t,...e},n)=>o.jsx("tbody",{ref:n,className:J("[&_tr:last-child]:border-0",t),...e}));QN.displayName="TableBody";const DF=y.forwardRef(({className:t,...e},n)=>o.jsx("tfoot",{ref:n,className:J("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...e}));DF.displayName="TableFooter";const sf=y.forwardRef(({className:t,...e},n)=>o.jsx("tr",{ref:n,className:J("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",t),...e}));sf.displayName="TableRow";const Io=y.forwardRef(({className:t,...e},n)=>o.jsx("th",{ref:n,className:J("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...e}));Io.displayName="TableHead";const Mo=y.forwardRef(({className:t,...e},n)=>o.jsx("td",{ref:n,className:J("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...e}));Mo.displayName="TableCell";const OF=y.forwardRef(({className:t,...e},n)=>o.jsx("caption",{ref:n,className:J("mt-4 text-sm text-muted-foreground",t),...e}));OF.displayName="TableCaption";const $F=()=>{const t=Ps(),[e,n]=y.useState(null),[r,i]=y.useState(!0),[s,a]=y.useState(!1),[c,l]=y.useState([]);y.useEffect(()=>{const{data:{subscription:h}}=oe.auth.onAuthStateChange((p,f)=>{n((f==null?void 0:f.user)??null),f!=null&&f.user||t("/auth")});return oe.auth.getSession().then(({data:{session:p}})=>{n((p==null?void 0:p.user)??null),p!=null&&p.user||t("/auth")}),()=>h.unsubscribe()},[t]),y.useEffect(()=>{e&&(async()=>{if(e)try{const{data:p,error:f}=await oe.from("user_roles").select("role").eq("user_id",e.id).eq("role","admin").maybeSingle();if(f&&f.code!=="PGRST116"&&f.code!=="PGRST301"){console.error("Error checking admin status:",f),k.error("Failed to verify admin status"),t("/");return}const m=!!p;a(m),m||(k.error("Access denied: Admin privileges required"),t("/"))}catch(p){console.error("Unexpected error:",p),t("/")}finally{i(!1)}})()},[e,t]),y.useEffect(()=>{(async()=>{if(s)try{const{data:p,error:f}=await oe.from("user_profiles").select("*").order("created_at",{ascending:!1});if(f)throw f;const{data:m,error:v}=await oe.from("user_roles").select("user_id, role");if(v)throw v;const g=(m==null?void 0:m.reduce((b,x)=>(b[x.user_id]||(b[x.user_id]=[]),b[x.user_id].push(x.role),b),{}))||{},w=(p==null?void 0:p.map(b=>({...b,roles:g[b.user_id]||["user"]})))||[];l(w)}catch(p){console.error("Error fetching users:",p),k.error("Failed to load users")}})()},[s]);const d=async(h,p)=>{const f=p.includes("admin");try{if(f){const{error:b}=await oe.from("user_roles").delete().eq("user_id",h).eq("role","admin");if(b)throw b;k.success("Admin privileges revoked")}else{const{error:b}=await oe.from("user_roles").insert({user_id:h,role:"admin"});if(b)throw b;k.success("Admin privileges granted")}const{data:m}=await oe.from("user_profiles").select("*").order("created_at",{ascending:!1}),{data:v}=await oe.from("user_roles").select("user_id, role"),g=(v==null?void 0:v.reduce((b,x)=>(b[x.user_id]||(b[x.user_id]=[]),b[x.user_id].push(x.role),b),{}))||{},w=(m==null?void 0:m.map(b=>({...b,roles:g[b.user_id]||["user"]})))||[];l(w)}catch(m){console.error("Error toggling admin:",m),k.error("Failed to update admin status")}},u=async h=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{const{error:p}=await oe.auth.admin.deleteUser(h);if(p)throw p;k.success("User deleted successfully"),l(c.filter(f=>f.user_id!==h))}catch(p){console.error("Error deleting user:",p),k.error("Failed to delete user")}};return r?o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),o.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading..."})]})}):s?o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(Ha,{user:e}),o.jsxs("div",{className:"container mx-auto px-6 py-24",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[o.jsx(wa,{className:"h-8 w-8 text-primary"}),o.jsx("h1",{className:"text-4xl font-bold",children:"Admin Dashboard"})]}),o.jsxs(es,{children:[o.jsxs(Os,{children:[o.jsxs($s,{className:"flex items-center gap-2",children:[o.jsx(_2,{className:"h-5 w-5"}),"User Management"]}),o.jsx(eo,{children:"Manage users, assign roles, and control access permissions"})]}),o.jsx(ts,{children:o.jsxs(XN,{children:[o.jsx(JN,{children:o.jsxs(sf,{children:[o.jsx(Io,{children:"Email"}),o.jsx(Io,{children:"Roles"}),o.jsx(Io,{children:"Created At"}),o.jsx(Io,{children:"Actions"})]})}),o.jsx(QN,{children:c.map(h=>o.jsxs(sf,{children:[o.jsx(Mo,{className:"font-medium",children:h.email}),o.jsx(Mo,{children:o.jsx("div",{className:"flex gap-2",children:h.roles.map(p=>o.jsxs(gr,{variant:p==="admin"?"default":"secondary",children:[p==="admin"&&o.jsx(cv,{className:"h-3 w-3 mr-1"}),p]},p))})}),o.jsx(Mo,{children:new Date(h.created_at).toLocaleDateString()}),o.jsx(Mo,{children:o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(U,{variant:h.roles.includes("admin")?"destructive":"default",size:"sm",onClick:()=>d(h.user_id,h.roles),disabled:h.user_id===(e==null?void 0:e.id),children:[o.jsx(cv,{className:"h-4 w-4 mr-1"}),h.roles.includes("admin")?"Revoke Admin":"Make Admin"]}),o.jsx(U,{variant:"outline",size:"sm",onClick:()=>u(h.user_id),disabled:h.user_id===(e==null?void 0:e.id),children:o.jsx(l0,{className:"h-4 w-4"})})]})})]},h.id))})]})})]})]})]}):null},LF=()=>{const t=Ps();return y.useEffect(()=>{(async()=>{try{const{data:{user:n}}=await oe.auth.getUser();if(!n){k.error("Please log in"),t("/auth");return}const{data:r,error:i}=await oe.from("vision_bpmn_jobs").select("bpmn_xml").eq("user_id",n.id).eq("status","completed").order("completed_at",{ascending:!1}).limit(1).single();if(i||!(r!=null&&r.bpmn_xml)){k.error("No completed diagrams found"),t("/vision-ai");return}const s=localStorage.getItem("diagramType")||"bpmn",a=s==="bpmn"?"generatedBpmn":"generatedPid";localStorage.setItem(a,r.bpmn_xml);const c=s==="bpmn"?"BPMN":"P&ID";k.success(`${c} diagram loaded successfully!`),t("/")}catch(n){console.error("Error loading diagram:",n),k.error("Failed to load diagram"),t("/vision-ai")}})()},[t]),o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-muted-foreground",children:"Loading your diagram..."})]})})},BF=()=>{const t=af();return y.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),o.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-background via-muted/30 to-background",children:o.jsxs("div",{className:"text-center px-6 slide-up",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"mb-4 text-8xl md:text-9xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"404"}),o.jsx("div",{className:"h-1 w-24 bg-gradient-to-r from-primary to-accent mx-auto rounded-full"})]}),o.jsx("h2",{className:"mb-4 text-2xl md:text-3xl font-semibold",children:"Page Not Found"}),o.jsx("p",{className:"mb-8 text-lg text-muted-foreground max-w-md mx-auto",children:"The page you're looking for doesn't exist or has been moved."}),o.jsxs("a",{href:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-all shadow-lg hover:shadow-xl font-medium",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Return to Home"]})]})})},FF=new NT,ek=()=>o.jsx(CT,{client:FF,children:o.jsxs(nT,{children:[o.jsx(aP,{}),o.jsx(LP,{}),o.jsx(Ck,{children:o.jsxs(Pk,{children:[o.jsx(Ir,{path:"/",element:o.jsx(Dr,{children:o.jsx(B6,{})})}),o.jsx(Ir,{path:"/features",element:o.jsx(Dr,{children:o.jsx(z6,{})})}),o.jsx(Ir,{path:"/vision-ai",element:o.jsx(Dr,{children:o.jsx(U6,{})})}),o.jsx(Ir,{path:"/pricing",element:o.jsx(Dr,{children:o.jsx(H6,{})})}),o.jsx(Ir,{path:"/contact",element:o.jsx(Dr,{children:o.jsx(aF,{})})}),o.jsx(Ir,{path:"/auth",element:o.jsx(Dr,{children:o.jsx(MF,{})})}),o.jsx(Ir,{path:"/admin",element:o.jsx(Dr,{children:o.jsx($F,{})})}),o.jsx(Ir,{path:"/load-diagram",element:o.jsx(Dr,{children:o.jsx(LF,{})})}),o.jsx(Ir,{path:"*",element:o.jsx(Dr,{children:o.jsx(BF,{})})})]})})]})}),tk=()=>{const e=window.location.host.split(".");return e.length>2?e[0]:null},zF=()=>o.jsxs("div",{children:[o.jsx("h1",{children:"BPMN Subdomain"}),o.jsx("p",{children:"This is the BPMN subdomain."})]}),UF=({user:t,diagramType:e})=>{const n=Ps(),{remainingPrompts:r,hasUsedAllPrompts:i,usePrompt:s,isUnlimited:a}=h_(!!t),[c,l]=y.useState(""),[d,u]=y.useState(!1),[h,p]=y.useState(null),[f,m]=y.useState(!1),[v,g]=y.useState("en-US"),[w,b]=y.useState(null),[x,E]=y.useState(!1),[N,j]=y.useState(""),[C,R]=y.useState(!1),[T,$]=y.useState("idle"),[B,D]=y.useState("idle"),[q,F]=y.useState(!1),[xe,de]=y.useState(null),[Be,$e]=y.useState(!1),pe=y.useRef(null),Ke=y.useRef(null),Ye=y.useRef(null),Te=e==="bpmn"?["Create a customer onboarding process","Design an order fulfillment workflow","Build a support ticket resolution process","Generate an employee hiring workflow","Create an invoice approval process"]:["Create a chemical reactor cooling system","Design a water treatment process flow","Build a distillation column control loop","Generate a pump and valve configuration","Create a heat exchanger system"];y.useEffect(()=>{const K=e==="bpmn"?"generatedBpmn":"generatedPid",M=localStorage.getItem(K);if(M){p(M),localStorage.removeItem(K),localStorage.removeItem("diagramType");const G=e==="bpmn"?"BPMN":"P&ID";k.success(`Your generated ${G} diagram is ready!`,{description:"You can now view and edit your process diagram"}),setTimeout(()=>{var ne;(ne=document.getElementById("bpmn-viewer"))==null||ne.scrollIntoView({behavior:"smooth",block:"start"})},500)}},[e]),y.useEffect(()=>{if(!xe)return;let K;const M=async()=>{const{data:Q,error:ee}=await oe.from("vision_bpmn_jobs").select("status, bpmn_xml, error_message").eq("id",xe).single();if(ee){console.error("Error checking job status:",ee);return}if(console.log("Job status:",Q.status),Q.status==="completed"&&Q.bpmn_xml){const ve=e==="bpmn"?"BPMN":"P&ID";p(Q.bpmn_xml),D("idle"),u(!1),de(null),E(!1),b(null),k.success(`${ve} diagram generated successfully!`),setTimeout(()=>{var Ne;(Ne=document.getElementById("bpmn-viewer"))==null||Ne.scrollIntoView({behavior:"smooth",block:"start"})},500),K&&clearInterval(K)}else if(Q.status==="failed"){const ve=Q.error_message||"Processing failed. Please try again.";D("idle"),u(!1),de(null),k.error("Upload failed",{description:ve,action:{label:"Retry",onClick:()=>{}},duration:1e4}),K&&clearInterval(K)}},G=oe.channel(`job-${xe}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"vision_bpmn_jobs",filter:`id=eq.${xe}`},Q=>{const ee=Q.new;if(console.log("Realtime job status update:",ee.status),ee.status==="completed"&&ee.bpmn_xml){const ve=e==="bpmn"?"BPMN":"P&ID";p(ee.bpmn_xml),D("idle"),u(!1),de(null),E(!1),b(null),k.success(`${ve} diagram generated successfully!`),setTimeout(()=>{var Ne;(Ne=document.getElementById("bpmn-viewer"))==null||Ne.scrollIntoView({behavior:"smooth",block:"start"})},500),K&&clearInterval(K)}else if(ee.status==="failed"){const ve=ee.error_message||"Processing failed. Please try again.";D("idle"),u(!1),de(null),k.error("Upload failed",{description:ve,action:{label:"Retry",onClick:()=>{w&&Fe()}},duration:1e4}),K&&clearInterval(K)}}).subscribe();K=window.setInterval(M,3e3),M();const ne=window.setTimeout(()=>{K&&clearInterval(K);const Q="Processing timed out - Please try refreshing the page or contact support";D("idle"),u(!1),de(null),k.error("Upload failed",{description:Q,action:{label:"Retry",onClick:()=>{w&&Fe()}},duration:1e4})},3e5);return()=>{clearTimeout(ne),oe.removeChannel(G),K&&clearInterval(K)}},[xe,e,w]);const Se=async K=>{var G,ne;if(!K.trim()){k.error("Please enter a process description");return}if(!t&&i){k.error("You've used all 5 free prompts. Please sign up to continue!"),n("/auth");return}if(!t&&!s()){k.error("You've used all 5 free prompts. Please sign up to continue!"),n("/auth");return}u(!0);const M=e==="bpmn"?"BPMN":"P&ID";D("reading"),await new Promise(Q=>setTimeout(Q,500)),D("generating");try{const{data:Q,error:ee}=await oe.functions.invoke("generate-bpmn",{body:{prompt:K,diagramType:e}});if(ee){console.error("Function error:",ee),D("idle"),(G=ee.message)!=null&&G.includes("429")?k.error("Rate limit exceeded. Please try again in a moment."):(ne=ee.message)!=null&&ne.includes("402")?k.error("AI credits depleted. Please add more credits to continue."):k.error(`Failed to generate ${M} model`);return}D("drawing"),await new Promise(ve=>setTimeout(ve,500)),Q!=null&&Q.bpmnXml?(p(Q.bpmnXml),D("idle"),k.success(`${M} model generated successfully!`)):(D("idle"),k.error("No diagram data received"))}catch(Q){console.error("Error generating BPMN:",Q),D("idle"),k.error("An error occurred while generating the model")}finally{u(!1)}},_e=()=>{Se(c),l("")},ut=K=>{l(K)},_t=async K=>{var Ne,et;const M="dataTransfer"in K?(Ne=K.dataTransfer.files)==null?void 0:Ne[0]:(et=K.target.files)==null?void 0:et[0];if(!M)return;const{data:{user:G},error:ne}=await oe.auth.getUser();if(ne||!G){k.error("Please log in to upload and analyze documents"),n("/auth");return}if(!["image/png","image/jpeg","image/jpg","image/webp","application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","text/plain"].includes(M.type)){k.error("Please upload an image, PDF, Word document, or text file");return}u(!0);const ee=e==="bpmn"?"BPMN":"P&ID";k.info(`Analyzing document and generating ${ee}...`);const ve=new FileReader;ve.onloadend=async()=>{const zt=ve.result;b({name:M.name,type:M.type,base64:zt}),E(!0),u(!1),k.success(`File uploaded! Review the preview before generating ${ee}.`)},ve.readAsDataURL(M)},re=async()=>{if(f)Ke.current&&Ke.current.state==="recording"&&Ke.current.stop(),Ye.current&&(Ye.current.getTracks().forEach(K=>K.stop()),Ye.current=null),m(!1),Ke.current=null;else try{const K=await navigator.mediaDevices.getUserMedia({audio:!0});Ye.current=K;const M=new MediaRecorder(K),G=[];M.ondataavailable=ne=>{G.push(ne.data)},M.onstop=async()=>{const ne=new Blob(G,{type:"audio/webm"}),Q=new FileReader;Q.readAsDataURL(ne),Q.onloadend=async()=>{var ve;const ee=(ve=Q.result)==null?void 0:ve.toString().split(",")[1];try{const{data:Ne,error:et}=await oe.functions.invoke("speech-to-text",{body:{audio:ee,language:v}});if(et)throw et;Ne!=null&&Ne.text&&(l(Ne.text),k.success("Voice recorded successfully!"))}catch(Ne){console.error("Speech-to-text error:",Ne),k.error("Failed to convert speech to text.")}},Ye.current&&(Ye.current.getTracks().forEach(ee=>ee.stop()),Ye.current=null)},M.start(),Ke.current=M,m(!0),k.info("Recording... Click again to stop")}catch(K){console.error("Error accessing microphone:",K),k.error("Could not access microphone. Please check permissions.")}},Fe=async()=>{if(w){u(!0),E(!1),D("reading"),await new Promise(K=>setTimeout(K,500)),D("generating");try{const{data:{user:K}}=await oe.auth.getUser();if(!K){D("idle"),k.error("Please log in to continue"),n("/auth");return}const M=w.base64.length*.75,G=200*1024*1024;if(M>G){D("idle"),u(!1),k.error("File too large",{description:"Maximum file size is 200 MB. Please select a smaller file."});return}const ne=k.loading("Processing your file...",{description:"This may take 30-60 seconds for complex diagrams"}),{data:Q,error:ee}=await oe.functions.invoke("vision-to-bpmn",{body:{imageBase64:w.base64,diagramType:e}});if(k.dismiss(ne),ee){console.error("Vision AI error:",ee),D("idle"),u(!1);const ve=ee.message||"Failed to start diagram generation";k.error("Upload failed",{description:ve,action:{label:"Retry",onClick:()=>{Fe()}},duration:1e4});return}if(!Q||!Q.jobId){D("idle"),u(!1),k.error("Upload failed",{description:"Failed to start processing",action:{label:"Retry",onClick:()=>{Fe()}},duration:1e4});return}de(Q.jobId),D("generating"),k.info("Processing started",{description:"We'll notify you when your diagram is ready (this may take 1-2 minutes)"})}catch(K){console.error("Vision AI processing error:",K),D("idle"),u(!1);const M=K instanceof Error?K.message:"Network error - Please check your connection and try again";k.error("Upload failed",{description:M,action:{label:"Retry",onClick:()=>{Fe()}},duration:1e4})}}},Qe=async()=>{if(!h||!N.trim()){const G=e==="bpmn"?"BPMN":"P&ID";k.error(`Please enter instructions to refine the ${G}`);return}const{data:{user:K}}=await oe.auth.getUser();if(!K){const G=e==="bpmn"?"BPMN":"P&ID";k.error(`Please log in to refine ${G}`),n("/auth");return}R(!0);const M=e==="bpmn"?"BPMN":"P&ID";k.info(`Refining ${M} based on your instructions...`),$("analyzing"),await new Promise(G=>setTimeout(G,500)),$("refining");try{const{data:G,error:ne}=await oe.functions.invoke("refine-bpmn",{body:{currentBpmnXml:h,instructions:N,userId:K.id,diagramType:e}});if(ne){console.error("Refinement error:",ne),$("idle");const Q=ne.message||JSON.stringify(ne);Q.includes("429")?k.error("Rate limit exceeded. Please try again in a moment."):Q.includes("402")?k.error("AI credits depleted. Please add more credits to continue."):Q.includes("401")||Q.includes("Authentication")?(k.error("Authentication required. Please log in again."),n("/auth")):k.error(`Failed to refine ${M}: ${Q}`);return}if(G!=null&&G.error){console.error("Refinement error in response:",G.error),$("idle");const Q=typeof G.error=="string"?G.error:JSON.stringify(G.error);Q.includes("402")?k.error("AI credits depleted. Please add more credits to continue."):Q.includes("401")||Q.includes("Authentication")?(k.error("Authentication required. Please log in again."),n("/auth")):k.error(`Failed to refine ${M}: ${Q}`);return}if(G!=null&&G.bpmnXml){$("applying"),await new Promise(ee=>setTimeout(ee,300));const Q=G.bpmnXml.includes("</bpmn:definitions>")||G.bpmnXml.includes("</definitions>");G.bpmnXml.includes("<?xml")&&Q?(p(G.bpmnXml),$("idle"),k.success(`${M} refined successfully!`),j("")):(console.error("Received invalid diagram XML:",G.bpmnXml.substring(0,200)),$("idle"),k.error("Received invalid diagram structure. Please try again."))}else console.error("No refined diagram received. Response:",G),$("idle"),k.error("No refined diagram received. The function may not be deployed or there was an error.")}catch(G){console.error("BPMN refinement error:",G),$("idle");const ne=G instanceof Error?G.message:String(G);ne.includes("Failed to fetch")||ne.includes("load the resource")?k.error("Network error: Unable to reach refine-bpmn function. Please check if the function is deployed."):k.error(`Failed to refine ${e==="bpmn"?"BPMN":"P&ID"}: ${ne}`)}finally{R(!1)}};return o.jsx("section",{className:"py-24 bg-muted/20 relative","data-section":"try-prossmind",children:o.jsxs("div",{className:"container mx-auto px-6",children:[o.jsxs("div",{className:"text-center mb-12 slide-up",children:[o.jsxs("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:["Try ",o.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"ProssMind!"})]}),o.jsx("p",{className:"text-lg text-muted-foreground max-w-3xl mx-auto",children:e==="bpmn"?"Describe your business process, upload an image, PDF, Word doc, or text file - AI will generate a BPMN diagram for you":"Describe your P&ID process, upload an image, PDF, Word doc, or text file - AI will generate a P&ID diagram for you"})]}),o.jsxs("div",{className:"max-w-5xl mx-auto mt-12 space-y-8",children:[o.jsxs("div",{className:"bg-gradient-to-br from-muted/50 to-muted/30 rounded-2xl p-8 border border-border/50 slide-up stagger-1",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx("div",{className:"rounded-full bg-primary/10 p-2",children:o.jsx(_a,{className:"h-5 w-5 text-primary"})}),o.jsxs("h3",{className:"font-semibold text-lg",children:["Try these ",e==="bpmn"?"BPMN":"P&ID"," examples:"]})]}),o.jsx("div",{className:"flex flex-wrap gap-3",children:Te.map((K,M)=>o.jsx(U,{variant:"outline",size:"sm",onClick:()=>ut(K),className:"text-sm hover:bg-primary/10 hover:border-primary/50 transition-all whitespace-nowrap",disabled:d,style:{minWidth:"max-content",paddingLeft:"1.2em",paddingRight:"1.2em"},"aria-label":`Use suggestion: ${K}`,children:K},M))})]}),o.jsx("div",{className:"bg-card border border-border rounded-2xl p-8 shadow-xl slide-up stagger-2",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs(Cg,{defaultValue:"prompt",className:"w-full",children:[o.jsxs($u,{className:"grid w-full grid-cols-3 bg-muted/50",children:[o.jsxs(Wr,{value:"prompt",className:"gap-2 data-[state=active]:bg-background data-[state=active]:shadow-sm",children:[o.jsx(jf,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Prompt"})]}),o.jsxs(Wr,{value:"voice",className:"gap-2 data-[state=active]:bg-background data-[state=active]:shadow-sm",children:[o.jsx($o,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Voice"})]}),o.jsxs(Wr,{value:"attachment",className:"gap-2 data-[state=active]:bg-background data-[state=active]:shadow-sm",children:[o.jsx(Lo,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Attachment"})]})]}),o.jsx(qr,{value:"prompt",className:"mt-4",children:o.jsx(Er,{placeholder:`Describe your ${e==="bpmn"?"business process":"P&ID process"} step by step...`,value:c,onChange:K=>l(K.target.value),className:"min-h-[120px] resize-none border-muted",style:{paddingLeft:"1.2em",paddingRight:"1.2em"},disabled:d})}),o.jsx(qr,{value:"voice",className:"mt-4",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Qh,{className:"h-4 w-4 text-muted-foreground"}),o.jsxs(Xp,{value:v,onValueChange:g,children:[o.jsx(ud,{className:"w-[200px] h-8",children:o.jsx(Jp,{placeholder:"Select language"})}),o.jsxs(hd,{children:[o.jsx(Ce,{value:"en-US",children:"English (US)"}),o.jsx(Ce,{value:"en-GB",children:"English (UK)"}),o.jsx(Ce,{value:"es-ES",children:"Spanish"}),o.jsx(Ce,{value:"fr-FR",children:"French"}),o.jsx(Ce,{value:"de-DE",children:"German"}),o.jsx(Ce,{value:"it-IT",children:"Italian"}),o.jsx(Ce,{value:"pt-BR",children:"Portuguese (Brazil)"}),o.jsx(Ce,{value:"pt-PT",children:"Portuguese (Portugal)"}),o.jsx(Ce,{value:"ru-RU",children:"Russian"}),o.jsx(Ce,{value:"ja-JP",children:"Japanese"}),o.jsx(Ce,{value:"ko-KR",children:"Korean"}),o.jsx(Ce,{value:"zh-CN",children:"Chinese (Simplified)"}),o.jsx(Ce,{value:"zh-TW",children:"Chinese (Traditional)"}),o.jsx(Ce,{value:"ar-SA",children:"Arabic"}),o.jsx(Ce,{value:"hi-IN",children:"Hindi"})]})]}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"Voice recognition language"})]}),o.jsx(U,{variant:"outline",onClick:re,disabled:d,className:f?"text-red-500 border-red-500":"w-full",children:f?o.jsxs(o.Fragment,{children:[o.jsx(ep,{className:"h-4 w-4 mr-2 animate-pulse"}),"Click to Stop Recording"]}):o.jsxs(o.Fragment,{children:[o.jsx($o,{className:"h-4 w-4 mr-2"}),"Start Voice Recording"]})})]})}),o.jsx(qr,{value:"attachment",className:"mt-4",children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("input",{ref:pe,type:"file",accept:"image/*,.pdf,.doc,.docx,.txt",onChange:_t,className:"hidden"}),o.jsxs("div",{onDragOver:K=>{K.preventDefault(),$e(!0)},onDragLeave:()=>$e(!1),onDrop:K=>{K.preventDefault(),$e(!1),_t(K)},className:`border-2 border-dashed rounded-2xl p-8 text-center transition-all ${Be?"border-primary bg-primary/5 scale-[1.02]":"border-border hover:border-primary/50"}`,children:[o.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[o.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[o.jsx(Ri,{className:"h-5 w-5","aria-hidden":"true"}),o.jsx("span",{className:"text-xs",children:"PNG/JPG"})]}),o.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[o.jsx(or,{className:"h-5 w-5","aria-hidden":"true"}),o.jsx("span",{className:"text-xs",children:"PDF"})]}),o.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[o.jsx(Jh,{className:"h-5 w-5","aria-hidden":"true"}),o.jsx("span",{className:"text-xs",children:"DOCX"})]})]}),o.jsxs(U,{variant:"outline",onClick:()=>{var K;return(K=pe.current)==null?void 0:K.click()},disabled:d,className:"w-full","aria-label":"Upload file",children:[o.jsx(Lo,{className:"h-4 w-4 mr-2","aria-hidden":"true"}),"Upload File"]}),o.jsx("p",{className:"text-xs text-muted-foreground mt-3",children:"Drag and drop a file here or click to browse"})]})]})})]}),d&&B!=="idle"&&o.jsxs("div",{className:"space-y-3 p-4 bg-muted/50 rounded-lg border border-border",children:[o.jsx("p",{className:"text-sm font-medium text-foreground mb-2",children:"Processing your document..."}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("span",{className:B==="reading"?"font-semibold":"text-muted-foreground",children:[B==="reading"&&o.jsx(On,{className:"h-4 w-4 inline mr-2 animate-spin","aria-hidden":"true"}),B!=="reading"&&" ","Step 1: Reading prompt..."]}),B==="reading"&&o.jsx(Ln,{value:33,className:"w-24","aria-label":"Progress: 33%"})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("span",{className:B==="generating"?"font-semibold":B==="drawing"?"text-muted-foreground":"",children:[B==="generating"&&o.jsx(On,{className:"h-4 w-4 inline mr-2 animate-spin","aria-hidden":"true"}),B!=="generating"&&B!=="reading"&&" ","Step 2: Generating..."]}),B==="generating"&&o.jsx(Ln,{value:66,className:"w-24","aria-label":"Progress: 66%"})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("span",{className:B==="drawing"?"font-semibold":"text-muted-foreground",children:[B==="drawing"&&o.jsx(On,{className:"h-4 w-4 inline mr-2 animate-spin","aria-hidden":"true"}),B!=="drawing"&&B!=="generating"&&B!=="reading"&&" ","Step 3: Drawing Diagram..."]}),B==="drawing"&&o.jsx(Ln,{value:100,className:"w-24","aria-label":"Progress: 100%"})]})]}),o.jsxs(U,{onClick:_e,className:"gap-2 shadow-lg hover:shadow-xl hover:scale-[1.03] transition-all w-full",size:"lg",disabled:d||!c.trim(),"aria-label":`Generate ${e==="bpmn"?"BPMN":"P&ID"} diagram`,children:[d?"Generating...":`Generate ${e==="bpmn"?"BPMN":"P&ID"}`,o.jsx(Wl,{className:"h-4 w-4","aria-hidden":"true"})]})]})}),x&&w&&o.jsxs("div",{className:"bg-card border border-border rounded-2xl p-6 shadow-lg",children:[o.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Preview Uploaded File"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-muted/30 rounded-lg p-4",children:[o.jsxs("p",{className:"text-sm font-medium mb-2",children:["File: ",w.name]}),w.type.startsWith("image/")&&o.jsx("div",{className:"mt-4 max-h-96 overflow-auto",children:o.jsx("img",{src:w.base64,alt:"Preview",className:"max-w-full rounded border"})}),w.extractedText&&o.jsxs("div",{className:"mt-4",children:[o.jsx("p",{className:"text-sm font-medium mb-2",children:"Extracted Content Preview:"}),o.jsx("div",{className:"bg-background rounded p-3 max-h-48 overflow-auto text-xs",children:w.extractedText})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(U,{onClick:Fe,className:"flex-1",disabled:d,children:d?"Generating...":`Generate ${e==="bpmn"?"BPMN":"P&ID"} from this file`}),o.jsx(U,{variant:"outline",onClick:()=>{E(!1),b(null)},children:"Cancel"})]})]})]}),h&&o.jsx("div",{id:"bpmn-viewer",className:"mt-12",children:o.jsx(Ng,{xml:h,onSave:p,diagramType:e,onRefine:()=>F(!0)})}),o.jsx(hn,{open:q,onOpenChange:F,children:o.jsxs(en,{className:"sm:max-w-[500px]",children:[o.jsxs(tn,{children:[o.jsxs(nn,{children:["Refine ",e==="bpmn"?"BPMN":"P&ID"," Diagram"]}),o.jsxs(rn,{children:["Describe the changes you'd like to make to your ",e==="bpmn"?"BPMN":"P&ID"," diagram"]})]}),o.jsx(Er,{value:N,onChange:K=>j(K.target.value),placeholder:`e.g., "Add a ${e==="bpmn"?"decision gateway":"control valve"} after the first ${e==="bpmn"?"task":"process unit"}"`,className:"min-h-[120px]"}),o.jsxs("div",{className:"flex gap-2 justify-end",children:[o.jsx(U,{variant:"outline",onClick:()=>{F(!1),j("")},children:"Cancel"}),o.jsx(U,{onClick:Qe,disabled:C||!N.trim(),children:C?"Refining...":"Apply Changes"})]})]})})]})]})})};async function HF(t){const{data:e,error:n}=await oe.from("vision_bpmn_jobs").select("bpmn_xml").eq("id",t).single();return n||!(e!=null&&e.bpmn_xml)?(console.error("Failed to load job result:",n),null):e.bpmn_xml}function VF(){const[t,e]=y.useState(null),[n,r]=y.useState(null),{jobId:i}=Tk();return y.useEffect(()=>{oe.auth.getSession().then(({data:{session:a}})=>{r((a==null?void 0:a.user)??null)});const{data:{subscription:s}}=oe.auth.onAuthStateChange((a,c)=>{r((c==null?void 0:c.user)??null)});return()=>s.unsubscribe()},[]),y.useEffect(()=>{i&&(async()=>{try{const a=await HF(i);e(a)}catch(a){console.error("Error loading job result:",a)}})()},[i]),o.jsx(zu,{children:o.jsxs("div",{className:"flex flex-col gap-8",children:[o.jsx(UF,{user:n,diagramType:"pid"}),t&&o.jsx(Ng,{xml:t,diagramType:"pid"})]})})}const GF=()=>{const t=tk();return t==="bpmn"?o.jsx(zF,{}):t==="pid"?o.jsx(VF,{}):o.jsx(ek,{})},WF=tk();Lw(document.getElementById("root")).render(o.jsx(cI,{children:WF?o.jsx(GF,{}):o.jsx(ek,{})}));
